(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var ub=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function nl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function cb(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var G2={exports:{}},Mc={},V2={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rl=Symbol.for("react.element"),U6=Symbol.for("react.portal"),G6=Symbol.for("react.fragment"),V6=Symbol.for("react.strict_mode"),W6=Symbol.for("react.profiler"),$6=Symbol.for("react.provider"),H6=Symbol.for("react.context"),X6=Symbol.for("react.forward_ref"),Y6=Symbol.for("react.suspense"),K6=Symbol.for("react.memo"),Q6=Symbol.for("react.lazy"),hm=Symbol.iterator;function Z6(t){return t===null||typeof t!="object"?null:(t=hm&&t[hm]||t["@@iterator"],typeof t=="function"?t:null)}var W2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$2=Object.assign,H2={};function ko(t,e,n){this.props=t,this.context=e,this.refs=H2,this.updater=n||W2}ko.prototype.isReactComponent={};ko.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ko.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function X2(){}X2.prototype=ko.prototype;function cp(t,e,n){this.props=t,this.context=e,this.refs=H2,this.updater=n||W2}var dp=cp.prototype=new X2;dp.constructor=cp;$2(dp,ko.prototype);dp.isPureReactComponent=!0;var pm=Array.isArray,Y2=Object.prototype.hasOwnProperty,fp={current:null},K2={key:!0,ref:!0,__self:!0,__source:!0};function Q2(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)Y2.call(e,r)&&!K2.hasOwnProperty(r)&&(i[r]=e[r]);var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){for(var u=Array(c),f=0;f<c;f++)u[f]=arguments[f+2];i.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)i[r]===void 0&&(i[r]=c[r]);return{$$typeof:rl,type:t,key:s,ref:l,props:i,_owner:fp.current}}function q6(t,e){return{$$typeof:rl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function hp(t){return typeof t=="object"&&t!==null&&t.$$typeof===rl}function J6(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var gm=/\/+/g;function th(t,e){return typeof t=="object"&&t!==null&&t.key!=null?J6(""+t.key):e.toString(36)}function Ru(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case rl:case U6:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+th(l,0):r,pm(i)?(n="",t!=null&&(n=t.replace(gm,"$&/")+"/"),Ru(i,e,n,"",function(f){return f})):i!=null&&(hp(i)&&(i=q6(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(gm,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",pm(t))for(var c=0;c<t.length;c++){s=t[c];var u=r+th(s,c);l+=Ru(s,e,n,u,i)}else if(u=Z6(t),typeof u=="function")for(t=u.call(t),c=0;!(s=t.next()).done;)s=s.value,u=r+th(s,c++),l+=Ru(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function lu(t,e,n){if(t==null)return t;var r=[],i=0;return Ru(t,r,"","",function(s){return e.call(n,s,i++)}),r}function e8(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Qt={current:null},Iu={transition:null},t8={ReactCurrentDispatcher:Qt,ReactCurrentBatchConfig:Iu,ReactCurrentOwner:fp};function Z2(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:lu,forEach:function(t,e,n){lu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return lu(t,function(){e++}),e},toArray:function(t){return lu(t,function(e){return e})||[]},only:function(t){if(!hp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=ko;be.Fragment=G6;be.Profiler=W6;be.PureComponent=cp;be.StrictMode=V6;be.Suspense=Y6;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t8;be.act=Z2;be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=$2({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=fp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)Y2.call(e,u)&&!K2.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var f=0;f<u;f++)c[f]=arguments[f+2];r.children=c}return{$$typeof:rl,type:t.type,key:i,ref:s,props:r,_owner:l}};be.createContext=function(t){return t={$$typeof:H6,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:$6,_context:t},t.Consumer=t};be.createElement=Q2;be.createFactory=function(t){var e=Q2.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:X6,render:t}};be.isValidElement=hp;be.lazy=function(t){return{$$typeof:Q6,_payload:{_status:-1,_result:t},_init:e8}};be.memo=function(t,e){return{$$typeof:K6,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=Iu.transition;Iu.transition={};try{t()}finally{Iu.transition=e}};be.unstable_act=Z2;be.useCallback=function(t,e){return Qt.current.useCallback(t,e)};be.useContext=function(t){return Qt.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return Qt.current.useDeferredValue(t)};be.useEffect=function(t,e){return Qt.current.useEffect(t,e)};be.useId=function(){return Qt.current.useId()};be.useImperativeHandle=function(t,e,n){return Qt.current.useImperativeHandle(t,e,n)};be.useInsertionEffect=function(t,e){return Qt.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return Qt.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return Qt.current.useMemo(t,e)};be.useReducer=function(t,e,n){return Qt.current.useReducer(t,e,n)};be.useRef=function(t){return Qt.current.useRef(t)};be.useState=function(t){return Qt.current.useState(t)};be.useSyncExternalStore=function(t,e,n){return Qt.current.useSyncExternalStore(t,e,n)};be.useTransition=function(){return Qt.current.useTransition()};be.version="18.3.1";V2.exports=be;var B=V2.exports;const Vt=nl(B);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n8=B,r8=Symbol.for("react.element"),i8=Symbol.for("react.fragment"),s8=Object.prototype.hasOwnProperty,o8=n8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a8={key:!0,ref:!0,__self:!0,__source:!0};function q2(t,e,n){var r,i={},s=null,l=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)s8.call(e,r)&&!a8.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:r8,type:t,key:s,ref:l,props:i,_owner:o8.current}}Mc.Fragment=i8;Mc.jsx=q2;Mc.jsxs=q2;G2.exports=Mc;var M=G2.exports,Jh={},J2={exports:{}},xn={},ev={exports:{}},tv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,W){var X=O.length;O.push(W);e:for(;0<X;){var ee=X-1>>>1,J=O[ee];if(0<i(J,W))O[ee]=W,O[X]=J,X=ee;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var W=O[0],X=O.pop();if(X!==W){O[0]=X;e:for(var ee=0,J=O.length,te=J>>>1;ee<te;){var ae=2*(ee+1)-1,ne=O[ae],oe=ae+1,U=O[oe];if(0>i(ne,X))oe<J&&0>i(U,ne)?(O[ee]=U,O[oe]=X,ee=oe):(O[ee]=ne,O[ae]=X,ee=ae);else if(oe<J&&0>i(U,X))O[ee]=U,O[oe]=X,ee=oe;else break e}}return W}function i(O,W){var X=O.sortIndex-W.sortIndex;return X!==0?X:O.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],f=[],p=1,m=null,x=3,v=!1,w=!1,T=!1,k=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function h(O){for(var W=n(f);W!==null;){if(W.callback===null)r(f);else if(W.startTime<=O)r(f),W.sortIndex=W.expirationTime,e(u,W);else break;W=n(f)}}function _(O){if(T=!1,h(O),!w)if(n(u)!==null)w=!0,G(E);else{var W=n(f);W!==null&&Y(_,W.startTime-O)}}function E(O,W){w=!1,T&&(T=!1,S(A),A=-1),v=!0;var X=x;try{for(h(W),m=n(u);m!==null&&(!(m.expirationTime>W)||O&&!R());){var ee=m.callback;if(typeof ee=="function"){m.callback=null,x=m.priorityLevel;var J=ee(m.expirationTime<=W);W=t.unstable_now(),typeof J=="function"?m.callback=J:m===n(u)&&r(u),h(W)}else r(u);m=n(u)}if(m!==null)var te=!0;else{var ae=n(f);ae!==null&&Y(_,ae.startTime-W),te=!1}return te}finally{m=null,x=X,v=!1}}var P=!1,I=null,A=-1,F=5,N=-1;function R(){return!(t.unstable_now()-N<F)}function D(){if(I!==null){var O=t.unstable_now();N=O;var W=!0;try{W=I(!0,O)}finally{W?V():(P=!1,I=null)}}else P=!1}var V;if(typeof C=="function")V=function(){C(D)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,z=j.port2;j.port1.onmessage=D,V=function(){z.postMessage(null)}}else V=function(){k(D,0)};function G(O){I=O,P||(P=!0,V())}function Y(O,W){A=k(function(){O(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){w||v||(w=!0,G(E))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(O){switch(x){case 1:case 2:case 3:var W=3;break;default:W=x}var X=x;x=W;try{return O()}finally{x=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,W){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var X=x;x=O;try{return W()}finally{x=X}},t.unstable_scheduleCallback=function(O,W,X){var ee=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ee+X:ee):X=ee,O){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=X+J,O={id:p++,callback:W,priorityLevel:O,startTime:X,expirationTime:J,sortIndex:-1},X>ee?(O.sortIndex=X,e(f,O),n(u)===null&&O===n(f)&&(T?(S(A),A=-1):T=!0,Y(_,X-ee))):(O.sortIndex=J,e(u,O),w||v||(w=!0,G(E))),O},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(O){var W=x;return function(){var X=x;x=W;try{return O.apply(this,arguments)}finally{x=X}}}})(tv);ev.exports=tv;var Sa=ev.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l8=B,vn=Sa;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nv=new Set,La={};function us(t,e){fo(t,e),fo(t+"Capture",e)}function fo(t,e){for(La[t]=e,t=0;t<e.length;t++)nv.add(e[t])}var zr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),e0=Object.prototype.hasOwnProperty,u8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mm={},ym={};function c8(t){return e0.call(ym,t)?!0:e0.call(mm,t)?!1:u8.test(t)?ym[t]=!0:(mm[t]=!0,!1)}function d8(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function f8(t,e,n,r){if(e===null||typeof e>"u"||d8(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zt(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var Lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Lt[t]=new Zt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Lt[e]=new Zt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Lt[t]=new Zt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Lt[t]=new Zt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Lt[t]=new Zt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Lt[t]=new Zt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Lt[t]=new Zt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Lt[t]=new Zt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Lt[t]=new Zt(t,5,!1,t.toLowerCase(),null,!1,!1)});var pp=/[\-:]([a-z])/g;function gp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(pp,gp);Lt[e]=new Zt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(pp,gp);Lt[e]=new Zt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(pp,gp);Lt[e]=new Zt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Lt[t]=new Zt(t,1,!1,t.toLowerCase(),null,!1,!1)});Lt.xlinkHref=new Zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Lt[t]=new Zt(t,1,!1,t.toLowerCase(),null,!0,!0)});function mp(t,e,n,r){var i=Lt.hasOwnProperty(e)?Lt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(f8(e,n,i,r)&&(n=null),r||i===null?c8(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Vr=l8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uu=Symbol.for("react.element"),Ws=Symbol.for("react.portal"),$s=Symbol.for("react.fragment"),yp=Symbol.for("react.strict_mode"),t0=Symbol.for("react.profiler"),rv=Symbol.for("react.provider"),iv=Symbol.for("react.context"),vp=Symbol.for("react.forward_ref"),n0=Symbol.for("react.suspense"),r0=Symbol.for("react.suspense_list"),xp=Symbol.for("react.memo"),ci=Symbol.for("react.lazy"),sv=Symbol.for("react.offscreen"),vm=Symbol.iterator;function ta(t){return t===null||typeof t!="object"?null:(t=vm&&t[vm]||t["@@iterator"],typeof t=="function"?t:null)}var nt=Object.assign,nh;function ya(t){if(nh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);nh=e&&e[1]||""}return`
`+nh+t}var rh=!1;function ih(t,e){if(!t||rh)return"";rh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var r=f}Reflect.construct(t,[],e)}else{try{e.call()}catch(f){r=f}t.call(e.prototype)}else{try{throw Error()}catch(f){r=f}t()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,c=s.length-1;1<=l&&0<=c&&i[l]!==s[c];)c--;for(;1<=l&&0<=c;l--,c--)if(i[l]!==s[c]){if(l!==1||c!==1)do if(l--,c--,0>c||i[l]!==s[c]){var u=`
`+i[l].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=l&&0<=c);break}}}finally{rh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ya(t):""}function h8(t){switch(t.tag){case 5:return ya(t.type);case 16:return ya("Lazy");case 13:return ya("Suspense");case 19:return ya("SuspenseList");case 0:case 2:case 15:return t=ih(t.type,!1),t;case 11:return t=ih(t.type.render,!1),t;case 1:return t=ih(t.type,!0),t;default:return""}}function i0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $s:return"Fragment";case Ws:return"Portal";case t0:return"Profiler";case yp:return"StrictMode";case n0:return"Suspense";case r0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case iv:return(t.displayName||"Context")+".Consumer";case rv:return(t._context.displayName||"Context")+".Provider";case vp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case xp:return e=t.displayName||null,e!==null?e:i0(t.type)||"Memo";case ci:e=t._payload,t=t._init;try{return i0(t(e))}catch{}}return null}function p8(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return i0(e);case 8:return e===yp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ti(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ov(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function g8(t){var e=ov(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function cu(t){t._valueTracker||(t._valueTracker=g8(t))}function av(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ov(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Qu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function s0(t,e){var n=e.checked;return nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function xm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ti(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lv(t,e){e=e.checked,e!=null&&mp(t,"checked",e,!1)}function o0(t,e){lv(t,e);var n=Ti(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?a0(t,e.type,n):e.hasOwnProperty("defaultValue")&&a0(t,e.type,Ti(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function wm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function a0(t,e,n){(e!=="number"||Qu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var va=Array.isArray;function ro(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ti(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function l0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return nt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _m(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ie(92));if(va(n)){if(1<n.length)throw Error(ie(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ti(n)}}function uv(t,e){var n=Ti(e.value),r=Ti(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Sm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function cv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function u0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?cv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var du,dv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(du=du||document.createElement("div"),du.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=du.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ka={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},m8=["Webkit","ms","Moz","O"];Object.keys(ka).forEach(function(t){m8.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ka[e]=ka[t]})});function fv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ka.hasOwnProperty(t)&&ka[t]?(""+e).trim():e+"px"}function hv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=fv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var y8=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function c0(t,e){if(e){if(y8[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function d0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var f0=null;function wp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var h0=null,io=null,so=null;function km(t){if(t=ol(t)){if(typeof h0!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=Oc(e),h0(t.stateNode,t.type,e))}}function pv(t){io?so?so.push(t):so=[t]:io=t}function gv(){if(io){var t=io,e=so;if(so=io=null,km(t),e)for(t=0;t<e.length;t++)km(e[t])}}function mv(t,e){return t(e)}function yv(){}var sh=!1;function vv(t,e,n){if(sh)return t(e,n);sh=!0;try{return mv(t,e,n)}finally{sh=!1,(io!==null||so!==null)&&(yv(),gv())}}function Oa(t,e){var n=t.stateNode;if(n===null)return null;var r=Oc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ie(231,e,typeof n));return n}var p0=!1;if(zr)try{var na={};Object.defineProperty(na,"passive",{get:function(){p0=!0}}),window.addEventListener("test",na,na),window.removeEventListener("test",na,na)}catch{p0=!1}function v8(t,e,n,r,i,s,l,c,u){var f=Array.prototype.slice.call(arguments,3);try{e.apply(n,f)}catch(p){this.onError(p)}}var Ca=!1,Zu=null,qu=!1,g0=null,x8={onError:function(t){Ca=!0,Zu=t}};function w8(t,e,n,r,i,s,l,c,u){Ca=!1,Zu=null,v8.apply(x8,arguments)}function _8(t,e,n,r,i,s,l,c,u){if(w8.apply(this,arguments),Ca){if(Ca){var f=Zu;Ca=!1,Zu=null}else throw Error(ie(198));qu||(qu=!0,g0=f)}}function cs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function xv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Cm(t){if(cs(t)!==t)throw Error(ie(188))}function S8(t){var e=t.alternate;if(!e){if(e=cs(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Cm(i),t;if(s===r)return Cm(i),e;s=s.sibling}throw Error(ie(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,c=i.child;c;){if(c===n){l=!0,n=i,r=s;break}if(c===r){l=!0,r=i,n=s;break}c=c.sibling}if(!l){for(c=s.child;c;){if(c===n){l=!0,n=s,r=i;break}if(c===r){l=!0,r=s,n=i;break}c=c.sibling}if(!l)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?t:e}function wv(t){return t=S8(t),t!==null?_v(t):null}function _v(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=_v(t);if(e!==null)return e;t=t.sibling}return null}var Sv=vn.unstable_scheduleCallback,Em=vn.unstable_cancelCallback,k8=vn.unstable_shouldYield,C8=vn.unstable_requestPaint,lt=vn.unstable_now,E8=vn.unstable_getCurrentPriorityLevel,_p=vn.unstable_ImmediatePriority,kv=vn.unstable_UserBlockingPriority,Ju=vn.unstable_NormalPriority,T8=vn.unstable_LowPriority,Cv=vn.unstable_IdlePriority,Rc=null,_r=null;function b8(t){if(_r&&typeof _r.onCommitFiberRoot=="function")try{_r.onCommitFiberRoot(Rc,t,void 0,(t.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:A8,P8=Math.log,N8=Math.LN2;function A8(t){return t>>>=0,t===0?32:31-(P8(t)/N8|0)|0}var fu=64,hu=4194304;function xa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ec(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var c=l&~i;c!==0?r=xa(c):(s&=l,s!==0&&(r=xa(s)))}else l=n&~i,l!==0?r=xa(l):s!==0&&(r=xa(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-er(e),i=1<<n,r|=t[n],e&=~i;return r}function M8(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R8(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-er(s),c=1<<l,u=i[l];u===-1?(!(c&n)||c&r)&&(i[l]=M8(c,e)):u<=e&&(t.expiredLanes|=c),s&=~c}}function m0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ev(){var t=fu;return fu<<=1,!(fu&4194240)&&(fu=64),t}function oh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function il(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-er(e),t[e]=n}function I8(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-er(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Sp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-er(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var je=0;function Tv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var bv,kp,Pv,Nv,Av,y0=!1,pu=[],yi=null,vi=null,xi=null,ja=new Map,Da=new Map,hi=[],L8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tm(t,e){switch(t){case"focusin":case"focusout":yi=null;break;case"dragenter":case"dragleave":vi=null;break;case"mouseover":case"mouseout":xi=null;break;case"pointerover":case"pointerout":ja.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Da.delete(e.pointerId)}}function ra(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ol(e),e!==null&&kp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function F8(t,e,n,r,i){switch(e){case"focusin":return yi=ra(yi,t,e,n,r,i),!0;case"dragenter":return vi=ra(vi,t,e,n,r,i),!0;case"mouseover":return xi=ra(xi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ja.set(s,ra(ja.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Da.set(s,ra(Da.get(s)||null,t,e,n,r,i)),!0}return!1}function Mv(t){var e=Ji(t.target);if(e!==null){var n=cs(e);if(n!==null){if(e=n.tag,e===13){if(e=xv(n),e!==null){t.blockedOn=e,Av(t.priority,function(){Pv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Lu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=v0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);f0=r,n.target.dispatchEvent(r),f0=null}else return e=ol(n),e!==null&&kp(e),t.blockedOn=n,!1;e.shift()}return!0}function bm(t,e,n){Lu(t)&&n.delete(e)}function O8(){y0=!1,yi!==null&&Lu(yi)&&(yi=null),vi!==null&&Lu(vi)&&(vi=null),xi!==null&&Lu(xi)&&(xi=null),ja.forEach(bm),Da.forEach(bm)}function ia(t,e){t.blockedOn===e&&(t.blockedOn=null,y0||(y0=!0,vn.unstable_scheduleCallback(vn.unstable_NormalPriority,O8)))}function za(t){function e(i){return ia(i,t)}if(0<pu.length){ia(pu[0],t);for(var n=1;n<pu.length;n++){var r=pu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(yi!==null&&ia(yi,t),vi!==null&&ia(vi,t),xi!==null&&ia(xi,t),ja.forEach(e),Da.forEach(e),n=0;n<hi.length;n++)r=hi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<hi.length&&(n=hi[0],n.blockedOn===null);)Mv(n),n.blockedOn===null&&hi.shift()}var oo=Vr.ReactCurrentBatchConfig,tc=!0;function j8(t,e,n,r){var i=je,s=oo.transition;oo.transition=null;try{je=1,Cp(t,e,n,r)}finally{je=i,oo.transition=s}}function D8(t,e,n,r){var i=je,s=oo.transition;oo.transition=null;try{je=4,Cp(t,e,n,r)}finally{je=i,oo.transition=s}}function Cp(t,e,n,r){if(tc){var i=v0(t,e,n,r);if(i===null)mh(t,e,r,nc,n),Tm(t,r);else if(F8(i,t,e,n,r))r.stopPropagation();else if(Tm(t,r),e&4&&-1<L8.indexOf(t)){for(;i!==null;){var s=ol(i);if(s!==null&&bv(s),s=v0(t,e,n,r),s===null&&mh(t,e,r,nc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else mh(t,e,r,null,n)}}var nc=null;function v0(t,e,n,r){if(nc=null,t=wp(r),t=Ji(t),t!==null)if(e=cs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=xv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return nc=t,null}function Rv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(E8()){case _p:return 1;case kv:return 4;case Ju:case T8:return 16;case Cv:return 536870912;default:return 16}default:return 16}}var gi=null,Ep=null,Fu=null;function Iv(){if(Fu)return Fu;var t,e=Ep,n=e.length,r,i="value"in gi?gi.value:gi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return Fu=i.slice(t,1<r?1-r:void 0)}function Ou(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gu(){return!0}function Pm(){return!1}function wn(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(s):s[c]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?gu:Pm,this.isPropagationStopped=Pm,this}return nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gu)},persist:function(){},isPersistent:gu}),e}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tp=wn(Co),sl=nt({},Co,{view:0,detail:0}),z8=wn(sl),ah,lh,sa,Ic=nt({},sl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==sa&&(sa&&t.type==="mousemove"?(ah=t.screenX-sa.screenX,lh=t.screenY-sa.screenY):lh=ah=0,sa=t),ah)},movementY:function(t){return"movementY"in t?t.movementY:lh}}),Nm=wn(Ic),B8=nt({},Ic,{dataTransfer:0}),U8=wn(B8),G8=nt({},sl,{relatedTarget:0}),uh=wn(G8),V8=nt({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),W8=wn(V8),$8=nt({},Co,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),H8=wn($8),X8=nt({},Co,{data:0}),Am=wn(X8),Y8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},K8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Z8(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Q8[t])?!!e[t]:!1}function bp(){return Z8}var q8=nt({},sl,{key:function(t){if(t.key){var e=Y8[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ou(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?K8[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bp,charCode:function(t){return t.type==="keypress"?Ou(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ou(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),J8=wn(q8),ex=nt({},Ic,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mm=wn(ex),tx=nt({},sl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bp}),nx=wn(tx),rx=nt({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),ix=wn(rx),sx=nt({},Ic,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ox=wn(sx),ax=[9,13,27,32],Pp=zr&&"CompositionEvent"in window,Ea=null;zr&&"documentMode"in document&&(Ea=document.documentMode);var lx=zr&&"TextEvent"in window&&!Ea,Lv=zr&&(!Pp||Ea&&8<Ea&&11>=Ea),Rm=String.fromCharCode(32),Im=!1;function Fv(t,e){switch(t){case"keyup":return ax.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ov(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Hs=!1;function ux(t,e){switch(t){case"compositionend":return Ov(e);case"keypress":return e.which!==32?null:(Im=!0,Rm);case"textInput":return t=e.data,t===Rm&&Im?null:t;default:return null}}function cx(t,e){if(Hs)return t==="compositionend"||!Pp&&Fv(t,e)?(t=Iv(),Fu=Ep=gi=null,Hs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Lv&&e.locale!=="ko"?null:e.data;default:return null}}var dx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dx[t.type]:e==="textarea"}function jv(t,e,n,r){pv(r),e=rc(e,"onChange"),0<e.length&&(n=new Tp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ta=null,Ba=null;function fx(t){Yv(t,0)}function Lc(t){var e=Ks(t);if(av(e))return t}function hx(t,e){if(t==="change")return e}var Dv=!1;if(zr){var ch;if(zr){var dh="oninput"in document;if(!dh){var Fm=document.createElement("div");Fm.setAttribute("oninput","return;"),dh=typeof Fm.oninput=="function"}ch=dh}else ch=!1;Dv=ch&&(!document.documentMode||9<document.documentMode)}function Om(){Ta&&(Ta.detachEvent("onpropertychange",zv),Ba=Ta=null)}function zv(t){if(t.propertyName==="value"&&Lc(Ba)){var e=[];jv(e,Ba,t,wp(t)),vv(fx,e)}}function px(t,e,n){t==="focusin"?(Om(),Ta=e,Ba=n,Ta.attachEvent("onpropertychange",zv)):t==="focusout"&&Om()}function gx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Lc(Ba)}function mx(t,e){if(t==="click")return Lc(e)}function yx(t,e){if(t==="input"||t==="change")return Lc(e)}function vx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var rr=typeof Object.is=="function"?Object.is:vx;function Ua(t,e){if(rr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!e0.call(e,i)||!rr(t[i],e[i]))return!1}return!0}function jm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Dm(t,e){var n=jm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jm(n)}}function Bv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Bv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Uv(){for(var t=window,e=Qu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qu(t.document)}return e}function Np(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function xx(t){var e=Uv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Bv(n.ownerDocument.documentElement,n)){if(r!==null&&Np(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Dm(n,s);var l=Dm(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wx=zr&&"documentMode"in document&&11>=document.documentMode,Xs=null,x0=null,ba=null,w0=!1;function zm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;w0||Xs==null||Xs!==Qu(r)||(r=Xs,"selectionStart"in r&&Np(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ba&&Ua(ba,r)||(ba=r,r=rc(x0,"onSelect"),0<r.length&&(e=new Tp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xs)))}function mu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ys={animationend:mu("Animation","AnimationEnd"),animationiteration:mu("Animation","AnimationIteration"),animationstart:mu("Animation","AnimationStart"),transitionend:mu("Transition","TransitionEnd")},fh={},Gv={};zr&&(Gv=document.createElement("div").style,"AnimationEvent"in window||(delete Ys.animationend.animation,delete Ys.animationiteration.animation,delete Ys.animationstart.animation),"TransitionEvent"in window||delete Ys.transitionend.transition);function Fc(t){if(fh[t])return fh[t];if(!Ys[t])return t;var e=Ys[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Gv)return fh[t]=e[n];return t}var Vv=Fc("animationend"),Wv=Fc("animationiteration"),$v=Fc("animationstart"),Hv=Fc("transitionend"),Xv=new Map,Bm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(t,e){Xv.set(t,e),us(e,[t])}for(var hh=0;hh<Bm.length;hh++){var ph=Bm[hh],_x=ph.toLowerCase(),Sx=ph[0].toUpperCase()+ph.slice(1);Ni(_x,"on"+Sx)}Ni(Vv,"onAnimationEnd");Ni(Wv,"onAnimationIteration");Ni($v,"onAnimationStart");Ni("dblclick","onDoubleClick");Ni("focusin","onFocus");Ni("focusout","onBlur");Ni(Hv,"onTransitionEnd");fo("onMouseEnter",["mouseout","mouseover"]);fo("onMouseLeave",["mouseout","mouseover"]);fo("onPointerEnter",["pointerout","pointerover"]);fo("onPointerLeave",["pointerout","pointerover"]);us("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));us("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));us("onBeforeInput",["compositionend","keypress","textInput","paste"]);us("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));us("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));us("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kx=new Set("cancel close invalid load scroll toggle".split(" ").concat(wa));function Um(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,_8(r,e,void 0,t),t.currentTarget=null}function Yv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var c=r[l],u=c.instance,f=c.currentTarget;if(c=c.listener,u!==s&&i.isPropagationStopped())break e;Um(i,c,f),s=u}else for(l=0;l<r.length;l++){if(c=r[l],u=c.instance,f=c.currentTarget,c=c.listener,u!==s&&i.isPropagationStopped())break e;Um(i,c,f),s=u}}}if(qu)throw t=g0,qu=!1,g0=null,t}function He(t,e){var n=e[E0];n===void 0&&(n=e[E0]=new Set);var r=t+"__bubble";n.has(r)||(Kv(e,t,2,!1),n.add(r))}function gh(t,e,n){var r=0;e&&(r|=4),Kv(n,t,r,e)}var yu="_reactListening"+Math.random().toString(36).slice(2);function Ga(t){if(!t[yu]){t[yu]=!0,nv.forEach(function(n){n!=="selectionchange"&&(kx.has(n)||gh(n,!1,t),gh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[yu]||(e[yu]=!0,gh("selectionchange",!1,e))}}function Kv(t,e,n,r){switch(Rv(e)){case 1:var i=j8;break;case 4:i=D8;break;default:i=Cp}n=i.bind(null,e,n,t),i=void 0,!p0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function mh(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;l=l.return}for(;c!==null;){if(l=Ji(c),l===null)return;if(u=l.tag,u===5||u===6){r=s=l;continue e}c=c.parentNode}}r=r.return}vv(function(){var f=s,p=wp(n),m=[];e:{var x=Xv.get(t);if(x!==void 0){var v=Tp,w=t;switch(t){case"keypress":if(Ou(n)===0)break e;case"keydown":case"keyup":v=J8;break;case"focusin":w="focus",v=uh;break;case"focusout":w="blur",v=uh;break;case"beforeblur":case"afterblur":v=uh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Nm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=U8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=nx;break;case Vv:case Wv:case $v:v=W8;break;case Hv:v=ix;break;case"scroll":v=z8;break;case"wheel":v=ox;break;case"copy":case"cut":case"paste":v=H8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Mm}var T=(e&4)!==0,k=!T&&t==="scroll",S=T?x!==null?x+"Capture":null:x;T=[];for(var C=f,h;C!==null;){h=C;var _=h.stateNode;if(h.tag===5&&_!==null&&(h=_,S!==null&&(_=Oa(C,S),_!=null&&T.push(Va(C,_,h)))),k)break;C=C.return}0<T.length&&(x=new v(x,w,null,n,p),m.push({event:x,listeners:T}))}}if(!(e&7)){e:{if(x=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",x&&n!==f0&&(w=n.relatedTarget||n.fromElement)&&(Ji(w)||w[Br]))break e;if((v||x)&&(x=p.window===p?p:(x=p.ownerDocument)?x.defaultView||x.parentWindow:window,v?(w=n.relatedTarget||n.toElement,v=f,w=w?Ji(w):null,w!==null&&(k=cs(w),w!==k||w.tag!==5&&w.tag!==6)&&(w=null)):(v=null,w=f),v!==w)){if(T=Nm,_="onMouseLeave",S="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(T=Mm,_="onPointerLeave",S="onPointerEnter",C="pointer"),k=v==null?x:Ks(v),h=w==null?x:Ks(w),x=new T(_,C+"leave",v,n,p),x.target=k,x.relatedTarget=h,_=null,Ji(p)===f&&(T=new T(S,C+"enter",w,n,p),T.target=h,T.relatedTarget=k,_=T),k=_,v&&w)t:{for(T=v,S=w,C=0,h=T;h;h=zs(h))C++;for(h=0,_=S;_;_=zs(_))h++;for(;0<C-h;)T=zs(T),C--;for(;0<h-C;)S=zs(S),h--;for(;C--;){if(T===S||S!==null&&T===S.alternate)break t;T=zs(T),S=zs(S)}T=null}else T=null;v!==null&&Gm(m,x,v,T,!1),w!==null&&k!==null&&Gm(m,k,w,T,!0)}}e:{if(x=f?Ks(f):window,v=x.nodeName&&x.nodeName.toLowerCase(),v==="select"||v==="input"&&x.type==="file")var E=hx;else if(Lm(x))if(Dv)E=yx;else{E=gx;var P=px}else(v=x.nodeName)&&v.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(E=mx);if(E&&(E=E(t,f))){jv(m,E,n,p);break e}P&&P(t,x,f),t==="focusout"&&(P=x._wrapperState)&&P.controlled&&x.type==="number"&&a0(x,"number",x.value)}switch(P=f?Ks(f):window,t){case"focusin":(Lm(P)||P.contentEditable==="true")&&(Xs=P,x0=f,ba=null);break;case"focusout":ba=x0=Xs=null;break;case"mousedown":w0=!0;break;case"contextmenu":case"mouseup":case"dragend":w0=!1,zm(m,n,p);break;case"selectionchange":if(wx)break;case"keydown":case"keyup":zm(m,n,p)}var I;if(Pp)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Hs?Fv(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(Lv&&n.locale!=="ko"&&(Hs||A!=="onCompositionStart"?A==="onCompositionEnd"&&Hs&&(I=Iv()):(gi=p,Ep="value"in gi?gi.value:gi.textContent,Hs=!0)),P=rc(f,A),0<P.length&&(A=new Am(A,t,null,n,p),m.push({event:A,listeners:P}),I?A.data=I:(I=Ov(n),I!==null&&(A.data=I)))),(I=lx?ux(t,n):cx(t,n))&&(f=rc(f,"onBeforeInput"),0<f.length&&(p=new Am("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:f}),p.data=I))}Yv(m,e)})}function Va(t,e,n){return{instance:t,listener:e,currentTarget:n}}function rc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Oa(t,n),s!=null&&r.unshift(Va(t,s,i)),s=Oa(t,e),s!=null&&r.push(Va(t,s,i))),t=t.return}return r}function zs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Gm(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var c=n,u=c.alternate,f=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&f!==null&&(c=f,i?(u=Oa(n,s),u!=null&&l.unshift(Va(n,u,c))):i||(u=Oa(n,s),u!=null&&l.push(Va(n,u,c)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var Cx=/\r\n?/g,Ex=/\u0000|\uFFFD/g;function Vm(t){return(typeof t=="string"?t:""+t).replace(Cx,`
`).replace(Ex,"")}function vu(t,e,n){if(e=Vm(e),Vm(t)!==e&&n)throw Error(ie(425))}function ic(){}var _0=null,S0=null;function k0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var C0=typeof setTimeout=="function"?setTimeout:void 0,Tx=typeof clearTimeout=="function"?clearTimeout:void 0,Wm=typeof Promise=="function"?Promise:void 0,bx=typeof queueMicrotask=="function"?queueMicrotask:typeof Wm<"u"?function(t){return Wm.resolve(null).then(t).catch(Px)}:C0;function Px(t){setTimeout(function(){throw t})}function yh(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),za(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);za(e)}function wi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $m(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Eo=Math.random().toString(36).slice(2),vr="__reactFiber$"+Eo,Wa="__reactProps$"+Eo,Br="__reactContainer$"+Eo,E0="__reactEvents$"+Eo,Nx="__reactListeners$"+Eo,Ax="__reactHandles$"+Eo;function Ji(t){var e=t[vr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Br]||n[vr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$m(t);t!==null;){if(n=t[vr])return n;t=$m(t)}return e}t=n,n=t.parentNode}return null}function ol(t){return t=t[vr]||t[Br],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ks(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function Oc(t){return t[Wa]||null}var T0=[],Qs=-1;function Ai(t){return{current:t}}function Xe(t){0>Qs||(t.current=T0[Qs],T0[Qs]=null,Qs--)}function Ge(t,e){Qs++,T0[Qs]=t.current,t.current=e}var bi={},$t=Ai(bi),cn=Ai(!1),is=bi;function ho(t,e){var n=t.type.contextTypes;if(!n)return bi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function dn(t){return t=t.childContextTypes,t!=null}function sc(){Xe(cn),Xe($t)}function Hm(t,e,n){if($t.current!==bi)throw Error(ie(168));Ge($t,e),Ge(cn,n)}function Qv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ie(108,p8(t)||"Unknown",i));return nt({},n,r)}function oc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bi,is=$t.current,Ge($t,t),Ge(cn,cn.current),!0}function Xm(t,e,n){var r=t.stateNode;if(!r)throw Error(ie(169));n?(t=Qv(t,e,is),r.__reactInternalMemoizedMergedChildContext=t,Xe(cn),Xe($t),Ge($t,t)):Xe(cn),Ge(cn,n)}var Lr=null,jc=!1,vh=!1;function Zv(t){Lr===null?Lr=[t]:Lr.push(t)}function Mx(t){jc=!0,Zv(t)}function Mi(){if(!vh&&Lr!==null){vh=!0;var t=0,e=je;try{var n=Lr;for(je=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Lr=null,jc=!1}catch(i){throw Lr!==null&&(Lr=Lr.slice(t+1)),Sv(_p,Mi),i}finally{je=e,vh=!1}}return null}var Zs=[],qs=0,ac=null,lc=0,Rn=[],In=0,ss=null,Fr=1,Or="";function Qi(t,e){Zs[qs++]=lc,Zs[qs++]=ac,ac=t,lc=e}function qv(t,e,n){Rn[In++]=Fr,Rn[In++]=Or,Rn[In++]=ss,ss=t;var r=Fr;t=Or;var i=32-er(r)-1;r&=~(1<<i),n+=1;var s=32-er(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Fr=1<<32-er(e)+i|n<<i|r,Or=s+t}else Fr=1<<s|n<<i|r,Or=t}function Ap(t){t.return!==null&&(Qi(t,1),qv(t,1,0))}function Mp(t){for(;t===ac;)ac=Zs[--qs],Zs[qs]=null,lc=Zs[--qs],Zs[qs]=null;for(;t===ss;)ss=Rn[--In],Rn[In]=null,Or=Rn[--In],Rn[In]=null,Fr=Rn[--In],Rn[In]=null}var yn=null,mn=null,Qe=!1,Zn=null;function Jv(t,e){var n=Fn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ym(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,yn=t,mn=wi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,yn=t,mn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ss!==null?{id:Fr,overflow:Or}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Fn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,yn=t,mn=null,!0):!1;default:return!1}}function b0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function P0(t){if(Qe){var e=mn;if(e){var n=e;if(!Ym(t,e)){if(b0(t))throw Error(ie(418));e=wi(n.nextSibling);var r=yn;e&&Ym(t,e)?Jv(r,n):(t.flags=t.flags&-4097|2,Qe=!1,yn=t)}}else{if(b0(t))throw Error(ie(418));t.flags=t.flags&-4097|2,Qe=!1,yn=t}}}function Km(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;yn=t}function xu(t){if(t!==yn)return!1;if(!Qe)return Km(t),Qe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!k0(t.type,t.memoizedProps)),e&&(e=mn)){if(b0(t))throw e3(),Error(ie(418));for(;e;)Jv(t,e),e=wi(e.nextSibling)}if(Km(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){mn=wi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}mn=null}}else mn=yn?wi(t.stateNode.nextSibling):null;return!0}function e3(){for(var t=mn;t;)t=wi(t.nextSibling)}function po(){mn=yn=null,Qe=!1}function Rp(t){Zn===null?Zn=[t]:Zn.push(t)}var Rx=Vr.ReactCurrentBatchConfig;function oa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var c=i.refs;l===null?delete c[s]:c[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,t))}return t}function wu(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qm(t){var e=t._init;return e(t._payload)}function t3(t){function e(S,C){if(t){var h=S.deletions;h===null?(S.deletions=[C],S.flags|=16):h.push(C)}}function n(S,C){if(!t)return null;for(;C!==null;)e(S,C),C=C.sibling;return null}function r(S,C){for(S=new Map;C!==null;)C.key!==null?S.set(C.key,C):S.set(C.index,C),C=C.sibling;return S}function i(S,C){return S=Ci(S,C),S.index=0,S.sibling=null,S}function s(S,C,h){return S.index=h,t?(h=S.alternate,h!==null?(h=h.index,h<C?(S.flags|=2,C):h):(S.flags|=2,C)):(S.flags|=1048576,C)}function l(S){return t&&S.alternate===null&&(S.flags|=2),S}function c(S,C,h,_){return C===null||C.tag!==6?(C=Eh(h,S.mode,_),C.return=S,C):(C=i(C,h),C.return=S,C)}function u(S,C,h,_){var E=h.type;return E===$s?p(S,C,h.props.children,_,h.key):C!==null&&(C.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ci&&Qm(E)===C.type)?(_=i(C,h.props),_.ref=oa(S,C,h),_.return=S,_):(_=Vu(h.type,h.key,h.props,null,S.mode,_),_.ref=oa(S,C,h),_.return=S,_)}function f(S,C,h,_){return C===null||C.tag!==4||C.stateNode.containerInfo!==h.containerInfo||C.stateNode.implementation!==h.implementation?(C=Th(h,S.mode,_),C.return=S,C):(C=i(C,h.children||[]),C.return=S,C)}function p(S,C,h,_,E){return C===null||C.tag!==7?(C=rs(h,S.mode,_,E),C.return=S,C):(C=i(C,h),C.return=S,C)}function m(S,C,h){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Eh(""+C,S.mode,h),C.return=S,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case uu:return h=Vu(C.type,C.key,C.props,null,S.mode,h),h.ref=oa(S,null,C),h.return=S,h;case Ws:return C=Th(C,S.mode,h),C.return=S,C;case ci:var _=C._init;return m(S,_(C._payload),h)}if(va(C)||ta(C))return C=rs(C,S.mode,h,null),C.return=S,C;wu(S,C)}return null}function x(S,C,h,_){var E=C!==null?C.key:null;if(typeof h=="string"&&h!==""||typeof h=="number")return E!==null?null:c(S,C,""+h,_);if(typeof h=="object"&&h!==null){switch(h.$$typeof){case uu:return h.key===E?u(S,C,h,_):null;case Ws:return h.key===E?f(S,C,h,_):null;case ci:return E=h._init,x(S,C,E(h._payload),_)}if(va(h)||ta(h))return E!==null?null:p(S,C,h,_,null);wu(S,h)}return null}function v(S,C,h,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return S=S.get(h)||null,c(C,S,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case uu:return S=S.get(_.key===null?h:_.key)||null,u(C,S,_,E);case Ws:return S=S.get(_.key===null?h:_.key)||null,f(C,S,_,E);case ci:var P=_._init;return v(S,C,h,P(_._payload),E)}if(va(_)||ta(_))return S=S.get(h)||null,p(C,S,_,E,null);wu(C,_)}return null}function w(S,C,h,_){for(var E=null,P=null,I=C,A=C=0,F=null;I!==null&&A<h.length;A++){I.index>A?(F=I,I=null):F=I.sibling;var N=x(S,I,h[A],_);if(N===null){I===null&&(I=F);break}t&&I&&N.alternate===null&&e(S,I),C=s(N,C,A),P===null?E=N:P.sibling=N,P=N,I=F}if(A===h.length)return n(S,I),Qe&&Qi(S,A),E;if(I===null){for(;A<h.length;A++)I=m(S,h[A],_),I!==null&&(C=s(I,C,A),P===null?E=I:P.sibling=I,P=I);return Qe&&Qi(S,A),E}for(I=r(S,I);A<h.length;A++)F=v(I,S,A,h[A],_),F!==null&&(t&&F.alternate!==null&&I.delete(F.key===null?A:F.key),C=s(F,C,A),P===null?E=F:P.sibling=F,P=F);return t&&I.forEach(function(R){return e(S,R)}),Qe&&Qi(S,A),E}function T(S,C,h,_){var E=ta(h);if(typeof E!="function")throw Error(ie(150));if(h=E.call(h),h==null)throw Error(ie(151));for(var P=E=null,I=C,A=C=0,F=null,N=h.next();I!==null&&!N.done;A++,N=h.next()){I.index>A?(F=I,I=null):F=I.sibling;var R=x(S,I,N.value,_);if(R===null){I===null&&(I=F);break}t&&I&&R.alternate===null&&e(S,I),C=s(R,C,A),P===null?E=R:P.sibling=R,P=R,I=F}if(N.done)return n(S,I),Qe&&Qi(S,A),E;if(I===null){for(;!N.done;A++,N=h.next())N=m(S,N.value,_),N!==null&&(C=s(N,C,A),P===null?E=N:P.sibling=N,P=N);return Qe&&Qi(S,A),E}for(I=r(S,I);!N.done;A++,N=h.next())N=v(I,S,A,N.value,_),N!==null&&(t&&N.alternate!==null&&I.delete(N.key===null?A:N.key),C=s(N,C,A),P===null?E=N:P.sibling=N,P=N);return t&&I.forEach(function(D){return e(S,D)}),Qe&&Qi(S,A),E}function k(S,C,h,_){if(typeof h=="object"&&h!==null&&h.type===$s&&h.key===null&&(h=h.props.children),typeof h=="object"&&h!==null){switch(h.$$typeof){case uu:e:{for(var E=h.key,P=C;P!==null;){if(P.key===E){if(E=h.type,E===$s){if(P.tag===7){n(S,P.sibling),C=i(P,h.props.children),C.return=S,S=C;break e}}else if(P.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ci&&Qm(E)===P.type){n(S,P.sibling),C=i(P,h.props),C.ref=oa(S,P,h),C.return=S,S=C;break e}n(S,P);break}else e(S,P);P=P.sibling}h.type===$s?(C=rs(h.props.children,S.mode,_,h.key),C.return=S,S=C):(_=Vu(h.type,h.key,h.props,null,S.mode,_),_.ref=oa(S,C,h),_.return=S,S=_)}return l(S);case Ws:e:{for(P=h.key;C!==null;){if(C.key===P)if(C.tag===4&&C.stateNode.containerInfo===h.containerInfo&&C.stateNode.implementation===h.implementation){n(S,C.sibling),C=i(C,h.children||[]),C.return=S,S=C;break e}else{n(S,C);break}else e(S,C);C=C.sibling}C=Th(h,S.mode,_),C.return=S,S=C}return l(S);case ci:return P=h._init,k(S,C,P(h._payload),_)}if(va(h))return w(S,C,h,_);if(ta(h))return T(S,C,h,_);wu(S,h)}return typeof h=="string"&&h!==""||typeof h=="number"?(h=""+h,C!==null&&C.tag===6?(n(S,C.sibling),C=i(C,h),C.return=S,S=C):(n(S,C),C=Eh(h,S.mode,_),C.return=S,S=C),l(S)):n(S,C)}return k}var go=t3(!0),n3=t3(!1),uc=Ai(null),cc=null,Js=null,Ip=null;function Lp(){Ip=Js=cc=null}function Fp(t){var e=uc.current;Xe(uc),t._currentValue=e}function N0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ao(t,e){cc=t,Ip=Js=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(un=!0),t.firstContext=null)}function Dn(t){var e=t._currentValue;if(Ip!==t)if(t={context:t,memoizedValue:e,next:null},Js===null){if(cc===null)throw Error(ie(308));Js=t,cc.dependencies={lanes:0,firstContext:t}}else Js=Js.next=t;return e}var es=null;function Op(t){es===null?es=[t]:es.push(t)}function r3(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Op(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ur(t,r)}function Ur(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var di=!1;function jp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function i3(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function jr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _i(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ur(t,n)}return i=r.interleaved,i===null?(e.next=e,Op(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ur(t,n)}function ju(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sp(t,n)}}function Zm(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function dc(t,e,n,r){var i=t.updateQueue;di=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var u=c,f=u.next;u.next=null,l===null?s=f:l.next=f,l=u;var p=t.alternate;p!==null&&(p=p.updateQueue,c=p.lastBaseUpdate,c!==l&&(c===null?p.firstBaseUpdate=f:c.next=f,p.lastBaseUpdate=u))}if(s!==null){var m=i.baseState;l=0,p=f=u=null,c=s;do{var x=c.lane,v=c.eventTime;if((r&x)===x){p!==null&&(p=p.next={eventTime:v,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=t,T=c;switch(x=e,v=n,T.tag){case 1:if(w=T.payload,typeof w=="function"){m=w.call(v,m,x);break e}m=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=T.payload,x=typeof w=="function"?w.call(v,m,x):w,x==null)break e;m=nt({},m,x);break e;case 2:di=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,x=i.effects,x===null?i.effects=[c]:x.push(c))}else v={eventTime:v,lane:x,tag:c.tag,payload:c.payload,callback:c.callback,next:null},p===null?(f=p=v,u=m):p=p.next=v,l|=x;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;x=c,c=x.next,x.next=null,i.lastBaseUpdate=x,i.shared.pending=null}}while(1);if(p===null&&(u=m),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);as|=l,t.lanes=l,t.memoizedState=m}}function qm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ie(191,i));i.call(r)}}}var al={},Sr=Ai(al),$a=Ai(al),Ha=Ai(al);function ts(t){if(t===al)throw Error(ie(174));return t}function Dp(t,e){switch(Ge(Ha,e),Ge($a,t),Ge(Sr,al),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:u0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=u0(e,t)}Xe(Sr),Ge(Sr,e)}function mo(){Xe(Sr),Xe($a),Xe(Ha)}function s3(t){ts(Ha.current);var e=ts(Sr.current),n=u0(e,t.type);e!==n&&(Ge($a,t),Ge(Sr,n))}function zp(t){$a.current===t&&(Xe(Sr),Xe($a))}var et=Ai(0);function fc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xh=[];function Bp(){for(var t=0;t<xh.length;t++)xh[t]._workInProgressVersionPrimary=null;xh.length=0}var Du=Vr.ReactCurrentDispatcher,wh=Vr.ReactCurrentBatchConfig,os=0,tt=null,mt=null,Et=null,hc=!1,Pa=!1,Xa=0,Ix=0;function Ut(){throw Error(ie(321))}function Up(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!rr(t[n],e[n]))return!1;return!0}function Gp(t,e,n,r,i,s){if(os=s,tt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Du.current=t===null||t.memoizedState===null?jx:Dx,t=n(r,i),Pa){s=0;do{if(Pa=!1,Xa=0,25<=s)throw Error(ie(301));s+=1,Et=mt=null,e.updateQueue=null,Du.current=zx,t=n(r,i)}while(Pa)}if(Du.current=pc,e=mt!==null&&mt.next!==null,os=0,Et=mt=tt=null,hc=!1,e)throw Error(ie(300));return t}function Vp(){var t=Xa!==0;return Xa=0,t}function mr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?tt.memoizedState=Et=t:Et=Et.next=t,Et}function zn(){if(mt===null){var t=tt.alternate;t=t!==null?t.memoizedState:null}else t=mt.next;var e=Et===null?tt.memoizedState:Et.next;if(e!==null)Et=e,mt=t;else{if(t===null)throw Error(ie(310));mt=t,t={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Et===null?tt.memoizedState=Et=t:Et=Et.next=t}return Et}function Ya(t,e){return typeof e=="function"?e(t):e}function _h(t){var e=zn(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=mt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var c=l=null,u=null,f=s;do{var p=f.lane;if((os&p)===p)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:t(r,f.action);else{var m={lane:p,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(c=u=m,l=r):u=u.next=m,tt.lanes|=p,as|=p}f=f.next}while(f!==null&&f!==s);u===null?l=r:u.next=c,rr(r,e.memoizedState)||(un=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,tt.lanes|=s,as|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Sh(t){var e=zn(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);rr(s,e.memoizedState)||(un=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function o3(){}function a3(t,e){var n=tt,r=zn(),i=e(),s=!rr(r.memoizedState,i);if(s&&(r.memoizedState=i,un=!0),r=r.queue,Wp(c3.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,Ka(9,u3.bind(null,n,r,i,e),void 0,null),Tt===null)throw Error(ie(349));os&30||l3(n,e,i)}return i}function l3(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=tt.updateQueue,e===null?(e={lastEffect:null,stores:null},tt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function u3(t,e,n,r){e.value=n,e.getSnapshot=r,d3(e)&&f3(t)}function c3(t,e,n){return n(function(){d3(e)&&f3(t)})}function d3(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!rr(t,n)}catch{return!0}}function f3(t){var e=Ur(t,1);e!==null&&tr(e,t,1,-1)}function Jm(t){var e=mr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ya,lastRenderedState:t},e.queue=t,t=t.dispatch=Ox.bind(null,tt,t),[e.memoizedState,t]}function Ka(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=tt.updateQueue,e===null?(e={lastEffect:null,stores:null},tt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function h3(){return zn().memoizedState}function zu(t,e,n,r){var i=mr();tt.flags|=t,i.memoizedState=Ka(1|e,n,void 0,r===void 0?null:r)}function Dc(t,e,n,r){var i=zn();r=r===void 0?null:r;var s=void 0;if(mt!==null){var l=mt.memoizedState;if(s=l.destroy,r!==null&&Up(r,l.deps)){i.memoizedState=Ka(e,n,s,r);return}}tt.flags|=t,i.memoizedState=Ka(1|e,n,s,r)}function ey(t,e){return zu(8390656,8,t,e)}function Wp(t,e){return Dc(2048,8,t,e)}function p3(t,e){return Dc(4,2,t,e)}function g3(t,e){return Dc(4,4,t,e)}function m3(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function y3(t,e,n){return n=n!=null?n.concat([t]):null,Dc(4,4,m3.bind(null,e,t),n)}function $p(){}function v3(t,e){var n=zn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Up(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function x3(t,e){var n=zn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Up(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function w3(t,e,n){return os&21?(rr(n,e)||(n=Ev(),tt.lanes|=n,as|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,un=!0),t.memoizedState=n)}function Lx(t,e){var n=je;je=n!==0&&4>n?n:4,t(!0);var r=wh.transition;wh.transition={};try{t(!1),e()}finally{je=n,wh.transition=r}}function _3(){return zn().memoizedState}function Fx(t,e,n){var r=ki(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},S3(t))k3(e,n);else if(n=r3(t,e,n,r),n!==null){var i=Kt();tr(n,t,r,i),C3(n,e,r)}}function Ox(t,e,n){var r=ki(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(S3(t))k3(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,c=s(l,n);if(i.hasEagerState=!0,i.eagerState=c,rr(c,l)){var u=e.interleaved;u===null?(i.next=i,Op(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=r3(t,e,i,r),n!==null&&(i=Kt(),tr(n,t,r,i),C3(n,e,r))}}function S3(t){var e=t.alternate;return t===tt||e!==null&&e===tt}function k3(t,e){Pa=hc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function C3(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Sp(t,n)}}var pc={readContext:Dn,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},jx={readContext:Dn,useCallback:function(t,e){return mr().memoizedState=[t,e===void 0?null:e],t},useContext:Dn,useEffect:ey,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,zu(4194308,4,m3.bind(null,e,t),n)},useLayoutEffect:function(t,e){return zu(4194308,4,t,e)},useInsertionEffect:function(t,e){return zu(4,2,t,e)},useMemo:function(t,e){var n=mr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=mr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Fx.bind(null,tt,t),[r.memoizedState,t]},useRef:function(t){var e=mr();return t={current:t},e.memoizedState=t},useState:Jm,useDebugValue:$p,useDeferredValue:function(t){return mr().memoizedState=t},useTransition:function(){var t=Jm(!1),e=t[0];return t=Lx.bind(null,t[1]),mr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=tt,i=mr();if(Qe){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=e(),Tt===null)throw Error(ie(349));os&30||l3(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,ey(c3.bind(null,r,s,t),[t]),r.flags|=2048,Ka(9,u3.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=mr(),e=Tt.identifierPrefix;if(Qe){var n=Or,r=Fr;n=(r&~(1<<32-er(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Xa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Ix++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Dx={readContext:Dn,useCallback:v3,useContext:Dn,useEffect:Wp,useImperativeHandle:y3,useInsertionEffect:p3,useLayoutEffect:g3,useMemo:x3,useReducer:_h,useRef:h3,useState:function(){return _h(Ya)},useDebugValue:$p,useDeferredValue:function(t){var e=zn();return w3(e,mt.memoizedState,t)},useTransition:function(){var t=_h(Ya)[0],e=zn().memoizedState;return[t,e]},useMutableSource:o3,useSyncExternalStore:a3,useId:_3,unstable_isNewReconciler:!1},zx={readContext:Dn,useCallback:v3,useContext:Dn,useEffect:Wp,useImperativeHandle:y3,useInsertionEffect:p3,useLayoutEffect:g3,useMemo:x3,useReducer:Sh,useRef:h3,useState:function(){return Sh(Ya)},useDebugValue:$p,useDeferredValue:function(t){var e=zn();return mt===null?e.memoizedState=t:w3(e,mt.memoizedState,t)},useTransition:function(){var t=Sh(Ya)[0],e=zn().memoizedState;return[t,e]},useMutableSource:o3,useSyncExternalStore:a3,useId:_3,unstable_isNewReconciler:!1};function Kn(t,e){if(t&&t.defaultProps){e=nt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function A0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:nt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zc={isMounted:function(t){return(t=t._reactInternals)?cs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Kt(),i=ki(t),s=jr(r,i);s.payload=e,n!=null&&(s.callback=n),e=_i(t,s,i),e!==null&&(tr(e,t,i,r),ju(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Kt(),i=ki(t),s=jr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=_i(t,s,i),e!==null&&(tr(e,t,i,r),ju(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Kt(),r=ki(t),i=jr(n,r);i.tag=2,e!=null&&(i.callback=e),e=_i(t,i,r),e!==null&&(tr(e,t,r,n),ju(e,t,r))}};function ty(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!Ua(n,r)||!Ua(i,s):!0}function E3(t,e,n){var r=!1,i=bi,s=e.contextType;return typeof s=="object"&&s!==null?s=Dn(s):(i=dn(e)?is:$t.current,r=e.contextTypes,s=(r=r!=null)?ho(t,i):bi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function ny(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&zc.enqueueReplaceState(e,e.state,null)}function M0(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},jp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Dn(s):(s=dn(e)?is:$t.current,i.context=ho(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(A0(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&zc.enqueueReplaceState(i,i.state,null),dc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function yo(t,e){try{var n="",r=e;do n+=h8(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function kh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function R0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Bx=typeof WeakMap=="function"?WeakMap:Map;function T3(t,e,n){n=jr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){mc||(mc=!0,G0=r),R0(t,e)},n}function b3(t,e,n){n=jr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){R0(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){R0(t,e),typeof r!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function ry(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Bx;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=e9.bind(null,t,e,n),e.then(t,t))}function iy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sy(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=jr(-1,1),e.tag=2,_i(n,e,1))),n.lanes|=1),t)}var Ux=Vr.ReactCurrentOwner,un=!1;function Yt(t,e,n,r){e.child=t===null?n3(e,null,n,r):go(e,t.child,n,r)}function oy(t,e,n,r,i){n=n.render;var s=e.ref;return ao(e,i),r=Gp(t,e,n,r,s,i),n=Vp(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gr(t,e,i)):(Qe&&n&&Ap(e),e.flags|=1,Yt(t,e,r,i),e.child)}function ay(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Jp(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,P3(t,e,s,r,i)):(t=Vu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ua,n(l,r)&&t.ref===e.ref)return Gr(t,e,i)}return e.flags|=1,t=Ci(s,r),t.ref=e.ref,t.return=e,e.child=t}function P3(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ua(s,r)&&t.ref===e.ref)if(un=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(un=!0);else return e.lanes=t.lanes,Gr(t,e,i)}return I0(t,e,n,r,i)}function N3(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(to,gn),gn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ge(to,gn),gn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ge(to,gn),gn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ge(to,gn),gn|=r;return Yt(t,e,i,n),e.child}function A3(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function I0(t,e,n,r,i){var s=dn(n)?is:$t.current;return s=ho(e,s),ao(e,i),n=Gp(t,e,n,r,s,i),r=Vp(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gr(t,e,i)):(Qe&&r&&Ap(e),e.flags|=1,Yt(t,e,n,i),e.child)}function ly(t,e,n,r,i){if(dn(n)){var s=!0;oc(e)}else s=!1;if(ao(e,i),e.stateNode===null)Bu(t,e),E3(e,n,r),M0(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,c=e.memoizedProps;l.props=c;var u=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=Dn(f):(f=dn(n)?is:$t.current,f=ho(e,f));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof l.getSnapshotBeforeUpdate=="function";m||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||u!==f)&&ny(e,l,r,f),di=!1;var x=e.memoizedState;l.state=x,dc(e,r,l,i),u=e.memoizedState,c!==r||x!==u||cn.current||di?(typeof p=="function"&&(A0(e,n,p,r),u=e.memoizedState),(c=di||ty(e,n,c,r,x,u,f))?(m||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),l.props=r,l.state=u,l.context=f,r=c):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,i3(t,e),c=e.memoizedProps,f=e.type===e.elementType?c:Kn(e.type,c),l.props=f,m=e.pendingProps,x=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=Dn(u):(u=dn(n)?is:$t.current,u=ho(e,u));var v=n.getDerivedStateFromProps;(p=typeof v=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==m||x!==u)&&ny(e,l,r,u),di=!1,x=e.memoizedState,l.state=x,dc(e,r,l,i);var w=e.memoizedState;c!==m||x!==w||cn.current||di?(typeof v=="function"&&(A0(e,n,v,r),w=e.memoizedState),(f=di||ty(e,n,f,r,x,w,u)||!1)?(p||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,w,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,w,u)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),l.props=r,l.state=w,l.context=u,r=f):(typeof l.componentDidUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&x===t.memoizedState||(e.flags|=1024),r=!1)}return L0(t,e,n,r,s,i)}function L0(t,e,n,r,i,s){A3(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&Xm(e,n,!1),Gr(t,e,s);r=e.stateNode,Ux.current=e;var c=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=go(e,t.child,null,s),e.child=go(e,null,c,s)):Yt(t,e,c,s),e.memoizedState=r.state,i&&Xm(e,n,!0),e.child}function M3(t){var e=t.stateNode;e.pendingContext?Hm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Hm(t,e.context,!1),Dp(t,e.containerInfo)}function uy(t,e,n,r,i){return po(),Rp(i),e.flags|=256,Yt(t,e,n,r),e.child}var F0={dehydrated:null,treeContext:null,retryLane:0};function O0(t){return{baseLanes:t,cachePool:null,transitions:null}}function R3(t,e,n){var r=e.pendingProps,i=et.current,s=!1,l=(e.flags&128)!==0,c;if((c=l)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ge(et,i&1),t===null)return P0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=Gc(l,r,0,null),t=rs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=O0(n),e.memoizedState=F0,t):Hp(e,l));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return Gx(t,e,l,r,c,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,c=i.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ci(i,u),r.subtreeFlags=i.subtreeFlags&14680064),c!==null?s=Ci(c,s):(s=rs(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?O0(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=F0,r}return s=t.child,t=s.sibling,r=Ci(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hp(t,e){return e=Gc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _u(t,e,n,r){return r!==null&&Rp(r),go(e,t.child,null,n),t=Hp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Gx(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=kh(Error(ie(422))),_u(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Gc({mode:"visible",children:r.children},i,0,null),s=rs(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&go(e,t.child,null,l),e.child.memoizedState=O0(l),e.memoizedState=F0,s);if(!(e.mode&1))return _u(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var c=r.dgst;return r=c,s=Error(ie(419)),r=kh(s,r,void 0),_u(t,e,l,r)}if(c=(l&t.childLanes)!==0,un||c){if(r=Tt,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ur(t,i),tr(r,t,i,-1))}return qp(),r=kh(Error(ie(421))),_u(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=t9.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,mn=wi(i.nextSibling),yn=e,Qe=!0,Zn=null,t!==null&&(Rn[In++]=Fr,Rn[In++]=Or,Rn[In++]=ss,Fr=t.id,Or=t.overflow,ss=e),e=Hp(e,r.children),e.flags|=4096,e)}function cy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),N0(t.return,e,n)}function Ch(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function I3(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Yt(t,e,r.children,n),r=et.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cy(t,n,e);else if(t.tag===19)cy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ge(et,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&fc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ch(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&fc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ch(e,!0,n,null,s);break;case"together":Ch(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),as|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,n=Ci(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ci(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Vx(t,e,n){switch(e.tag){case 3:M3(e),po();break;case 5:s3(e);break;case 1:dn(e.type)&&oc(e);break;case 4:Dp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ge(uc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ge(et,et.current&1),e.flags|=128,null):n&e.child.childLanes?R3(t,e,n):(Ge(et,et.current&1),t=Gr(t,e,n),t!==null?t.sibling:null);Ge(et,et.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return I3(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ge(et,et.current),r)break;return null;case 22:case 23:return e.lanes=0,N3(t,e,n)}return Gr(t,e,n)}var L3,j0,F3,O3;L3=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};j0=function(){};F3=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ts(Sr.current);var s=null;switch(n){case"input":i=s0(t,i),r=s0(t,r),s=[];break;case"select":i=nt({},i,{value:void 0}),r=nt({},r,{value:void 0}),s=[];break;case"textarea":i=l0(t,i),r=l0(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ic)}c0(n,r);var l;n=null;for(f in i)if(!r.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var c=i[f];for(l in c)c.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(La.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in r){var u=r[f];if(c=i!=null?i[f]:void 0,r.hasOwnProperty(f)&&u!==c&&(u!=null||c!=null))if(f==="style")if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(s||(s=[]),s.push(f,n)),n=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(s=s||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(La.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&He("scroll",t),s||c===u||(s=[])):(s=s||[]).push(f,u))}n&&(s=s||[]).push("style",n);var f=s;(e.updateQueue=f)&&(e.flags|=4)}};O3=function(t,e,n,r){n!==r&&(e.flags|=4)};function aa(t,e){if(!Qe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Gt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Wx(t,e,n){var r=e.pendingProps;switch(Mp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gt(e),null;case 1:return dn(e.type)&&sc(),Gt(e),null;case 3:return r=e.stateNode,mo(),Xe(cn),Xe($t),Bp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&($0(Zn),Zn=null))),j0(t,e),Gt(e),null;case 5:zp(e);var i=ts(Ha.current);if(n=e.type,t!==null&&e.stateNode!=null)F3(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ie(166));return Gt(e),null}if(t=ts(Sr.current),xu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[vr]=e,r[Wa]=s,t=(e.mode&1)!==0,n){case"dialog":He("cancel",r),He("close",r);break;case"iframe":case"object":case"embed":He("load",r);break;case"video":case"audio":for(i=0;i<wa.length;i++)He(wa[i],r);break;case"source":He("error",r);break;case"img":case"image":case"link":He("error",r),He("load",r);break;case"details":He("toggle",r);break;case"input":xm(r,s),He("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},He("invalid",r);break;case"textarea":_m(r,s),He("invalid",r)}c0(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var c=s[l];l==="children"?typeof c=="string"?r.textContent!==c&&(s.suppressHydrationWarning!==!0&&vu(r.textContent,c,t),i=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(s.suppressHydrationWarning!==!0&&vu(r.textContent,c,t),i=["children",""+c]):La.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&He("scroll",r)}switch(n){case"input":cu(r),wm(r,s,!0);break;case"textarea":cu(r),Sm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ic)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=cv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[vr]=e,t[Wa]=r,L3(t,e,!1,!1),e.stateNode=t;e:{switch(l=d0(n,r),n){case"dialog":He("cancel",t),He("close",t),i=r;break;case"iframe":case"object":case"embed":He("load",t),i=r;break;case"video":case"audio":for(i=0;i<wa.length;i++)He(wa[i],t);i=r;break;case"source":He("error",t),i=r;break;case"img":case"image":case"link":He("error",t),He("load",t),i=r;break;case"details":He("toggle",t),i=r;break;case"input":xm(t,r),i=s0(t,r),He("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=nt({},r,{value:void 0}),He("invalid",t);break;case"textarea":_m(t,r),i=l0(t,r),He("invalid",t);break;default:i=r}c0(n,i),c=i;for(s in c)if(c.hasOwnProperty(s)){var u=c[s];s==="style"?hv(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&dv(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Fa(t,u):typeof u=="number"&&Fa(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(La.hasOwnProperty(s)?u!=null&&s==="onScroll"&&He("scroll",t):u!=null&&mp(t,s,u,l))}switch(n){case"input":cu(t),wm(t,r,!1);break;case"textarea":cu(t),Sm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ti(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ro(t,!!r.multiple,s,!1):r.defaultValue!=null&&ro(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ic)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Gt(e),null;case 6:if(t&&e.stateNode!=null)O3(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ie(166));if(n=ts(Ha.current),ts(Sr.current),xu(e)){if(r=e.stateNode,n=e.memoizedProps,r[vr]=e,(s=r.nodeValue!==n)&&(t=yn,t!==null))switch(t.tag){case 3:vu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&vu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[vr]=e,e.stateNode=r}return Gt(e),null;case 13:if(Xe(et),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qe&&mn!==null&&e.mode&1&&!(e.flags&128))e3(),po(),e.flags|=98560,s=!1;else if(s=xu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ie(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ie(317));s[vr]=e}else po(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Gt(e),s=!1}else Zn!==null&&($0(Zn),Zn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||et.current&1?yt===0&&(yt=3):qp())),e.updateQueue!==null&&(e.flags|=4),Gt(e),null);case 4:return mo(),j0(t,e),t===null&&Ga(e.stateNode.containerInfo),Gt(e),null;case 10:return Fp(e.type._context),Gt(e),null;case 17:return dn(e.type)&&sc(),Gt(e),null;case 19:if(Xe(et),s=e.memoizedState,s===null)return Gt(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)aa(s,!1);else{if(yt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=fc(t),l!==null){for(e.flags|=128,aa(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ge(et,et.current&1|2),e.child}t=t.sibling}s.tail!==null&&lt()>vo&&(e.flags|=128,r=!0,aa(s,!1),e.lanes=4194304)}else{if(!r)if(t=fc(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),aa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!Qe)return Gt(e),null}else 2*lt()-s.renderingStartTime>vo&&n!==1073741824&&(e.flags|=128,r=!0,aa(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=lt(),e.sibling=null,n=et.current,Ge(et,r?n&1|2:n&1),e):(Gt(e),null);case 22:case 23:return Zp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?gn&1073741824&&(Gt(e),e.subtreeFlags&6&&(e.flags|=8192)):Gt(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function $x(t,e){switch(Mp(e),e.tag){case 1:return dn(e.type)&&sc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mo(),Xe(cn),Xe($t),Bp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return zp(e),null;case 13:if(Xe(et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));po()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Xe(et),null;case 4:return mo(),null;case 10:return Fp(e.type._context),null;case 22:case 23:return Zp(),null;case 24:return null;default:return null}}var Su=!1,Wt=!1,Hx=typeof WeakSet=="function"?WeakSet:Set,de=null;function eo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){it(t,e,r)}else n.current=null}function D0(t,e,n){try{n()}catch(r){it(t,e,r)}}var dy=!1;function Xx(t,e){if(_0=tc,t=Uv(),Np(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,c=-1,u=-1,f=0,p=0,m=t,x=null;t:for(;;){for(var v;m!==n||i!==0&&m.nodeType!==3||(c=l+i),m!==s||r!==0&&m.nodeType!==3||(u=l+r),m.nodeType===3&&(l+=m.nodeValue.length),(v=m.firstChild)!==null;)x=m,m=v;for(;;){if(m===t)break t;if(x===n&&++f===i&&(c=l),x===s&&++p===r&&(u=l),(v=m.nextSibling)!==null)break;m=x,x=m.parentNode}m=v}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(S0={focusedElem:t,selectionRange:n},tc=!1,de=e;de!==null;)if(e=de,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,de=t;else for(;de!==null;){e=de;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var T=w.memoizedProps,k=w.memoizedState,S=e.stateNode,C=S.getSnapshotBeforeUpdate(e.elementType===e.type?T:Kn(e.type,T),k);S.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var h=e.stateNode.containerInfo;h.nodeType===1?h.textContent="":h.nodeType===9&&h.documentElement&&h.removeChild(h.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(_){it(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,de=t;break}de=e.return}return w=dy,dy=!1,w}function Na(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&D0(e,n,s)}i=i.next}while(i!==r)}}function Bc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function z0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function j3(t){var e=t.alternate;e!==null&&(t.alternate=null,j3(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[vr],delete e[Wa],delete e[E0],delete e[Nx],delete e[Ax])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function D3(t){return t.tag===5||t.tag===3||t.tag===4}function fy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||D3(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function B0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ic));else if(r!==4&&(t=t.child,t!==null))for(B0(t,e,n),t=t.sibling;t!==null;)B0(t,e,n),t=t.sibling}function U0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(U0(t,e,n),t=t.sibling;t!==null;)U0(t,e,n),t=t.sibling}var Mt=null,Qn=!1;function ai(t,e,n){for(n=n.child;n!==null;)z3(t,e,n),n=n.sibling}function z3(t,e,n){if(_r&&typeof _r.onCommitFiberUnmount=="function")try{_r.onCommitFiberUnmount(Rc,n)}catch{}switch(n.tag){case 5:Wt||eo(n,e);case 6:var r=Mt,i=Qn;Mt=null,ai(t,e,n),Mt=r,Qn=i,Mt!==null&&(Qn?(t=Mt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mt.removeChild(n.stateNode));break;case 18:Mt!==null&&(Qn?(t=Mt,n=n.stateNode,t.nodeType===8?yh(t.parentNode,n):t.nodeType===1&&yh(t,n),za(t)):yh(Mt,n.stateNode));break;case 4:r=Mt,i=Qn,Mt=n.stateNode.containerInfo,Qn=!0,ai(t,e,n),Mt=r,Qn=i;break;case 0:case 11:case 14:case 15:if(!Wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&D0(n,e,l),i=i.next}while(i!==r)}ai(t,e,n);break;case 1:if(!Wt&&(eo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){it(n,e,c)}ai(t,e,n);break;case 21:ai(t,e,n);break;case 22:n.mode&1?(Wt=(r=Wt)||n.memoizedState!==null,ai(t,e,n),Wt=r):ai(t,e,n);break;default:ai(t,e,n)}}function hy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Hx),e.forEach(function(r){var i=n9.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Xn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,c=l;e:for(;c!==null;){switch(c.tag){case 5:Mt=c.stateNode,Qn=!1;break e;case 3:Mt=c.stateNode.containerInfo,Qn=!0;break e;case 4:Mt=c.stateNode.containerInfo,Qn=!0;break e}c=c.return}if(Mt===null)throw Error(ie(160));z3(s,l,i),Mt=null,Qn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){it(i,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)B3(e,t),e=e.sibling}function B3(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xn(e,t),gr(t),r&4){try{Na(3,t,t.return),Bc(3,t)}catch(T){it(t,t.return,T)}try{Na(5,t,t.return)}catch(T){it(t,t.return,T)}}break;case 1:Xn(e,t),gr(t),r&512&&n!==null&&eo(n,n.return);break;case 5:if(Xn(e,t),gr(t),r&512&&n!==null&&eo(n,n.return),t.flags&32){var i=t.stateNode;try{Fa(i,"")}catch(T){it(t,t.return,T)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&s.type==="radio"&&s.name!=null&&lv(i,s),d0(c,l);var f=d0(c,s);for(l=0;l<u.length;l+=2){var p=u[l],m=u[l+1];p==="style"?hv(i,m):p==="dangerouslySetInnerHTML"?dv(i,m):p==="children"?Fa(i,m):mp(i,p,m,f)}switch(c){case"input":o0(i,s);break;case"textarea":uv(i,s);break;case"select":var x=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?ro(i,!!s.multiple,v,!1):x!==!!s.multiple&&(s.defaultValue!=null?ro(i,!!s.multiple,s.defaultValue,!0):ro(i,!!s.multiple,s.multiple?[]:"",!1))}i[Wa]=s}catch(T){it(t,t.return,T)}}break;case 6:if(Xn(e,t),gr(t),r&4){if(t.stateNode===null)throw Error(ie(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(T){it(t,t.return,T)}}break;case 3:if(Xn(e,t),gr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{za(e.containerInfo)}catch(T){it(t,t.return,T)}break;case 4:Xn(e,t),gr(t);break;case 13:Xn(e,t),gr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Kp=lt())),r&4&&hy(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Wt=(f=Wt)||p,Xn(e,t),Wt=f):Xn(e,t),gr(t),r&8192){if(f=t.memoizedState!==null,(t.stateNode.isHidden=f)&&!p&&t.mode&1)for(de=t,p=t.child;p!==null;){for(m=de=p;de!==null;){switch(x=de,v=x.child,x.tag){case 0:case 11:case 14:case 15:Na(4,x,x.return);break;case 1:eo(x,x.return);var w=x.stateNode;if(typeof w.componentWillUnmount=="function"){r=x,n=x.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(T){it(r,n,T)}}break;case 5:eo(x,x.return);break;case 22:if(x.memoizedState!==null){gy(m);continue}}v!==null?(v.return=x,de=v):gy(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,f?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(c=m.stateNode,u=m.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=fv("display",l))}catch(T){it(t,t.return,T)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(T){it(t,t.return,T)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Xn(e,t),gr(t),r&4&&hy(t);break;case 21:break;default:Xn(e,t),gr(t)}}function gr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(D3(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Fa(i,""),r.flags&=-33);var s=fy(t);U0(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,c=fy(t);B0(t,c,l);break;default:throw Error(ie(161))}}catch(u){it(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Yx(t,e,n){de=t,U3(t)}function U3(t,e,n){for(var r=(t.mode&1)!==0;de!==null;){var i=de,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||Su;if(!l){var c=i.alternate,u=c!==null&&c.memoizedState!==null||Wt;c=Su;var f=Wt;if(Su=l,(Wt=u)&&!f)for(de=i;de!==null;)l=de,u=l.child,l.tag===22&&l.memoizedState!==null?my(i):u!==null?(u.return=l,de=u):my(i);for(;s!==null;)de=s,U3(s),s=s.sibling;de=i,Su=c,Wt=f}py(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,de=s):py(t)}}function py(t){for(;de!==null;){var e=de;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Wt||Bc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Wt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Kn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&qm(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}qm(e,l,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var p=f.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&za(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}Wt||e.flags&512&&z0(e)}catch(x){it(e,e.return,x)}}if(e===t){de=null;break}if(n=e.sibling,n!==null){n.return=e.return,de=n;break}de=e.return}}function gy(t){for(;de!==null;){var e=de;if(e===t){de=null;break}var n=e.sibling;if(n!==null){n.return=e.return,de=n;break}de=e.return}}function my(t){for(;de!==null;){var e=de;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Bc(4,e)}catch(u){it(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){it(e,i,u)}}var s=e.return;try{z0(e)}catch(u){it(e,s,u)}break;case 5:var l=e.return;try{z0(e)}catch(u){it(e,l,u)}}}catch(u){it(e,e.return,u)}if(e===t){de=null;break}var c=e.sibling;if(c!==null){c.return=e.return,de=c;break}de=e.return}}var Kx=Math.ceil,gc=Vr.ReactCurrentDispatcher,Xp=Vr.ReactCurrentOwner,jn=Vr.ReactCurrentBatchConfig,Re=0,Tt=null,ft=null,It=0,gn=0,to=Ai(0),yt=0,Qa=null,as=0,Uc=0,Yp=0,Aa=null,ln=null,Kp=0,vo=1/0,Ir=null,mc=!1,G0=null,Si=null,ku=!1,mi=null,yc=0,Ma=0,V0=null,Uu=-1,Gu=0;function Kt(){return Re&6?lt():Uu!==-1?Uu:Uu=lt()}function ki(t){return t.mode&1?Re&2&&It!==0?It&-It:Rx.transition!==null?(Gu===0&&(Gu=Ev()),Gu):(t=je,t!==0||(t=window.event,t=t===void 0?16:Rv(t.type)),t):1}function tr(t,e,n,r){if(50<Ma)throw Ma=0,V0=null,Error(ie(185));il(t,n,r),(!(Re&2)||t!==Tt)&&(t===Tt&&(!(Re&2)&&(Uc|=n),yt===4&&pi(t,It)),fn(t,r),n===1&&Re===0&&!(e.mode&1)&&(vo=lt()+500,jc&&Mi()))}function fn(t,e){var n=t.callbackNode;R8(t,e);var r=ec(t,t===Tt?It:0);if(r===0)n!==null&&Em(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Em(n),e===1)t.tag===0?Mx(yy.bind(null,t)):Zv(yy.bind(null,t)),bx(function(){!(Re&6)&&Mi()}),n=null;else{switch(Tv(r)){case 1:n=_p;break;case 4:n=kv;break;case 16:n=Ju;break;case 536870912:n=Cv;break;default:n=Ju}n=K3(n,G3.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function G3(t,e){if(Uu=-1,Gu=0,Re&6)throw Error(ie(327));var n=t.callbackNode;if(lo()&&t.callbackNode!==n)return null;var r=ec(t,t===Tt?It:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=vc(t,r);else{e=r;var i=Re;Re|=2;var s=W3();(Tt!==t||It!==e)&&(Ir=null,vo=lt()+500,ns(t,e));do try{qx();break}catch(c){V3(t,c)}while(1);Lp(),gc.current=s,Re=i,ft!==null?e=0:(Tt=null,It=0,e=yt)}if(e!==0){if(e===2&&(i=m0(t),i!==0&&(r=i,e=W0(t,i))),e===1)throw n=Qa,ns(t,0),pi(t,r),fn(t,lt()),n;if(e===6)pi(t,r);else{if(i=t.current.alternate,!(r&30)&&!Qx(i)&&(e=vc(t,r),e===2&&(s=m0(t),s!==0&&(r=s,e=W0(t,s))),e===1))throw n=Qa,ns(t,0),pi(t,r),fn(t,lt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ie(345));case 2:Zi(t,ln,Ir);break;case 3:if(pi(t,r),(r&130023424)===r&&(e=Kp+500-lt(),10<e)){if(ec(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Kt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=C0(Zi.bind(null,t,ln,Ir),e);break}Zi(t,ln,Ir);break;case 4:if(pi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-er(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=lt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Kx(r/1960))-r,10<r){t.timeoutHandle=C0(Zi.bind(null,t,ln,Ir),r);break}Zi(t,ln,Ir);break;case 5:Zi(t,ln,Ir);break;default:throw Error(ie(329))}}}return fn(t,lt()),t.callbackNode===n?G3.bind(null,t):null}function W0(t,e){var n=Aa;return t.current.memoizedState.isDehydrated&&(ns(t,e).flags|=256),t=vc(t,e),t!==2&&(e=ln,ln=n,e!==null&&$0(e)),t}function $0(t){ln===null?ln=t:ln.push.apply(ln,t)}function Qx(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!rr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function pi(t,e){for(e&=~Yp,e&=~Uc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-er(e),r=1<<n;t[n]=-1,e&=~r}}function yy(t){if(Re&6)throw Error(ie(327));lo();var e=ec(t,0);if(!(e&1))return fn(t,lt()),null;var n=vc(t,e);if(t.tag!==0&&n===2){var r=m0(t);r!==0&&(e=r,n=W0(t,r))}if(n===1)throw n=Qa,ns(t,0),pi(t,e),fn(t,lt()),n;if(n===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Zi(t,ln,Ir),fn(t,lt()),null}function Qp(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(vo=lt()+500,jc&&Mi())}}function ls(t){mi!==null&&mi.tag===0&&!(Re&6)&&lo();var e=Re;Re|=1;var n=jn.transition,r=je;try{if(jn.transition=null,je=1,t)return t()}finally{je=r,jn.transition=n,Re=e,!(Re&6)&&Mi()}}function Zp(){gn=to.current,Xe(to)}function ns(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Tx(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(Mp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sc();break;case 3:mo(),Xe(cn),Xe($t),Bp();break;case 5:zp(r);break;case 4:mo();break;case 13:Xe(et);break;case 19:Xe(et);break;case 10:Fp(r.type._context);break;case 22:case 23:Zp()}n=n.return}if(Tt=t,ft=t=Ci(t.current,null),It=gn=e,yt=0,Qa=null,Yp=Uc=as=0,ln=Aa=null,es!==null){for(e=0;e<es.length;e++)if(n=es[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}es=null}return t}function V3(t,e){do{var n=ft;try{if(Lp(),Du.current=pc,hc){for(var r=tt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}hc=!1}if(os=0,Et=mt=tt=null,Pa=!1,Xa=0,Xp.current=null,n===null||n.return===null){yt=1,Qa=e,ft=null;break}e:{var s=t,l=n.return,c=n,u=e;if(e=It,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,p=c,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var x=p.alternate;x?(p.updateQueue=x.updateQueue,p.memoizedState=x.memoizedState,p.lanes=x.lanes):(p.updateQueue=null,p.memoizedState=null)}var v=iy(l);if(v!==null){v.flags&=-257,sy(v,l,c,s,e),v.mode&1&&ry(s,f,e),e=v,u=f;var w=e.updateQueue;if(w===null){var T=new Set;T.add(u),e.updateQueue=T}else w.add(u);break e}else{if(!(e&1)){ry(s,f,e),qp();break e}u=Error(ie(426))}}else if(Qe&&c.mode&1){var k=iy(l);if(k!==null){!(k.flags&65536)&&(k.flags|=256),sy(k,l,c,s,e),Rp(yo(u,c));break e}}s=u=yo(u,c),yt!==4&&(yt=2),Aa===null?Aa=[s]:Aa.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=T3(s,u,e);Zm(s,S);break e;case 1:c=u;var C=s.type,h=s.stateNode;if(!(s.flags&128)&&(typeof C.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(Si===null||!Si.has(h)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=b3(s,c,e);Zm(s,_);break e}}s=s.return}while(s!==null)}H3(n)}catch(E){e=E,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(1)}function W3(){var t=gc.current;return gc.current=pc,t===null?pc:t}function qp(){(yt===0||yt===3||yt===2)&&(yt=4),Tt===null||!(as&268435455)&&!(Uc&268435455)||pi(Tt,It)}function vc(t,e){var n=Re;Re|=2;var r=W3();(Tt!==t||It!==e)&&(Ir=null,ns(t,e));do try{Zx();break}catch(i){V3(t,i)}while(1);if(Lp(),Re=n,gc.current=r,ft!==null)throw Error(ie(261));return Tt=null,It=0,yt}function Zx(){for(;ft!==null;)$3(ft)}function qx(){for(;ft!==null&&!k8();)$3(ft)}function $3(t){var e=Y3(t.alternate,t,gn);t.memoizedProps=t.pendingProps,e===null?H3(t):ft=e,Xp.current=null}function H3(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=$x(n,e),n!==null){n.flags&=32767,ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yt=6,ft=null;return}}else if(n=Wx(n,e,gn),n!==null){ft=n;return}if(e=e.sibling,e!==null){ft=e;return}ft=e=t}while(e!==null);yt===0&&(yt=5)}function Zi(t,e,n){var r=je,i=jn.transition;try{jn.transition=null,je=1,Jx(t,e,n,r)}finally{jn.transition=i,je=r}return null}function Jx(t,e,n,r){do lo();while(mi!==null);if(Re&6)throw Error(ie(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(I8(t,s),t===Tt&&(ft=Tt=null,It=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ku||(ku=!0,K3(Ju,function(){return lo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=jn.transition,jn.transition=null;var l=je;je=1;var c=Re;Re|=4,Xp.current=null,Xx(t,n),B3(n,t),xx(S0),tc=!!_0,S0=_0=null,t.current=n,Yx(n),C8(),Re=c,je=l,jn.transition=s}else t.current=n;if(ku&&(ku=!1,mi=t,yc=i),s=t.pendingLanes,s===0&&(Si=null),b8(n.stateNode),fn(t,lt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(mc)throw mc=!1,t=G0,G0=null,t;return yc&1&&t.tag!==0&&lo(),s=t.pendingLanes,s&1?t===V0?Ma++:(Ma=0,V0=t):Ma=0,Mi(),null}function lo(){if(mi!==null){var t=Tv(yc),e=jn.transition,n=je;try{if(jn.transition=null,je=16>t?16:t,mi===null)var r=!1;else{if(t=mi,mi=null,yc=0,Re&6)throw Error(ie(331));var i=Re;for(Re|=4,de=t.current;de!==null;){var s=de,l=s.child;if(de.flags&16){var c=s.deletions;if(c!==null){for(var u=0;u<c.length;u++){var f=c[u];for(de=f;de!==null;){var p=de;switch(p.tag){case 0:case 11:case 15:Na(8,p,s)}var m=p.child;if(m!==null)m.return=p,de=m;else for(;de!==null;){p=de;var x=p.sibling,v=p.return;if(j3(p),p===f){de=null;break}if(x!==null){x.return=v,de=x;break}de=v}}}var w=s.alternate;if(w!==null){var T=w.child;if(T!==null){w.child=null;do{var k=T.sibling;T.sibling=null,T=k}while(T!==null)}}de=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,de=l;else e:for(;de!==null;){if(s=de,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Na(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,de=S;break e}de=s.return}}var C=t.current;for(de=C;de!==null;){l=de;var h=l.child;if(l.subtreeFlags&2064&&h!==null)h.return=l,de=h;else e:for(l=C;de!==null;){if(c=de,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Bc(9,c)}}catch(E){it(c,c.return,E)}if(c===l){de=null;break e}var _=c.sibling;if(_!==null){_.return=c.return,de=_;break e}de=c.return}}if(Re=i,Mi(),_r&&typeof _r.onPostCommitFiberRoot=="function")try{_r.onPostCommitFiberRoot(Rc,t)}catch{}r=!0}return r}finally{je=n,jn.transition=e}}return!1}function vy(t,e,n){e=yo(n,e),e=T3(t,e,1),t=_i(t,e,1),e=Kt(),t!==null&&(il(t,1,e),fn(t,e))}function it(t,e,n){if(t.tag===3)vy(t,t,n);else for(;e!==null;){if(e.tag===3){vy(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Si===null||!Si.has(r))){t=yo(n,t),t=b3(e,t,1),e=_i(e,t,1),t=Kt(),e!==null&&(il(e,1,t),fn(e,t));break}}e=e.return}}function e9(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Kt(),t.pingedLanes|=t.suspendedLanes&n,Tt===t&&(It&n)===n&&(yt===4||yt===3&&(It&130023424)===It&&500>lt()-Kp?ns(t,0):Yp|=n),fn(t,e)}function X3(t,e){e===0&&(t.mode&1?(e=hu,hu<<=1,!(hu&130023424)&&(hu=4194304)):e=1);var n=Kt();t=Ur(t,e),t!==null&&(il(t,e,n),fn(t,n))}function t9(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),X3(t,n)}function n9(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(e),X3(t,n)}var Y3;Y3=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||cn.current)un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return un=!1,Vx(t,e,n);un=!!(t.flags&131072)}else un=!1,Qe&&e.flags&1048576&&qv(e,lc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bu(t,e),t=e.pendingProps;var i=ho(e,$t.current);ao(e,n),i=Gp(null,e,r,t,i,n);var s=Vp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,dn(r)?(s=!0,oc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,jp(e),i.updater=zc,e.stateNode=i,i._reactInternals=e,M0(e,r,t,n),e=L0(null,e,r,!0,s,n)):(e.tag=0,Qe&&s&&Ap(e),Yt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=i9(r),t=Kn(r,t),i){case 0:e=I0(null,e,r,t,n);break e;case 1:e=ly(null,e,r,t,n);break e;case 11:e=oy(null,e,r,t,n);break e;case 14:e=ay(null,e,r,Kn(r.type,t),n);break e}throw Error(ie(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kn(r,i),I0(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kn(r,i),ly(t,e,r,i,n);case 3:e:{if(M3(e),t===null)throw Error(ie(387));r=e.pendingProps,s=e.memoizedState,i=s.element,i3(t,e),dc(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=yo(Error(ie(423)),e),e=uy(t,e,r,n,i);break e}else if(r!==i){i=yo(Error(ie(424)),e),e=uy(t,e,r,n,i);break e}else for(mn=wi(e.stateNode.containerInfo.firstChild),yn=e,Qe=!0,Zn=null,n=n3(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(po(),r===i){e=Gr(t,e,n);break e}Yt(t,e,r,n)}e=e.child}return e;case 5:return s3(e),t===null&&P0(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,k0(r,i)?l=null:s!==null&&k0(r,s)&&(e.flags|=32),A3(t,e),Yt(t,e,l,n),e.child;case 6:return t===null&&P0(e),null;case 13:return R3(t,e,n);case 4:return Dp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=go(e,null,r,n):Yt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kn(r,i),oy(t,e,r,i,n);case 7:return Yt(t,e,e.pendingProps,n),e.child;case 8:return Yt(t,e,e.pendingProps.children,n),e.child;case 12:return Yt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,Ge(uc,r._currentValue),r._currentValue=l,s!==null)if(rr(s.value,l)){if(s.children===i.children&&!cn.current){e=Gr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var c=s.dependencies;if(c!==null){l=s.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=jr(-1,n&-n),u.tag=2;var f=s.updateQueue;if(f!==null){f=f.shared;var p=f.pending;p===null?u.next=u:(u.next=p.next,p.next=u),f.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),N0(s.return,n,e),c.lanes|=n;break}u=u.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(ie(341));l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),N0(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Yt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ao(e,n),i=Dn(i),r=r(i),e.flags|=1,Yt(t,e,r,n),e.child;case 14:return r=e.type,i=Kn(r,e.pendingProps),i=Kn(r.type,i),ay(t,e,r,i,n);case 15:return P3(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kn(r,i),Bu(t,e),e.tag=1,dn(r)?(t=!0,oc(e)):t=!1,ao(e,n),E3(e,r,i),M0(e,r,i,n),L0(null,e,r,!0,t,n);case 19:return I3(t,e,n);case 22:return N3(t,e,n)}throw Error(ie(156,e.tag))};function K3(t,e){return Sv(t,e)}function r9(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(t,e,n,r){return new r9(t,e,n,r)}function Jp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function i9(t){if(typeof t=="function")return Jp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===vp)return 11;if(t===xp)return 14}return 2}function Ci(t,e){var n=t.alternate;return n===null?(n=Fn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Vu(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")Jp(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case $s:return rs(n.children,i,s,e);case yp:l=8,i|=8;break;case t0:return t=Fn(12,n,e,i|2),t.elementType=t0,t.lanes=s,t;case n0:return t=Fn(13,n,e,i),t.elementType=n0,t.lanes=s,t;case r0:return t=Fn(19,n,e,i),t.elementType=r0,t.lanes=s,t;case sv:return Gc(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case rv:l=10;break e;case iv:l=9;break e;case vp:l=11;break e;case xp:l=14;break e;case ci:l=16,r=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=Fn(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function rs(t,e,n,r){return t=Fn(7,t,r,e),t.lanes=n,t}function Gc(t,e,n,r){return t=Fn(22,t,r,e),t.elementType=sv,t.lanes=n,t.stateNode={isHidden:!1},t}function Eh(t,e,n){return t=Fn(6,t,null,e),t.lanes=n,t}function Th(t,e,n){return e=Fn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function s9(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oh(0),this.expirationTimes=oh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function eg(t,e,n,r,i,s,l,c,u){return t=new s9(t,e,n,c,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Fn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jp(s),t}function o9(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ws,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Q3(t){if(!t)return bi;t=t._reactInternals;e:{if(cs(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(dn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var n=t.type;if(dn(n))return Qv(t,n,e)}return e}function Z3(t,e,n,r,i,s,l,c,u){return t=eg(n,r,!0,t,i,s,l,c,u),t.context=Q3(null),n=t.current,r=Kt(),i=ki(n),s=jr(r,i),s.callback=e??null,_i(n,s,i),t.current.lanes=i,il(t,i,r),fn(t,r),t}function Vc(t,e,n,r){var i=e.current,s=Kt(),l=ki(i);return n=Q3(n),e.context===null?e.context=n:e.pendingContext=n,e=jr(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=_i(i,e,l),t!==null&&(tr(t,i,l,s),ju(t,i,l)),l}function xc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function tg(t,e){xy(t,e),(t=t.alternate)&&xy(t,e)}function a9(){return null}var q3=typeof reportError=="function"?reportError:function(t){console.error(t)};function ng(t){this._internalRoot=t}Wc.prototype.render=ng.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));Vc(t,e,null,null)};Wc.prototype.unmount=ng.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ls(function(){Vc(null,t,null,null)}),e[Br]=null}};function Wc(t){this._internalRoot=t}Wc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Nv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<hi.length&&e!==0&&e<hi[n].priority;n++);hi.splice(n,0,t),n===0&&Mv(t)}};function rg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $c(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function wy(){}function l9(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var f=xc(l);s.call(f)}}var l=Z3(e,r,t,0,null,!1,!1,"",wy);return t._reactRootContainer=l,t[Br]=l.current,Ga(t.nodeType===8?t.parentNode:t),ls(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var c=r;r=function(){var f=xc(u);c.call(f)}}var u=eg(t,0,!1,null,null,!1,!1,"",wy);return t._reactRootContainer=u,t[Br]=u.current,Ga(t.nodeType===8?t.parentNode:t),ls(function(){Vc(e,u,n,r)}),u}function Hc(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var c=i;i=function(){var u=xc(l);c.call(u)}}Vc(e,l,t,i)}else l=l9(n,e,t,i,r);return xc(l)}bv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xa(e.pendingLanes);n!==0&&(Sp(e,n|1),fn(e,lt()),!(Re&6)&&(vo=lt()+500,Mi()))}break;case 13:ls(function(){var r=Ur(t,1);if(r!==null){var i=Kt();tr(r,t,1,i)}}),tg(t,1)}};kp=function(t){if(t.tag===13){var e=Ur(t,134217728);if(e!==null){var n=Kt();tr(e,t,134217728,n)}tg(t,134217728)}};Pv=function(t){if(t.tag===13){var e=ki(t),n=Ur(t,e);if(n!==null){var r=Kt();tr(n,t,e,r)}tg(t,e)}};Nv=function(){return je};Av=function(t,e){var n=je;try{return je=t,e()}finally{je=n}};h0=function(t,e,n){switch(e){case"input":if(o0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Oc(r);if(!i)throw Error(ie(90));av(r),o0(r,i)}}}break;case"textarea":uv(t,n);break;case"select":e=n.value,e!=null&&ro(t,!!n.multiple,e,!1)}};mv=Qp;yv=ls;var u9={usingClientEntryPoint:!1,Events:[ol,Ks,Oc,pv,gv,Qp]},la={findFiberByHostInstance:Ji,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},c9={bundleType:la.bundleType,version:la.version,rendererPackageName:la.rendererPackageName,rendererConfig:la.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wv(t),t===null?null:t.stateNode},findFiberByHostInstance:la.findFiberByHostInstance||a9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cu.isDisabled&&Cu.supportsFiber)try{Rc=Cu.inject(c9),_r=Cu}catch{}}xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u9;xn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rg(e))throw Error(ie(200));return o9(t,e,null,n)};xn.createRoot=function(t,e){if(!rg(t))throw Error(ie(299));var n=!1,r="",i=q3;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=eg(t,1,!1,null,null,n,!1,r,i),t[Br]=e.current,Ga(t.nodeType===8?t.parentNode:t),new ng(e)};xn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=wv(e),t=t===null?null:t.stateNode,t};xn.flushSync=function(t){return ls(t)};xn.hydrate=function(t,e,n){if(!$c(e))throw Error(ie(200));return Hc(null,t,e,!0,n)};xn.hydrateRoot=function(t,e,n){if(!rg(t))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=q3;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=Z3(e,null,t,1,n??null,i,!1,s,l),t[Br]=e.current,Ga(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Wc(e)};xn.render=function(t,e,n){if(!$c(e))throw Error(ie(200));return Hc(null,t,e,!1,n)};xn.unmountComponentAtNode=function(t){if(!$c(t))throw Error(ie(40));return t._reactRootContainer?(ls(function(){Hc(null,null,t,!1,function(){t._reactRootContainer=null,t[Br]=null})}),!0):!1};xn.unstable_batchedUpdates=Qp;xn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$c(n))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return Hc(t,e,n,!1,r)};xn.version="18.3.1-next-f1338f8080-20240426";function J3(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(J3)}catch(t){console.error(t)}}J3(),J2.exports=xn;var d9=J2.exports,_y=d9;Jh.createRoot=_y.createRoot,Jh.hydrateRoot=_y.hydrateRoot;const Sy=({isLoading:t,onSave:e,onSaveAs:n,canSaveAs:r,onLoad:i,onClear:s,buttonStyle:l})=>M.jsxs("div",{className:"flex flex-wrap gap-2",children:[M.jsx("button",{style:{...l(!1),opacity:t?.5:1},onClick:e,disabled:t,title:"Save as PNML",children:"Save"}),M.jsx("button",{style:{...l(!1),opacity:t||!r?.5:1},onClick:n,disabled:t||!r,title:"Save As (choose location and filename)",children:"Save as"}),M.jsx("button",{style:{...l(!1),opacity:t?.5:1},onClick:i,disabled:t,title:"Load PNML file",children:"Load"}),M.jsx("button",{style:{...l(!1)},onClick:s,title:"Clear canvas",children:"Clear"})]}),ky=({mode:t,setMode:e,buttonStyle:n})=>M.jsxs("div",{className:"flex flex-wrap gap-2",children:[M.jsx("button",{style:{...n(t==="select")},"data-testid":"toolbar-select",onClick:()=>{t!=="select"&&e("select")},children:"Select"}),M.jsx("button",{style:n(t==="place"),"data-testid":"toolbar-place",onClick:()=>{t!=="place"&&e("place")},children:"Place"}),M.jsx("button",{style:n(t==="transition"),"data-testid":"toolbar-transition",onClick:()=>{t!=="transition"&&e("transition")},children:"Transition"}),M.jsx("button",{style:n(t==="arc"),"data-testid":"toolbar-arc",onClick:()=>{t!=="arc"&&e("arc")},children:"Arc"})]}),Cy=({canUndo:t,canRedo:e,onUndo:n,onRedo:r,buttonStyle:i})=>M.jsxs("div",{className:"flex flex-wrap gap-2",children:[M.jsx("button",{style:{...i(!1),opacity:t?1:.5},onClick:n,disabled:!t,title:"Undo (Ctrl+Z)",children:"Undo"}),M.jsx("button",{style:{...i(!1),opacity:e?1:.5},onClick:r,disabled:!e,title:"Redo (Ctrl+Y)",children:"Redo"})]}),Ey=({onOpenSettings:t,buttonStyle:e})=>M.jsx("div",{className:"flex flex-wrap gap-2",children:M.jsx("button",{style:e(!1),onClick:t,title:"Simulation Settings","data-testid":"toolbar-settings",children:"Settings"})});function bh(t){const e={types:[]};try{const r=new DOMParser().parseFromString(t,"application/xml"),i=r.getElementsByTagName("parsererror")[0];if(i)throw new Error(i.textContent||"Invalid XML");const l=Array.from(r.getElementsByTagName("*")).filter(f=>f.localName==="algebraicDataTypes")[0];if(!l)return e;const u=Array.from(l.childNodes).filter(f=>f.nodeType===1).filter(f=>f.localName==="type");for(const f of u){const p=f.getAttribute("name")||"",x=Array.from(f.childNodes).filter(k=>k.nodeType===1&&k.localName==="operation").map(k=>{const C=Array.from(k.childNodes).filter(h=>h.nodeType===1&&h.localName==="param").map(h=>({index:Number(h.getAttribute("index")||"0"),type:h.getAttribute("type")||""}));return{name:k.getAttribute("name")||"",arity:Number(k.getAttribute("arity")||"0"),result:k.getAttribute("result")||"",params:C}}),v=Array.from(f.childNodes).find(k=>k.nodeType===1&&k.localName==="axioms"),T=(v?Array.from(v.childNodes).filter(k=>k.nodeType===1&&k.localName==="axiom"):[]).map(k=>({name:k.getAttribute("name")||"",equation:(k.textContent||"").trim()}));e.types.push({name:p,operations:x,axioms:T})}return e}catch(n){return console.error("Error parsing ADT XML:",n),e}}function f9(t){const e=[],n=new Set;for(const r of t.types||[]){r.name||e.push("Type missing name"),n.has(r.name)&&e.push(`Duplicate type: ${r.name}`),n.add(r.name);for(const i of r.operations||[])i.name||e.push(`Operation missing name in type ${r.name}`),(!Number.isInteger(i.arity)||i.arity<0)&&e.push(`Invalid arity for ${r.name}.${i.name}`),i.result||e.push(`Operation ${r.name}.${i.name} missing result type`);for(const i of r.axioms||[])(!i.equation||!i.equation.includes("="))&&e.push(`Axiom in ${r.name} must be an equation with '='`)}return{valid:e.length===0,errors:e}}const h9=`<?xml version="1.0"?>
<algebraicDataTypes xmlns="http://example.org/apn-adt">
  <type name="Int">
    <operation name="+" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="-" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="*" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&lt;" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&lt;=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&gt;" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&gt;=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <axioms>
      <axiom name="commutativity">x + y = y + x</axiom>
      <axiom name="associativity">(x + y) + z = x + (y + z)</axiom>
      <axiom name="multiplication_commutativity">x * y = y * x</axiom>
      <axiom name="multiplication_associativity">(x * y) * z = x * (y * z)</axiom>
      <axiom name="distributivity">x * (y + z) = (x * y) + (x * z)</axiom>
    </axioms>
  </type>
  <type name="Bool">
    <operation name="and" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="or" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="not" arity="1" result="Bool">
      <param index="0" type="Bool"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <axioms>
      <axiom name="and_commutativity">x and y = y and x</axiom>
      <axiom name="and_associativity">(x and y) and z = x and (y and z)</axiom>
      <axiom name="or_commutativity">x or y = y or x</axiom>
      <axiom name="or_associativity">(x or y) or z = x or (y or z)</axiom>
      <axiom name="de_morgan_and">not (x and y) = (not x) or (not y)</axiom>
      <axiom name="de_morgan_or">not (x or y) = (not x) and (not y)</axiom>
      <axiom name="double_negation">not (not x) = x</axiom>
    </axioms>
  </type>
  <type name="Pair">
    <operation name="fst" arity="1" result="Any">
      <param index="0" type="Pair"/>
    </operation>
    <operation name="snd" arity="1" result="Any">
      <param index="0" type="Pair"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Pair"/>
      <param index="1" type="Pair"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Pair"/>
      <param index="1" type="Pair"/>
    </operation>
    <axioms>
      <axiom name="pair_equality">(x, y) == (a, b) = (x == a) and (y == b)</axiom>
      <axiom name="fst_projection">fst((x, y)) = x</axiom>
      <axiom name="snd_projection">snd((x, y)) = y</axiom>
    </axioms>
  </type>
  <type name="String">
    <operation name="concat" arity="2" result="String">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="substring" arity="3" result="String">
      <param index="0" type="String"/>
      <param index="1" type="Int"/>
      <param index="2" type="Int"/>
    </operation>
    <operation name="isSubstringOf" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="length" arity="1" result="Int">
      <param index="0" type="String"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <axioms>
      <axiom name="concat_associativity">concat(concat(x, y), z) = concat(x, concat(y, z))</axiom>
      <axiom name="concat_empty_left">concat('', x) = x</axiom>
      <axiom name="concat_empty_right">concat(x, '') = x</axiom>
      <axiom name="substring_bounds">substring(x, 0, length(x)) = x</axiom>
      <axiom name="length_concat">length(concat(x, y)) = length(x) + length(y)</axiom>
    </axioms>
  </type>
  <type name="List">
    <operation name="length" arity="1" result="Int">
      <param index="0" type="List"/>
    </operation>
    <operation name="concat" arity="2" result="List">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="head" arity="1" result="Any">
      <param index="0" type="List"/>
    </operation>
    <operation name="tail" arity="1" result="List">
      <param index="0" type="List"/>
    </operation>
    <operation name="append" arity="2" result="List">
      <param index="0" type="List"/>
      <param index="1" type="Any"/>
    </operation>
    <operation name="sublist" arity="3" result="List">
      <param index="0" type="List"/>
      <param index="1" type="Int"/>
      <param index="2" type="Int"/>
    </operation>
    <operation name="isSublistOf" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <axioms>
      <axiom name="length_empty">length([]) = 0</axiom>
      <axiom name="concat_empty_left">concat([], x) = x</axiom>
      <axiom name="concat_empty_right">concat(x, []) = x</axiom>
      <axiom name="head_cons">head([h | t]) = h</axiom>
      <axiom name="tail_cons">tail([h | t]) = t</axiom>
      <axiom name="length_concat">length(concat(x, y)) = length(x) + length(y)</axiom>
    </axioms>
  </type>
</algebraicDataTypes>`,e5=B.createContext(null);function p9({children:t}){const e=B.useMemo(()=>bh(h9),[]),[n,r]=B.useState([]),i=B.useMemo(()=>{const p=new Map;for(const m of e.types||[])p.set(m.name,{...m,__readonly:!0});for(const m of n){const x=bh(m);for(const v of x.types||[])p.has(v.name)||p.set(v.name,{...v,__readonly:!1})}return p},[e,n]),s=B.useCallback(()=>Array.from(i.keys()),[i]),l=B.useCallback(p=>i.get(p)||null,[i]),c=B.useCallback(p=>{const m=bh(p),x=f9(m);if(!x.valid)return{ok:!1,errors:x.errors};for(const v of m.types||[])if(i.has(v.name))return{ok:!1,errors:[`Duplicate type: ${v.name}`]};return r(v=>[...v,p]),{ok:!0}},[i]),u=B.useCallback(()=>n.join(`
`),[n]),f=B.useMemo(()=>({listTypes:s,getType:l,registerCustomADTXml:c,exportCustomADTXml:u,baseReadOnly:!0,addOrReplaceCustomADT:p=>c(p),clearCustomADTs:()=>r([])}),[s,l,c,u]);return M.jsx(e5.Provider,{value:f,children:t})}function g9(){const t=B.useContext(e5);if(!t)throw new Error("useAdtRegistry must be used within AdtProvider");return t}function Rt(t){if(typeof t!="string")throw new Error("Expression must be a string");const e=t.trim();let n=0;function r(k){return k>="0"&&k<="9"}function i(){for(;n<e.length&&/\s/.test(e[n]);)n++}function s(){i();let k=n;for(;n<e.length&&r(e[n]);)n++;if(k===n)throw new Error(`Expected int at position ${n}`);const S=e.slice(k,n);return{type:"int",value:parseInt(S,10)}}function l(k){return/[A-Za-z_]/.test(k)}function c(k){return/[A-Za-z0-9_]/.test(k)}function u(){if(i(),e[n]!=="'")throw new Error(`Expected string literal at position ${n}`);n++;let k="";for(;n<e.length&&e[n]!=="'";){if(e[n]==="\\"&&n+1<e.length){n++;const S=e[n];S==="n"?k+=`
`:S==="t"?k+="	":S==="r"?k+="\r":S==="\\"?k+="\\":S==="'"?k+="'":k+=S}else k+=e[n];n++}if(n>=e.length)throw new Error("Unterminated string literal");return n++,{type:"string",value:k}}function f(){i();let k=n;if(!l(e[n]))throw new Error(`Expected identifier at position ${n}`);for(n++;n<e.length&&c(e[n]);)n++;const S=e.slice(k,n);if(S&&/^[A-Z]/.test(S))throw new Error(`Variable names must start with lowercase letter, got '${S}' (use 't' instead of 'T', 'f' instead of 'F')`);if(i(),e[n]==="("){n++;const h=[];if(i(),e[n]!==")")do if(i(),h.push(v()),i(),e[n]===",")n++;else break;while(n<e.length);if(i(),e[n]!==")")throw new Error(`Expected ')' after function arguments at position ${n}`);return n++,{type:"funcall",name:S,args:h}}const C=n;if(i(),e[n]===":"){n++,i();const h=n;for(;n<e.length&&/[A-Za-z]/.test(e[n]);)n++;const _=e.slice(h,n).toLowerCase();return _==="int"||_==="bool"||_==="pair"||_==="string"||_==="list"?{type:"var",name:S,varType:_}:(n=C,{type:"var",name:S})}return{type:"var",name:S}}function p(){if(i(),e[n]!=="[")throw new Error(`Expected '[' at position ${n}`);n++;const k=[];if(i(),e[n]==="]")return n++,{type:"list",elements:[]};for(;n<e.length;){if(i(),k.push(v()),i(),e[n]==="]")return n++,{type:"list",elements:k};if(e[n]===","){n++;continue}throw new Error(`Expected ',' or ']' at position ${n}`)}throw new Error("Unterminated list literal")}function m(){if(i(),n>=e.length)throw new Error(`Unexpected end of input at position ${n}`);if(e[n]==="("){n++,i();const k=v();if(i(),e[n]===","){n++;const S=v();if(i(),n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,{type:"pair",fst:k,snd:S}}if(n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,k}if(e[n]==="[")return p();if(e[n]==="'")return u();if(r(e[n]))return s();if(/[A-Za-z_]/.test(e[n]))return f();throw new Error(`Unexpected character '${e[n]}' at position ${n}`)}function x(){let k=m();for(i();n<e.length&&(e[n]==="*"||e[n]==="/");){const S=e[n++],C=m();k={type:"binop",op:S,left:k,right:C},i()}return k}function v(){let k=x();for(i();n<e.length&&(e[n]==="+"||e[n]==="-");){const S=e[n++],C=x();k={type:"binop",op:S,left:k,right:C},i()}return k}let w=v();if(i(),n<e.length)throw new Error(`Unexpected character '${e[n]}' at position ${n}`);function T(k){return!k||typeof k!="object"||(k.type==="bin"&&(k.type="binop"),k.left&&(k.left=T(k.left)),k.right&&(k.right=T(k.right)),Array.isArray(k.args)&&(k.args=k.args.map(T)),Array.isArray(k.elements)&&(k.elements=k.elements.map(T))),k}return w=T(w),w}function t5(t){if(typeof t!="string")throw new Error("Pattern must be a string");const e=t.trim();let n=0;function r(){for(;n<e.length&&/\s/.test(e[n]);)n++}function i(){if(r(),n>=e.length)throw new Error(`Unexpected end of input at position ${n}`);if(e.slice(n,n+1)==="T")return n++,{type:"boolLit",value:!0};if(e.slice(n,n+1)==="F")return n++,{type:"boolLit",value:!1};if(e.slice(n,n+4)==="true")return n+=4,{type:"boolLit",value:!0};if(e.slice(n,n+5)==="false")return n+=5,{type:"boolLit",value:!1};if(/[0-9]/.test(e[n])){let l=n;for(;n<e.length&&/[0-9]/.test(e[n]);)n++;return{type:"int",value:parseInt(e.slice(l,n),10)}}if(e[n]==="["){n++,r();const l=[];for(;n<e.length&&e[n]!=="]";)l.push(i()),r(),e[n]===","&&(n++,r());if(n>=e.length||e[n]!=="]")throw new Error(`Expected ']' at position ${n}`);return n++,{type:"listPattern",elements:l}}if(/[a-zA-Z_]/.test(e[n])){let l=n;for(;n<e.length&&/[a-zA-Z0-9_]/.test(e[n]);)n++;const c=e.slice(l,n);if(r(),e[n]===":"){n++,r();let u=n;for(;n<e.length&&/[a-zA-Z]/.test(e[n]);)n++;const f=e.slice(u,n).toLowerCase();if(f==="int"||f==="bool"||f==="pair"||f==="string"||f==="list")return{type:"var",name:c,varType:f};throw new Error(`Unknown type '${f}' at position ${u}`)}return{type:"var",name:c}}if(e[n]==="("){n++,r();const l=[];for(;n<e.length&&e[n]!==")";)l.push(i()),r(),n<e.length&&e[n]===","&&(n++,r());if(n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,l.length===2?{type:"pairPattern",fst:l[0],snd:l[1]}:{type:"tuplePattern",elements:l}}throw new Error(`Unexpected character '${e[n]}' at position ${n}`)}const s=i();if(r(),n<e.length)throw new Error(`Unexpected character '${e[n]}' at position ${n}`);return s}function Ty(t,e){const n=new Map;function r(s,l){switch(s.type){case"int":return!(typeof l!="number"||l!==s.value);case"boolLit":return!(typeof l!="boolean"||l!==s.value);case"var":if(s.varType){const c=s.varType;if(c==="int"&&typeof l!="number"||c==="bool"&&typeof l!="boolean"||c==="string"&&typeof l!="string"||c==="list"&&!Array.isArray(l)||c==="pair"&&(!l||typeof l!="object"||!l.__pair__))return!1}if(n.has(s.name)){if(n.get(s.name)!==l)return!1}else n.set(s.name,l);return!0;case"pairPattern":return!(!l||typeof l!="object"||!l.__pair__||!r(s.fst,l.fst)||!r(s.snd,l.snd));case"tuplePattern":if(!Array.isArray(l)||l.length!==s.elements.length)return!1;for(let c=0;c<s.elements.length;c++)if(!r(s.elements[c],l[c]))return!1;return!0;case"listPattern":if(!Array.isArray(l)||l.length!==s.elements.length)return!1;for(let c=0;c<s.elements.length;c++)if(!r(s.elements[c],l[c]))return!1;return!0;default:return!1}}return r(t,e)?Object.fromEntries(n):null}function by(t,e=20){if(!t)return[];if(Array.isArray(t.valueTokens))return t.valueTokens.slice(0,e);const n=Number(t.tokens||0);return Number.isFinite(n)&&n>0?Array.from({length:Math.min(n,e)},()=>1):[]}function n5(t){return t.replace(/:int\b/g,":Int").replace(/:bool\b/g,":Bool").replace(/:pair\b/g,":Pair").replace(/:string\b/g,":String").replace(/:list\b/g,":List")}function Za(t){return typeof t=="number"?"Int":typeof t=="boolean"?"Bool":typeof t=="string"?"String":Array.isArray(t)?"List":t&&typeof t=="object"&&t.__pair__?"Pair":"Int"}function Wu(t,e,n=null,r={}){if(!t||(!e||e.size===0)&&!n)return t;let i=t;const{overwrite:s=!1}=r||{},l=t.match(/\b[a-z][a-zA-Z0-9_]*\b/g);return l&&l.forEach(c=>{if(c!=="true"&&c!=="false"&&c!=="and"&&c!=="or"&&c!=="not"){const u=e.get(c)||n;if(!u)return;if(s){const f=new RegExp(`\\b${c}(?::[A-Za-z]+)?\\b`,"g");i=i.replace(f,`${c}:${u}`)}else if(!t.includes(`${c}:`)){const f=new RegExp(`\\b${c}(?!:)\\b`,"g");i=i.replace(f,`${c}:${u}`)}}}),i}const m9="modulepreload",y9=function(t,e){return new URL(t,e).href},Py={},Ei=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=y9(s,r),s in Py)return;Py[s]=!0;const l=s.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(!!r)for(let p=i.length-1;p>=0;p--){const m=i[p];if(m.href===s&&(!l||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${c}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":m9,l||(f.as="script",f.crossOrigin=""),f.href=s,document.head.appendChild(f),l)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})},H0={silent:0,error:1,warn:2,info:3,debug:4},v9=(()=>{var r,i,s;const t=typeof globalThis<"u"?globalThis.__PETRI_NET_LOG_LEVEL__:void 0,e=typeof process<"u"?((r=process.env)==null?void 0:r.VITE_LOG_LEVEL)||((i=process.env)==null?void 0:i.LOG_LEVEL):void 0,n=typeof process<"u"&&((s=process.env)==null?void 0:s.NODE_ENV)==="production"?"warn":"debug";return(t||e||n||"warn").toLowerCase()})();function r5(t){if(!t)return"warn";const e=String(t).toLowerCase();return H0[e]!==void 0?e:"warn"}let x9=r5(v9);function Eu(t){const e=r5(t);return H0[e]<=H0[x9]}const fe={debug:(...t)=>{Eu("debug")&&console.debug(...t)},info:(...t)=>{Eu("info")&&console.info(...t)},warn:(...t)=>{Eu("warn")&&console.warn(...t)},error:(...t)=>{Eu("error")&&console.error(...t)}};let Ph=null;async function w9(){if(typeof process<"u"&&process.env&&{}.JEST_WORKER_ID){fe.debug("Jest worker detected, skipping Z3 asset fetch");return}if(typeof document>"u"){if(typeof globalThis.initZ3=="function")return;const e=globalThis.Module;try{const n=await fetch("/z3-built.wasm.base64");if(!n.ok)throw new Error(`Failed to fetch WASM base64: ${n.status}`);const i=`data:application/wasm;base64,${await n.text()}`,s={...typeof e=="object"?e:{},locateFile:u=>{if(u.endsWith(".wasm"))return fe.debug("[Z3 worker] locateFile",u,"->",`${i.substring(0,50)}...`),i;const f=`/${u}`;return fe.debug("[Z3 worker] locateFile",u,"->",f),f}};globalThis.Module=s;const l=await fetch("/z3-built.js");if(!l.ok)throw new Error(`Failed to fetch z3-built.js: ${l.status}`);const c=await l.text();if((0,eval)(c),await new Promise(u=>setTimeout(u,20)),typeof globalThis.initZ3!="function")throw new Error("initZ3 not defined after eval");return}catch(n){throw new Error(`Failed to load Z3 in worker: ${n.message}`)}finally{typeof e=="object"?globalThis.Module=e:delete globalThis.Module}}typeof globalThis.initZ3!="function"&&(fe.debug("initZ3 not found, loading Z3 built assets..."),await new Promise((e,n)=>{const r=document.createElement("script");r.src="/z3-built.js",r.async=!0,r.addEventListener("load",()=>{typeof globalThis.initZ3=="function"?(fe.debug("Z3 built assets loaded successfully"),e()):n(new Error("initZ3 function not found after loading z3-built.js"))}),r.addEventListener("error",i=>{n(new Error(`Failed to load z3-built.js: ${(i==null?void 0:i.message)||i}`))}),document.head.appendChild(r)}))}async function _9(){return Ph||(Ph=(async()=>{try{fe.debug("Initializing Z3 context..."),await w9();const{init:t}=await Ei(()=>import("./browser-b01a75fe.js").then(r=>r.b),[],import.meta.url);if(!t)throw new Error("Z3 init function not found. Z3-solver package may not be properly installed.");fe.debug("Calling Z3 init...");const e=await t();if(!e)throw new Error("Z3 initialization failed. Check browser console for WASM loading errors.");fe.debug("Creating Z3 context...");const n=new e.Context("main");if(!n)throw new Error("Failed to create Z3 context.");return fe.debug("Z3 context initialized successfully"),{z3:e,ctx:n}}catch(t){fe.error("Z3 initialization error:",t);const e=typeof process<"u"&&process.env&&{}.JEST_WORKER_ID;if(typeof document<"u"&&!e){fe.debug("Retrying Z3 initialization with asset loading...");try{typeof globalThis.initZ3!="function"&&(fe.debug("initZ3 not found, loading Z3 built assets..."),await new Promise((s,l)=>{const c=document.createElement("script");c.src="/z3-built.js",c.async=!0,c.addEventListener("load",()=>{typeof globalThis.initZ3=="function"?(fe.debug("Z3 built assets loaded successfully"),s()):l(new Error("initZ3 function not found after loading z3-built.js"))}),c.addEventListener("error",u=>{l(new Error(`Failed to load z3-built.js: ${(u==null?void 0:u.message)||u}`))}),document.head.appendChild(c)}));const{init:n}=await Ei(()=>import("./browser-b01a75fe.js").then(s=>s.b),[],import.meta.url),r=await n(),i=new r.Context("main");return fe.debug("Z3 context initialized successfully (fallback)"),{z3:r,ctx:i}}catch(n){fe.error("Fallback Z3 initialization also failed:",n)}}if(e||typeof document>"u"){fe.debug("Retrying Z3 initialization for Node.js...");try{const{init:n}=await Ei(()=>import("./browser-b01a75fe.js").then(s=>s.b),[],import.meta.url),r=await n(),i=new r.Context("main");return fe.debug("Z3 context initialized successfully (Node.js)"),{z3:r,ctx:i}}catch(n){fe.error("Node.js Z3 initialization also failed:",n)}}throw new Error(`initZ3 was not imported correctly. Please consult documentation on how to load Z3 in browser. Details: ${t.message}`)}})()),Ph}function ua(t,e=new Set){return t&&(t.type==="var"&&e.add(t.name),t.type==="pair"&&(ua(t.fst,e),ua(t.snd,e)),t.type==="binop"&&(ua(t.left,e),ua(t.right,e)),t.type==="funcall"&&t.args&&t.args.forEach(n=>ua(n,e))),e}function Mn(t,e,n){var s;const{Int:r,String:i}=t;switch(e.type){case"int":return r.val(e.value);case"string":return i.val(e.value);case"pair":const l=Mn(t,e.fst,n),c=Mn(t,e.snd,n);return l.concat(i.val(",")).concat(c);case"var":return n(e.name);case"funcall":{if(e.name==="length"&&e.args&&e.args.length===1&&((s=e.args[0])==null?void 0:s.type)==="string")return r.val((e.args[0].value||"").length);if(e.name==="concat"&&e.args&&e.args.length===2){const u=Mn(t,e.args[0],n),f=Mn(t,e.args[1],n);return u.concat(f)}if(e.name==="substring"&&e.args&&e.args.length===3){const u=Mn(t,e.args[0],n),f=Mn(t,e.args[1],n),p=Mn(t,e.args[2],n);return u.substr(f,p)}if(e.name==="length"&&e.args&&e.args.length===1)return Mn(t,e.args[0],n).length();throw new Error(`Unknown function '${e.name}'`)}case"binop":{const u=Mn(t,e.left,n),f=Mn(t,e.right,n);switch(e.op){case"+":return u.add(f);case"-":return u.sub(f);case"*":return u.mul(f);case"/":return u.div(f);default:throw new Error(`Unknown operator '${e.op}'`)}}default:throw new Error(`Unknown AST node '${e.type}'`)}}function Jn(t,e){function n(r){if(r.type==="int")return r.value|0;if(r.type==="string")return r.value;if(r.type==="list")return(r.elements||[]).map(n);if(r.type==="pair")return{__pair__:!0,fst:n(r.fst),snd:n(r.snd)};if(r.type==="var"){const i=e==null?void 0:e[r.name];if(i===void 0)throw new Error(`Unbound variable '${r.name}'`);return i}if(r.type==="funcall"){if(r.name==="concat"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(typeof i=="string"&&typeof s=="string")return i+s;if(Array.isArray(i)&&Array.isArray(s))return[...i,...s];throw new Error("concat requires two strings or two lists")}if(r.name==="substring"&&r.args&&r.args.length===3){const i=n(r.args[0]),s=n(r.args[1]),l=n(r.args[2]);if(typeof i!="string"||typeof s!="number"||typeof l!="number")throw new Error("substring requires string, int, int");return i.substr(s,l)}if(r.name==="length"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Error("length requires string or list")}if(r.name==="isSubstringOf"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(typeof i!="string"||typeof s!="string")throw new Error("isSubstringOf requires two strings");return s.includes(i)}if(r.name==="head"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!Array.isArray(i)||i.length===0)throw new Error("head requires non-empty list");return i[0]}if(r.name==="tail"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!Array.isArray(i))throw new Error("tail requires list");return i.length===0?[]:i.slice(1)}if(r.name==="append"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(!Array.isArray(i))throw new Error("append requires list");return[...i,s]}if(r.name==="sublist"&&r.args&&r.args.length===3){const i=n(r.args[0]),s=n(r.args[1]),l=n(r.args[2]);if(!Array.isArray(i)||typeof s!="number"||typeof l!="number")throw new Error("sublist requires list, int, int");return i.slice(s,s+l)}if(r.name==="isSublistOf"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(!Array.isArray(i)||!Array.isArray(s))throw new Error("isSublistOf requires two lists");const l=i.length;if(l===0)return!0;for(let c=0;c<=s.length-l;c++){let u=!0;for(let f=0;f<l;f++)if(s[c+f]!==i[f]){u=!1;break}if(u)return!0}return!1}if(r.name==="fst"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!i||typeof i!="object"||i.__pair__!==!0)throw new Error("fst requires pair");return i.fst}if(r.name==="snd"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!i||typeof i!="object"||i.__pair__!==!0)throw new Error("snd requires pair");return i.snd}throw new Error(`Unknown function '${r.name}'`)}if(r.type==="binop"){const i=n(r.left),s=n(r.right);if(typeof i!="number"||typeof s!="number")throw new Error("Arithmetic operands must be numbers");switch(r.op){case"+":return i+s|0;case"-":return i-s|0;case"*":return i*s|0;case"/":if(s===0)throw new Error("Division by zero");return Math.trunc(i/s)|0;default:throw new Error(`Unknown operator '${r.op}'`)}}throw new Error(`Unknown node type '${r.type}'`)}return n(t)}function S9(t,e){if(typeof t!="string")throw new Error("Predicate must be a string");const n=t.trim(),r=[">=","<=","==","!=",">","<"];let i=0,s=-1,l=null;for(let m=0;m<n.length;m++){const x=n[m];if(x==="("?i++:x===")"&&(i=Math.max(0,i-1)),i!==0)continue;const v=n.slice(m,m+2);if(r.includes(v)){l=v,s=m;break}if(r.includes(x)){l=x,s=m;break}}if(!l||s<0)throw new Error("Predicate must contain a comparison operator");const c=n.slice(0,s).trim(),u=n.slice(s+l.length).trim(),f=e(c),p=e(u);return{type:"cmp",op:l,left:f,right:p}}function xo(t,e){if(typeof t!="string")throw new Error("Boolean expression must be a string");const n=t.trim();let r=0;const i=()=>{for(;r<n.length&&/\s/.test(n[r]);)r++},s=(_,E)=>(_===0||/[^A-Za-z0-9_]/.test(n[_-1]||""))&&(_+E===n.length||/[^A-Za-z0-9_]/.test(n[_+E]||"")),l=_=>(i(),n.slice(r,r+_.length).toLowerCase()===_&&s(r,_.length)),c=()=>{i();const _=r;if(!/[A-Za-z_]/.test(n[r]||""))throw new Error(`Expected identifier at position ${r}`);for(r++;r<n.length&&/[A-Za-z0-9_]/.test(n[r]);)r++;const E=n.slice(_,r);if(E&&/^[A-Z]/.test(E))throw new Error(`Variable names must start with lowercase letter, got '${E}'`);const P=r;if(i(),n[r]===":"){r++,i();const I=r;for(;r<n.length&&/[A-Za-z]/.test(n[r]);)r++;const A=n.slice(I,r).toLowerCase();return A==="int"||A==="bool"||A==="pair"?{name:E,varType:A}:(r=P,{name:E})}return{name:E}},u=_=>{const E=String(_||"").trim();if(/^true$/i.test(E)||E==="T")return{type:"boolLit",value:!0};if(/^false$/i.test(E)||E==="F")return{type:"boolLit",value:!1};if(/^-?\d+$/.test(E))return{type:"int",value:parseInt(E,10)};if(E.startsWith("(")&&E.endsWith(")")){const F=E.slice(1,-1).trim();let N=0,R=-1;for(let D=0;D<F.length;D++){const V=F[D];if(V==="(")N++;else if(V===")")N=Math.max(0,N-1);else if(V===","&&N===0){R=D;break}}if(R>=0){const D=F.slice(0,R).trim(),V=F.slice(R+1).trim();if(D.length&&V.length)return{type:"pairLit",fst:u(D),snd:u(V)}}}try{if(typeof e=="function")return e(E)}catch{}const P=E.match(/^([A-Za-z_][A-Za-z0-9_]*)(?::([A-Za-z]+))?$/);if(!P)throw new Error(`Unrecognized term '${E}'`);const I=P[1];if(I&&/^[A-Z]/.test(I))throw new Error(`Variable names must start with lowercase letter, got '${I}'`);const A=(P[2]||"").toLowerCase();return A==="bool"?{type:"boolVar",name:I,varType:"bool"}:A==="pair"?{type:"pairVar",name:I,varType:"pair"}:{type:"var",name:I}},f=()=>{if(i(),r>=n.length)throw new Error("Unexpected end");if(n[r]==="T"&&s(r,1))return r+=1,{type:"boolLit",value:!0};if(n[r]==="F"&&s(r,1))return r+=1,{type:"boolLit",value:!1};if(l("true"))return r+=4,{type:"boolLit",value:!0};if(l("false"))return r+=5,{type:"boolLit",value:!1};if(n.slice(r).startsWith("isSubstringOf")){if(r+=13,i(),n[r]!=="(")throw new Error("Expected '('");let N=r+1,R=1;for(r++;r<n.length&&R>0;r++){const O=n[r];O==="("?R++:O===")"&&R--}if(R!==0)throw new Error("Unterminated isSubstringOf arguments");const D=n.slice(N,r-1).trim();let V=0,j="";const z=[];for(let O=0;O<D.length;O++){const W=D[O];if(W==="("){V++,j+=W;continue}if(W===")"){V=Math.max(0,V-1),j+=W;continue}if(W===","&&V===0){z.push(j.trim()),j="";continue}j+=W}if(j.trim().length&&z.push(j.trim()),z.length!==2)throw new Error("isSubstringOf expects two arguments");const G=e(z[0]),Y=e(z[1]);return{type:"boolFuncall",name:"isSubstringOf",args:[G,Y]}}const _=[">=","<=","==","!=",">","<"];let E=0,P=-1,I=null;for(let N=r;N<n.length;N++){const R=n[N];if(R==="("?E++:R===")"&&(E=Math.max(0,E-1)),E!==0)continue;if(n.slice(N,N+3)==="<->"){N+=2;continue}if(n.slice(N,N+2)==="->"){N+=1;continue}const D=n.slice(N,N+2);if(_.includes(D)){I=D,P=N;break}if(_.includes(R)){I=R,P=N;break}}if(I&&P>=0){const N=n.slice(r,P).trim(),R=P+I.length;let D=n.length;E=0;const V=(O,W)=>(O===0||/[^A-Za-z0-9_]/.test(n[O-1]||""))&&(O+W===n.length||/[^A-Za-z0-9_]/.test(n[O+W]||"")),j=O=>{const W=n.slice(O),X=["&&","||","^","->","<->"],ee=["and","or","xor","implies","iff"];for(const J of X)if(W.startsWith(J))return!0;for(const J of ee)if(W.toLowerCase().startsWith(J)&&V(O,J.length))return!0;return!1};for(let O=R;O<n.length;O++){const W=n[O];if(W==="("){E++;continue}if(W===")"){if(E===0){D=O;break}E=Math.max(0,E-1);continue}if(E===0&&j(O)){D=O;break}}const z=n.slice(R,D).trim(),G=u(N),Y=u(z);return r=D,{type:"cmp",op:I,left:G,right:Y}}if(n[r]==="("){r++;const N=C();if(i(),n[r]!==")")throw new Error(`Expected ')' at ${r}`);return r++,N}const{name:A,varType:F}=c();return F?{type:"boolVar",name:A,varType:F}:{type:"boolVar",name:A}},p={not:["not"],and:["and"],xor:["xor"],or:["or"],implies:["implies"],iff:["iff"]},m={not:["!"],and:["&&"],xor:["^"],or:["||"],implies:["->"],iff:["<->"]},x=(_,E)=>{i();for(const P of _)if(n.slice(r,r+P.length)===P)return r+=P.length,!0;for(const P of E)if(n.slice(r,r+P.length).toLowerCase()===P&&s(r,P.length))return r+=P.length,!0;return!1},v=()=>(i(),x(m.not,p.not)?{type:"not",expr:v()}:f()),w=()=>{let _=v();for(;i(),x(m.and,p.and);){const E=v();_={type:"and",left:_,right:E}}return _},T=()=>{let _=w();for(;i(),x(m.xor,p.xor);){const E=w();_={type:"xor",left:_,right:E}}return _},k=()=>{let _=T();for(;i(),x(m.or,p.or);){const E=T();_={type:"or",left:_,right:E}}return _},S=()=>{let _=k();for(;i(),x(m.implies,p.implies);){const E=k();_={type:"implies",left:_,right:E}}return _},C=()=>{let _=S();for(;i(),x(m.iff,p.iff);){const E=S();_={type:"iff",left:_,right:E}}return _},h=C();if(i(),r!==n.length)throw new Error(`Unexpected token '${n[r]}' at position ${r}`);return h}function uo(t,e,n){const r=l=>{if(typeof l=="boolean")return l;if(typeof l=="number")return l!==0;if(l&&typeof l=="object"&&l.__pair__)return!0;throw new Error("Non-bool binding in bool expression")},i=l=>{if(!l)throw new Error("Invalid term");if(l.type==="int"||l.type==="bin"||l.type==="var"){try{return Jn(l,e)}catch{}if(l.type==="var"&&typeof(e==null?void 0:e[l.name])<"u")return e[l.name]}return l.type==="boolLit"?!!l.value:l.type==="boolVar"?!!(e!=null&&e[l.name]):l.type==="pairVar"?e==null?void 0:e[l.name]:l.type==="pairLit"?{__pair__:!0,fst:i(l.fst),snd:i(l.snd)}:Jn(l,e)},s=l=>{switch(l.type){case"boolLit":return!!l.value;case"boolVar":return r(e==null?void 0:e[l.name]);case"boolFuncall":{if(l.name==="isSubstringOf"&&l.args&&l.args.length===2){const c=Jn(l.args[0],e||{}),u=Jn(l.args[1],e||{});if(typeof c!="string"||typeof u!="string")throw new Error("isSubstringOf requires two string arguments");return u.includes(c)}throw new Error(`Unknown boolean function '${l.name}'`)}case"not":return!s(l.expr);case"and":return s(l.left)&&s(l.right);case"or":return s(l.left)||s(l.right);case"xor":{const c=s(l.left),u=s(l.right);return c&&!u||!c&&u}case"implies":{const c=s(l.left),u=s(l.right);return!c||u}case"iff":{const c=s(l.left),u=s(l.right);return c===u}case"cmp":{const c=i(l.left),u=i(l.right),f=(p,m)=>p&&typeof p=="object"&&p.__pair__&&m&&typeof m=="object"&&m.__pair__?f(p.fst,m.fst)&&f(p.snd,m.snd):p===m;switch(l.op){case"==":return f(c,u);case"!=":return!f(c,u);case"<":return c<u;case"<=":return c<=u;case">":return c>u;case">=":return c>=u;default:return!1}}default:throw new Error(`Unknown bool AST node '${l.type}'`)}};return s(t)}async function k9(t,e,n){const{ctx:r}=await _9(),{Int:i,Bool:s,Solver:l,And:c,Not:u,Or:f}=r,p=typeof t=="string"?xo(t,n):t,m=new Set,x=new Set,v=h=>{if(h)switch(h.type){case"boolVar":x.add(h.name);break;case"and":case"or":v(h.left),v(h.right);break;case"not":v(h.expr);break;case"cmp":{const _=E=>{E&&(E.type==="var"&&m.add(E.name),E.type==="bin"&&(_(E.left),_(E.right)))};_(h.left),_(h.right);break}}};v(p);const w=new Map(Array.from(m).map(h=>[h,i.const(h)])),T=new Map(Array.from(x).map(h=>[h,s.const(h)])),k=h=>{switch(h.type){case"boolLit":return h.value?s.val(!0):s.val(!1);case"boolVar":return T.get(h.name);case"boolFuncall":{if(h.name==="isSubstringOf"&&h.args&&h.args.length===2)try{const _=Jn(h.args[0],e||{}),E=Jn(h.args[1],e||{});if(typeof _!="string"||typeof E!="string")throw new Error("isSubstringOf requires two string arguments");return E.includes(_)?s.val(!0):s.val(!1)}catch{try{const E=Mn(r,h.args[1],I=>w.get(I)),P=Mn(r,h.args[0],I=>w.get(I));return E.contains(P)}catch{return s.val(!1)}}throw new Error(`Unknown boolean function '${h.name}'`)}case"not":return u(k(h.expr));case"and":return c(k(h.left),k(h.right));case"or":return f(k(h.left),k(h.right));case"cmp":{const _=P=>P&&(P.type==="int"||P.type==="var"||P.type==="bin"||P.type==="binop");if(_(h.left)&&_(h.right)){const P=F=>{if(F.type==="int")return i.val(F.value);if(F.type==="var")return w.get(F.name);if(F.type==="bin"||F.type==="binop"){const N=P(F.left),R=P(F.right);switch(F.op){case"+":return N.add(R);case"-":return N.sub(R);case"*":return N.mul(R);case"/":return N.div(R);default:throw new Error("Unknown arithmetic operator")}}throw new Error("Unknown arithmetic AST in bool comparison")},I=P(h.left),A=P(h.right);switch(h.op){case"==":return I.eq(A);case"!=":return u(I.eq(A));case"<":return I.lt(A);case"<=":return I.le(A);case">":return I.gt(A);case">=":return I.ge(A);default:throw new Error(`Unsupported predicate operator '${h.op}'`)}}return uo({type:"cmp",op:h.op,left:h.left,right:h.right},e||{})?s.val(!0):s.val(!1)}default:throw new Error(`Unknown bool AST node '${h.type}'`)}},S=new l;try{let h=1e4;try{typeof window<"u"&&window.__Z3_SETTINGS__&&typeof window.__Z3_SETTINGS__.solverTimeoutMs=="number"&&(h=window.__Z3_SETTINGS__.solverTimeoutMs|0)}catch{}S.set("timeout",h)}catch{}if(e&&typeof e=="object"){const h=[];for(const[_,E]of Object.entries(e))w.has(_)&&typeof E=="number"?h.push(w.get(_).eq(i.val(E|0))):T.has(_)&&typeof E=="boolean"&&h.push(T.get(_).eq(E?s.val(!0):s.val(!1)));h.length&&S.add(c(...h))}S.add(k(p));const C=await S.check();return String(C)==="sat"}async function C9(t,e,n=5){const{solveEquation:r}=await Ei(()=>import("./eval-bool-1d538633.js"),[],import.meta.url);return await r(t,e,n)}function E9(t,e,n=Rt){if(!t||typeof t!="string")return{};const r={},i=t.split(",");for(const s of i){const l=s.indexOf("=");if(l===-1)continue;const c=s.slice(0,l).trim(),u=s.slice(l+1).trim();if(!c)continue;const f=n(u);r[c]=Jn(f,e)}return r}function T9(t){return t&&typeof t=="object"&&(t.__pair__||Object.prototype.hasOwnProperty.call(t,"fst")&&Object.prototype.hasOwnProperty.call(t,"snd"))}function Ra(t){return typeof t=="boolean"?t?"T":"F":typeof t=="string"?`'${t}'`:Array.isArray(t)?`[${t.map(Ra).join(", ")}]`:T9(t)?`(${Ra(t.fst)}, ${Ra(t.snd)})`:String(t)}function i5(t){return!Array.isArray(t)||t.length===0?"":t.map(Ra).join(", ")}const Ny="text-xs font-semibold text-gray-600 uppercase tracking-wider";function b9({isOpen:t,onClose:e}){const n=g9(),r=n.listTypes(),[i,s]=B.useState("x + 2 * y"),[l,c]=B.useState("x=3, y=4"),[u,f]=B.useState(null),[p,m]=B.useState([]),[x,v]=B.useState(null),w=B.useMemo(()=>r.map(h=>n.getType(h)),[r,n]);if(!t)return null;function T(C){const h=String(C||"").trim();if(!h)return{};try{const E=JSON.parse(h);if(E&&typeof E=="object"&&!Array.isArray(E))return E}catch{}const _={};for(const E of h.split(",")){const P=E.trim();if(!P)continue;const I=P.indexOf("=");if(I===-1)continue;const A=P.slice(0,I).trim(),F=P.slice(I+1).trim(),N=Number.parseInt(F,10);A&&(_[A]=Number.isFinite(N)?N:0)}return _}function k(C){let h=0;for(let _=0;_<C.length;_++){const E=C[_];if(E==="("?h++:E===")"&&(h=Math.max(0,h-1)),h===0&&E==="="){const P=C[_-1]||"",I=C[_+1]||"";if(P!=="="&&I!=="="&&P!=="<"&&P!==">")return _}}return-1}const S=async()=>{v(null),f(null),m([]);try{const C=String(i||"").trim();if(!C)throw new Error("Please enter an expression or an equation.");const h=k(C),_=T(l);if(h>=0){const E=Rt(C.slice(0,h)),P=Rt(C.slice(h+1));if(Object.keys(_).length>0){const A=await uo({type:"cmp",op:"==",left:E,right:P},_,Rt);f(!!A)}else{const{solutions:I}=await C9(E,P,5);m(I||[])}}else try{const E=Rt(C),P=await Jn(E,_);f(P)}catch{const P=xo(C,Rt),I=uo(P,_,Rt);f(!!I)}}catch(C){v(String(C.message||C))}};return M.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:M.jsxs("div",{className:"bg-white rounded shadow-lg w-[1000px] max-h-[85vh] overflow-y-auto p-4",children:[M.jsxs("div",{className:"flex items-center justify-between mb-3",children:[M.jsx("h3",{className:"text-lg font-semibold",children:"ADT Manager - Available Types and Operations"}),M.jsx("button",{className:"px-2 py-1 bg-gray-200 rounded",onClick:e,children:"Close"})]}),M.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[M.jsxs("div",{children:[M.jsx("div",{className:Ny,children:"Available Data Types"}),w.map(C=>M.jsxs("div",{className:"mt-3 p-3 border rounded bg-gray-50",children:[M.jsxs("div",{className:"flex items-center justify-between mb-3",children:[M.jsx("div",{className:"font-semibold text-lg",children:C.name}),C.__readonly&&M.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded",children:"Built-in"})]}),M.jsxs("div",{className:"mb-3",children:[M.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-700",children:"Operations"}),M.jsxs("div",{className:"space-y-1",children:[(C.operations||[]).map((h,_)=>M.jsxs("div",{className:"text-sm font-mono bg-white p-2 rounded border",children:[M.jsx("span",{className:"text-blue-600 font-semibold",children:h.name}),M.jsxs("span",{className:"text-gray-600",children:["(",h.params?h.params.map((E,P)=>`${E.type} ${String.fromCharCode(97+P)}`).join(", "):"no params",")"]}),M.jsx("span",{className:"text-gray-500",children:"  "}),M.jsx("span",{className:"text-green-600 font-semibold",children:h.result})]},_)),(!C.operations||C.operations.length===0)&&M.jsx("div",{className:"text-sm text-gray-500 italic",children:"(no operations)"})]})]}),M.jsxs("div",{children:[M.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-700",children:"Axioms"}),M.jsxs("div",{className:"space-y-1",children:[(C.axioms||[]).map((h,_)=>M.jsxs("div",{className:"text-sm font-mono bg-white p-2 rounded border",children:[M.jsx("span",{className:"text-purple-600 font-semibold",children:h.name?h.name+": ":""}),M.jsx("span",{className:"text-gray-800",children:h.equation})]},_)),(!C.axioms||C.axioms.length===0)&&M.jsx("div",{className:"text-sm text-gray-500 italic",children:"(no axioms)"})]})]})]},C.name))]}),M.jsxs("div",{children:[M.jsx("div",{className:Ny,children:"Interactive Tools"}),M.jsxs("div",{className:"mt-3 p-3 border rounded bg-gray-50",children:[M.jsx("div",{className:"text-sm font-semibold mb-3 text-gray-700",children:"Sandbox"}),M.jsxs("div",{className:"space-y-3",children:[M.jsxs("div",{children:[M.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Expression or Equation"}),M.jsx("input",{className:"w-full border rounded p-2 text-sm font-mono",placeholder:"Enter an expression (e.g., x + 2*y) or equation with '=' (e.g., x + y = 7)",value:i,onChange:C=>s(C.target.value),"data-testid":"sandbox-expr"})]}),M.jsxs("div",{children:[M.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Variable Bindings"}),M.jsx("input",{className:"w-full border rounded p-2 text-sm font-mono",placeholder:'{"x":3, "y":4} or x=3, y=4',value:l,onChange:C=>c(C.target.value),"data-testid":"sandbox-bindings"})]}),M.jsxs("div",{className:"flex items-center space-x-2",children:[M.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded text-sm",onClick:S,"data-testid":"sandbox-run",children:"Run"}),u!==null&&M.jsxs("span",{className:"text-sm","data-testid":"sandbox-result",children:["Result: ",M.jsx("span",{className:"font-mono bg-green-100 px-2 py-1 rounded",children:Ra(u)})]})]}),x&&M.jsx("div",{className:"p-2 text-red-700 bg-red-100 border border-red-200 rounded text-sm whitespace-pre-wrap",children:x}),p&&p.length>0&&M.jsxs("div",{className:"text-sm","data-testid":"sandbox-solutions",children:[M.jsx("div",{className:"font-semibold mb-2 text-gray-700",children:"Solutions (up to 5):"}),M.jsx("div",{className:"space-y-1",children:p.map((C,h)=>M.jsx("div",{className:"font-mono bg-white p-2 rounded border","data-testid":"sandbox-sol-entry",children:JSON.stringify(C)},h))})]})]})]}),M.jsxs("div",{className:"mt-4 p-3 border rounded bg-blue-50",children:[M.jsx("div",{className:"text-sm font-semibold mb-2 text-blue-800",children:"Usage Notes"}),M.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[M.jsx("div",{children:" Int operations: +(Int a, Int b), *(Int a, Int b), ==(Int a, Int b), etc."}),M.jsx("div",{children:" Bool operations: and(Bool a, Bool b), or(Bool a, Bool b), not(Bool a)"}),M.jsx("div",{children:" Pair operations: fst(Pair p), snd(Pair p), ==(Pair a, Pair b)"}),M.jsx("div",{children:" Pair literals: (value1, value2)"}),M.jsx("div",{children:" All operations support pattern matching and deconstruction"}),M.jsx("div",{children:" Parameter names (a, b, c, ...) are automatically assigned for display"})]})]})]})]})]})})}const wc="http://example.org/apn",P9="http://www.pnml.org/version-2009/grammar/pnml",N9=500,s5={startX:40,startY:40,spacing:80,columns:25,transitionOffsetX:220};function Nh(t){return t?Array.from(t):[]}function A9(t){const n=new DOMParser().parseFromString(t,"application/xml"),r=n.querySelector("parsererror");if(r)throw console.error("XML parsing error:",r.textContent),new Error("Invalid XML: "+r.textContent);const i=n.documentElement,s=i.namespaceURI||P9;return{xmlDoc:n,pnmlElement:i,PNML_NS:s}}function M9(t,e){const n=t.getElementsByTagNameNS(e,"net");if(n&&n.length>0)return n[0];const r=t.getElementsByTagName("net");return r&&r.length>0?r[0]:null}function R9(t,e){const n=t.getElementsByTagNameNS(e,"page");if(n&&n.length>0)return n[0];const r=t.getElementsByTagName("page");return r&&r.length>0?r[0]:null}function o5(t){const e=(i,s)=>{if(!i)return[];const l=typeof i.getElementsByTagNameNS=="function"?i.getElementsByTagNameNS(t,s):[];if(l&&l.length>0)return Nh(l);const c=typeof i.getElementsByTagNameNS=="function"?i.getElementsByTagNameNS(wc,s):[];if(c&&c.length>0)return Nh(c);const u=typeof i.getElementsByTagName=="function"?i.getElementsByTagName(s):[];return u&&u.length>0?Nh(u):[]},n=(i,s)=>e(i,s);return{getElements:e,findChildElements:n,getTextContent:(i,s)=>{const l=n(i,s);if(l.length===0)return"";const c=l[0],u=c.getElementsByTagName("text").length?c.getElementsByTagName("text"):c.getElementsByTagNameNS(wc,"text");if(u&&u.length>0){const f=u[0];if(f&&typeof f.textContent=="string")return f.textContent}return typeof c.textContent=="string"?c.textContent:""}}}function Ah(t,e,n){return t?o5(e).getElements(t,n):[]}function I9(t){return t>=N9}function a5(t,e,n,r,i){const{findChildElements:s}=e,{applyAutoLayout:l,layout:c=s5}=n,{startX:u,startY:f,spacing:p,columns:m,transitionOffsetX:x}=c,v=L9(t,s);if(v.found||!l)return{x:v.x,y:v.y};const w=r%m,T=Math.floor(r/m),k=u+w*p,S=f+T*p;return i==="transition"?{x:k+x,y:S}:{x:k,y:S}}function L9(t,e){const n=e(t,"graphics");if(n.length>0){const r=e(n[0],"position");if(r.length>0){const i=parseInt(r[0].getAttribute("x")||"0",10),s=parseInt(r[0].getAttribute("y")||"0",10);return{x:i,y:s,found:!0}}}return{x:0,y:0,found:!1}}function F9(t,e={}){return{applyAutoLayout:t,layout:{...s5,...e}}}function ig(t){const e=[];let n="",r=0,i=0,s=!1;for(let c=0;c<t.length;c++){const u=t[c];if(s){n+=u,u==="'"&&t[c-1]!=="\\"&&(s=!1);continue}if(u==="'"){s=!0,n+=u;continue}if(u==="("){r++,n+=u;continue}if(u===")"){r=Math.max(0,r-1),n+=u;continue}if(u==="["){i++,n+=u;continue}if(u==="]"){i=Math.max(0,i-1),n+=u;continue}if(u===","&&r===0&&i===0){e.push(n.trim()),n="";continue}n+=u}const l=n.trim();return l.length>0&&e.push(l),e.filter(Boolean)}function Ia(t){const e=String(t||"").trim(),n=e.toLowerCase();if(e==="T"||n==="true")return!0;if(e==="F"||n==="false")return!1;if(/^[+-]?\d+$/.test(e))return parseInt(e,10);if(e.startsWith("'")&&e.endsWith("'")&&e.length>=2)return e.slice(1,-1).replace(/\\(.)/g,(i,s)=>s==="n"?`
`:s==="t"?"	":s==="r"?"\r":s==="\\"?"\\":s==="'"?"'":s);if(e.startsWith("[")&&e.endsWith("]")){const r=e.slice(1,-1).trim();return r.length===0?[]:ig(r).map(s=>Ia(s))}if(e.startsWith("(")&&e.endsWith(")")){const r=e.slice(1,-1).trim();let i=0,s=-1;for(let l=0;l<r.length;l++){const c=r[l];if(c==="(")i++;else if(c===")")i=Math.max(0,i-1);else if(c===","&&i===0){s=l;break}}if(s>=0){const l=r.slice(0,s).trim(),c=r.slice(s+1).trim();return{__pair__:!0,fst:Ia(l),snd:Ia(c)}}}return null}const O9=t=>`P${t+1}`;function j9(t,e,n){const{getTextContent:r,getElements:i}=e,s=[];return t.forEach((l,c)=>{try{const u=l.getAttribute("id"),f=r(l,"name")||O9(c),p=a5(l,e,n,c,"place");let m=0,x;const v=i(l,"valueTokens").filter(T=>T.namespaceURI===wc&&T.parentElement===l);if(v.length>0){const T=v[0],k=T.getElementsByTagNameNS?T.getElementsByTagNameNS(wc,"token"):T.getElementsByTagName("token"),S=Array.from(k||[]).map(C=>{let h=r(C,"text");!h&&typeof C.textContent=="string"&&(h=C.textContent);const _=typeof h=="string"?h.trim():"";return _?Ia(_):null}).filter(C=>C!==null);x=S,m=S.length}else{const T=r(l,"initialMarking");if(T){const k=T.trim();if(k.startsWith("[")&&k.endsWith("]"))try{const S=k.slice(1,-1).trim();x=(S.length?ig(S):[]).map(Ia).filter(h=>h!==null),m=Array.isArray(x)?x.length:0}catch(S){console.warn(`Could not parse token list for ${u}:`,S)}else{const S=parseInt(k,10);Number.isFinite(S)&&(m=S)}}}const w=r(l,"type");s.push({id:u,name:f,label:f,x:p.x,y:p.y,tokens:m,valueTokens:x,type:w||void 0})}catch(u){console.error("Error processing place:",u)}}),s}const D9=t=>`T${t+1}`;function z9(t,e,n){const{getTextContent:r}=e,i=[];return t.forEach((s,l)=>{try{const c=s.getAttribute("id"),u=r(s,"name")||D9(l),f=a5(s,e,n,l,"transition"),p=r(s,"guard"),m=r(s,"action");i.push({id:c,name:u,label:u,x:f.x,y:f.y,guard:p||void 0,action:m||void 0})}catch(c){console.error("Error processing transition:",c)}}),i}const B9="north",U9="south";function G9(t,e,n){const{getTextContent:r,findChildElements:i}=e,s=[],{placeIds:l,transitionIds:c}=n;return t.forEach(u=>{try{const f=u.getAttribute("id"),p=u.getAttribute("source"),m=u.getAttribute("target");if(!p||!m){console.warn(`Skipping arc ${f} due to missing source or target`);return}let x=B9,v=U9;const w=i(u,"graphics");if(w.length>0){const _=i(w[0],"metadata");if(_.length>0){const E=i(_[0],"sourceDirection");E.length>0&&E[0].textContent&&(x=E[0].textContent);const P=i(_[0],"targetDirection");P.length>0&&P[0].textContent&&(v=P[0].textContent)}}const T=V9(f,p,m,l,c);let k=1;const S=r(u,"inscription");if(S){const _=parseInt(S,10);Number.isFinite(_)?k=_:console.warn(`Could not parse weight for ${f}: '${S}', defaulting to 1`)}const C=r(u,"binding");let h;if(C&&C.includes(","))try{h=ig(C)}catch{h=C.split(",").map(E=>E.trim()).filter(Boolean)}else C&&(h=[C.trim()]);s.push({id:f,source:p,target:m,type:T,weight:k,binding:h?void 0:C||void 0,bindings:h||void 0,sourceDirection:x,targetDirection:v})}catch(f){console.error("Error processing arc:",f)}}),s}function V9(t,e,n,r,i){const s=r.includes(e),l=i.includes(e),c=r.includes(n),u=i.includes(n);return s&&u?"place-to-transition":l&&c?"transition-to-place":e.toLowerCase().includes("place")&&n.toLowerCase().includes("transition")?"place-to-transition":e.toLowerCase().includes("transition")&&n.toLowerCase().includes("place")?"transition-to-place":(console.warn(`Could not determine arc type for ${t}, defaulting to place-to-transition`),"place-to-transition")}function W9(t){const e={places:[],transitions:[],arcs:[]};try{const{xmlDoc:n,PNML_NS:r}=A9(t),i=M9(n,r);if(!i)return console.error("No net element found in the PNML file"),e;const s=i.getAttribute("netMode");s&&(e.netMode=s);const l=R9(i,r);if(!l)return console.error("No page element found in the PNML file"),e;const c=o5(r),u=Ah(l,r,"place"),f=Ah(l,r,"transition"),p=Ah(l,r,"arc"),m=u.length+f.length,x=F9(I9(m));return e.places=j9(u,c,x),e.transitions=z9(f,c,x),e.arcs=G9(p,c,{placeIds:e.places.map(v=>v.id),transitionIds:e.transitions.map(v=>v.id)}),e}catch(n){return console.error("Error parsing PNML:",n),e}}const an="http://example.org/apn";function $9(t){try{const e=document.implementation.createDocument("http://www.pnml.org/version-2009/grammar/pnml","pnml",null),n=e.documentElement;let r=!1;const i=e.createElement("net");i.setAttribute("id","net1"),i.setAttribute("type","http://www.pnml.org/version-2009/grammar/ptnet"),n.appendChild(i),t.netMode&&i.setAttribute("netMode",t.netMode);const s=e.createElement("name"),l=e.createElement("text");l.textContent="Petri Net",s.appendChild(l),i.appendChild(s);const c=e.createElement("page");c.setAttribute("id","page1"),i.appendChild(c);const u=t.places||[];u.forEach(T=>{const k=e.createElement("place");k.setAttribute("id",T.id);const S=e.createElement("name"),C=e.createElement("text");C.textContent=T.label||T.name||`P${T.id}`,S.appendChild(C),k.appendChild(S);const h=e.createElement("graphics"),_=e.createElement("position");if(_.setAttribute("x",T.x||0),_.setAttribute("y",T.y||0),h.appendChild(_),k.appendChild(h),T.type){const P=e.createElementNS(an,"apn:type"),I=e.createElementNS(an,"apn:text");I.textContent=String(T.type),P.appendChild(I),k.appendChild(P),r=!0}const E=P=>typeof P=="boolean"?P?"T":"F":typeof P=="string"?`'${P.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}'`:Array.isArray(P)?`[${P.map(E).join(", ")}]`:P&&typeof P=="object"&&P.__pair__?`(${E(P.fst)}, ${E(P.snd)})`:String(P);if(Array.isArray(T.valueTokens)){const P=e.createElementNS(an,"apn:valueTokens");T.valueTokens.forEach(I=>{const A=e.createElementNS(an,"apn:token"),F=e.createElementNS(an,"apn:text");F.textContent=E(I),A.appendChild(F),P.appendChild(A)}),k.appendChild(P),r=!0}else if(T.tokens>0){const P=e.createElement("initialMarking"),I=e.createElement("text");I.textContent=T.tokens,P.appendChild(I),k.appendChild(P)}c.appendChild(k)});const f=t.transitions||[];f.forEach(T=>{const k=e.createElement("transition");k.setAttribute("id",T.id);const S=e.createElement("name"),C=e.createElement("text");C.textContent=T.label||T.name||`T${T.id}`,S.appendChild(C),k.appendChild(S);const h=e.createElement("graphics"),_=e.createElement("position");if(_.setAttribute("x",T.x||0),_.setAttribute("y",T.y||0),h.appendChild(_),k.appendChild(h),T.guard){const E=e.createElementNS(an,"apn:guard"),P=e.createElementNS(an,"apn:text");P.textContent=String(T.guard),E.appendChild(P),k.appendChild(E),r=!0}if(T.action){const E=e.createElementNS(an,"apn:action"),P=e.createElementNS(an,"apn:text");P.textContent=String(T.action),E.appendChild(P),k.appendChild(E),r=!0}c.appendChild(k)});const p=t.arcs||[],m=new Set(u.map(T=>T.id)),x=new Set(f.map(T=>T.id));return p.filter(T=>{const k=T.source||T.sourceId,S=T.target||T.targetId;if(!k||!S||k==="undefined"||S==="undefined")return console.warn(`Skipping invalid arc ${T.id} during save - missing or undefined source/target`),!1;const C=m.has(k)||x.has(k),h=m.has(S)||x.has(S);return!C||!h?(console.warn(`Skipping invalid arc ${T.id} during save - references non-existent elements`),!1):!0}).forEach(T=>{const k=e.createElement("arc");k.setAttribute("id",T.id);const S=T.source||T.sourceId,C=T.target||T.targetId;k.setAttribute("source",S),k.setAttribute("target",C);const h=e.createElement("graphics"),_=e.createElement("metadata"),E=e.createElement("sourceDirection");E.textContent=T.sourceDirection||"north",_.appendChild(E);const P=e.createElement("targetDirection");if(P.textContent=T.targetDirection||"south",_.appendChild(P),h.appendChild(_),k.appendChild(h),T.weight>1&&!(T.binding||Array.isArray(T.bindings)&&T.bindings.length)){const I=e.createElement("inscription"),A=e.createElement("text");A.textContent=T.weight,I.appendChild(A),k.appendChild(I)}if(Array.isArray(T.bindings)&&T.bindings.length>0){const I=e.createElementNS(an,"apn:binding"),A=e.createElementNS(an,"apn:text");A.textContent=T.bindings.join(", "),I.appendChild(A),k.appendChild(I),r=!0}else if(T.binding){const I=e.createElementNS(an,"apn:binding"),A=e.createElementNS(an,"apn:text");A.textContent=String(T.binding),I.appendChild(A),k.appendChild(I),r=!0}c.appendChild(k)}),r&&n.setAttribute("xmlns:apn",an),new XMLSerializer().serializeToString(e)}catch(e){throw console.error("Error generating PNML:",e),e}}async function Ay(t){try{return $9(t)}catch(e){throw console.error("Error exporting to PNML:",e),e}}async function H9(t){try{return W9(t)}catch(e){throw console.error("Error importing from PNML:",e),e}}class X9{constructor(){this.listeners=new Map}on(e,n){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(n)}off(e,n){if(!this.listeners.has(e))return;const r=this.listeners.get(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}emit(e,n){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)try{i(n)}catch(s){console.error(`Error in event listener for ${e}:`,s)}}removeAllListeners(e){e?this.listeners.delete(e):this.listeners.clear()}listenerCount(e){return this.listeners.has(e)?this.listeners.get(e).length:0}}const no={transitionsChanged:"transitionsChanged",transitionFired:"transitionFired"},ca=new X9;class l5{constructor(){this.isInitialized=!1,this.petriNet=null,this.eventBus=null,this.simulationMode="single"}async initialize(e,n={}){if(!this.validatePetriNet(e))throw new Error("Invalid Petri net structure");this.petriNet=this.normalizeNet(e),this.isInitialized=!0,this.simulationMode=n.simulationMode||"single",await this.initializeSpecific(this.petriNet,n)}async initializeSpecific(e,n){}async update(e){if(!this.isInitialized)throw new Error("Simulator not initialized");if(!this.validatePetriNet(e))throw new Error("Invalid Petri net structure");this.petriNet=this.normalizeNet(e),await this.updateSpecific(this.petriNet)}async updateSpecific(e){}async getEnabledTransitions(){return this.isInitialized?await this.getEnabledTransitionsSpecific():[]}async getEnabledTransitionsSpecific(){return[]}async fireTransition(e,n={}){if(!this.isInitialized)throw new Error("Simulator not initialized");if(!(n.skipEnabledCheck||!1)&&!(await this.getEnabledTransitions()).includes(e))throw new Error(`Transition ${e} is not enabled`);return await this.fireTransitionSpecific(e,n)}async fireTransitionSpecific(e){return this.petriNet}async stepSimulation(){if(!this.isInitialized)throw new Error("Simulator not initialized");return await this.stepSimulationSpecific()}async stepSimulationSpecific(){return this.petriNet}reset(){this.isInitialized=!1,this.petriNet=null,this.simulationMode="single",this.resetSpecific()}resetSpecific(){}setEventBus(e){this.eventBus=e}emitTransitionsChanged(e={}){if(!this.eventBus)return;const n=Array.isArray(e.enabled)?e.enabled:[],r=Array.isArray(e.previouslyEnabled)?e.previouslyEnabled:[],i=typeof e.hasEnabled=="boolean"?e.hasEnabled:n.length>0;this.eventBus.emit(no.transitionsChanged,{enabled:n,previouslyEnabled:r,hasEnabled:i})}emitTransitionFired(e={}){if(!this.eventBus)return;const{transitionId:n,newPetriNet:r}=e||{};n&&this.eventBus.emit(no.transitionFired,{transitionId:n,newPetriNet:r})}getType(){throw new Error("getType() must be implemented by subclasses")}validatePetriNet(e){if(!e||typeof e!="object")return!1;const{places:n,transitions:r,arcs:i}=e;return!(!Array.isArray(n)||!Array.isArray(r)||!Array.isArray(i))}normalizeNet(e){const n=JSON.parse(JSON.stringify(e||{places:[],transitions:[],arcs:[]})),r=Array.isArray(n.places)?n.places:[],i=Array.isArray(n.transitions)?n.transitions:[],s=Array.isArray(n.arcs)?n.arcs:[],l=new Set(r.map(u=>String(u.id))),c=new Set(i.map(u=>String(u.id)));for(const u of r){if(u.id=String(u.id),Array.isArray(u.valueTokens)){const f=u.valueTokens.length;(!Number.isFinite(u.tokens)||u.tokens!==f)&&(u.tokens=f)}else Number.isFinite(u.tokens)||(u.tokens=0);!u.label&&u.name&&(u.label=u.name),!u.name&&u.label&&(u.name=u.label)}for(const u of s){u.id!==void 0&&(u.id=String(u.id));const f=u.sourceId||u.source,p=u.targetId||u.target;u.sourceId=String(f),u.targetId=String(p),u.source===void 0&&(u.source=u.sourceId),u.target===void 0&&(u.target=u.targetId);const m=Number(u.weight);u.weight=Number.isFinite(m)&&m>0?m:1,Array.isArray(u.bindings)||(u.binding?u.bindings=[String(u.binding)]:u.bindings=[]),u.sourceType||(u.sourceType=l.has(u.sourceId)?"place":c.has(u.sourceId)?"transition":u.sourceType),u.targetType||(u.targetType=l.has(u.targetId)?"place":c.has(u.targetId)?"transition":u.targetType)}return n.places=r,n.transitions=i,n.arcs=s,n}isReady(){return this.isInitialized&&this.petriNet!==null}getSimulationStats(){if(!this.isInitialized)return{enabledTransitions:[],totalTokens:0,totalPlaces:0,totalTransitions:0};const{places:e,transitions:n}=this.petriNet,r=e.reduce((i,s)=>i+(s.tokens||0),0);return{enabledTransitions:[],totalTokens:r,totalPlaces:e.length,totalTransitions:n.length}}}function Y9(t){if(!(t!=null&&t.transitions)||!(t!=null&&t.places)||!(t!=null&&t.arcs))return!1;for(const e of t.transitions)if(u5(e.id,t))return!1;return!0}function u5(t,e){const n=K9(t,e.places,e.arcs);for(const r of n){const i=e.arcs.find(l=>(l.sourceId===r.id||l.source===r.id)&&(l.targetId===t||l.target===t));if(!i)continue;const s=i.weight||1;if((r.tokens||0)<s)return!1}return!0}function K9(t,e,n){const r=[];for(const i of n){const s=i.sourceId||i.source;if((i.targetId||i.target)===t){const c=e.find(u=>u.id===s);c&&r.push(c)}}return r}function Q9(t){var l,c,u,f,p;if(!t)return null;const e=((l=t.places)==null?void 0:l.length)||0,n=((c=t.transitions)==null?void 0:c.length)||0,r=((u=t.arcs)==null?void 0:u.length)||0,i=((f=t.places)==null?void 0:f.reduce((m,x)=>m+(x.tokens||0),0))||0,s=((p=t.transitions)==null?void 0:p.filter(m=>u5(m.id,t)))||[];return{placeCount:e,transitionCount:n,arcCount:r,totalTokens:i,enabledTransitionCount:s.length,enabledTransitions:s.map(m=>m.id),isDeadlock:Y9(t)}}function c5(t,e){const n=new Map;for(const r of t)r.srcId&&(n.has(r.srcId)||n.set(r.srcId,[]),n.get(r.srcId).push(r));for(const[r,i]of n.entries()){const s=e[r];if(!s)continue;const l=i.filter(u=>u.countFallback).length;if(l>0){const u=Number(s.tokens||0);s.tokens=Math.max(0,u-l)}const c=i.filter(u=>!u.countFallback);if(Array.isArray(s.valueTokens)&&c.length>0){c.sort((u,f)=>f.tokenIndex-u.tokenIndex);for(const u of c)u.tokenIndex>=0&&u.tokenIndex<s.valueTokens.length&&s.valueTokens.splice(u.tokenIndex,1);s.tokens=s.valueTokens.length}}}function Z9(t,e,n,r,i){const{evaluateArithmeticWithBindings:s,evaluateBooleanWithBindings:l,evaluatePatternLiteral:c,parseArithmetic:u}=i;for(const f of t){const p=f.targetId,m=r[p];if(!m)continue;const x=e.get(f.id)||[];if(x.length>0){Array.isArray(m.valueTokens)||(m.valueTokens=[]);for(const v of x)try{let w;const{kind:T,ast:k}=v;k&&(k.type==="var"||k.type==="boolVar"||k.type==="pairVar")?w=(n||{})[k.name]:T==="arith"?w=s(k,n):T==="bool"?w=l(k,n,u):T==="pattern"?w=c(k,n||{}):T==="pair"&&k.type==="pairLit"&&(w=c(k,n||{})),Array.isArray(m.valueTokens)||(m.valueTokens=[]),typeof w=="number"?m.valueTokens.push(w|0):typeof w=="boolean"||typeof w=="string"||q9(w)?m.valueTokens.push(w):Array.isArray(w)&&(T==="arith"||T==="pair"||k&&(k.type==="list"||k.type==="listPattern"||k.type==="tuplePattern")?m.valueTokens.push(w):m.valueTokens.push(...w))}catch{}}else if(f.weight&&(f.weight|0)>0){const v=f.weight|0;for(let w=0;w<v;w++){const T=Object.values(n||{});if(Array.isArray(m.valueTokens)){const k=T[0];m.valueTokens.push(typeof k=="boolean"?!!k:Number.isFinite(k)?k|0:1)}else m.tokens=Number(m.tokens||0)+1|0}}else Array.isArray(m.valueTokens)?m.valueTokens.push(1):m.tokens=Number(m.tokens||0)+1|0;Array.isArray(m.valueTokens)&&(m.tokens=m.valueTokens.length)}}function q9(t){return!!(t&&typeof t=="object"&&t.__pair__===!0&&"fst"in t&&"snd"in t)}class J9 extends l5{constructor(){super(),this.maxTokens=1/0}getType(){return"pt"}async initializeSpecific(e,n={}){const r=Number(n.maxTokens);this.maxTokens=Number.isFinite(r)&&r>=0?r:1/0,this.validatePTNet(e),this.initializeTokens(e),fe.debug("P/T Simulator initialized with",e.places.length,"places and",e.transitions.length,"transitions")}async updateSpecific(e){this.initializeTokens(e);const n=await this.getEnabledTransitionsSpecific();this.emitTransitionsChanged({enabled:n})}async getEnabledTransitionsSpecific(){if(!this.petriNet)return[];const{places:e,transitions:n,arcs:r}=this.petriNet,i=[];for(const s of n)this.isTransitionEnabled(s,e,r)&&i.push(s.id);return i}isTransitionEnabled(e,n,r){const i=r.filter(s=>s.target===e.id&&s.source!==e.id);for(const s of i){const l=n.find(f=>f.id===s.source);if(!l)continue;const c=s.weight||1;if((l.tokens||0)<c)return!1}return!0}async fireTransitionSpecific(e,n={}){const{places:r,transitions:i,arcs:s}=this.petriNet,l=n.skipEnabledCheck||!1,c=l?[]:await this.getEnabledTransitionsSpecific();if(!i.find(k=>k.id===e))throw new Error(`Transition ${e} not found`);const f=JSON.parse(JSON.stringify(this.petriNet)),p=f.places,m=s.filter(k=>k.target===e&&k.source!==e),x=s.filter(k=>k.source===e&&k.target!==e),v=[];for(const k of m){const S=(k.weight||1)|0;for(let C=0;C<S;C++)v.push({srcId:k.source,countFallback:!0})}const w=Object.fromEntries(p.map(k=>[k.id,k]));c5(v,w);const T=x.map(k=>({id:k.id,sourceId:k.source,targetId:k.target,weight:k.weight||1}));for(const k of T){const S=w[k.targetId];if(!S)continue;Array.isArray(S.valueTokens)&&delete S.valueTokens;const C=(k.weight||1)|0;S.tokens=Number(S.tokens||0)+C|0}for(const k of p)Array.isArray(k.valueTokens)?(k.tokens=Math.min(this.maxTokens,Array.isArray(k.valueTokens)?k.valueTokens.length:k.tokens||0),delete k.valueTokens):k.tokens=Math.min(this.maxTokens,k.tokens||0);if(this.petriNet=f,!l){this.emitTransitionFired({transitionId:e,newPetriNet:f});const k=await this.getEnabledTransitionsSpecific();this.emitTransitionsChanged({enabled:k,previouslyEnabled:c})}return f}async stepSimulationSpecific(){return this.petriNet}resetSpecific(){this.maxTokens=1/0}validatePTNet(e){const{transitions:n}=e;for(const r of n){if(r.guard&&typeof r.guard=="string"&&(r.guard.includes("+")||r.guard.includes("-")||r.guard.includes("*")||r.guard.includes("/")||r.guard.includes("=")||r.guard.includes("<")||r.guard.includes(">")||r.guard.includes("!=")))throw new Error("P/T simulator cannot handle algebraic expressions. Use algebraic simulator instead.");if(r.action&&typeof r.action=="string"&&(r.action.includes("+")||r.action.includes("-")||r.action.includes("*")||r.action.includes("/")||r.action.includes("=")))throw new Error("P/T simulator cannot handle algebraic expressions. Use algebraic simulator instead.")}}initializeTokens(e){const{places:n}=e;for(const r of n)(r.tokens===void 0||r.tokens===null)&&(r.tokens=0),r.tokens=Math.min(this.maxTokens,Math.max(0,r.tokens))}getSimulationStats(){if(!this.isInitialized)return{enabledTransitions:[],totalTokens:0,totalPlaces:0,totalTransitions:0};const{places:e,transitions:n}=this.petriNet,r=e.reduce((s,l)=>s+(l.tokens||0),0);return{enabledTransitions:this.getEnabledTransitionsSync(),totalTokens:r,totalPlaces:e.length,totalTransitions:n.length}}getEnabledTransitionsSync(){if(!this.petriNet)return[];const{places:e,transitions:n,arcs:r}=this.petriNet,i=[];for(const s of n)this.isTransitionEnabled(s,e,r)&&i.push(s.id);return i}}function yr(t,e){if(!t)return null;switch(t.type){case"pairLit":return{__pair__:!0,fst:yr(t.fst,e),snd:yr(t.snd,e)};case"list":return(t.elements||[]).map(n=>yr(n,e));case"pairPattern":return{__pair__:!0,fst:yr(t.fst,e),snd:yr(t.snd,e)};case"tuplePattern":return(t.elements||t.components||[]).map(n=>yr(n,e));case"listPattern":return(t.elements||[]).map(n=>yr(n,e));case"boolLit":return!!t.value;case"int":return t.value|0;case"var":case"boolVar":case"pairVar":return(e||{})[t.name];default:return null}}function ew(t,e,n,r){var i;try{const s=(t.arcs||[]).filter(l=>l.sourceId===n&&(l.targetType==="place"||!l.targetType));for(const l of s){const c=((i=e==null?void 0:e.bindingAstsByArc)==null?void 0:i.get(l.id))||[];for(const u of c){const{ast:f}=u||{};if(f&&(f.type==="var"||f.type==="boolVar"||f.type==="pairVar")){const p=r?r[f.name]:void 0;if(p===void 0)continue;const m=f.varType;if(m==="int"&&typeof p!="number"||m==="bool"&&typeof p!="boolean"||m==="string"&&typeof p!="string"||m==="pair"&&!(p&&typeof p=="object"&&p.__pair__===!0)||m==="list"&&!Array.isArray(p))return!1}}}return!0}catch{return!1}}const tw=["concat","substring","length","head","tail","append","sublist","isSublistOf","isSubstringOf","fst","snd"],nw=new Set(tw);function rw(t,e,n,r){const i=new Map;for(const s of t.transitions||[])if(s.guard&&typeof s.guard=="string")try{const l=n(String(s.guard),e);i.set(s.id,l)}catch{try{const c=r(String(s.guard),e);i.set(s.id,c)}catch{}}return i}function iw(t,e){if(!t)return!1;const n=t.length;for(let r=0;r<n;r+=1){const i=t[r];if(!/[A-Za-z_]/.test(i))continue;let s=r+1;for(;s<n&&/[A-Za-z0-9_]/.test(t[s]);)s+=1;const l=t.slice(r,s);if(e.has(l)){let c=s;for(;c<n&&/\s/.test(t[c]);)c+=1;if(c<n&&t[c]==="(")return!0}r=s-1}return!1}function sw(t,e,n,r,i){const s=new Map;for(const l of t.arcs||[]){const c=l.id,u=Array.isArray(l.bindings)?l.bindings:l.binding?[l.binding]:[],f=[];for(const p of u){const m=String(p),x=m.trim(),v=iw(x,i),w=h=>{if(!h||typeof h!="object")return!0;switch(h.type){case"funcall":return i.has(h.name)?(h.args||[]).every(w):!1;case"pair":return w(h.fst)&&w(h.snd);case"list":return(h.elements||[]).every(w);case"binop":return w(h.left)&&w(h.right);default:return!0}},T=()=>{let h=null;try{h=n(m)}catch{h=null}return!h||!w(h)?!1:(h.type==="var"&&h.varType==="bool"?f.push({kind:"bool",ast:{type:"boolVar",name:h.name,varType:"bool"}}):h.type==="var"&&h.varType==="pair"?f.push({kind:"pair",ast:{type:"pairVar",name:h.name,varType:"pair"}}):f.push({kind:"arith",ast:h}),!0)},k=()=>{try{const h=e(m);return f.push({kind:"pattern",ast:h}),!0}catch{return!1}};let S=!1;if(v?(S=T(),S||(S=k())):(S=k(),S||(S=T())),S)continue;const C=m==="T"?!0:m==="F"?!1:null;if(C!==null){f.push({kind:"bool",ast:{type:"boolLit",value:C}});continue}try{f.push({kind:"bool",ast:r(m,n)});continue}catch{}}f.length&&s.set(c,f)}return s}function My(t){return!!(t&&typeof t=="object"&&t.__pair__===!0&&"fst"in t&&"snd"in t)}async function Ry({transition:t,inputArcs:e,placesById:n,bindingAstsByArc:r,guardAst:i,parseArithmetic:s,evaluateBooleanPredicate:l,matchPattern:c,getTokensForPlace:u,evaluateArithmeticWithBindings:f,evaluateBooleanWithBindings:p,evaluatePatternLiteral:m,maxTokensPerPlace:x=20}){const v=[],w=async(T,k)=>{if(T>=e.length){if(!i)return{env:k,picks:v};try{return p(i,k||{},s)?{env:k,picks:v}:null}catch{try{return await l(i,k||{},s)?{env:k,picks:v}:null}catch{return null}}}const S=e[T],C=S.id,h=S.sourceId||S.source,_=n[h],E=u(_,x),P=r.get(C)||[],I=P.length||(S.weight?Math.max(1,S.weight|0):0);if(I===0)return w(T+1,k);if(E.length<I)return null;const A=new Array(E.length).fill(!1),F=async(N,R)=>{if(N>=I)return w(T+1,R);for(let D=0;D<E.length;D++){if(A[D])continue;A[D]=!0;const V=E[D];let j=!0,z=R;const G=P[N];if(G){const{kind:Y,ast:O}=G;if(Y==="pattern"){const W=c(O,V);if(W===null)j=!1;else{for(const[X,ee]of Object.entries(W))if(z&&Object.prototype.hasOwnProperty.call(z,X)&&z[X]!==ee){j=!1;break}j&&(z={...z||{},...W})}}else if(O&&(O.type==="var"||O.type==="boolVar"||O.type==="pairVar"))z&&Object.prototype.hasOwnProperty.call(z,O.name)&&z[O.name]!==V?j=!1:(typeof V=="boolean"&&O.varType&&O.varType!=="bool"&&(j=!1),typeof V=="number"&&O.varType&&O.varType!=="int"&&(j=!1),typeof V=="string"&&O.varType&&O.varType!=="string"&&(j=!1),Array.isArray(V)&&O.varType&&O.varType!=="list"&&(j=!1),My(V)&&O.varType&&O.varType!=="pair"&&(j=!1),j&&(z={...z||{},[O.name]:V}));else if(Y==="arith")try{const W=f(O,R||{});(typeof V!="number"||W!==(V|0))&&(j=!1)}catch{j=!1}else if(Y==="bool")try{const W=p(O,R||{},s);(typeof V!="bool"||W!==V)&&(j=!1)}catch{j=!1}else if(Y==="pair")try{if(O.type==="pairLit"){const W=m(O,R||{});(!My(V)||JSON.stringify(W)!==JSON.stringify(V))&&(j=!1)}}catch{j=!1}}if(j){v.push({arcId:S.id,srcId:h,tokenIndex:D,value:V,countFallback:!Array.isArray(_==null?void 0:_.valueTokens)});const Y=await F(N+1,z);if(Y)return Y;v.pop()}A[D]=!1}return null};return F(0,k||{})};return w(0,{})}function d5(t){const e=new Set;function n(r){if(r)switch(r.type){case"var":e.add(r.name);break;case"pairPattern":n(r.fst),n(r.snd);break;case"listPattern":Array.isArray(r.elements)&&r.elements.forEach(n);break;case"tuplePattern":r.elements&&r.elements.forEach(n);break}}return n(t),Array.from(e)}function f5(t){const e=new Set;function n(r){if(r)switch(r.type){case"var":case"boolVar":case"pairVar":e.add(r.name);break;case"binop":case"cmp":n(r.left),n(r.right);break;case"unop":n(r.operand);break;case"call":r.args&&r.args.forEach(n);break;case"pairPattern":n(r.fst),n(r.snd);break;case"tuplePattern":r.elements&&r.elements.forEach(n);break;case"pairLit":n(r.fst),n(r.snd);break}}return n(t),Array.from(e)}function ow(t,e,n,r,i){const s=new Set;for(const u of i){const f=e.get(u.id)||[];for(const p of f){const{kind:m,ast:x}=p||{};m==="pattern"&&d5(x).forEach(w=>s.add(w))}}const l=n.get(r);if(l){const u=f5(l);for(const f of u)if(!s.has(f))return!0}const c=(t.arcs||[]).filter(u=>u.sourceId===r&&(u.targetType==="place"||!u.targetType));for(const u of c){const f=e.get(u.id)||[];if(f.length===0)return!0;for(const p of f){const{kind:m,ast:x}=p||{};if(m==="pattern"&&x.type==="var"&&!s.has(x.name))return!0}}return!1}function aw(t){const e=(t.places||[]).map(l=>({id:l.id,label:l.label||"",tokens:Number(Array.isArray(l.valueTokens)?l.valueTokens.length:l.tokens||0),x:Number(l.x||0),y:Number(l.y||0),name:l.name||"",type:"place",valueTokens:Array.isArray(l.valueTokens)?[...l.valueTokens]:void 0})),n=(t.transitions||[]).map(l=>({id:l.id,label:l.label||"",x:Number(l.x||0),y:Number(l.y||0),name:l.name||"",type:"transition",guard:l.guard,action:l.action})),r=new Set(e.map(l=>l.id)),i=new Set(n.map(l=>l.id)),s=(t.arcs||[]).map(l=>{const c=l.sourceId||l.source,u=l.targetId||l.target,f=r.has(c)?"place":i.has(c)?"transition":l.sourceType||"place",p=r.has(u)?"place":i.has(u)?"transition":l.targetType||"transition",m=l.type||`${f}-to-${p}`;return{id:l.id,sourceId:c,targetId:u,source:c,target:u,weight:Number(l.weight||1),sourceType:f,targetType:p,type:m,bindings:Array.isArray(l.bindings)?[...l.bindings]:l.binding?[l.binding]:[]}});return{places:e,transitions:n,arcs:s}}let wr=[],lw=1;const _c=new Map;let Iy=0,Mh=null;const ll=typeof Worker<"u",On={poolSize:0,idleTimeoutMs:3e5,prewarmOnAlgebraicMode:!0,solverTimeoutMs:1e4};function uw(){try{if(typeof globalThis<"u"){const t=globalThis;t.__Z3_SETTINGS__={...t.__Z3_SETTINGS__||{},...On}}}catch{}}function To(t){return Math.max(0,(Number.isFinite(t)?t:0)|0)}function cw(t={}){typeof t.poolSize=="number"&&(On.poolSize=To(t.poolSize)),typeof t.idleTimeoutMs=="number"&&(On.idleTimeoutMs=Math.max(1e3,t.idleTimeoutMs|0)),typeof t.prewarmOnAlgebraicMode=="boolean"&&(On.prewarmOnAlgebraicMode=t.prewarmOnAlgebraicMode),typeof t.solverTimeoutMs=="number"&&(On.solverTimeoutMs=Math.max(0,t.solverTimeoutMs|0)),dw()}function h5(){if(!ll)throw new Error("Z3 worker pool unavailable in this environment");const t=new Worker(new URL(""+new URL("z3.worker-a27510d9.js",import.meta.url).href,self.location),{type:"module"});return t.onmessage=({data:e})=>{const{id:n,ok:r,result:i,error:s}=e||{},l=_c.get(n);l&&(_c.delete(n),r?l.resolve(i):l.reject(new Error(s)),p5())},t}function dw(){if(uw(),!ll)return;const t=To(On.poolSize);for(;wr.length<t;)wr.push(h5());for(;wr.length>t;){const e=wr.pop();try{e.terminate()}catch{}}}function fw(){if(!ll)throw new Error("Z3 worker pool unavailable in this environment");if(To(On.poolSize)<=0)throw new Error("Z3 worker pool disabled");wr.length===0&&wr.push(h5());const e=wr[Iy%wr.length];return Iy++,e}function p5(){ll&&(On.idleTimeoutMs<=0||(Mh&&clearTimeout(Mh),Mh=setTimeout(()=>{const t=To(On.poolSize);for(;wr.length>t;){const e=wr.pop();try{e.terminate()}catch{}}},On.idleTimeoutMs)))}function bo(t,...e){const n=fw(),r=lw++;return new Promise((i,s)=>{_c.set(r,{resolve:i,reject:s});try{n.postMessage({id:r,op:t,args:e})}catch(l){_c.delete(r),s(l);return}p5()})}function X0(){return To(On.poolSize)}function Y0(){return ll&&To(On.poolSize)>0}const hw=t=>bo("parseBooleanExpr",t),K0=(t,e,n)=>bo("evaluateBooleanPredicate",t,e),pw=(t,e,n)=>bo("evaluateArithmeticWithBindings",t,e),gw=(t,e)=>bo("evaluateAction",t,e),mw=(t,e)=>bo("solveEquation",t,e),yw=(t,e,n)=>bo("solveInequality",t,e,n),Sc=Object.freeze(Object.defineProperty({__proto__:null,evaluateAction:gw,evaluateArithmeticWithBindings:pw,evaluateBooleanPredicate:K0,getConfiguredPoolSize:X0,isWorkerPoolEnabled:Y0,parseBooleanExpr:hw,setZ3WorkerConfig:cw,solveEquation:mw,solveInequality:yw},Symbol.toStringTag,{value:"Module"})),Rh=async(t,e,n)=>{try{if((typeof Y0=="function"?Y0():!1)&&typeof K0=="function")try{return await K0(t,e,n)}catch{}}catch{}return k9(t,e,n)},Ly=t=>JSON.parse(JSON.stringify(t||{places:[],transitions:[],arcs:[]})),vw=(t,e)=>{const n=new Set,r=l=>{if(l)switch(l.type){case"boolVar":case"pairVar":n.add(l.name);break;case"and":case"or":r(l.left),r(l.right);break;case"not":r(l.expr);break;case"cmp":i(l.left),i(l.right);break}},i=l=>{l&&(l.type==="var"||l.type==="boolVar"||l.type==="pairVar"?n.add(l.name):l.type==="bin"?(i(l.left),i(l.right)):l.type==="pairLit"&&(i(l.fst),i(l.snd)))};r(t);const s=new Set(Object.keys(e||{}));return Array.from(n).filter(l=>!s.has(l))},Fy=t=>{try{const e=Array.isArray(t==null?void 0:t.transitions)?t.transitions.slice():[],n=Array.isArray(t==null?void 0:t.arcs)?t.arcs.slice():[];e.sort((s,l)=>String(s.id).localeCompare(String(l.id))),n.sort((s,l)=>String(s.id).localeCompare(String(l.id)));const r=e.map(s=>`${s.id}|g:${String(s.guard||"")}|a:${String(s.action||"")}`).join(";"),i=n.map(s=>`${s.id}|b:${Array.isArray(s.bindings)?s.bindings.join(","):s.binding?String(s.binding):""}`).join(";");return`${r}||${i}`}catch{return String(Math.random())}};class xw extends l5{constructor(){super(),this.lastEnabledTransitions=[],this.cache={guardAstByTransition:new Map,bindingAstsByArc:new Map},this._cacheSignature=null,this._config={maxTokensPerPlace:1/0},this._enabledCache=new Map}getType(){return"algebraic"}async initializeSpecific(e,n={}){this.lastEnabledTransitions=[],this._enabledCache.clear(),this._cacheSignature=null,this.petriNet=Ly(e),n&&typeof n.maxTokensPerPlace=="number"&&n.maxTokensPerPlace>=0?this._config.maxTokensPerPlace=n.maxTokensPerPlace|0:this._config.maxTokensPerPlace=1/0,await this.buildCaches(),await this.checkTransitionStateChanges()}async buildCaches(){this.cache.guardAstByTransition.clear(),this.cache.bindingAstsByArc.clear(),this.cache.guardAstByTransition=rw(this.petriNet,Rt,xo,S9),this.cache.bindingAstsByArc=sw(this.petriNet,t5,Rt,xo,nw),this._cacheSignature=Fy(this.petriNet)}getStatus(){var e,n,r;return{isInitialized:this.isInitialized,hasPyodide:!1,hasSimulator:!0,hasPetriNet:!!this.petriNet,simulationMode:this.simulationMode,petriNetSize:this.petriNet?{places:((e=this.petriNet.places)==null?void 0:e.length)||0,transitions:((n=this.petriNet.transitions)==null?void 0:n.length)||0,arcs:((r=this.petriNet.arcs)==null?void 0:r.length)||0}:null}}async setSimulationMode(e){if(e==="single"||e==="maximal")this.simulationMode=e;else throw new Error("Mode must be 'single' or 'maximal'")}_outputBindingsTypeCompatible(e,n){return ew(this.petriNet,this.cache,e,n)}_invalidateEnabledCache(e){if(!e||e.size===0)return;const n=this.petriNet.arcs||[];for(const r of n){const i=r.sourceId||r.source;if((r.type==="place-to-transition"||r.sourceType==="place")&&e.has(i)){const l=String(r.targetId||r.target);this._enabledCache.delete(l)}}}_clearEnabledCache(){this._enabledCache.clear()}async updateSpecific(e){const r=Fy(e)!==this._cacheSignature;this.petriNet=Ly(e),r&&await this.buildCaches(),this._clearEnabledCache(),await this.checkTransitionStateChanges()}async getEnabledTransitionsSpecific(){const e=Array.isArray(this.petriNet.transitions)?this.petriNet.transitions:[];if(e.length===0)return[];const n=[];for(let i=0;i<e.length;i++){const s=String(e[i].id);this._enabledCache.has(s)||n.push(e[i])}if(n.length>0){const i=typeof X0=="function"?Number(X0()||0):0,s=Math.max(1,Math.min(n.length,i>0?i:1));if(s<=1)for(const l of n)try{const c=await this.isTransitionEnabled(l.id);this._enabledCache.set(String(l.id),c)}catch{this._enabledCache.set(String(l.id),!1)}else{const l=new Array(n.length).fill(!1);let c=0;const u=async()=>{for(;;){const p=c++;if(p>=n.length)break;const m=n[p];try{const x=await this.isTransitionEnabled(m.id);l[p]=x}catch{}}},f=Array.from({length:s},()=>u());await Promise.all(f);for(let p=0;p<n.length;p++)this._enabledCache.set(String(n[p].id),l[p])}}const r=[];for(const i of e){const s=String(i.id);this._enabledCache.get(s)===!0&&r.push(s)}return r}async checkForUnboundVariables(e,n){return ow(this.petriNet,this.cache.bindingAstsByArc,this.cache.guardAstByTransition,e,n)}extractVariablesFromPattern(e){return d5(e)}extractVariablesFromExpression(e){return f5(e)}async isTransitionEnabled(e){if(!this.isInitialized)return!1;const n=(this.petriNet.transitions||[]).find(u=>u.id===e);if(!n)return!1;const r=(this.petriNet.arcs||[]).filter(u=>(u.targetId===e||u.target===e)&&(u.sourceType==="place"||!u.sourceType));if(r.length===0)return!0;if(await this.checkForUnboundVariables(e,r))return fe.debug("Transition disabled due to unbound variables:",e),!1;const s=this.cache.guardAstByTransition.get(e),l=Object.fromEntries((this.petriNet.places||[]).map(u=>[u.id,u])),c=await Ry({transition:n,inputArcs:r,placesById:l,bindingAstsByArc:this.cache.bindingAstsByArc,guardAst:s,parseArithmetic:Rt,evaluateBooleanPredicate:Rh,matchPattern:Ty,getTokensForPlace:by,evaluateArithmeticWithBindings:Jn,evaluateBooleanWithBindings:uo,evaluatePatternLiteral:yr,maxTokensPerPlace:this._config.maxTokensPerPlace});return c?this._outputBindingsTypeCompatible(e,c.env||{}):!1}async stepSimulationSpecific(){return this.getCurrentState()}async fireTransitionSpecific(e,n={}){const r=n.skipEnabledCheck||!1,i=r?[]:await this.getEnabledTransitionsSpecific(),s=(this.petriNet.transitions||[]).find(w=>w.id===e);if(!s)return this.getCurrentState();const l=(this.petriNet.arcs||[]).filter(w=>(w.targetId===e||w.target===e)&&(w.sourceType==="place"||!w.sourceType)),c=(this.petriNet.arcs||[]).filter(w=>(w.sourceId===e||w.source===e)&&(w.targetType==="place"||!w.targetType)),u=Object.fromEntries((this.petriNet.places||[]).map(w=>[w.id,w])),f=this.cache.guardAstByTransition.get(e),p=await Ry({transition:s,inputArcs:l,placesById:u,bindingAstsByArc:this.cache.bindingAstsByArc,guardAst:f,parseArithmetic:Rt,evaluateBooleanPredicate:Rh,matchPattern:Ty,getTokensForPlace:by,evaluateArithmeticWithBindings:Jn,evaluateBooleanWithBindings:uo,evaluatePatternLiteral:yr,maxTokensPerPlace:this._config.maxTokensPerPlace});if(!p)throw new Error(`Transition ${e} is not enabled`);let m=p.env||{};const x=p.picks||[];if(f&&vw(f,m).length>0)try{if(!await Rh(f,m,Rt))throw new Error("Guard unsatisfied under any extension")}catch{}const v=new Set;for(const w of x)v.add(w.srcId);for(const w of c)v.add(w.targetId||w.target);if(c5(x,u),Z9(c,this.cache.bindingAstsByArc,m,u,{evaluateArithmeticWithBindings:Jn,evaluateBooleanWithBindings:uo,evaluatePatternLiteral:yr,parseArithmetic:Rt}),s.action&&typeof s.action=="string")try{const w=E9(s.action,m,Rt)}catch{}if(this._invalidateEnabledCache(v),!r){await this.checkTransitionStateChanges();const w=this.getCurrentState();this.emitTransitionFired({transitionId:e,newPetriNet:w});const T=await this.getEnabledTransitionsSpecific();return this.emitTransitionsChanged({enabled:T,previouslyEnabled:i}),w}return this.getCurrentState()}getCurrentState(){return aw(this.petriNet)}async checkTransitionStateChanges(){if(this.isInitialized)try{const e=await this.getEnabledTransitionsSpecific();if(JSON.stringify([...e].sort())!==JSON.stringify([...this.lastEnabledTransitions].sort())){const r=[...this.lastEnabledTransitions];this.lastEnabledTransitions=[...e],this.emitTransitionsChanged({enabled:e,previouslyEnabled:r})}}catch{}}resetSpecific(){this.lastEnabledTransitions=[],this.cache.guardAstByTransition.clear(),this.cache.bindingAstsByArc.clear(),this._cacheSignature=null,this._config.maxTokensPerPlace=1/0,this._clearEnabledCache()}}class ww{static createSimulator(e){switch(e){case"pt":return new J9;case"algebraic":return new xw;default:throw new Error(`Unknown net mode: ${e}`)}}static getAvailableTypes(){return["pt","algebraic"]}static isSupported(e){return this.getAvailableTypes().includes(e)}}const Oy=async()=>{try{await new Promise(t=>setTimeout(t,0))}catch{}try{typeof requestAnimationFrame<"u"&&await new Promise(t=>requestAnimationFrame(()=>t()))}catch{}},_w=t=>{const e=new Set;if(!t||!Array.isArray(t.transitions))return e;const n=Array.isArray(t.arcs)?t.arcs:[],r=Array.isArray(t.places)?t.places:[],i=new Set(r.map(s=>String(s.id)));for(const s of t.transitions){const l=String(s.id);let c=!1,u=!1;for(const f of n){const p=String(f.sourceId||f.source),m=String(f.targetId||f.target);if(m===l&&p!==l&&i.has(p)&&(c=!0),p===l&&m!==l&&i.has(m)&&(u=!0),c&&u)break}!c&&!u&&e.add(l)}return e},Sw=(t,e,n)=>{const r=new Map;for(const c of t)r.set(c,new Set);for(const c of e||[]){const u=c.targetId||c.target,f=c.sourceId||c.source;(c.type==="place-to-transition"||c.sourceType==="place")&&r.has(u)&&r.get(u).add(f)}const i=t.slice();for(let c=i.length-1;c>0;c--){const u=Math.random()*(c+1)|0,f=i[c];i[c]=i[u],i[u]=f}const s=new Set,l=[];for(const c of i){const u=r.get(c)||new Set;let f=!0;for(const p of u)if(s.has(p)){f=!1;break}if(f){l.push(c);for(const p of u)s.add(p);if(n>0&&l.length>=n)break}}return l},kw=(t=[])=>t.map(e=>{if(typeof e=="string")return e;if(e&&typeof e=="object"){if(e.id)return e.id;if(e.get)return e.get("id")}return String(e)}).filter(Boolean),Cw=async({simulator:t,mode:e="single",maxSteps:n=1e5,timeBudgetMs:r=3e4,yieldEvery:i=100,onProgress:s,shouldCancel:l,batchMax:c=0,progressEveryMs:u=0,yieldEveryMs:f=0})=>{const p=typeof performance<"u"&&performance.now?()=>performance.now():()=>Date.now(),m=p();let x=0,v=m,w=m,T=-1;const k=E=>{if(!s)return;const P=E-m,I=u>0?Math.floor(P/u):0;if(I!==T){T=I;try{s({steps:x,elapsedMs:P})}catch{}}},S=_w(t.petriNet||{}),C=async()=>{const E=await t.getEnabledTransitions();return kw(E).filter(I=>!S.has(String(I)))},h=async()=>{if(l&&l())return!1;const E=p(),P=E-m;if(i>0&&x%i===0){const I=p();k(I),await Oy();const A=p();return w=A,v=A,u>0&&k(A),!(r>0&&A-m>r||l&&l())}if(u>0&&E-v>=u&&(k(E),v=E),f>0&&E-w>=f){await Oy();const I=p();if(w=I,u>0&&I-v>=u&&(k(I),v=I),r>0&&I-m>r||l&&l())return!1}return!(r>0&&P>r||l&&l())};let _=!0;for(;_&&x<n&&!(l&&l());){const E=await C();if(!E||E.length===0)break;if(e==="maximal"){const P=t.petriNet||{},I=c>0?c:Number.POSITIVE_INFINITY;let A=Sw(E,P.arcs||[],I);if(!A||A.length===0){const F=E[Math.floor(Math.random()*E.length)];A=F?[F]:[]}if(l&&l()){_=!1;break}await Promise.all(A.map(F=>t.fireTransition(F,{skipEnabledCheck:!0}))),x+=A.length,_=await h()}else{const P=E[Math.floor(Math.random()*E.length)];await t.fireTransition(P),x+=1,_=await h()}}if(s)try{s({steps:x,elapsedMs:p()-m})}catch{}return{petriNet:t.petriNet||null,steps:x}},jy=(t,e={})=>{fe.debug("determineNetMode called with:",{petriNet:t,options:e});const n=(e==null?void 0:e.netMode)||(t==null?void 0:t.netMode);if(fe.debug("Found netMode from options/petriNet:",n),n){const r=n==="algebraic-int"?"algebraic":n;return fe.debug("Using configured netMode:",r),r}return fe.debug("No configured netMode, detecting from content"),g5(t)},g5=t=>{const e=t||{},n=Array.isArray(e.transitions)?e.transitions:[],r=Array.isArray(e.arcs)?e.arcs:[],i=Array.isArray(e.places)?e.places:[];fe.debug("Net mode detection:",{places:i,transitions:n,arcs:r});for(const s of n){if(typeof s.guard=="string"&&s.guard.trim().length>0)return fe.debug("Found guard, using algebraic mode"),"algebraic";if(typeof s.action=="string"&&s.action.trim().length>0)return fe.debug("Found action, using algebraic mode"),"algebraic"}for(const s of r){const l=Array.isArray(s.bindings)?s.bindings:s.binding?[s.binding]:[];if(fe.debug("Checking arc bindings:",l),l.some(u=>typeof u=="string"&&(/:[ ]*(integer|boolean)/i.test(u)||u==="T"||u==="F"||/[+\-*/()]/.test(u))))return fe.debug("Found algebraic binding, using algebraic mode"),"algebraic"}return i.some(s=>Array.isArray(s.valueTokens)&&s.valueTokens.length>0)?(fe.debug("Found valueTokens, using algebraic mode"),"algebraic"):(fe.debug("Using P/T mode"),"pt")};class Ew{constructor(){this.currentSimulator=null,this._ready=!1,this.netMode=null,this.eventBus=null,this.pendingListeners=new Map}async initialize(e,n={}){try{fe.debug("SimulatorCore.initialize called with:",{petriNet:e,options:n});const r=jy(e,n);return this.currentSimulator=ww.createSimulator(r),this.netMode=r,this.eventBus&&this.currentSimulator.setEventBus(this.eventBus),await this.currentSimulator.initialize(e,n),this._ready=!0,this.setupPendingListeners(),fe.debug(`Simulator initialized with ${r} simulator`),{success:!0,netMode:r,simulatorType:this.currentSimulator.getType()}}catch(r){throw console.error("Failed to initialize simulator:",r),this._ready=!1,this.currentSimulator=null,r}}async update(e){if(!this.currentSimulator)return{success:!0};try{return await this.currentSimulator.update(e),{success:!0}}catch(n){throw console.error("Failed to update simulator:",n),n}}async getEnabledTransitions(){if(!this.currentSimulator)return[];try{return await this.currentSimulator.getEnabledTransitions()}catch(e){return console.error("Failed to get enabled transitions:",e),[]}}async fireTransition(e){if(!this.currentSimulator)throw new Error("Simulator not initialized");try{return await this.currentSimulator.fireTransition(e)}catch(n){throw console.error(`Failed to fire transition ${e}:`,n),n}}async stepSimulation(){if(!this.currentSimulator)throw new Error("Simulator not initialized");try{const e=await this.currentSimulator.getEnabledTransitions();if(!e||e.length===0)return this.currentSimulator.petriNet||null;const n=e[Math.floor(Math.random()*e.length)],r=typeof n=="string"?n:n&&n.id?n.id:String(n);return await this.currentSimulator.fireTransition(r)}catch(e){throw console.error("Failed to step simulation:",e),e}}async runToCompletion({mode:e="single",maxSteps:n=1e5,timeBudgetMs:r=3e4,yieldEvery:i=100,onProgress:s,shouldCancel:l,batchMax:c=0,progressEveryMs:u=0,yieldEveryMs:f=0}={}){if(!this.currentSimulator)throw new Error("Simulator not initialized");const p=this.currentSimulator.eventBus||null;try{this.currentSimulator.setEventBus&&this.currentSimulator.setEventBus(null)}catch{}try{return this.currentSimulator.setSimulationMode&&(this.currentSimulator.simulationMode=e),await Cw({simulator:this.currentSimulator,mode:e,maxSteps:n,timeBudgetMs:r,yieldEvery:i,onProgress:s,shouldCancel:l,batchMax:c,progressEveryMs:u,yieldEveryMs:f})}finally{try{this.currentSimulator.setEventBus&&this.currentSimulator.setEventBus(p)}catch{}}}reset(){this.currentSimulator&&this.currentSimulator.reset(),this.currentSimulator=null,this._ready=!1,this.netMode=null,this.pendingListeners.clear()}deactivateSimulation(){this._active=!1}activateSimulation(e=!1){if(!this.currentSimulator)throw new Error("Simulator not initialized");fe.debug(`Simulation activated (continuous: ${e})`)}async isReady(){return this._ready&&this.currentSimulator&&this.currentSimulator.isReady()}getSimulatorStatus(){var e;return{isReady:this._ready,netMode:this.netMode,simulatorType:((e=this.currentSimulator)==null?void 0:e.getType())||"none",simulatorStatus:{simulator:this.currentSimulator}}}getSimulatorType(){var e;return((e=this.currentSimulator)==null?void 0:e.getType())||"none"}getSimulationMode(){var e;return((e=this.currentSimulator)==null?void 0:e.simulationMode)||"single"}setSimulationMode(e){this.currentSimulator&&(this.currentSimulator.simulationMode=e)}setEventBus(e){this.eventBus=e,this.currentSimulator&&this.currentSimulator.setEventBus(e)}__queueListener(e,n){this.pendingListeners.has(e)||this.pendingListeners.set(e,[]),this.pendingListeners.get(e).push(n)}setupPendingListeners(){if(!(!this.currentSimulator||!this.eventBus)){for(const[e,n]of this.pendingListeners)for(const r of n)this.eventBus.on(e,r);this.pendingListeners.clear()}}determineNetMode(e,n){return jy(e,n)}detectNetModeFromContent(e){return g5(e)}}const fi=new Ew;function Tw(){try{return typeof window>"u"||typeof Worker>"u"||typeof process<"u"&&process.env&&{}.JEST_WORKER_ID?null:new Function('return new Worker(new URL("../workers/simulation.worker.js", import.meta.url), { type: "module" })')()||null}catch{try{return new Worker("/src/workers/simulation.worker.js",{type:"module"})||null}catch{return null}}}var bw="Expected a function",Dy=0/0,Pw="[object Symbol]",Nw=/^\s+|\s+$/g,Aw=/^[-+]0x[0-9a-f]+$/i,Mw=/^0b[01]+$/i,Rw=/^0o[0-7]+$/i,Iw=parseInt,Lw=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Fw=typeof self=="object"&&self&&self.Object===Object&&self,Ow=Lw||Fw||Function("return this")(),jw=Object.prototype,Dw=jw.toString,zw=Math.max,Bw=Math.min,Ih=function(){return Ow.Date.now()};function Uw(t,e,n){var r,i,s,l,c,u,f=0,p=!1,m=!1,x=!0;if(typeof t!="function")throw new TypeError(bw);e=zy(e)||0,Q0(n)&&(p=!!n.leading,m="maxWait"in n,s=m?zw(zy(n.maxWait)||0,e):s,x="trailing"in n?!!n.trailing:x);function v(P){var I=r,A=i;return r=i=void 0,f=P,l=t.apply(A,I),l}function w(P){return f=P,c=setTimeout(S,e),p?v(P):l}function T(P){var I=P-u,A=P-f,F=e-I;return m?Bw(F,s-A):F}function k(P){var I=P-u,A=P-f;return u===void 0||I>=e||I<0||m&&A>=s}function S(){var P=Ih();if(k(P))return C(P);c=setTimeout(S,T(P))}function C(P){return c=void 0,x&&r?v(P):(r=i=void 0,l)}function h(){c!==void 0&&clearTimeout(c),f=0,r=u=i=c=void 0}function _(){return c===void 0?l:C(Ih())}function E(){var P=Ih(),I=k(P);if(r=arguments,i=this,u=P,I){if(c===void 0)return w(u);if(m)return c=setTimeout(S,e),v(u)}return c===void 0&&(c=setTimeout(S,e)),l}return E.cancel=h,E.flush=_,E}function Q0(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Gw(t){return!!t&&typeof t=="object"}function Vw(t){return typeof t=="symbol"||Gw(t)&&Dw.call(t)==Pw}function zy(t){if(typeof t=="number")return t;if(Vw(t))return Dy;if(Q0(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Q0(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(Nw,"");var n=Mw.test(t);return n||Rw.test(t)?Iw(t.slice(2),n?2:8):Aw.test(t)?Dy:+t}var Ww=Uw;const $w=nl(Ww),Hw=({elements:t,netMode:e,simulatorCore:n,setElements:r,updateHistory:i,setEnabledTransitionIds:s,setIsSimulatorReady:l,setSimulationError:c,latestElementsRef:u,forceResetCounter:f})=>{B.useEffect(()=>{u.current=t},[t,u]),B.useEffect(()=>{try{n.setEventBus(ca)}catch{}},[n]),B.useEffect(()=>{(async()=>{var w,T;if(!(t&&t.places&&t.transitions&&t.arcs&&t.places.length>0&&t.transitions.length>0&&t.arcs.length>0)){try{await((w=n.deactivateSimulation)==null?void 0:w.call(n)),await((T=n.reset)==null?void 0:T.call(n)),s([]),l(!1),c(null)}catch(k){fe.error("Failed to reset simulator:",k)}return}try{fe.debug("Simulator force reset counter:",f),fe.debug("Initializing/updating simulator",{elements:t,netMode:e}),await n.initialize(t,{netMode:e})}catch(k){fe.error("Failed to initialize simulator:",k),s([]),l(!1);return}try{await n.update(u.current)}catch(k){fe.error("Failed to update simulator:",k),s([]),l(!1),c("Failed to update simulator");return}try{if(n.isReady&&await n.isReady()){const k=await n.getEnabledTransitions();s(k||[]),l(k&&k.length>0)}else{const k=Q9(u.current),S=(k==null?void 0:k.enabledTransitions)||[];s(S),l(S.length>0)}c(k=>k==="Failed to update simulator"?null:k)}catch(k){fe.error("Failed to compute enabled transitions:",k),s([]),l(!1),c("Failed to update simulator")}})()},[t,e,n,f,s,l,c,u]),B.useEffect(()=>{const x=w=>{s(w.enabled||[]),l(w.hasEnabled);try{typeof window<"u"&&(window.__ENABLED_TRANSITIONS__=Array.isArray(w.enabled)?w.enabled:[])}catch{}},v=w=>{try{typeof window<"u"&&(window.__LAST_FIRED_TRANSITION_ID__=w.transitionId||null)}catch{}w.newPetriNet&&(r(w.newPetriNet),u.current=w.newPetriNet,i&&i(w.newPetriNet,!0))};return ca.on(no.transitionsChanged,x),ca.on(no.transitionFired,v),()=>{ca.off(no.transitionsChanged,x),ca.off(no.transitionFired,v)}},[r,i,s,l,u]),B.useEffect(()=>()=>{try{n.deactivateSimulation()}catch{}},[n]);const p=B.useCallback(async()=>{try{if(n.isReady&&await n.isReady()){const x=await n.getEnabledTransitions();s(x||[]);const v=Array.isArray(x)&&x.length>0;return l(v),x||[]}return s([]),l(!1),[]}catch(x){return console.error("Error refreshing enabled transitions:",x),c("Failed to refresh enabled transitions"),[]}},[n,s,l,c]),m=B.useMemo(()=>$w(p,100),[p]);return B.useEffect(()=>()=>{m.cancel()},[m]),{refreshEnabledTransitions:p,debouncedRefresh:m}};class Xw{constructor(){this.conflictCache=new Map}areTransitionsInConflict(e,n,r,i){const s=`${e}-${n}`,l=`${n}-${e}`;if(this.conflictCache.has(s))return this.conflictCache.get(s);if(this.conflictCache.has(l))return this.conflictCache.get(l);const c=this._requiredCategories(e,i),u=this._requiredCategories(n,i);let f=!1;for(const[p,m]of c.entries()){const x=u.get(p);if(x&&(m.has("int")&&x.has("int")||m.has("bool")&&x.has("bool"))){f=!0;break}}return this.conflictCache.set(s,f),f}_requiredCategories(e,n){const r=new Map;for(const i of n){const s=i.sourceId||i.source;if(!((i.targetId||i.target)===e&&(i.sourceType==="place"||i.type==="place-to-transition")))continue;const c=Array.isArray(i.bindings)?i.bindings:i.binding?[i.binding]:[];r.has(s)||r.set(s,new Set);const u=r.get(s);for(const f of c){const p=String(f||"");/:[ ]*boolean/i.test(p)||p==="T"||p==="F"?u.add("bool"):u.add("int")}c.length===0&&u.add("int")}return r}findNonConflictingTransitions(e,n,r){if(e.length<=1)return e;this.conflictCache.clear();const i=[];for(let s=e.length;s>=1;s--){const l=this.getCombinations(e,s);for(const c of l)this.isNonConflictingSet(c,n,r)&&i.push(c);if(i.length>0)return i}return e.map(s=>[s])}isNonConflictingSet(e,n,r){for(let i=0;i<e.length;i++)for(let s=i+1;s<e.length;s++)if(this.areTransitionsInConflict(e[i].id,e[s].id,n,r))return!1;return!0}getCombinations(e,n){if(n===0)return[[]];if(n>e.length)return[];const r=[],i=(s,l)=>{if(l.length===n){r.push([...l]);return}for(let c=s;c<e.length;c++)l.push(e[c]),i(c+1,l),l.pop()};return i(0,[]),r}getInputPlaces(e,n,r){const i=[];for(const s of r){const l=s.sourceId||s.source,c=s.targetId||s.target;if(s.sourceType==="place"&&c===e||s.type==="place-to-transition"&&c===e){const f=n.find(p=>p.id===l);f&&i.push(f)}}return i}getOutputPlaces(e,n,r){const i=[];for(const s of r){const l=s.sourceId||s.source,c=s.targetId||s.target;if(s.targetType==="place"&&l===e||s.type==="transition-to-place"&&l===e){const f=n.find(p=>p.id===c);f&&i.push(f)}}return i}clearCache(){this.conflictCache.clear()}getCacheStats(){return{size:this.conflictCache.size,keys:Array.from(this.conflictCache.keys())}}}const Yw=1e3,kc=t=>(t||[]).map(e=>typeof e=="string"?e:e&&typeof e=="object"?e.id??(e.get?e.get("id"):void 0):String(e)).filter(Boolean),m5=t=>(t.current||(t.current=new Xw),t.current),Kw=({simulatorCore:t,setElements:e,updateHistory:n,clearError:r,refreshEnabledTransitions:i,setSimulationError:s,latestElementsRef:l})=>async c=>{try{if(t.getSimulatorType&&t.getSimulatorType()==="none")throw new Error("Simulator not initialized. Please wait for initialization to complete.");await t.activateSimulation(!1);const u=await t.fireTransition(c);if(!u||typeof u!="object")throw new Error("Invalid Petri net returned from simulator");if(!u.places||!Array.isArray(u.places)||!u.transitions||!Array.isArray(u.transitions)||!u.arcs||!Array.isArray(u.arcs))throw new Error("Incomplete Petri net structure returned from simulator");const f=JSON.parse(JSON.stringify(u));e(f),l.current=f,n&&n(f,!0),r(),await i(),setTimeout(()=>{try{t.activateSimulation()}catch{}},50)}catch(u){console.error(`Error firing transition ${c}:`,u),s(u.message||`Failed to fire transition ${c}.`)}},Qw=({simulatorCore:t,handleFireTransition:e,conflictResolverRef:n,latestElementsRef:r,refreshEnabledTransitions:i,setSimulationError:s,stopAllSimulations:l})=>async()=>{var c,u;try{if(t.getSimulatorType&&t.getSimulatorType()==="none")throw new Error("Simulator not initialized. Please wait for initialization to complete.");let f="single";try{f=t.getSimulationMode?t.getSimulationMode():"single"}catch{}if(f==="maximal"){const v=await t.getEnabledTransitions();if(!v||v.length===0)return;const w=m5(n),T=kc(v).map(_=>({id:_})),k=w.findNonConflictingTransitions(T,((c=r.current)==null?void 0:c.places)||[],((u=r.current)==null?void 0:u.arcs)||[]),S=Array.isArray(k)?k:Array.from(k||[]),C=S.length?S[Math.floor(Math.random()*S.length)]:[],h=Array.isArray(C)?C:C?[C]:[];for(const _ of h)await e(_.id);await i();return}const p=await t.getEnabledTransitions();if(!p||p.length===0)return;const m=kc(p),x=m[Math.floor(Math.random()*m.length)];await e(x)}catch(f){console.error("Error in step simulation:",f),s("Error during simulation step: "+(f.message||"Unknown error")),l()}},Zw=t=>new Promise(e=>setTimeout(e,t)),qw=({simulatorCore:t,isContinuousSimulatingRef:e,isRunningRef:n,setIsContinuousSimulating:r,setEnabledTransitionIds:i,stepSimulation:s,refreshEnabledTransitions:l,setSimulationError:c})=>async()=>{if(!(e.current||n.current))try{await t.activateSimulation();const u=await t.getEnabledTransitions();if(!u||u.length===0)return;r(!0),e.current=!0;const f=kc(u);for(i(f);e.current;){await s();const p=await l();if(!p||p.length===0)break;await Zw(Yw)}}catch(u){console.error("Error starting continuous simulation:",u),c("Failed to start continuous simulation")}finally{e.current=!1,r(!1);try{t.deactivateSimulation()}catch{}}},Jw=(t,e)=>{const n=Number(t);return!Number.isFinite(n)||n<=0?null:Math.max(1,Math.min(e,Math.floor(n)))},e7=()=>{try{const t=window.__Z3_SETTINGS__||{};return{poolSize:Number.isFinite(Number(t.poolSize))?Number(t.poolSize):0,idleTimeoutMs:t.idleTimeoutMs,prewarmOnAlgebraicMode:t.prewarmOnAlgebraicMode,solverTimeoutMs:t.solverTimeoutMs}}catch{return{poolSize:0}}},t7=({simulationSettings:t})=>{let e=!1;try{e=!!window.__PETRI_NET_NON_VISUAL_RUN__}catch{}const n=typeof window<"u"&&window.__PETRI_NET_SETTINGS__?window.__PETRI_NET_SETTINGS__:{};!e&&(t!=null&&t.useNonVisualRun)&&(e=!0);const r=t==null?void 0:t.batchMode,i=r!==void 0?!!r:!!(n!=null&&n.batchMode);i&&(e=!0);const s=!!((t==null?void 0:t.limitIterations)??(n==null?void 0:n.limitIterations)),l=Jw((t==null?void 0:t.maxIterations)??(n==null?void 0:n.maxIterations),1e6);return{useNonVisual:e,batchMode:i,limitIterationsFlag:s,maxIterations:l}},n7=({simulatorCore:t,isContinuousSimulatingRef:e,isRunningRef:n,setIsRunning:r,setIsContinuousSimulating:i,refreshEnabledTransitions:s,simulationSettings:l,ensureWorker:c,setElements:u,latestElementsRef:f,updateHistory:p,setSimulationError:m,conflictResolverRef:x,elements:v,handleFireTransition:w,setCompletionStats:T,netMode:k})=>async()=>{if(!(e.current||n.current))try{await t.activateSimulation(!1),r(!0),i(!1),n.current=!0,await s();const{useNonVisual:S,batchMode:C,limitIterationsFlag:h,maxIterations:_}=t7({simulationSettings:l}),E=2e5,P=h?_??E:E;let I=null,A=!1;const F=async z=>{try{if(I||(I=e7()),Number(I.poolSize||0)>=z)return;(await Ei(()=>Promise.resolve().then(()=>Sc),void 0,import.meta.url)).setZ3WorkerConfig({...I,poolSize:z}),A=!0}catch{}},N=async()=>{if(A){try{(await Ei(()=>Promise.resolve().then(()=>Sc),void 0,import.meta.url)).setZ3WorkerConfig(I||{})}catch{}A=!1}};let R=!1;if(C){await F(8);const z=await c();if(z)try{let G="single";try{G=t.getSimulationMode?t.getSimulationMode():"single"}catch{}const Y=async O=>{const{op:W,payload:X}=O.data||{};if(W==="done"){z.removeEventListener("message",Y),X&&X.elements&&typeof X.elements=="object"&&(u(X.elements),f.current=X.elements,p&&p(X.elements,!0)),await N(),await s(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}X!=null&&X.stats&&T({elapsedMs:X.stats.elapsedMs,transitionsFired:X.stats.steps?X.stats.steps.toLocaleString():"0"})}else W==="error"&&(z.removeEventListener("message",Y),m((X==null?void 0:X.message)||"Worker error"),await N(),n.current=!1,r(!1))};z.addEventListener("message",Y),z.postMessage({op:"start",payload:{elements:f.current,simOptions:{netMode:k},run:{mode:G,batchMax:0,maxSteps:P,timeBudgetMs:0,yieldEvery:5e3,progressEveryMs:0,yieldEveryMs:0},z3:typeof window<"u"?window.__Z3_SETTINGS__||{}:{}}}),R=!0}catch(G){console.error("Worker run failed, falling back to in-thread run:",G),await N()}}if(R)return;if(S&&typeof t.runToCompletion=="function"){let z="single";try{z=t.getSimulationMode?t.getSimulationMode():"single"}catch{}const G=()=>{try{return!!window.__PETRI_NET_CANCEL_RUN__}catch{return!1}},Y=performance.now?performance.now():Date.now();try{const O=await t.runToCompletion({mode:z,maxSteps:P,timeBudgetMs:0,yieldEvery:5e3,progressEveryMs:0,yieldEveryMs:0,onProgress:()=>{},shouldCancel:G,batchMax:0}),W=performance.now?performance.now():Date.now(),X=Math.round(W-Y);O&&O.petriNet&&typeof O.petriNet=="object"&&(u(O.petriNet),f.current=O.petriNet,p&&p(O.petriNet,!0)),T({elapsedMs:X,transitionsFired:O!=null&&O.steps?O.steps.toLocaleString():"0"})}finally{await N(),await s(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}}return}let D=P;const V=m5(x),j=async()=>{if(!n.current){r(!1);return}if(D<=0){n.current=!1,r(!1);return}try{const z=await t.getEnabledTransitions();if(!z||z.length===0){n.current=!1,r(!1);return}const G=kc(z).map(ee=>({id:ee})),Y=V.findNonConflictingTransitions(G,v.places||[],v.arcs||[]),O=Array.isArray(Y)?Y:Array.from(Y||[]),W=O.length?O[Math.floor(Math.random()*O.length)]:[],X=Array.isArray(W)?W:W?[W]:[];for(const ee of X){if(D<=0)break;await w(ee.id),D-=1}if(D<=0){n.current=!1,r(!1);return}setTimeout(j,50)}catch(z){console.error("Error in run simulation:",z),m(z.message||"Error during simulation run"),n.current=!1,r(!1)}};j()}catch(S){console.error("Error starting run simulation:",S),m("Failed to start run simulation")}},r7=(t,e,n,r,i={},s)=>{const[l,c]=B.useState(!1),[u,f]=B.useState(!1),[p,m]=B.useState([]),[x,v]=B.useState(null),[w,T]=B.useState(!1),[k,S]=B.useState(0),[C,h]=B.useState(null),_=B.useRef(!1),E=B.useRef(!1),P=B.useRef(t),I=B.useRef(null),A=B.useRef(null),F=s||fi,N=B.useCallback(async()=>{if(A.current)return A.current;try{const ee=Tw();return A.current=ee,ee}catch(ee){return console.error("Failed to create simulation worker:",ee),null}},[]),{refreshEnabledTransitions:R,debouncedRefresh:D}=Hw({elements:t,netMode:r,simulatorCore:F,setElements:e,updateHistory:n,setEnabledTransitionIds:m,setIsSimulatorReady:T,setSimulationError:v,latestElementsRef:P,forceResetCounter:k});B.useEffect(()=>{P.current=t},[t]);const V=B.useCallback(()=>{v(null)},[]),j=B.useCallback(()=>{fe.debug("Forcing simulator reset"),S(ee=>ee+1)},[]),z=B.useCallback(()=>{var ee,J;c(!1),f(!1),_.current=!1,E.current=!1;try{F.deactivateSimulation()}catch{}V(),m([]);try{(J=(ee=A.current)==null?void 0:ee.postMessage)==null||J.call(ee,{op:"cancel"})}catch{}},[V,F]);B.useEffect(()=>{l||u?(F.activateSimulation(),R()):(F.deactivateSimulation(),R())},[l,u,R]),B.useEffect(()=>((u||l)&&D(),()=>D.cancel()),[u,l,D]);const G=B.useMemo(()=>Kw({simulatorCore:F,setElements:e,updateHistory:n,clearError:V,refreshEnabledTransitions:R,setSimulationError:v,latestElementsRef:P}),[F,e,n,V,R,v]),Y=B.useMemo(()=>Qw({simulatorCore:F,handleFireTransition:G,conflictResolverRef:I,latestElementsRef:P,refreshEnabledTransitions:R,setSimulationError:v,stopAllSimulations:z}),[F,G,I,R,v,z]),O=B.useMemo(()=>qw({simulatorCore:F,isContinuousSimulatingRef:_,isRunningRef:E,setIsContinuousSimulating:c,setEnabledTransitionIds:m,stepSimulation:Y,refreshEnabledTransitions:R,setSimulationError:v}),[F,_,E,c,m,Y,R,v]),W=B.useMemo(()=>n7({simulatorCore:F,isContinuousSimulatingRef:_,isRunningRef:E,setIsRunning:f,setIsContinuousSimulating:c,refreshEnabledTransitions:R,simulationSettings:i,ensureWorker:N,setElements:e,latestElementsRef:P,updateHistory:n,setSimulationError:v,conflictResolverRef:I,elements:t,handleFireTransition:G,setCompletionStats:h,netMode:r}),[F,_,E,f,c,R,i==null?void 0:i.limitIterations,i==null?void 0:i.maxIterations,i==null?void 0:i.batchMode,i==null?void 0:i.useNonVisualRun,N,e,P,n,v,I,t,G,h,r]),X=B.useCallback(()=>{h(null)},[]);return{isContinuousSimulating:l,isRunning:u,enabledTransitionIds:p,simulationError:x,isSimulatorReady:w,handleFireTransition:G,stepSimulation:Y,startContinuousSimulation:O,startRunSimulation:W,stopAllSimulations:z,clearError:V,forceSimulatorReset:j,completionStats:C,dismissCompletionDialog:X}};function i7(t){if(!t||typeof t!="object")return"pt";const e=Array.isArray(t.places)?t.places:[],n=Array.isArray(t.transitions)?t.transitions:[],r=Array.isArray(t.arcs)?t.arcs:[];return e.some(s=>Array.isArray(s.valueTokens)&&s.valueTokens.length>0||!!s.type)||n.some(s=>!!s.guard||!!s.action)||r.some(s=>Array.isArray(s.bindings)&&s.bindings.length>0||!!s.binding)?"algebraic-int":"pt"}function s7(t){const{elements:e,setElements:n,updateHistory:r,simulationSettings:i,setSimulationSettings:s,resetEditor:l,forceSimulatorReset:c,setIsLoading:u,setError:f,setSuccess:p,setIsAdtOpen:m,saveFileHandle:x,setSaveFileHandle:v}=t||{},w=()=>{m&&m(!0)},T=async(_,E)=>{const P=await _.createWritable();await P.write(new Blob([E],{type:"application/xml"})),await P.close()};return{handleSave:async()=>{try{u==null||u(!0),f==null||f(null),p==null||p(null);const _={...e||{},netMode:(i==null?void 0:i.netMode)||"pt"},E=await Ay(_),P="petri-net.pnml";if(typeof window<"u"&&typeof window.showSaveFilePicker=="function")try{if(x)await T(x,E);else{const A=await window.showSaveFilePicker({suggestedName:P,types:[{description:"PNML Files",accept:{"application/xml":[".pnml",".xml"],"text/xml":[".pnml",".xml"]}}],excludeAcceptAllOption:!1});await T(A,E),v==null||v(A)}}catch(A){if(A&&(A.name==="AbortError"||A.name==="SecurityError"))p==null||p("Save cancelled.");else{const F=new Blob([E],{type:"application/xml"}),N=URL.createObjectURL(F),R=document.createElement("a");R.href=N,R.download=P,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(N)}}else{const A=new Blob([E],{type:"application/xml"}),F=URL.createObjectURL(A),N=document.createElement("a");N.href=F,N.download=P,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(F)}p==null||p("Petri net saved.")}catch(_){console.error("Error saving Petri net:",_),f==null||f(`Error saving Petri net: ${_.message}`)}finally{u==null||u(!1)}},handleSaveAs:async()=>{try{u==null||u(!0),f==null||f(null),p==null||p(null);const _={...e||{},netMode:(i==null?void 0:i.netMode)||"pt"},E=await Ay(_),P="petri-net.pnml";if(typeof window<"u"&&typeof window.showSaveFilePicker=="function")try{const A=await window.showSaveFilePicker({suggestedName:P,types:[{description:"PNML Files",accept:{"application/xml":[".pnml",".xml"],"text/xml":[".pnml",".xml"]}}],excludeAcceptAllOption:!1});await T(A,E),v==null||v(A)}catch(A){if(A&&(A.name==="AbortError"||A.name==="SecurityError"))p==null||p("Save cancelled.");else{const F=new Blob([E],{type:"application/xml"}),N=URL.createObjectURL(F),R=document.createElement("a");R.href=N,R.download=P,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(N)}}else{const A=new Blob([E],{type:"application/xml"}),F=URL.createObjectURL(A),N=document.createElement("a");N.href=F,N.download=P,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(F)}p==null||p("Petri net saved.")}catch(_){console.error("Error saving Petri net:",_),f==null||f(`Error saving Petri net: ${_.message}`)}finally{u==null||u(!1)}},handleLoad:()=>{const _=document.createElement("input");_.type="file",_.accept=".pnml,.xml";try{_.style.display="none",document.body.appendChild(_)}catch{}_.onchange=async E=>{const P=E.target.files[0];if(P)try{u==null||u(!0),f==null||f(null),p==null||p(null);const I=await new Promise((j,z)=>{const G=new FileReader;G.onload=Y=>j(Y.target.result),G.onerror=z,G.readAsText(P)});if(!I||String(I).trim()==="")throw new Error("The selected file is empty");if(!String(I).includes("<pnml")&&!String(I).includes("<PNML"))throw new Error("The file does not appear to be a valid PNML file");const A=H9(I),F=new Promise((j,z)=>{setTimeout(()=>z(new Error("Operation timed out. The file may be too large or invalid.")),1e4)}),N=await Promise.race([A,F]);if(!N||typeof N!="object")throw new Error("Invalid data structure in the imported file");const R={places:Array.isArray(N.places)?N.places:[],transitions:Array.isArray(N.transitions)?N.transitions:[],arcs:Array.isArray(N.arcs)?N.arcs:[]},D=(R.arcs||[]).filter(j=>{if(j.source==="undefined"||j.target==="undefined"||!j.source||!j.target)return!1;const z=R.places.some(Y=>Y.id===j.source)||R.transitions.some(Y=>Y.id===j.source),G=R.places.some(Y=>Y.id===j.target)||R.transitions.some(Y=>Y.id===j.target);return z&&G});R.arcs=D.map(j=>{if(!j.type||j.type!=="place-to-transition"&&j.type!=="transition-to-place"){const z=R.places.some(Y=>Y.id===j.source),G=R.places.some(Y=>Y.id===j.target);return z&&!G?{...j,type:"place-to-transition"}:!z&&G?{...j,type:"transition-to-place"}:{...j,type:"place-to-transition"}}return j}),c&&c(),n==null||n(R);const V=R.netMode;if(V)s==null||s(j=>({...j||{},netMode:V}));else try{const j=i7(R);s==null||s(z=>({...z||{},netMode:j}))}catch{}r&&r(R),p==null||p(`Petri net loaded successfully with ${R.places.length} places, ${R.transitions.length} transitions, and ${R.arcs.length} arcs.`)}catch(I){console.error("Error loading Petri net:",I),f==null||f(`Error loading Petri net: ${I.message}`)}finally{u==null||u(!1);try{_&&_.parentNode&&_.parentNode.removeChild(_)}catch{}}},_.click()},handleClear:()=>{var _,E;try{(_=fi.deactivateSimulation)==null||_.call(fi),(E=fi.reset)==null||E.call(fi)}catch{}if(l)l();else{const P={places:[],transitions:[],arcs:[]};n==null||n(P),s==null||s(I=>({...I||{},netMode:"pt"})),r&&r(P)}p==null||p("Canvas cleared successfully.")},handleOpenAdtManager:w}}const At=[];for(let t=0;t<256;++t)At.push((t+256).toString(16).slice(1));function o7(t,e=0){return(At[t[e+0]]+At[t[e+1]]+At[t[e+2]]+At[t[e+3]]+"-"+At[t[e+4]]+At[t[e+5]]+"-"+At[t[e+6]]+At[t[e+7]]+"-"+At[t[e+8]]+At[t[e+9]]+"-"+At[t[e+10]]+At[t[e+11]]+At[t[e+12]]+At[t[e+13]]+At[t[e+14]]+At[t[e+15]]).toLowerCase()}let Lh;const a7=new Uint8Array(16);function l7(){if(!Lh){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Lh=crypto.getRandomValues.bind(crypto)}return Lh(a7)}const u7=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),By={randomUUID:u7};function co(t,e,n){var i;if(By.randomUUID&&!e&&!t)return By.randomUUID();t=t||{};const r=t.random??((i=t.rng)==null?void 0:i.call(t))??l7();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){if(n=n||0,n<0||n+16>e.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let s=0;s<16;++s)e[n+s]=r[s];return e}return o7(r)}function y5(t,e){const n=new Set((e||[]).filter(l=>l.type==="place"||l.type==="transition").map(l=>l.id)),r=(t.places||[]).filter(l=>n.has(l.id)),i=(t.transitions||[]).filter(l=>n.has(l.id)),s=(t.arcs||[]).filter(l=>n.has(l.source)&&n.has(l.target));return{places:r,transitions:i,arcs:s}}function v5(t,e,n){if(!t)return null;const r=new Map,i=n&&typeof n.x=="number"?n.x:(n==null?void 0:n.dx)||0,s=n&&typeof n.y=="number"?n.y:(n==null?void 0:n.dy)||0,l=[],c=(t.places||[]).map(p=>{const m=e();r.set(p.id,m);const x=typeof p.x=="number"&&isFinite(p.x)?p.x:0,v=typeof p.y=="number"&&isFinite(p.y)?p.y:0,w={...p,id:m,x:x+i,y:v+s};return l.push({id:m,type:"place"}),w}),u=(t.transitions||[]).map(p=>{const m=e();r.set(p.id,m);const x=typeof p.x=="number"&&isFinite(p.x)?p.x:0,v=typeof p.y=="number"&&isFinite(p.y)?p.y:0,w={...p,id:m,x:x+i,y:v+s};return l.push({id:m,type:"transition"}),w}),f=(t.arcs||[]).map(p=>({...p,id:e(),source:r.get(p.source),target:r.get(p.target)}));return{newPlaces:c,newTransitions:u,newArcs:f,newSelection:l}}function c7(t,e){const n=new Set(Array.isArray(e)?e.map(i=>typeof i=="string"?i:i.id):[]),r={...t};return r.places=(t.places||[]).filter(i=>!n.has(i.id)),r.transitions=(t.transitions||[]).filter(i=>!n.has(i.id)),r.arcs=(t.arcs||[]).filter(i=>!n.has(i.source)&&!n.has(i.target)),r}function x5(t){const{elements:e,setElements:n,selectedElement:r,selectedElements:i,clearSelection:s,setSelection:l,clipboardRef:c,netMode:u,setClipboard:f,getClipboard:p,onClipboardMismatch:m,handleUndo:x,handleRedo:v,setMode:w,arcStart:T,setArcStart:k,setTempArcEnd:S,setSelectedElement:C}=t;B.useEffect(()=>{const h=E=>{const I=navigator.platform.toUpperCase().includes("MAC")?E.metaKey:E.ctrlKey;E.key==="Shift"&&t.isShiftPressedRef&&(t.isShiftPressedRef.current=!0);const A=E.target,F=A==null?void 0:A.tagName,N=F==="INPUT"||F==="TEXTAREA"||(A==null?void 0:A.isContentEditable);if(!N&&(E.key==="Delete"||E.key==="Backspace")){if(i.length===0&&!r)return;E.preventDefault(),n(R=>{const D=[],V=new Set;i.length>0?i.forEach(z=>{(z.type==="place"||z.type==="transition")&&D.push(z.id),z.type==="arc"&&V.add(z.id)}):r&&((r.type==="place"||r.type==="transition")&&D.push(r.id),r.type==="arc"&&V.add(r.id));let j=R;return D.length>0&&(j=c7(j,D)),V.size>0&&(j={...j,arcs:j.arcs.filter(z=>!V.has(z.id))}),j}),s();return}if(!N&&I&&(E.key==="a"||E.key==="A")){E.preventDefault();const R=[...e.places.map(D=>({id:D.id,type:"place"})),...e.transitions.map(D=>({id:D.id,type:"transition"})),...e.arcs.map(D=>({id:D.id,type:"arc"}))];l(R);return}if(!N&&I&&(E.key==="z"||E.key==="Z")&&typeof x=="function"){E.preventDefault(),x();return}if(!N&&I&&(E.key==="y"||E.key==="Y")&&typeof v=="function"){E.preventDefault(),v();return}if(!N&&!I){if((E.key==="p"||E.key==="P")&&typeof w=="function"){E.preventDefault(),w("place");return}if((E.key==="t"||E.key==="T")&&typeof w=="function"){E.preventDefault(),w("transition");return}if((E.key==="a"||E.key==="A")&&typeof w=="function"){E.preventDefault(),w("arc");return}if((E.key==="s"||E.key==="S")&&typeof w=="function"){E.preventDefault(),w("select");return}if(E.key==="Escape"){E.preventDefault(),typeof w=="function"&&w("select"),typeof k=="function"&&T&&k(null),typeof S=="function"&&S(null),typeof C=="function"&&C(null);return}}if(!N&&I&&(E.key==="c"||E.key==="C")){if(i.length===0)return;E.preventDefault();const R=y5(e,i),D=u||"pt";typeof f=="function"?f(R):c&&(c.current={payload:R,netMode:D,source:"local",timestamp:Date.now()});return}if(!N&&I&&(E.key==="v"||E.key==="V")){const R=u||"pt",D=typeof p=="function"?p():c==null?void 0:c.current;if(!D)return;const V=D.payload||D;if(!V)return;const j=D.netMode||R;if(j&&R&&j!==R){typeof m=="function"?m(j,R,D):console.warn(`Blocked paste: shared clipboard contains ${j} net, editor mode is ${R}.`);return}E.preventDefault();const{newPlaces:z,newTransitions:G,newArcs:Y,newSelection:O}=v5(V,co,{x:40,y:40});n(W=>({...W,places:[...W.places,...z],transitions:[...W.transitions,...G],arcs:[...W.arcs,...Y]})),l(O);return}},_=E=>{E.key==="Shift"&&t.isShiftPressedRef&&(t.isShiftPressedRef.current=!1)};return document.addEventListener("keydown",h),document.addEventListener("keyup",_),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",_)}},[e,i,r,n,s,l,c,t,x,v,w,T,k,S,C])}function d7(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var w5=d7,f7=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,h7=f7,p7=h7,g7=typeof self=="object"&&self&&self.Object===Object&&self,m7=p7||g7||Function("return this")(),_5=m7,y7=_5,v7=function(){return y7.Date.now()},x7=v7,w7=/\s/;function _7(t){for(var e=t.length;e--&&w7.test(t.charAt(e)););return e}var S7=_7,k7=S7,C7=/^\s+/;function E7(t){return t&&t.slice(0,k7(t)+1).replace(C7,"")}var T7=E7,b7=_5,P7=b7.Symbol,S5=P7,Uy=S5,k5=Object.prototype,N7=k5.hasOwnProperty,A7=k5.toString,da=Uy?Uy.toStringTag:void 0;function M7(t){var e=N7.call(t,da),n=t[da];try{t[da]=void 0;var r=!0}catch{}var i=A7.call(t);return r&&(e?t[da]=n:delete t[da]),i}var R7=M7,I7=Object.prototype,L7=I7.toString;function F7(t){return L7.call(t)}var O7=F7,Gy=S5,j7=R7,D7=O7,z7="[object Null]",B7="[object Undefined]",Vy=Gy?Gy.toStringTag:void 0;function U7(t){return t==null?t===void 0?B7:z7:Vy&&Vy in Object(t)?j7(t):D7(t)}var G7=U7;function V7(t){return t!=null&&typeof t=="object"}var W7=V7,$7=G7,H7=W7,X7="[object Symbol]";function Y7(t){return typeof t=="symbol"||H7(t)&&$7(t)==X7}var K7=Y7,Q7=T7,Wy=w5,Z7=K7,$y=0/0,q7=/^[-+]0x[0-9a-f]+$/i,J7=/^0b[01]+$/i,e_=/^0o[0-7]+$/i,t_=parseInt;function n_(t){if(typeof t=="number")return t;if(Z7(t))return $y;if(Wy(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Wy(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Q7(t);var n=J7.test(t);return n||e_.test(t)?t_(t.slice(2),n?2:8):q7.test(t)?$y:+t}var r_=n_,i_=w5,Fh=x7,Hy=r_,s_="Expected a function",o_=Math.max,a_=Math.min;function l_(t,e,n){var r,i,s,l,c,u,f=0,p=!1,m=!1,x=!0;if(typeof t!="function")throw new TypeError(s_);e=Hy(e)||0,i_(n)&&(p=!!n.leading,m="maxWait"in n,s=m?o_(Hy(n.maxWait)||0,e):s,x="trailing"in n?!!n.trailing:x);function v(P){var I=r,A=i;return r=i=void 0,f=P,l=t.apply(A,I),l}function w(P){return f=P,c=setTimeout(S,e),p?v(P):l}function T(P){var I=P-u,A=P-f,F=e-I;return m?a_(F,s-A):F}function k(P){var I=P-u,A=P-f;return u===void 0||I>=e||I<0||m&&A>=s}function S(){var P=Fh();if(k(P))return C(P);c=setTimeout(S,T(P))}function C(P){return c=void 0,x&&r?v(P):(r=i=void 0,l)}function h(){c!==void 0&&clearTimeout(c),f=0,r=u=i=c=void 0}function _(){return c===void 0?l:C(Fh())}function E(){var P=Fh(),I=k(P);if(r=arguments,i=this,u=P,I){if(c===void 0)return w(u);if(m)return clearTimeout(c),c=setTimeout(S,e),v(u)}return c===void 0&&(c=setTimeout(S,e)),l}return E.cancel=h,E.flush=_,E}var u_=l_;const c_=nl(u_);function d_(t,e){return!t||!e||!Oh(t.places,e.places,C5)||!Oh(t.transitions,e.transitions,Z0)||!Oh(t.arcs,e.arcs,E5)?!1:(fe.debug("HistoryManager: States are identical"),!0)}function Oh(t=[],e=[],n){if(t.length!==e.length){const i=n===C5?"places":n===Z0?"transitions":"arcs";return fe.debug(`HistoryManager: States differ in number of ${i}`),!1}const r=new Map;e.forEach(i=>r.set(i.id,i));for(const i of t){const s=r.get(i.id);if(!s)return fe.debug(`HistoryManager: ${n===E5?"Arc":n===Z0?"Transition":"Place"} ${i.id} not found in second state`),!1;if(!n(i,s))return!1}return!0}function C5(t,e){const n=JSON.stringify(t.valueTokens||[])===JSON.stringify(e.valueTokens||[]),r=t.x===e.x&&t.y===e.y&&t.tokens===e.tokens&&t.label===e.label&&t.name===e.name&&n;return r||fe.debug(`HistoryManager: Place ${t.id} differs - x: ${t.x} vs ${e.x}, y: ${t.y} vs ${e.y}, tokens: ${t.tokens} vs ${e.tokens}, label: ${t.label} vs ${e.label}, name: ${t.name} vs ${e.name}`),r}function Z0(t,e){const n=t.x===e.x&&t.y===e.y&&t.label===e.label&&t.name===e.name&&(t.guard||"")===(e.guard||"");return n||fe.debug(`HistoryManager: Transition ${t.id} differs - x: ${t.x} vs ${e.x}, y: ${t.y} vs ${e.y}, label: ${t.label} vs ${e.label}, name: ${t.name} vs ${e.name}`),n}function E5(t,e){if(!(t.source===e.source&&t.target===e.target&&t.weight===e.weight))return fe.debug(`HistoryManager: Arc ${t.id} differs - source: ${t.source} vs ${e.source}, target: ${t.target} vs ${e.target}, weight: ${t.weight} vs ${e.weight}`),!1;const r=(t.label||"")===(e.label||"")&&(t.sourceType||"")===(e.sourceType||"")&&(t.targetType||"")===(e.targetType||"")&&JSON.stringify(t.bindings||[])===JSON.stringify(e.bindings||[])&&JSON.stringify(t.anglePoints||[])===JSON.stringify(e.anglePoints||[]);return r||fe.debug(`HistoryManager: Arc ${t.id} differs in secondary properties`),r}function $u(t){if(!t||!t.places||!t.transitions||!t.arcs)return{places:[],transitions:[],arcs:[]};const e=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(i=>e(i));const r={};for(const i in n)if(Object.prototype.hasOwnProperty.call(n,i)){const s=n[i];s===null||typeof s!="object"?r[i]=s:Array.isArray(s)?r[i]=[...s]:r[i]={...s}}return r};return{places:t.places.map(e),transitions:t.transitions.map(e),arcs:t.arcs.map(e)}}function jh(t){return!t||!t.places||!t.transitions||!t.arcs?{places:[],transitions:[],arcs:[]}:$u(t)}class Xy{constructor(e){this.states=[$u(e)],this.currentIndex=0,this.maxStates=50}addState(e){const n=$u(e),r=this.states[this.currentIndex];return this.currentIndex>=0&&d_(r,n)?(fe.debug("HistoryManager: State unchanged, not adding to history"),{canUndo:this.canUndo(),canRedo:this.canRedo()}):(fe.debug(`HistoryManager: Adding new state to history. Current index: ${this.currentIndex}, States count: ${this.states.length}`),this.currentIndex<this.states.length-1&&(fe.debug(`HistoryManager: Removing ${this.states.length-this.currentIndex-1} future states`),this.states=this.states.slice(0,this.currentIndex+1)),this.states.push(n),this.currentIndex++,this.states.length>this.maxStates&&(this.states.shift(),this.currentIndex--),fe.debug(`HistoryManager: New state added. Current index: ${this.currentIndex}, States count: ${this.states.length}`),{canUndo:this.canUndo(),canRedo:this.canRedo()})}undo(){if(!this.canUndo())return fe.debug("HistoryManager: Cannot undo - no previous states"),null;this.currentIndex--;const e=this.states[this.currentIndex];return fe.debug(`HistoryManager: Undoing to index ${this.currentIndex}, states count: ${this.states.length}`),{state:jh(e),canUndo:this.canUndo(),canRedo:this.canRedo()}}redo(){if(!this.canRedo())return fe.debug("HistoryManager: Cannot redo - no future states"),null;this.currentIndex++;const e=this.states[this.currentIndex];return fe.debug(`HistoryManager: Redoing to index ${this.currentIndex}, states count: ${this.states.length}`),{state:jh(e),canUndo:this.canUndo(),canRedo:this.canRedo()}}canUndo(){return this.currentIndex>0}canRedo(){return this.currentIndex<this.states.length-1}getCurrentState(){return this.states[this.currentIndex]}deepCopyState(e){return $u(e)}validateState(e){return jh(e)}}const f_="petri-net-shared-clipboard";function h_({clipboardRef:t,netMode:e,instanceId:n,onIncompatibleClipboard:r}){const i=B.useRef(null),s=B.useRef(e||"pt"),l=B.useRef(r||null);B.useEffect(()=>{s.current=e||"pt"},[e]),B.useEffect(()=>{l.current=r||null},[r]),B.useEffect(()=>{if(typeof window>"u"||typeof window.BroadcastChannel!="function")return;const f=new window.BroadcastChannel(f_);i.current=f;const p=m=>{var T;const x=m==null?void 0:m.data;if(!x||x.type!=="PETRI_NET_CLIPBOARD_UPDATE"||x.instanceId===n)return;const v={payload:x.payload,netMode:x.netMode,source:"remote",instanceId:x.instanceId,timestamp:x.timestamp||Date.now()};t&&(t.current=v);const w=s.current;v.netMode&&w&&v.netMode!==w&&((T=l.current)==null||T.call(l,v.netMode,w,v))};return f.addEventListener("message",p),()=>{f.removeEventListener("message",p),i.current=null,f.close()}},[t,n]);const c=B.useCallback(f=>{if(!f)return;const p={payload:f,netMode:s.current,source:"local",instanceId:n,timestamp:Date.now()};t&&(t.current=p);const m=i.current;if(m&&typeof m.postMessage=="function")try{m.postMessage({type:"PETRI_NET_CLIPBOARD_UPDATE",payload:f,netMode:p.netMode,instanceId:n,timestamp:p.timestamp})}catch(x){console.warn("Failed to broadcast clipboard payload:",x)}},[t,n]),u=B.useCallback(()=>t==null?void 0:t.current,[t]);return{setClipboard:c,getClipboard:u}}const T5=B.createContext(),p_=({children:t})=>{const[r,i]=B.useState({width:800,height:600}),[s,l]=B.useState({width:1e4,height:7500}),[c,u]=B.useState({x:0,y:0}),[f,p]=B.useState(1),[m,x]=B.useState(!0),v=20,w=B.useRef(null),[T,k]=B.useState(null),S=B.useRef(null),[C,h]=B.useState(!1),[_,E]=B.useState({visible:!1,position:null,elementType:null}),P=B.useRef("select"),A={stageDimensions:r,setStageDimensions:i,virtualCanvasDimensions:s,setVirtualCanvasDimensions:l,canvasScroll:c,setCanvasScroll:u,zoomLevel:f,setZoomLevel:p,gridSnappingEnabled:m,toggleGridSnapping:()=>{x(F=>!F)},gridSize:v,MIN_ZOOM:.1,MAX_ZOOM:3,appRef:w,containerRef:T,setContainerRef:k,stageRef:S,isDragging:C,setIsDragging:h,snapIndicator:_,setSnapIndicator:E,prevModeRef:P};return M.jsx(T5.Provider,{value:A,children:t})},Po=()=>{const t=B.useContext(T5);if(t===void 0)throw new Error("useEditorUI must be used within an EditorUIProvider");return t};function Yy(t){if(!(t!=null&&t.valueTokens)||t.valueTokens.length===0)return null;const e=Za(t.valueTokens[0]);return t.valueTokens.every(r=>Za(r)===e)?e:null}function ul(t,e,n=!0){if(!n)return console.log("[TypeInference] Disabled, returning original state"),t;if(e!=="algebraic-int"||!(t!=null&&t.places)||!(t!=null&&t.arcs)||!(t!=null&&t.transitions))return console.log("[TypeInference] Skipping - netMode:",e,"hasPlaces:",!!(t!=null&&t.places)),t;console.log("[TypeInference] Starting with overwrite=",n);const r={arcs:[],transitions:[]},i=!!n;t.places.forEach(c=>{const u=Yy(c);u&&t.arcs.filter(p=>p.source===c.id).forEach(p=>{if(p.bindings&&p.bindings.length>0){const m=[];let x=!1;for(const v of p.bindings){if(!v){m.push(v);continue}const w=new Map,T=v.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(T&&T.forEach(S=>{if(S!=="true"&&S!=="false"&&S!=="and"&&S!=="or"&&S!=="not")if(!v.includes(`${S}:`))w.set(S,u);else{const C=v.match(new RegExp(`${S}:(Int|Bool|Pair|String|List)`,"i"));C&&C[1]&&w.set(S,C[1])}}),u==="List"){const S=Array.isArray(c.valueTokens)?c.valueTokens:[];let C=null;if(S.length>0&&Array.isArray(S[0])&&S[0].length>0){const h=Za(S[0][0]);S.every(E=>Array.isArray(E)&&E.every(P=>Za(P)===h))&&(C=h)}if(C)for(const[h,_]of Array.from(w.entries()))_==="List"&&w.set(h,C);else w.clear()}const k=w.size>0?Wu(v,w,null,{overwrite:i}):v;k!==v&&(x=!0),m.push(k)}x&&r.arcs.push({arcId:p.id,newBindings:m})}})});const s=t.arcs.map(c=>{const u=r.arcs.find(f=>f.arcId===c.id);return u?u.newBindings?{...c,bindings:[...u.newBindings]}:{...c,bindings:[u.newBinding]}:c});return t.transitions.forEach(c=>{const u=s.filter(m=>m.target===c.id),f=new Map;if(console.log("[TypeInference] Processing transition:",c.id,"inputArcs:",u.length),u.forEach(m=>{m.bindings&&m.bindings.length>0&&m.bindings.forEach(x=>{if(!x)return;console.log("[TypeInference] Input arc binding:",x);const v=x.match(/\b([a-z][a-zA-Z0-9_]*)\:(Int|Bool|Pair|String|List)\b/gi);v&&v.forEach(T=>{const k=T.match(/\b([a-z][a-zA-Z0-9_]*)\:(Int|Bool|Pair|String|List)\b/i);k&&k[1]&&k[2]&&f.set(k[1],k[2])});const w=x.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(console.log("[TypeInference] All variable matches in binding:",w),w){const T=t.places.find(k=>k.id===m.source);if(T){const k=Yy(T);k&&w.forEach(S=>{S!=="true"&&S!=="false"&&S!=="and"&&S!=="or"&&S!=="not"&&(f.has(S)||f.set(S,k))})}}})}),console.log("[TypeInference] Extracted variable types for",c.id,":",JSON.stringify(Array.from(f.entries()))),c.guard&&f.size>0){const m=c.guard.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(m){const x=new Map;if(m.forEach(v=>{if(v!=="true"&&v!=="false"&&v!=="and"&&v!=="or"&&v!=="not"){const w=f.get(v);if(!w)return;i?x.set(v,w):new RegExp(`\\b${v}\\s*:(Int|Bool|Pair|String|List)\\b`,"i").test(c.guard)||x.set(v,w)}}),console.log("[TypeInference] Guard type map for",c.id,":",Array.from(x.entries())),x.size>0){const v=Wu(c.guard,x,null,{overwrite:i});console.log("[TypeInference] Guard before:",c.guard),console.log("[TypeInference] Guard after:",v),v!==c.guard&&r.transitions.push({transitionId:c.id,newGuard:v})}}}s.filter(m=>m.source===c.id).forEach(m=>{if(m.bindings&&m.bindings.length>0){const x=[];let v=!1;for(const w of m.bindings){if(!w){x.push(w);continue}const T=new Map,k=w.match(/\b[a-z][a-zA-Z0-9_]*\b/g);k&&k.forEach(C=>{if(C!=="true"&&C!=="false"&&C!=="and"&&C!=="or"&&C!=="not"){const h=f.get(C);if(!h)return;i?T.set(C,h):new RegExp(`\\b${C}\\s*:(Int|Bool|Pair|String|List)\\b`,"i").test(w)||T.set(C,h)}});const S=T.size>0?Wu(w,T,null,{overwrite:i}):w;S!==w&&(v=!0),x.push(S)}v&&r.arcs.push({arcId:m.id,newBindings:x})}})}),r.arcs.length===0&&r.transitions.length===0?t:{...t,arcs:t.arcs.map(c=>{const u=r.arcs.find(f=>f.arcId===c.id);return u?u.newBindings?{...c,bindings:[...u.newBindings]}:{...c,bindings:[u.newBinding]}:c}),transitions:t.transitions.map(c=>{const u=r.transitions.find(f=>f.transitionId===c.id);return u?{...c,guard:u.newGuard}:c})}}const sg=B.createContext(),g_=({children:t})=>{const{gridSnappingEnabled:e,gridSize:n,setCanvasScroll:r,setZoomLevel:i}=Po(),[s,l]=B.useState({places:[],transitions:[],arcs:[]}),[c,u]=B.useState(null),[f,p]=B.useState([]),[m,x]=B.useState("select"),[v,w]=B.useState(null),[T,k]=B.useState(null),[S,C]=B.useState(!1),[h,_]=B.useState({maxIterations:2e5,limitIterations:!1,netMode:"pt",useNonVisualRun:!1,batchMode:!1,showInferredTypes:!1}),[E,P]=B.useState({poolSize:1,idleTimeoutMs:3e5,prewarmOnAlgebraicMode:!0,solverTimeoutMs:1e4}),[I,A]=B.useState(null),F=B.useRef(new Xy({places:[],transitions:[],arcs:[]})),[N,R]=B.useState(!1),[D,V]=B.useState(!1),j=B.useRef(c_(xe=>{const Ve=F.current.addState(xe);R(Ve.canUndo),V(Ve.canRedo)},500)),[z,G]=B.useState(!1),Y=B.useRef(m),O=B.useRef(null),W=B.useRef(null),X=B.useRef(co()),ee=B.useRef(!1),J=(h==null?void 0:h.netMode)||"pt",te=B.useRef(!!(h!=null&&h.showInferredTypes)),ae=B.useRef(null),ne=B.useCallback((xe,Ve)=>{console.warn(`Shared clipboard net mode mismatch: received ${xe||"unknown"} while editor is ${Ve||J}. Copy/paste is disabled until both editors use the same mode.`)},[J]),{setClipboard:oe,getClipboard:U}=h_({clipboardRef:W,netMode:J,instanceId:X.current,onIncompatibleClipboard:ne}),q=(xe,Ve=!1)=>{if(Ve){const Jt=F.current.addState(xe);R(Jt.canUndo),V(Jt.canRedo)}else j.current(xe)},{isContinuousSimulating:re,isRunning:pe,enabledTransitionIds:me,simulationError:Ae,isSimulatorReady:Te,handleFireTransition:wt,stepSimulation:Me,startContinuousSimulation:Ft,startRunSimulation:ct,stopAllSimulations:qt,forceSimulatorReset:Yr,completionStats:sr,dismissCompletionDialog:ws}=r7(s,l,q,(h==null?void 0:h.netMode)||"pt",h);B.useEffect(()=>(!z&&Y.current===m&&q(s),Y.current=m,()=>j.current.cancel()),[s,z,m]),B.useEffect(()=>{const xe=!!(h!=null&&h.showInferredTypes),Ve=te.current;if(xe!==Ve){if(te.current=xe,xe&&J==="algebraic-int"){l(Jt=>(ae.current=Jt,ul(Jt,J,!0)));return}!xe&&ae.current&&(l(ae.current),ae.current=null)}},[h==null?void 0:h.showInferredTypes,J,l]);const _s=()=>{if(!N)return;fe.debug("Undoing to previous state...");const xe=F.current.undo();xe&&(fe.debug("Undo result:",xe.state),l(xe.state),R(xe.canUndo),V(xe.canRedo),Yr())},Ss=()=>{if(!D)return;fe.debug("Redoing to next state...");const xe=F.current.redo();xe&&(fe.debug("Redo result:",xe.state),l(xe.state),R(xe.canUndo),V(xe.canRedo),Yr())},or=(xe,Ve)=>e?{x:Math.round(xe/n)*n,y:Math.round(Ve/n)*n}:{x:xe,y:Ve},ks=xe=>{_(xe),C(!1)};B.useEffect(()=>{(async()=>{if(!(typeof window>"u"))try{const{setZ3WorkerConfig:Ve}=await Ei(()=>Promise.resolve().then(()=>Sc),void 0,import.meta.url);Ve(E)}catch{}})()},[E]);const bt=()=>{const xe={places:[],transitions:[],arcs:[]};l(xe),u(null),p([]),x("select"),w(null),k(null),_({maxIterations:2e5,limitIterations:!1,netMode:"pt",useNonVisualRun:!1,batchMode:!1,showInferredTypes:!1}),r({x:0,y:0}),i(1),F.current=new Xy(xe),R(!1),V(!1),fe.debug("Editor completely reset")},Kr=(xe,Ve)=>xe?f.some(Jt=>Jt.id===xe&&Jt.type===Ve):!1,Cs=()=>{u(null),p([])},gl=xe=>{if(p(Array.isArray(xe)?xe:[]),Array.isArray(xe)&&xe.length>0){const Ve=xe[xe.length-1],Jt=Ve.type==="place"?s.places.find(Qr=>Qr.id===Ve.id):Ve.type==="transition"?s.transitions.find(Qr=>Qr.id===Ve.id):s.arcs.find(Qr=>Qr.id===Ve.id);Jt&&u({...Jt,type:Ve.type})}else u(null)};return x5({elements:s,setElements:l,selectedElement:c,selectedElements:f,clearSelection:Cs,setSelection:gl,clipboardRef:W,isShiftPressedRef:ee,netMode:J,setClipboard:oe,getClipboard:U,onClipboardMismatch:ne}),M.jsx(sg.Provider,{value:{elements:s,setElements:l,selectedElement:c,setSelectedElement:u,mode:m,setMode:x,arcStart:v,setArcStart:w,tempArcEnd:T,setTempArcEnd:k,isDragging:z,setIsDragging:G,isContinuousSimulating:re,isRunning:pe,isSimulatorReady:Te,enabledTransitionIds:me,simulationError:Ae,stepSimulation:Me,handleFireTransition:wt,startContinuousSimulation:Ft,startRunSimulation:ct,stopAllSimulations:qt,completionStats:sr,dismissCompletionDialog:ws,isSettingsDialogOpen:S,setIsSettingsDialogOpen:C,simulationSettings:h,setSimulationSettings:_,netMode:J,historyManagerRef:F,canUndo:N,setCanUndo:R,canRedo:D,setCanRedo:V,handleUndo:_s,handleRedo:Ss,updateHistory:q,snapToGrid:or,handleSaveSettings:ks,z3Settings:E,setZ3Settings:P,resetEditor:bt,simulatorCore:fi,forceSimulatorReset:Yr,selectedElements:f,setSelectedElements:p,isIdSelected:Kr,clearSelection:Cs,setSelection:gl,multiDragRef:O,clipboardRef:W,setClipboard:oe,getClipboard:U,onClipboardMismatch:ne,instanceId:X.current,isShiftPressedRef:ee,saveFileHandle:I,setSaveFileHandle:A},children:t})},_n=()=>{const t=B.useContext(sg);if(t===void 0)throw new Error("usePetriNet must be used within a PetriNetProvider");return t},m_=({mode:t,setMode:e,gridSnappingEnabled:n,onToggleGridSnapping:r,canUndo:i,canRedo:s,onUndo:l,onRedo:c,elements:u,setElements:f,updateHistory:p,simulationSettings:m,setSimulationSettings:x,simulationMode:v,setSimulationMode:w,isSimulating:T,startSimulation:k,stopSimulation:S,clearCanvas:C,onOpenSettings:h,resetEditor:_})=>{const[E,P]=B.useState(!1),[I,A]=B.useState(null),[F,N]=B.useState(null),[R,D]=B.useState(!1),[V,j]=B.useState(!1),{saveFileHandle:z,setSaveFileHandle:G}=(()=>{try{return _n()}catch{return{saveFileHandle:null,setSaveFileHandle:()=>{}}}})(),{handleSave:Y,handleSaveAs:O,handleLoad:W,handleClear:X,handleOpenAdtManager:ee}=s7({elements:u,setElements:f,updateHistory:p,simulationSettings:m,setSimulationSettings:x,resetEditor:_,setIsLoading:P,setError:A,setSuccess:N,setIsAdtOpen:D,saveFileHandle:z,setSaveFileHandle:G});B.useEffect(()=>{if(!F)return;const re=setTimeout(()=>N(null),5e3);return()=>clearTimeout(re)},[F]);const J=B.useMemo(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(min-width: 1024px)"):null,[]);B.useEffect(()=>{if(!J)return;const re=pe=>{pe.matches&&j(!1)};return J.addEventListener?J.addEventListener("change",re):J.addListener(re),()=>{J.removeEventListener?J.removeEventListener("change",re):J.removeListener(re)}},[J]);const te=(re="desktop")=>pe=>({padding:"0.375rem 0.5rem",borderRadius:"0.25rem",backgroundColor:pe?"#4338ca":"white",color:pe?"rgba(255, 255, 255, 0.85)":"rgba(31, 41, 55, 0.7)",border:pe?"1px solid #3730a3":"1px solid #d1d5db",borderBottom:pe?"2px solid #312e81":"2px solid #9ca3af",margin:re==="mobile"?"0 0 0.5rem 0":"0 0.125rem",minWidth:re==="mobile"?"100%":"80px",width:re==="mobile"?"100%":"80px",fontSize:"0.75rem",fontWeight:600,cursor:"pointer",transition:"all 0.15s ease-in-out",textAlign:"center",height:"32px",display:"inline-flex",alignItems:"center",justifyContent:"center",boxShadow:pe?"inset 0 1px 0 rgba(255, 255, 255, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1)":"inset 0 1px 0 rgba(255, 255, 255, 0.7), 0 2px 4px rgba(0, 0, 0, 0.1)",position:"relative",top:"0",transform:pe?"translateY(1px)":"translateY(0)",textShadow:pe?"0 -1px 1px rgba(0, 0, 0, 0.5), 0 1px 0 rgba(255, 255, 255, 0.15)":"0 1px 0 rgba(255, 255, 255, 0.5), 0 -1px 0 rgba(0, 0, 0, 0.2)"}),ae=B.useMemo(()=>te("desktop"),[]),ne=B.useMemo(()=>te("mobile"),[]),oe=re=>({padding:"0.5rem",marginTop:"0.5rem",borderRadius:"0.25rem",backgroundColor:re?"#fee2e2":"#d1fae5",color:re?"#b91c1c":"#047857",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem"}),U=()=>M.jsxs("div",{className:"hidden lg:flex items-start",children:[M.jsxs("div",{className:"file-operations p-2",children:[M.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"File"}),M.jsx(Sy,{isLoading:E,onSave:Y,onSaveAs:O,canSaveAs:!!z,onLoad:W,onClear:X,buttonStyle:ae})]}),M.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),M.jsxs("div",{className:"editing-tools p-2",children:[M.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"Editing"}),M.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[M.jsxs("div",{className:"flex items-center mr-4",children:[M.jsx("input",{type:"checkbox",id:"grid-snap-toggle","data-testid":"grid-snap-toggle",checked:n,onChange:r,className:"mr-1"}),M.jsx("label",{htmlFor:"grid-snap-toggle",className:"text-xs text-gray-700",children:"Snap to Grid"})]}),M.jsx(ky,{mode:t,setMode:e,buttonStyle:ae})]})]}),M.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),M.jsxs("div",{className:"adt-tools p-2",children:[M.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"ADT Manager"}),M.jsx("div",{className:"flex justify-between",children:M.jsx("button",{style:ae(!1),onClick:ee,title:"Open ADT Manager","data-testid":"toolbar-adt-manager",children:"ADT"})})]}),M.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),M.jsxs("div",{className:"history-tools p-2",children:[M.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"History"}),M.jsx(Cy,{canUndo:i,canRedo:s,onUndo:l,onRedo:c,buttonStyle:ae})]}),M.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),M.jsxs("div",{className:"settings-tools p-2 ml-auto",children:[M.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"Settings"}),M.jsx(Ey,{onOpenSettings:h,buttonStyle:ae})]})]}),q=()=>M.jsxs("div",{className:"flex flex-col space-y-6",children:[M.jsxs("div",{className:"file-operations",children:[M.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"File"}),M.jsx(Sy,{isLoading:E,onSave:Y,onSaveAs:O,canSaveAs:!!z,onLoad:W,onClear:X,buttonStyle:ne})]}),M.jsxs("div",{className:"editing-tools",children:[M.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"Editing"}),M.jsxs("div",{className:"flex flex-col gap-3",children:[M.jsxs("div",{className:"flex items-center",children:[M.jsx("input",{type:"checkbox",id:"grid-snap-toggle-mobile","data-testid":"grid-snap-toggle-mobile",checked:n,onChange:r,className:"mr-2"}),M.jsx("label",{htmlFor:"grid-snap-toggle-mobile",className:"text-sm text-gray-700",children:"Snap to Grid"})]}),M.jsx(ky,{mode:t,setMode:e,buttonStyle:ne})]})]}),M.jsxs("div",{className:"adt-tools",children:[M.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"ADT Manager"}),M.jsx("button",{style:ne(!1),onClick:()=>{j(!1),ee()},title:"Open ADT Manager","data-testid":"toolbar-adt-manager-mobile",children:"ADT"})]}),M.jsxs("div",{className:"history-tools",children:[M.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"History"}),M.jsx(Cy,{canUndo:i,canRedo:s,onUndo:l,onRedo:c,buttonStyle:ne})]}),M.jsxs("div",{className:"settings-tools",children:[M.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"Settings"}),M.jsx(Ey,{onOpenSettings:()=>{j(!1),h()},buttonStyle:ne})]})]});return M.jsxs("div",{className:"toolbar-container flex flex-col p-2 bg-gray-50 border-b border-gray-200 shadow-sm",style:{minHeight:"70px"},children:[M.jsx("div",{className:"hidden lg:block",children:U()}),M.jsxs("div",{className:"lg:hidden flex items-center justify-between px-1",children:[M.jsxs("div",{children:[M.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Editor Controls"}),M.jsx("p",{className:"text-xs text-gray-500",children:"Tap to open full toolbar"})]}),M.jsx("button",{className:"p-2 rounded-md border border-gray-200 shadow-sm bg-white",onClick:()=>j(!0),"aria-label":"Open toolbar menu",children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),R&&M.jsx(b9,{isOpen:R,onClose:()=>D(!1)}),I&&M.jsxs("div",{style:oe(!0),children:[I,M.jsx("button",{onClick:()=>A(null),style:{marginLeft:"0.5rem"},children:""})]}),F&&M.jsxs("div",{style:oe(!1),children:[F,M.jsx("button",{onClick:()=>N(null),style:{marginLeft:"0.5rem"},children:""})]}),V&&M.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[M.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40",onClick:()=>j(!1)}),M.jsxs("div",{className:"absolute top-12 left-0 right-0 mx-4 bg-white rounded-2xl shadow-2xl p-5 max-h-[calc(100vh-100px)] overflow-y-auto",children:[M.jsxs("div",{className:"flex items-center justify-between mb-4",children:[M.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Toolbar"}),M.jsx("button",{className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200",onClick:()=>j(!1),"aria-label":"Close toolbar menu",children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),q()]})]})]})},y_=({mode:t,tokens:e,valueTokensInput:n,onTokensChange:r,onValueTokensChange:i,onValueTokensBlur:s})=>t==="pt"?M.jsxs("div",{className:"mb-4",children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tokens (PT mode)"}),M.jsx("input",{type:"number",min:"0",value:e,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}):t==="algebraic-int"?M.jsxs("div",{className:"mb-4",children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Algebraic Tokens"}),M.jsx("input",{type:"text",value:n,onChange:i,onBlur:s,className:"w-full px-3 py-2 border border-gray-300 rounded-md font-mono text-sm",placeholder:"e.g., 2, 3, 'hello', T, F, (1, 2), [1, 2, 3]"})]}):null,v_=({mode:t,weight:e,bindingsInput:n,bindingError:r,onWeightChange:i,onBindingsChange:s,onBindingsBlur:l})=>t==="pt"?M.jsxs("div",{className:"mb-4",children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),M.jsx("input",{type:"number",min:"1",value:e,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}):t==="algebraic-int"?M.jsxs("div",{className:"mb-4",children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bindings"}),M.jsx("input",{type:"text",value:n,onChange:s,onBlur:l,className:`w-full px-3 py-2 border rounded-md font-mono text-sm ${r?"border-red-500":"border-gray-300"}`,placeholder:"e.g., x, y, (a, b)"}),r&&M.jsx("p",{className:"text-red-600 text-xs mt-1",children:r})]}):null,x_=({guardText:t,guardError:e,onGuardChange:n,onGuardBlur:r})=>M.jsxs("div",{className:"mb-4",children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guard"}),M.jsx("input",{type:"text",value:t,onChange:n,onBlur:r,className:`w-full px-3 py-2 border rounded-md font-mono text-sm ${e?"border-red-500":"border-gray-300"}`,placeholder:"e.g., x > 0 and y < 10"}),e&&M.jsx("p",{className:"text-red-600 text-xs mt-1",children:e})]});function w_(){const t=B.useCallback(r=>{const i=[];let s="",l=0,c=0,u=!1;for(let p=0;p<r.length;p++){const m=r[p];if(u){s+=m,m==="'"&&r[p-1]!=="\\"&&(u=!1);continue}if(m==="'"){u=!0,s+=m;continue}if(m==="("){l++,s+=m;continue}if(m===")"){l=Math.max(0,l-1),s+=m;continue}if(m==="["){c++,s+=m;continue}if(m==="]"){c=Math.max(0,c-1),s+=m;continue}if(m===","&&l===0&&c===0){i.push(s.trim()),s="";continue}s+=m}const f=s.trim();return f.length>0&&i.push(f),i},[]),e=B.useCallback(r=>{const i=String(r||"").trim(),s=i.toLowerCase();if(i==="T"||s==="true")return!0;if(i==="F"||s==="false")return!1;if(/^[+-]?\d+$/.test(i))return parseInt(i,10);if(i.startsWith("'")&&i.endsWith("'"))return i.slice(1,-1);if(i.startsWith("[")&&i.endsWith("]")){const l=i.slice(1,-1).trim();return l?t(l).map(e):[]}if(i.startsWith("(")&&i.endsWith(")")){const l=i.slice(1,-1).trim();let c=0,u=-1;for(let f=0;f<l.length;f++){const p=l[f];if(p==="(")c++;else if(p===")")c=Math.max(0,c-1);else if(p===","&&c===0){u=f;break}}if(u>=0)return{__pair__:!0,fst:e(l.slice(0,u)),snd:e(l.slice(u+1))}}return null},[t]);return{parseValueTokensInput:B.useCallback(r=>{const i=String(r||"").trim();return i?t(i).map(e).filter(s=>s!==null):[]},[t,e]),splitTopLevelCommas:t}}function __(){const t=B.useCallback(n=>{const r=[];let i="",s=0,l=0;for(let c=0;c<n.length;c++){const u=n[c];if(u==="(")s++;else if(u===")")s=Math.max(0,s-1);else if(u==="[")l++;else if(u==="]")l=Math.max(0,l-1);else if(u===","&&s===0&&l===0){r.push(i.trim()),i="";continue}i+=u}return i.trim()&&r.push(i.trim()),r.filter(Boolean)},[]),e=B.useCallback(n=>{const r=t(String(n||""));for(const i of r){try{t5(i);continue}catch{}try{Rt(i);continue}catch{}try{xo(i,Rt);continue}catch{}return{ok:!1,error:`Invalid binding: ${i}`}}return{ok:!0,bindings:r}},[t]);return{splitTopLevel:t,validateBindings:e}}const S_=({getElementInfo:t,setElements:e,updateHistory:n,setFormValues:r})=>B.useCallback(i=>{const s=i.target.value;r(u=>({...u,label:s}));const{elementId:l,elementType:c}=t();c==="place"?e(u=>({...u,places:u.places.map(f=>f.id===l?{...f,label:s}:f)})):c==="transition"?e(u=>({...u,transitions:u.transitions.map(f=>f.id===l?{...f,label:s}:f)})):c==="arc"&&e(u=>({...u,arcs:u.arcs.map(f=>f.id===l?{...f,label:s}:f)})),n()},[t,e,n,r]),k_=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,parseValueTokensInput:l,showInferredTypes:c})=>{const u=B.useCallback(m=>{let x=parseInt(m.target.value,10);Number.isFinite(x)||(x=0),x<0&&(x=0),e(w=>({...w,tokens:x}));const{elementId:v}=n();r(w=>({...w,places:w.places.map(T=>T.id===v?{...T,tokens:x}:T)})),i()},[n,r,i,e]),f=B.useCallback(()=>{const m=t.valueTokensInput.trim(),{elementId:x}=n();if(!m){r(w=>({...w,places:w.places.map(T=>T.id===x?{...T,valueTokens:[],tokens:0}:T)})),i();return}const v=l(m);r(w=>{const T={...w,places:w.places.map(k=>k.id===x?{...k,valueTokens:v,tokens:v.length}:k)};return ul(T,s,c)}),i()},[t.valueTokensInput,n,s,l,r,i,c]),p=B.useCallback(m=>Array.isArray(m.valueTokens)?i5(m.valueTokens):"",[]);return{handleTokensChange:u,handleValueTokensBlur:f,serializeTokensFromElement:p}},C_=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,validateBindings:l,showInferredTypes:c})=>{const u=B.useCallback(m=>{const x=parseInt(m.target.value,10)||1;e(w=>({...w,weight:x}));const{elementId:v}=n();r(w=>({...w,arcs:w.arcs.map(T=>T.id===v?{...T,weight:x}:T)})),i()},[n,r,i,e]),f=B.useCallback(()=>{const m=t.bindingsInput.trim();e(k=>({...k,bindingError:null}));const{elementId:x}=n();if(!m){r(k=>({...k,arcs:k.arcs.map(S=>S.id===x?{...S,bindings:[]}:S)})),i();return}const{ok:v,bindings:w,error:T}=l(m);if(!v){e(k=>({...k,bindingError:T}));return}r(k=>({...k,arcs:k.arcs.map(S=>S.id===x?{...S,bindings:w}:S)})),i(),r(k=>{const S={...k,arcs:k.arcs.map(C=>C.id===x?{...C,bindings:w}:C)};return ul(S,s,c)}),i()},[t.bindingsInput,n,s,r,e,i,l,c]),p=B.useCallback((m,x)=>m!=="arc"||!Array.isArray(x.bindings)?"":x.bindings.map(v=>{const w=String(v||"");return/^true$/i.test(w)?"T":/^false$/i.test(w)?"F":n5(w)}).join(", "),[]);return{handleWeightChange:u,handleBindingsBlur:f,serializeBindingsFromElement:p}},E_=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,showInferredTypes:l})=>({handleGuardBlur:B.useCallback(()=>{const u=t.guardText.trim();e(p=>({...p,guardError:null}));const{elementId:f}=n();if(!u){r(p=>({...p,transitions:p.transitions.map(m=>m.id===f?{...m,guard:""}:m)})),i();return}try{xo(u,Rt),r(p=>({...p,transitions:p.transitions.map(m=>m.id===f?{...m,guard:u}:m)})),i(),r(p=>{const m={...p,transitions:p.transitions.map(x=>x.id===f?{...x,guard:u}:x)};return ul(m,s,l)}),i()}catch(p){e(m=>({...m,guardError:`Invalid guard: ${p.message}`}))}},[t.guardText,n,s,r,e,i,l])}),T_=({elements:t,netMode:e,setElements:n,updateHistory:r,showInferredTypes:i})=>{const s=i??!0,l=B.useCallback(u=>{if(!s||!(t!=null&&t.places)||!(t!=null&&t.arcs)||e!=="algebraic-int")return;const f=t.places.find(v=>v.id===u);if(!f||!f.valueTokens||f.valueTokens.length===0)return;const p=Za(f.valueTokens[f.valueTokens.length-1]),x=t.arcs.filter(v=>v.source===u).reduce((v,w)=>{if(!Array.isArray(w.bindings)||w.bindings.length===0)return v;const T=w.bindings[0];if(!T||!s&&T.includes(":"))return v;const k=T.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(!k)return v;const S=new Map;if(k.forEach(h=>{["true","false","and","or","not"].includes(h)||S.set(h,p)}),S.size===0)return v;const C=Wu(T,S,null,{overwrite:s});return C!==T&&v.push({arcId:w.id,newBinding:C}),v},[]);x.length!==0&&(n(v=>({...v,arcs:v.arcs.map(w=>{const T=x.find(k=>k.arcId===w.id);return T?{...w,bindings:[T.newBinding]}:w})})),r())},[t,e,n,r,s]),c=B.useCallback(()=>{if(!s)return;const u=ul(t,e,s);u!==t&&(n(u),r())},[t,e,n,r,s]);return{inferTypesForPlace:l,performGlobalTypeInference:c}};function b_({selectedElement:t,elements:e,setElements:n,updateHistory:r,netMode:i,showInferredTypes:s=!0}){const[l,c]=B.useState({label:"",tokens:0,weight:1,valueTokensInput:"",bindingsInput:"",bindingError:null,guardText:"",guardError:null}),{parseValueTokensInput:u}=w_(),{validateBindings:f}=__(),p=B.useCallback(()=>{if(!t)return{elementId:"",elementType:""};const E=t.id||t.element&&t.element.id||"",P=t.type||E.split("-")[0];return{elementId:E,elementType:P}},[t]),{handleTokensChange:m,handleValueTokensBlur:x,serializeTokensFromElement:v}=k_({formValues:l,setFormValues:c,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,parseValueTokensInput:u,showInferredTypes:s}),{handleWeightChange:w,handleBindingsBlur:T,serializeBindingsFromElement:k}=C_({formValues:l,setFormValues:c,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,validateBindings:f,showInferredTypes:s}),{handleGuardBlur:S}=E_({formValues:l,setFormValues:c,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,showInferredTypes:s}),C=S_({getElementInfo:p,setElements:n,updateHistory:r,setFormValues:c}),{inferTypesForPlace:h,performGlobalTypeInference:_}=T_({elements:e,netMode:i,setElements:n,updateHistory:r,showInferredTypes:s});return B.useEffect(()=>{if(!t)return;const{elementType:E}=p(),P=E==="transition"?String(t.guard||"").replace(/\btrue\b/gi,"T").replace(/\bfalse\b/gi,"F"):"";c(I=>({...I,label:t.label||"",tokens:t.tokens||0,weight:t.weight!==void 0?t.weight:1,valueTokensInput:v(t),bindingsInput:k(E,t),guardText:P}))},[t,p,v,k,c]),{formValues:l,setFormValues:c,handleLabelChange:C,handleTokensChange:m,handleWeightChange:w,handleValueTokensBlur:x,handleBindingsBlur:T,handleGuardBlur:S,inferTypesForPlace:h,performGlobalTypeInference:_,getElementInfo:p}}const P_=({selectedElement:t,elements:e,setElements:n,updateHistory:r,simulationSettings:i})=>{const s=B.useContext(sg)||{};s.enabledTransitionIds,s.isSimulatorReady;const l=(i==null?void 0:i.netMode)||"pt",c=!!(i!=null&&i.showInferredTypes),{formValues:u,setFormValues:f,handleLabelChange:p,handleTokensChange:m,handleWeightChange:x,handleValueTokensBlur:v,handleBindingsBlur:w,handleGuardBlur:T,getElementInfo:k}=b_({selectedElement:t,elements:e,setElements:n,updateHistory:r,netMode:l,showInferredTypes:c});if(!t)return null;const{elementType:S}=k();return M.jsxs("div",{className:"properties-panel w-full px-4 py-2 overflow-y-auto mx-0",children:[M.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Properties"}),M.jsxs("div",{className:"mb-4",children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),M.jsx("input",{type:"text",value:u.label,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"P1, P2, etc."})]}),t&&S==="place"&&M.jsx(y_,{mode:l,tokens:u.tokens,valueTokensInput:u.valueTokensInput,onTokensChange:m,onValueTokensChange:C=>f(h=>({...h,valueTokensInput:C.target.value})),onValueTokensBlur:v}),t&&S==="arc"&&M.jsx(v_,{mode:l,weight:u.weight,bindingsInput:u.bindingsInput,bindingError:u.bindingError,onWeightChange:x,onBindingsChange:C=>f(h=>({...h,bindingsInput:C.target.value})),onBindingsBlur:w}),t&&S==="transition"&&l==="algebraic-int"&&M.jsx(x_,{guardText:u.guardText,guardError:u.guardError,onGuardChange:C=>f(h=>({...h,guardText:C.target.value})),onGuardBlur:T})]})},N_=({enabledTransitions:t,isLoading:e,isOpen:n,onClose:r,onFire:i})=>n?M.jsxs("div",{"data-testid":"enabled-transitions",className:"enabled-transitions-panel mt-4 p-4 bg-gray-50 border border-gray-200 rounded-md",children:[M.jsxs("div",{className:"flex justify-between items-center mb-3",children:[M.jsx("h3",{className:"text-md font-semibold",children:"Enabled Transitions"}),M.jsx("span",{onClick:r,role:"button",tabIndex:0,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),r&&r())},className:"text-gray-500 hover:text-gray-800 cursor-pointer select-none","aria-label":"Close enabled transitions panel",children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e?M.jsx("p",{className:"text-gray-500",children:"Loading..."}):t.length===0?M.jsx("p",{className:"text-gray-500",children:"No enabled transitions"}):M.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto pr-1",children:t.map(s=>M.jsx("button",{type:"button",className:"flex items-center text-left hover:bg-gray-100 rounded px-1 py-0.5",onClick:()=>i&&i(s.id),"data-testid":`enabled-${s.label||s.id}`,title:s.label||s.id,children:M.jsx("span",{className:"font-medium",children:s.label||s.id.substring(11,17)})},s.id))})]}):null,A_=({elements:t,enabledTransitionIds:e})=>{const{handleFireTransition:n,netMode:r}=_n(),[i,s]=B.useState(!1),[l,c]=B.useState(!1);return M.jsxs("div",{className:"pt-4 mt-4 px-4",children:[M.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Petri Net"}),M.jsxs("div",{className:"mb-4 pl-1",children:[M.jsxs("div",{className:"flex justify-between items-center mb-2",children:[M.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Current Markings"}),M.jsxs("button",{"data-testid":"toggle-markings",className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm flex items-center space-x-1 transition-colors",onClick:()=>s(!i),children:[M.jsx("span",{children:i?"Hide":"Show"}),M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})]})]}),i&&M.jsx("div",{"data-testid":"current-marking",className:"markings-panel p-3 bg-gray-50 border border-gray-200 rounded-md",children:(t.places||[]).length===0?M.jsx("p",{className:"text-gray-500 text-sm",children:"No places defined"}):M.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-64 overflow-y-auto pr-1",children:(t.places||[]).filter(u=>r==="algebraic-int"?(Array.isArray(u.valueTokens)?u.valueTokens:[]).length>0:!0).map(u=>{const f=u.label||u.name||u.id.substring(6,12),p=u.tokens||0,m=Array.isArray(u.valueTokens)?u.valueTokens:[],x=r==="algebraic-int"&&Array.isArray(u.valueTokens),v=x?i5(m):"";return M.jsxs("div",{className:"flex items-start text-sm",children:[M.jsx("span",{className:"font-medium text-gray-800 mr-2 truncate",title:f,children:f}),x?M.jsx("div",{className:"flex-1 text-gray-800 bg-purple-50 border border-purple-200 rounded px-2 py-1 whitespace-pre-wrap break-words overflow-visible",title:v,children:v||"[]"}):M.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-purple-100 text-purple-800 border border-purple-200 font-semibold min-w-[2rem] justify-center",children:p})]},u.id)})})})]}),M.jsxs("div",{className:"mb-2 pl-1",children:[M.jsxs("div",{className:"flex justify-between items-center mb-2",children:[M.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Enabled Transitions"}),M.jsxs("button",{"data-testid":"show-enabled-transitions",className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm flex items-center space-x-1 transition-colors",onClick:()=>c(!l),children:[M.jsx("span",{children:l?"Hide":"Show"}),M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})]})]}),l&&M.jsx(N_,{isOpen:!0,enabledTransitions:(e||[]).map(u=>{const f=(t.transitions||[]).find(p=>p.id===u);return{id:u,label:f&&(f.label||f.name)||u}}),isLoading:!1,onClose:()=>c(!1),onFire:u=>n&&n(u)})]})]})};const M_=({stats:t,onDismiss:e})=>{if(!t)return null;const n=r=>{if(r<1e3)return`${r}ms`;const i=Math.floor(r/1e3),s=Math.floor(i/60),l=i%60;return s>0?`${s}m ${l}s`:`${i}s`};return M.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:M.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md mx-4",children:[M.jsxs("div",{className:"flex items-center mb-4",children:[M.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3",children:M.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),M.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Simulation Complete"})]}),M.jsxs("div",{className:"space-y-3 mb-6",children:[M.jsxs("div",{className:"flex justify-between items-center",children:[M.jsx("span",{className:"text-gray-600",children:"Duration:"}),M.jsx("span",{className:"font-medium text-gray-900",children:n(t.elapsedMs)})]}),M.jsxs("div",{className:"flex justify-between items-center",children:[M.jsx("span",{className:"text-gray-600",children:"Transitions Fired:"}),M.jsx("span",{className:"font-medium text-gray-900",children:t.transitionsFired})]})]}),M.jsx("div",{className:"flex justify-end",children:M.jsx("button",{onClick:e,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"OK"})})]})})},R_=()=>{const{isContinuousSimulating:t,isRunning:e,enabledTransitionIds:n,simulationError:r,isSimulatorReady:i,stepSimulation:s,startContinuousSimulation:l,startRunSimulation:c,stopAllSimulations:u,completionStats:f,dismissCompletionDialog:p}=_n(),m=t||e;return M.jsxs("div",{"data-testid":"simulation-manager",className:"simulation-manager w-full px-4 py-2 mx-0",children:[M.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Simulation"}),r&&M.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded mb-4",children:r}),M.jsxs("div",{className:"bg-gray-200 p-3 rounded-lg shadow-lg border border-gray-300",children:[M.jsxs("div",{className:"flex items-center justify-between space-x-3 mb-3",children:[M.jsxs("button",{"data-testid":"sim-step",className:"flex-1 h-12 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:s,disabled:!i||m||n.length===0,title:"Execute one step forward",children:[M.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),M.jsx("span",{className:"text-xs font-bold",children:"Step"})]}),M.jsxs("button",{"data-testid":"sim-simulate",className:"flex-1 h-12 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:l,disabled:!i||m||n.length===0,title:"Simulate with animation",children:[M.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:M.jsx("path",{fillRule:"evenodd",d:"M10 18V6l8 6-8 6z",clipRule:"evenodd"})})}),M.jsx("span",{className:"text-xs font-bold",children:"Simulate"})]}),M.jsxs("button",{"data-testid":"sim-run",className:"flex-1 h-12 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!1}catch{}c()},disabled:!i||m||n.length===0,title:"Run to completion",children:[M.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7"})})}),M.jsx("span",{className:"text-xs font-bold",children:"Run"})]})]}),M.jsx("div",{children:M.jsxs("button",{"data-testid":"sim-stop",className:"w-full h-10 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 flex items-center justify-center space-x-2 transition-all shadow-md",onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!0}catch{}u()},disabled:!m,title:"Stop simulation or run",children:[M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:M.jsx("rect",{x:"7",y:"7",width:"10",height:"10"})}),M.jsx("span",{className:"text-sm font-bold",children:"STOP"})]})}),e&&M.jsx("div",{className:"mt-2 flex items-center justify-center",children:M.jsxs("span",{className:"inline-flex items-center space-x-1 text-green-600",children:[M.jsx("span",{className:"w-4 h-4 bg-green-500 rounded-full sim-pulse-strong"}),M.jsx("span",{className:"font-medium text-sm",children:"Simulation running..."})]})})]}),M.jsx(M_,{stats:f,onDismiss:p})]})},I_=({isOpen:t,onClose:e})=>{const{z3Settings:n,setZ3Settings:r}=_n(),[i,s]=B.useState(0),[l,c]=B.useState(3e5),[u,f]=B.useState(!0),[p,m]=B.useState(1e4);B.useEffect(()=>{t&&(s(Number((n==null?void 0:n.poolSize)??0)),c(Number((n==null?void 0:n.idleTimeoutMs)??3e5)),f(!!((n==null?void 0:n.prewarmOnAlgebraicMode)??!0)),m(Number((n==null?void 0:n.solverTimeoutMs)??1e4)))},[t,n]);const x=()=>{const v={poolSize:Math.max(0,Number(i)||0),idleTimeoutMs:Math.max(1e3,Number(l)||3e5),prewarmOnAlgebraicMode:!!u,solverTimeoutMs:Math.max(100,Number(p)||1e4)};try{typeof window<"u"&&Ei(()=>Promise.resolve().then(()=>Sc),void 0,import.meta.url).then(w=>w.setZ3WorkerConfig(v)).catch(()=>{})}catch{}try{r(v)}catch{}e==null||e()};return t?M.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:M.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-md mx-4",children:[M.jsxs("div",{className:"flex justify-between items-center mb-4",children:[M.jsx("h2",{className:"text-xl font-semibold",children:"Z3 Settings"}),M.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:""})]}),M.jsxs("div",{className:"space-y-4",children:[M.jsxs("div",{children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Worker Pool"}),M.jsx("div",{className:"space-y-3",children:M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsx("div",{className:"text-sm",children:"Pool size (0 = on-demand)"}),M.jsx("input",{type:"number",min:0,max:8,value:i,onChange:v=>s(v.target.value),className:"w-24 border rounded px-2 py-1 text-sm"})]})})]}),M.jsxs("div",{children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lifecycle"}),M.jsxs("div",{className:"space-y-3",children:[M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsx("div",{className:"text-sm",children:"idleTimeoutMs"}),M.jsx("input",{type:"number",min:1e3,max:36e5,step:1e3,value:l,onChange:v=>c(v.target.value),className:"w-28 border rounded px-2 py-1 text-sm"})]}),M.jsxs("label",{className:"flex items-center text-sm",children:[M.jsx("input",{type:"checkbox",checked:u,onChange:v=>f(v.target.checked),className:"mr-2"}),"Pre-warm when switching to Algebraic mode"]}),M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsx("div",{className:"text-sm",children:"Solver timeout (ms)"}),M.jsx("input",{type:"number",min:100,max:6e4,step:100,value:p,onChange:v=>m(v.target.value),className:"w-28 border rounded px-2 py-1 text-sm"})]})]})]}),M.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded p-3",children:[M.jsx("h3",{className:"text-sm font-medium text-purple-800 mb-1",children:"Notes"}),M.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[M.jsx("li",{children:" Pool size 0 keeps workers off until a batch run forces 8 workers"}),M.jsx("li",{children:" Idle timeout trims the pool back to the configured size after bursts"}),M.jsx("li",{children:" Pre-warm hides first-use latency when switching to algebraic-int"}),M.jsx("li",{children:" Solver timeout applies to boolean predicate checks (headless runs benefit from a shorter timeout)"})]})]})]}),M.jsxs("div",{className:"mt-6 flex justify-end",children:[M.jsx("button",{onClick:e,className:"px-3 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors mr-2",children:"Cancel"}),M.jsx("button",{onClick:x,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"Save"})]})]})}):null},fa=2e5,L_=({isOpen:t,onClose:e})=>{const{simulatorCore:n,simulationSettings:r,handleSaveSettings:i,elements:s,z3Settings:l,setZ3Settings:c}=_n(),[u,f]=B.useState("single"),[p,m]=B.useState(!1),[x,v]=B.useState(fa),[w,T]=B.useState(!1),[k,S]=B.useState("pt"),[C,h]=B.useState(!1),[_,E]=B.useState(!1),[P,I]=B.useState(!1),[A,F]=B.useState(!1),[N,R]=B.useState(!1);B.useEffect(()=>{var j,z,G;if(t){try{if(n){const te=n.getSimulationMode?n.getSimulationMode():"single";f(te)}}catch(te){fe.warn("Could not get current simulation mode:",te)}const Y=Number((r==null?void 0:r.maxIterations)??fa),O=!!(r!=null&&r.limitIterations);T(O);const W=Number.isFinite(Y)&&Y>0?Math.max(1,Math.min(1e6,Math.floor(Y))):fa;v(W);const X=(r==null?void 0:r.netMode)||"pt";S(X);const ee=!!(r!=null&&r.batchMode);F(ee);const J=!!(ee||r!=null&&r.useNonVisualRun);I(J),R(!!(r!=null&&r.showInferredTypes)),ee&&u!=="maximal"&&D("maximal");try{const te=(((j=s==null?void 0:s.places)==null?void 0:j.length)||0)>0||(((z=s==null?void 0:s.transitions)==null?void 0:z.length)||0)>0||(((G=s==null?void 0:s.arcs)==null?void 0:G.length)||0)>0;h(!!te)}catch{h(!1)}}},[t,n,r]);const D=async j=>{if(!n||!n.setSimulationMode){f(j);return}m(!0);try{await n.setSimulationMode(j),f(j),fe.info("Simulation mode changed to:",j)}catch(z){fe.error("Failed to change simulation mode:",z),f(u)}finally{m(!1)}},V=()=>{const j=!!w,z=Math.max(1,Math.min(1e6,Math.floor(Number(x)||fa)));i({...r,maxIterations:j?z:fa,limitIterations:j,netMode:k,useNonVisualRun:A?!0:P,batchMode:A,showInferredTypes:N}),e==null||e()};return t?M.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[M.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-md mx-4 max-h-[90vh] flex flex-col",children:[M.jsxs("div",{className:"flex justify-between items-center mb-4",children:[M.jsx("h2",{className:"text-xl font-semibold",children:"Simulation Settings"}),M.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold","data-testid":"settings-close",children:""})]}),M.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 pr-2",children:[M.jsxs("div",{children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limits"}),M.jsxs("div",{className:"space-y-3",children:[M.jsxs("div",{className:"flex items-center justify-between",children:[M.jsx("div",{className:"text-sm",children:"Max iterations"}),M.jsxs("div",{className:"flex items-center space-x-2",children:[M.jsx("input",{type:"number",min:1,max:1e6,value:x,onChange:j=>v(j.target.value),disabled:!w,className:"w-24 border rounded px-2 py-1 text-sm disabled:bg-gray-100"}),M.jsxs("label",{className:"flex items-center text-sm",children:[M.jsx("input",{type:"checkbox",checked:w,onChange:j=>{const z=j.target.checked;T(z),z&&(!Number.isFinite(Number(x))||Number(x)<=0)&&v(100)},className:"mr-1"}),"Limit iterations"]})]})]}),!w&&M.jsx("div",{className:"text-xs text-gray-600",children:"Default runs allow up to 200,000 steps when this option is unchecked."})]})]}),M.jsxs("div",{children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Run Options"}),M.jsxs("label",{className:"flex items-center text-sm",children:[M.jsx("input",{type:"checkbox",checked:A?!0:P,onChange:j=>{const z=j.target.checked;I(z)},disabled:A,className:"mr-2"}),M.jsxs("span",{className:"text-sm",children:[M.jsx("strong",{children:"Use non-visual execution for Run"})," - No per-step animations"]})]}),M.jsxs("label",{className:"flex items-center text-sm mt-2",children:[M.jsx("input",{type:"checkbox",checked:A,onChange:j=>{const z=j.target.checked;if(F(z),z){I(!0),D("maximal");try{c(G=>{const Y=G?{...G}:l?{...l}:{};return Number(Y.poolSize||0)>=8?Y:{...Y,poolSize:8}})}catch{}}},className:"mr-2"}),M.jsxs("span",{className:"text-sm",children:[M.jsx("strong",{children:"Batch mode"})," - Always headless, keeps background worker active"]})]}),A&&M.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Batch mode forces non-visual execution and reuses the simulation worker after the first run."})]}),M.jsxs("div",{children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type Annotations"}),M.jsxs("label",{className:"flex items-center text-sm",children:[M.jsx("input",{type:"checkbox",checked:N,onChange:j=>R(j.target.checked),className:"mr-2"}),M.jsxs("span",{className:"text-sm",children:[M.jsx("strong",{children:"Show inferred variable types"}),"  Display automatically inferred types in guards and bindings"]})]}),M.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"When off, only manually annotated types remain visible so expressions stay concise."})]}),M.jsxs("div",{children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Simulation Mode"}),M.jsxs("div",{className:"space-y-2",children:[M.jsxs("label",{className:"flex items-center",children:[M.jsx("input",{type:"radio",name:"simulationMode",value:"single",checked:u==="single",onChange:j=>D(j.target.value),disabled:p,className:"mr-2"}),M.jsxs("span",{className:"text-sm",children:[M.jsx("strong",{children:"Single Transition"})," - Fire one enabled transition at random"]})]}),M.jsxs("label",{className:"flex items-center",children:[M.jsx("input",{type:"radio",name:"simulationMode",value:"maximal",checked:u==="maximal",onChange:j=>D(j.target.value),disabled:p,className:"mr-2"}),M.jsxs("span",{className:"text-sm",children:[M.jsx("strong",{children:"Maximal Concurrent"})," - Fire all non-conflicting enabled transitions simultaneously"]})]})]})]}),M.jsxs("div",{children:[M.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Net Type"}),M.jsxs("div",{className:"space-y-2",children:[M.jsxs("label",{className:"flex items-center",children:[M.jsx("input",{type:"radio",name:"netMode",value:"pt",checked:k==="pt",onChange:j=>S(j.target.value),disabled:C,className:"mr-2"}),M.jsxs("span",{className:"text-sm",children:[M.jsx("strong",{children:"P/T Net"})," - Classic place/transition nets with counts"]})]}),M.jsxs("label",{className:"flex items-center",children:[M.jsx("input",{type:"radio",name:"netMode",value:"algebraic-int",checked:k==="algebraic-int",onChange:j=>S(j.target.value),disabled:C,className:"mr-2"}),M.jsxs("span",{className:"text-sm",children:[M.jsx("strong",{children:"Algebraic (Integer)"})," - Integer tokens with guard and term labels"]})]}),C&&M.jsx("div",{className:"text-xs text-gray-600",children:"Net type is locked while the canvas has elements. Clear the canvas to switch."})]})]}),p&&M.jsx("div",{className:"text-center text-sm text-gray-600",children:"Updating simulation mode..."})]}),M.jsxs("div",{className:"mt-6 pt-4 flex justify-end border-t border-gray-200",children:[M.jsx("button",{onClick:()=>E(!0),className:"px-3 py-2 bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors mr-auto",children:"Z3 Settings"}),M.jsx("button",{onClick:e,className:"px-3 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors mr-2","data-testid":"settings-cancel",children:"Cancel"}),M.jsx("button",{onClick:V,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors","data-testid":"settings-save",children:"Save"})]})]}),_&&M.jsx(I_,{isOpen:_,onClose:()=>E(!1)})]}):null};var b5={exports:{}},Xc={},Cc={},ke={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object globalThis]")}t.glob=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.20",isBrowser:n(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var i;return(i=t.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const r=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=r,t.Konva._injectGlobal(t.Konva)})(ke);var rt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=ke;class n{constructor(_=[1,0,0,1,0,0]){this.dirty=!1,this.m=_&&_.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(_){_.m[0]=this.m[0],_.m[1]=this.m[1],_.m[2]=this.m[2],_.m[3]=this.m[3],_.m[4]=this.m[4],_.m[5]=this.m[5]}point(_){const E=this.m;return{x:E[0]*_.x+E[2]*_.y+E[4],y:E[1]*_.x+E[3]*_.y+E[5]}}translate(_,E){return this.m[4]+=this.m[0]*_+this.m[2]*E,this.m[5]+=this.m[1]*_+this.m[3]*E,this}scale(_,E){return this.m[0]*=_,this.m[1]*=_,this.m[2]*=E,this.m[3]*=E,this}rotate(_){const E=Math.cos(_),P=Math.sin(_),I=this.m[0]*E+this.m[2]*P,A=this.m[1]*E+this.m[3]*P,F=this.m[0]*-P+this.m[2]*E,N=this.m[1]*-P+this.m[3]*E;return this.m[0]=I,this.m[1]=A,this.m[2]=F,this.m[3]=N,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(_,E){const P=this.m[0]+this.m[2]*E,I=this.m[1]+this.m[3]*E,A=this.m[2]+this.m[0]*_,F=this.m[3]+this.m[1]*_;return this.m[0]=P,this.m[1]=I,this.m[2]=A,this.m[3]=F,this}multiply(_){const E=this.m[0]*_.m[0]+this.m[2]*_.m[1],P=this.m[1]*_.m[0]+this.m[3]*_.m[1],I=this.m[0]*_.m[2]+this.m[2]*_.m[3],A=this.m[1]*_.m[2]+this.m[3]*_.m[3],F=this.m[0]*_.m[4]+this.m[2]*_.m[5]+this.m[4],N=this.m[1]*_.m[4]+this.m[3]*_.m[5]+this.m[5];return this.m[0]=E,this.m[1]=P,this.m[2]=I,this.m[3]=A,this.m[4]=F,this.m[5]=N,this}invert(){const _=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),E=this.m[3]*_,P=-this.m[1]*_,I=-this.m[2]*_,A=this.m[0]*_,F=_*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),N=_*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=E,this.m[1]=P,this.m[2]=I,this.m[3]=A,this.m[4]=F,this.m[5]=N,this}getMatrix(){return this.m}decompose(){const _=this.m[0],E=this.m[1],P=this.m[2],I=this.m[3],A=this.m[4],F=this.m[5],N=_*I-E*P,R={x:A,y:F,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(_!=0||E!=0){const D=Math.sqrt(_*_+E*E);R.rotation=E>0?Math.acos(_/D):-Math.acos(_/D),R.scaleX=D,R.scaleY=N/D,R.skewX=(_*P+E*I)/N,R.skewY=0}else if(P!=0||I!=0){const D=Math.sqrt(P*P+I*I);R.rotation=Math.PI/2-(I>0?Math.acos(-P/D):-Math.acos(P/D)),R.scaleX=N/D,R.scaleY=D,R.skewX=0,R.skewY=(_*P+E*I)/N}return R.rotation=t.Util._getRotation(R.rotation),R}}t.Transform=n;const r="[object Array]",i="[object Number]",s="[object String]",l="[object Boolean]",c=Math.PI/180,u=180/Math.PI,f="#",p="",m="0",x="Konva warning: ",v="Konva error: ",w="rgb(",T={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},k=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let S=[];const C=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(h){setTimeout(h,60)};t.Util={_isElement(h){return!!(h&&h.nodeType==1)},_isFunction(h){return!!(h&&h.constructor&&h.call&&h.apply)},_isPlainObject(h){return!!h&&h.constructor===Object},_isArray(h){return Object.prototype.toString.call(h)===r},_isNumber(h){return Object.prototype.toString.call(h)===i&&!isNaN(h)&&isFinite(h)},_isString(h){return Object.prototype.toString.call(h)===s},_isBoolean(h){return Object.prototype.toString.call(h)===l},isObject(h){return h instanceof Object},isValidSelector(h){if(typeof h!="string")return!1;const _=h[0];return _==="#"||_==="."||_===_.toUpperCase()},_sign(h){return h===0||h>0?1:-1},requestAnimFrame(h){S.push(h),S.length===1&&C(function(){const _=S;S=[],_.forEach(function(E){E()})})},createCanvasElement(){const h=document.createElement("canvas");try{h.style=h.style||{}}catch{}return h},createImageElement(){return document.createElement("img")},_isInDocument(h){for(;h=h.parentNode;)if(h==document)return!0;return!1},_urlToImage(h,_){const E=t.Util.createImageElement();E.onload=function(){_(E)},E.src=h},_rgbToHex(h,_,E){return((1<<24)+(h<<16)+(_<<8)+E).toString(16).slice(1)},_hexToRgb(h){h=h.replace(f,p);const _=parseInt(h,16);return{r:_>>16&255,g:_>>8&255,b:_&255}},getRandomColor(){let h=(Math.random()*16777215<<0).toString(16);for(;h.length<6;)h=m+h;return f+h},getRGB(h){let _;return h in T?(_=T[h],{r:_[0],g:_[1],b:_[2]}):h[0]===f?this._hexToRgb(h.substring(1)):h.substr(0,4)===w?(_=k.exec(h.replace(/ /g,"")),{r:parseInt(_[1],10),g:parseInt(_[2],10),b:parseInt(_[3],10)}):{r:0,g:0,b:0}},colorToRGBA(h){return h=h||"black",t.Util._namedColorToRBA(h)||t.Util._hex3ColorToRGBA(h)||t.Util._hex4ColorToRGBA(h)||t.Util._hex6ColorToRGBA(h)||t.Util._hex8ColorToRGBA(h)||t.Util._rgbColorToRGBA(h)||t.Util._rgbaColorToRGBA(h)||t.Util._hslColorToRGBA(h)},_namedColorToRBA(h){const _=T[h.toLowerCase()];return _?{r:_[0],g:_[1],b:_[2],a:1}:null},_rgbColorToRGBA(h){if(h.indexOf("rgb(")===0){h=h.match(/rgb\(([^)]+)\)/)[1];const _=h.split(/ *, */).map(Number);return{r:_[0],g:_[1],b:_[2],a:1}}},_rgbaColorToRGBA(h){if(h.indexOf("rgba(")===0){h=h.match(/rgba\(([^)]+)\)/)[1];const _=h.split(/ *, */).map((E,P)=>E.slice(-1)==="%"?P===3?parseInt(E)/100:parseInt(E)/100*255:Number(E));return{r:_[0],g:_[1],b:_[2],a:_[3]}}},_hex8ColorToRGBA(h){if(h[0]==="#"&&h.length===9)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:parseInt(h.slice(7,9),16)/255}},_hex6ColorToRGBA(h){if(h[0]==="#"&&h.length===7)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:1}},_hex4ColorToRGBA(h){if(h[0]==="#"&&h.length===5)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:parseInt(h[4]+h[4],16)/255}},_hex3ColorToRGBA(h){if(h[0]==="#"&&h.length===4)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:1}},_hslColorToRGBA(h){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(h)){const[_,...E]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(h),P=Number(E[0])/360,I=Number(E[1])/100,A=Number(E[2])/100;let F,N,R;if(I===0)return R=A*255,{r:Math.round(R),g:Math.round(R),b:Math.round(R),a:1};A<.5?F=A*(1+I):F=A+I-A*I;const D=2*A-F,V=[0,0,0];for(let j=0;j<3;j++)N=P+1/3*-(j-1),N<0&&N++,N>1&&N--,6*N<1?R=D+(F-D)*6*N:2*N<1?R=F:3*N<2?R=D+(F-D)*(2/3-N)*6:R=D,V[j]=R*255;return{r:Math.round(V[0]),g:Math.round(V[1]),b:Math.round(V[2]),a:1}}},haveIntersection(h,_){return!(_.x>h.x+h.width||_.x+_.width<h.x||_.y>h.y+h.height||_.y+_.height<h.y)},cloneObject(h){const _={};for(const E in h)this._isPlainObject(h[E])?_[E]=this.cloneObject(h[E]):this._isArray(h[E])?_[E]=this.cloneArray(h[E]):_[E]=h[E];return _},cloneArray(h){return h.slice(0)},degToRad(h){return h*c},radToDeg(h){return h*u},_degToRad(h){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(h)},_radToDeg(h){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(h)},_getRotation(h){return e.Konva.angleDeg?t.Util.radToDeg(h):h},_capitalize(h){return h.charAt(0).toUpperCase()+h.slice(1)},throw(h){throw new Error(v+h)},error(h){console.error(v+h)},warn(h){e.Konva.showWarnings&&console.warn(x+h)},each(h,_){for(const E in h)_(E,h[E])},_inRange(h,_,E){return _<=h&&h<E},_getProjectionToSegment(h,_,E,P,I,A){let F,N,R;const D=(h-E)*(h-E)+(_-P)*(_-P);if(D==0)F=h,N=_,R=(I-E)*(I-E)+(A-P)*(A-P);else{const V=((I-h)*(E-h)+(A-_)*(P-_))/D;V<0?(F=h,N=_,R=(h-I)*(h-I)+(_-A)*(_-A)):V>1?(F=E,N=P,R=(E-I)*(E-I)+(P-A)*(P-A)):(F=h+V*(E-h),N=_+V*(P-_),R=(F-I)*(F-I)+(N-A)*(N-A))}return[F,N,R]},_getProjectionToLine(h,_,E){const P=t.Util.cloneObject(h);let I=Number.MAX_VALUE;return _.forEach(function(A,F){if(!E&&F===_.length-1)return;const N=_[(F+1)%_.length],R=t.Util._getProjectionToSegment(A.x,A.y,N.x,N.y,h.x,h.y),D=R[0],V=R[1],j=R[2];j<I&&(P.x=D,P.y=V,I=j)}),P},_prepareArrayForTween(h,_,E){const P=[],I=[];if(h.length>_.length){const F=_;_=h,h=F}for(let F=0;F<h.length;F+=2)P.push({x:h[F],y:h[F+1]});for(let F=0;F<_.length;F+=2)I.push({x:_[F],y:_[F+1]});const A=[];return I.forEach(function(F){const N=t.Util._getProjectionToLine(F,P,E);A.push(N.x),A.push(N.y)}),A},_prepareToStringify(h){let _;h.visitedByCircularReferenceRemoval=!0;for(const E in h)if(h.hasOwnProperty(E)&&h[E]&&typeof h[E]=="object"){if(_=Object.getOwnPropertyDescriptor(h,E),h[E].visitedByCircularReferenceRemoval||t.Util._isElement(h[E]))if(_.configurable)delete h[E];else return null;else if(t.Util._prepareToStringify(h[E])===null)if(_.configurable)delete h[E];else return null}return delete h.visitedByCircularReferenceRemoval,h},_assign(h,_){for(const E in _)h[E]=_[E];return h},_getFirstPointerId(h){return h.touches?h.changedTouches[0].identifier:h.pointerId||999},releaseCanvas(...h){e.Konva.releaseCanvasOnDestroy&&h.forEach(_=>{_.width=0,_.height=0})},drawRoundedRectPath(h,_,E,P){let I=0,A=0,F=0,N=0;typeof P=="number"?I=A=F=N=Math.min(P,_/2,E/2):(I=Math.min(P[0]||0,_/2,E/2),A=Math.min(P[1]||0,_/2,E/2),N=Math.min(P[2]||0,_/2,E/2),F=Math.min(P[3]||0,_/2,E/2)),h.moveTo(I,0),h.lineTo(_-A,0),h.arc(_-A,A,A,Math.PI*3/2,0,!1),h.lineTo(_,E-N),h.arc(_-N,E-N,N,0,Math.PI/2,!1),h.lineTo(F,E),h.arc(F,E-F,F,Math.PI/2,Math.PI,!1),h.lineTo(0,I),h.arc(I,I,I,Math.PI,Math.PI*3/2,!1)}}})(rt);var Ze={},Ee={},ye={};Object.defineProperty(ye,"__esModule",{value:!0});ye.RGBComponent=F_;ye.alphaComponent=O_;ye.getNumberValidator=j_;ye.getNumberOrArrayOfNumbersValidator=D_;ye.getNumberOrAutoValidator=z_;ye.getStringValidator=B_;ye.getStringOrGradientValidator=U_;ye.getFunctionValidator=G_;ye.getNumberArrayValidator=V_;ye.getBooleanValidator=W_;ye.getComponentValidator=$_;const Wr=ke,st=rt;function $r(t){return st.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||st.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function F_(t){return t>255?255:t<0?0:Math.round(t)}function O_(t){return t>1?1:t<1e-4?1e-4:t}function j_(){if(Wr.Konva.isUnminified)return function(t,e){return st.Util._isNumber(t)||st.Util.warn($r(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function D_(t){if(Wr.Konva.isUnminified)return function(e,n){let r=st.Util._isNumber(e),i=st.Util._isArray(e)&&e.length==t;return!r&&!i&&st.Util.warn($r(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function z_(){if(Wr.Konva.isUnminified)return function(t,e){var n=st.Util._isNumber(t),r=t==="auto";return n||r||st.Util.warn($r(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function B_(){if(Wr.Konva.isUnminified)return function(t,e){return st.Util._isString(t)||st.Util.warn($r(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function U_(){if(Wr.Konva.isUnminified)return function(t,e){const n=st.Util._isString(t),r=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return n||r||st.Util.warn($r(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function G_(){if(Wr.Konva.isUnminified)return function(t,e){return st.Util._isFunction(t)||st.Util.warn($r(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function V_(){if(Wr.Konva.isUnminified)return function(t,e){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&t instanceof n||(st.Util._isArray(t)?t.forEach(function(r){st.Util._isNumber(r)||st.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):st.Util.warn($r(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function W_(){if(Wr.Konva.isUnminified)return function(t,e){var n=t===!0||t===!1;return n||st.Util.warn($r(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function $_(t){if(Wr.Konva.isUnminified)return function(e,n){return e==null||st.Util.isObject(e)||st.Util.warn($r(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=rt,n=ye,r="get",i="set";t.Factory={addGetterSetter(s,l,c,u,f){t.Factory.addGetter(s,l,c),t.Factory.addSetter(s,l,u,f),t.Factory.addOverloadedGetterSetter(s,l)},addGetter(s,l,c){var u=r+e.Util._capitalize(l);s.prototype[u]=s.prototype[u]||function(){const f=this.attrs[l];return f===void 0?c:f}},addSetter(s,l,c,u){var f=i+e.Util._capitalize(l);s.prototype[f]||t.Factory.overWriteSetter(s,l,c,u)},overWriteSetter(s,l,c,u){var f=i+e.Util._capitalize(l);s.prototype[f]=function(p){return c&&p!==void 0&&p!==null&&(p=c.call(this,p,l)),this._setAttr(l,p),u&&u.call(this),this}},addComponentsGetterSetter(s,l,c,u,f){const p=c.length,m=e.Util._capitalize,x=r+m(l),v=i+m(l);s.prototype[x]=function(){const T={};for(let k=0;k<p;k++){const S=c[k];T[S]=this.getAttr(l+m(S))}return T};const w=(0,n.getComponentValidator)(c);s.prototype[v]=function(T){const k=this.attrs[l];u&&(T=u.call(this,T,l)),w&&w.call(this,T,l);for(const S in T)T.hasOwnProperty(S)&&this._setAttr(l+m(S),T[S]);return T||c.forEach(S=>{this._setAttr(l+m(S),void 0)}),this._fireChangeEvent(l,k,T),f&&f.call(this),this},t.Factory.addOverloadedGetterSetter(s,l)},addOverloadedGetterSetter(s,l){var c=e.Util._capitalize(l),u=i+c,f=r+c;s.prototype[l]=function(){return arguments.length?(this[u](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(s,l,c,u){e.Util.error("Adding deprecated "+l);const f=r+e.Util._capitalize(l),p=l+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[f]=function(){e.Util.error(p);const m=this.attrs[l];return m===void 0?c:m},t.Factory.addSetter(s,l,u,function(){e.Util.error(p)}),t.Factory.addOverloadedGetterSetter(s,l)},backCompat(s,l){e.Util.each(l,function(c,u){const f=s.prototype[u],p=r+e.Util._capitalize(c),m=i+e.Util._capitalize(c);function x(){f.apply(this,arguments),e.Util.error('"'+c+'" method is deprecated and will be removed soon. Use ""'+u+'" instead.')}s.prototype[c]=x,s.prototype[p]=x,s.prototype[m]=x})},afterSetFilter(){this._filterUpToDate=!1}}})(Ee);var nr={},Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.HitContext=Dr.SceneContext=Dr.Context=void 0;const P5=rt,H_=ke;function X_(t){const e=[],n=t.length,r=P5.Util;for(let i=0;i<n;i++){let s=t[i];r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s)}return e}const Ky=",",Y_="(",K_=")",Q_="([",Z_="])",q_=";",J_="()",eS="=",Qy=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],tS=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],nS=100;class Yc{constructor(e){this.canvas=e,H_.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){let r=this.traceArr,i=r.length,s="",l,c,u,f;for(l=0;l<i;l++)c=r[l],u=c.method,u?(f=c.args,s+=u,e?s+=J_:P5.Util._isArray(f[0])?s+=Q_+f.join(Ky)+Z_:(n&&(f=f.map(p=>typeof p=="number"?Math.floor(p):p)),s+=Y_+f.join(Ky)+K_)):(s+=c.property,e||(s+=eS+c.val)),s+=q_;return s}clearTrace(){this.traceArr=[]}_trace(e){let n=this.traceArr,r;n.push(e),r=n.length,r>=nS&&n.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){const n=e.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(e){const n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){const n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}setAttr(e,n){this._context[e]=n}arc(e,n,r,i,s,l){this._context.arc(e,n,r,i,s,l)}arcTo(e,n,r,i,s){this._context.arcTo(e,n,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,r,i,s,l){this._context.bezierCurveTo(e,n,r,i,s,l)}clearRect(e,n,r,i){this._context.clearRect(e,n,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,n){const r=arguments;if(r.length===2)return this._context.createImageData(e,n);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,r,i){return this._context.createLinearGradient(e,n,r,i)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,r,i,s,l){return this._context.createRadialGradient(e,n,r,i,s,l)}drawImage(e,n,r,i,s,l,c,u,f){const p=arguments,m=this._context;p.length===3?m.drawImage(e,n,r):p.length===5?m.drawImage(e,n,r,i,s):p.length===9&&m.drawImage(e,n,r,i,s,l,c,u,f)}ellipse(e,n,r,i,s,l,c,u){this._context.ellipse(e,n,r,i,s,l,c,u)}isPointInPath(e,n,r,i){return r?this._context.isPointInPath(r,e,n,i):this._context.isPointInPath(e,n,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,n,r,i){this._context.fillRect(e,n,r,i)}strokeRect(e,n,r,i){this._context.strokeRect(e,n,r,i)}fillText(e,n,r,i){i?this._context.fillText(e,n,r,i):this._context.fillText(e,n,r)}measureText(e){return this._context.measureText(e)}getImageData(e,n,r,i){return this._context.getImageData(e,n,r,i)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,r,i){this._context.rect(e,n,r,i)}roundRect(e,n,r,i,s){this._context.roundRect(e,n,r,i,s)}putImageData(e,n,r){this._context.putImageData(e,n,r)}quadraticCurveTo(e,n,r,i){this._context.quadraticCurveTo(e,n,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,r,i,s,l){this._context.setTransform(e,n,r,i,s,l)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,r,i){this._context.strokeText(e,n,r,i)}transform(e,n,r,i,s,l){this._context.transform(e,n,r,i,s,l)}translate(e,n){this._context.translate(e,n)}_enableTrace(){let e=this,n=Qy.length,r=this.setAttr,i,s;const l=function(c){let u=e[c],f;e[c]=function(){return s=X_(Array.prototype.slice.call(arguments,0)),f=u.apply(e,arguments),e._trace({method:c,args:s}),f}};for(i=0;i<n;i++)l(Qy[i]);e.setAttr=function(){r.apply(e,arguments);const c=arguments[0];let u=arguments[1];(c==="shadowOffsetX"||c==="shadowOffsetY"||c==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),e._trace({property:c,val:u})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}Dr.Context=Yc;tS.forEach(function(t){Object.defineProperty(Yc.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class rS extends Yc{constructor(e,{willReadFrequently:n=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(e){const n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){const n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){const n=e.fill(),r=e.getFillPriority();if(n&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const l=e.getFillRadialGradientColorStops();if(l&&r==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):l&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const n=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(n.x,n.y,r.x,r.y);if(i){for(let l=0;l<i.length;l+=2)s.addColorStop(i[l],i[l+1]);this.setAttr("strokeStyle",s)}}_stroke(e){const n=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var n,r,i;const s=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",l=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,c=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},u=e.getAbsoluteScale(),f=this.canvas.getPixelRatio(),p=u.x*f,m=u.y*f;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",l*Math.min(Math.abs(p),Math.abs(m))),this.setAttr("shadowOffsetX",c.x*p),this.setAttr("shadowOffsetY",c.y*m)}}Dr.SceneContext=rS;class iS extends Yc{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const n=e.getStrokeScaleEnabled();if(!n){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e);const r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),n||this.restore()}}}Dr.HitContext=iS;Object.defineProperty(nr,"__esModule",{value:!0});nr.HitCanvas=nr.SceneCanvas=nr.Canvas=void 0;const Ec=rt,N5=Dr,A5=ke;let Tu;function sS(){if(Tu)return Tu;const t=Ec.Util.createCanvasElement(),e=t.getContext("2d");return Tu=function(){const n=A5.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/r}(),Ec.Util.releaseCanvas(t),Tu}class og{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const r=(e||{}).pixelRatio||A5.Konva.pixelRatio||sS();this.pixelRatio=r,this._canvas=Ec.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const n=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,n){this.setWidth(e||0),this.setHeight(n||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(i){return Ec.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}nr.Canvas=og;class oS extends og{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new N5.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}nr.SceneCanvas=oS;class aS extends og{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new N5.HitContext(this),this.setSize(e.width,e.height)}}nr.HitCanvas=aS;var Kc={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=ke,n=rt;t.DD={get isDragging(){let r=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return t.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];t.DD._dragElements.forEach((s,l)=>{const{node:c}=s,u=c.getStage();u.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=n.Util._getFirstPointerId(r));const f=u._changedPointerPositions.find(p=>p.id===s.pointerId);if(f){if(s.dragStatus!=="dragging"){const p=c.dragDistance();if(Math.max(Math.abs(f.x-s.startPointerPos.x),Math.abs(f.y-s.startPointerPos.y))<p||(c.startDrag({evt:r}),!c.isDragging()))return}c._setDragPosition(r,s),i.push(c)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];t.DD._dragElements.forEach(s=>{const{node:l}=s,c=l.getStage();if(r&&c.setPointersPositions(r),!c._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const f=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){t.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(Kc);Object.defineProperty(Ze,"__esModule",{value:!0});Ze.Node=void 0;const Pe=rt,cl=Ee,ha=nr,li=ke,An=Kc,ut=ye,Hu="absoluteOpacity",bu="allEventListeners",Rr="absoluteTransform",Zy="absoluteScale",Ki="canvas",lS="Change",uS="children",cS="konva",q0="listening",qy="mouseenter",Jy="mouseleave",e2="set",t2="Shape",Xu=" ",n2="stage",ui="transform",dS="Stage",J0="visible",fS=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Xu);let hS=1;class ve{constructor(e){this._id=hS++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===ui||e===Rr)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){let r=this._cache.get(e);return(r===void 0||(e===ui||e===Rr)&&r.dirty===!0)&&(r=n.call(this),this._cache.set(e,r)),r}_calculate(e,n,r){if(!this._attachedDepsListeners.get(e)){const i=n.map(s=>s+"Change.konva").join(Xu);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(Ki)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Rr&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Ki)){const{scene:e,filter:n,hit:r}=this._cache.get(Ki);Pe.Util.releaseCanvas(e,n,r),this._cache.delete(Ki)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const n=e||{};let r={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(n.width||r.width),s=Math.ceil(n.height||r.height),l=n.pixelRatio,c=n.x===void 0?Math.floor(r.x):n.x,u=n.y===void 0?Math.floor(r.y):n.y,f=n.offset||0,p=n.drawBorder||!1,m=n.hitCanvasPixelRatio||1;if(!i||!s){Pe.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const x=Math.abs(Math.round(r.x)-c)>.5?1:0,v=Math.abs(Math.round(r.y)-u)>.5?1:0;i+=f*2+x,s+=f*2+v,c-=f,u-=f;const w=new ha.SceneCanvas({pixelRatio:l,width:i,height:s}),T=new ha.SceneCanvas({pixelRatio:l,width:0,height:0,willReadFrequently:!0}),k=new ha.HitCanvas({pixelRatio:m,width:i,height:s}),S=w.getContext(),C=k.getContext();return k.isCache=!0,w.isCache=!0,this._cache.delete(Ki),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(w.getContext()._context.imageSmoothingEnabled=!1,T.getContext()._context.imageSmoothingEnabled=!1),S.save(),C.save(),S.translate(-c,-u),C.translate(-c,-u),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Hu),this._clearSelfAndDescendantCache(Zy),this.drawScene(w,this),this.drawHit(k,this),this._isUnderCache=!1,S.restore(),C.restore(),p&&(S.save(),S.beginPath(),S.rect(0,0,i,s),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),this._cache.set(Ki,{scene:w,filter:T,hit:k,x:c,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(Ki)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){const r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,s=1/0,l=-1/0,c=-1/0;const u=this.getAbsoluteTransform(n);return r.forEach(function(f){const p=u.point(f);i===void 0&&(i=l=p.x,s=c=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),l=Math.max(l,p.x),c=Math.max(c,p.y)}),{x:i,y:s,width:l-i,height:c-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);const r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){const n=this._getCanvasCache(),r=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),n=this._getCanvasCache(),r=n.scene,i=n.filter,s=i.getContext(),l,c,u,f;if(e){if(!this._filterUpToDate){const p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(l=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),c=s.getImageData(0,0,i.getWidth(),i.getHeight()),u=0;u<l;u++){if(f=e[u],typeof f!="function"){Pe.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,c),s.putImageData(c,0,0)}}catch(m){Pe.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,n){if(this._cache&&this._cache.delete(bu),arguments.length===3)return this._delegate.apply(this,arguments);let r=e.split(Xu),i=r.length,s,l,c,u,f;for(s=0;s<i;s++)l=r[s],c=l.split("."),u=c[0],f=c[1]||"",this.eventListeners[u]||(this.eventListeners[u]=[]),this.eventListeners[u].push({name:f,handler:n});return this}off(e,n){let r=(e||"").split(Xu),i=r.length,s,l,c,u,f,p;if(this._cache&&this._cache.delete(bu),!e)for(l in this.eventListeners)this._off(l);for(s=0;s<i;s++)if(c=r[s],u=c.split("."),f=u[0],p=u[1],f)this.eventListeners[f]&&this._off(f,p,n);else for(l in this.eventListeners)this._off(l,p,n);return this}dispatchEvent(e){const n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(r){n.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,r){const i=this;this.on(e,function(s){const l=s.target.findAncestors(n,!0,i);for(let c=0;c<l.length;c++)s=Pe.Util.cloneObject(s),s.currentTarget=l[c],r.call(l[c],s)})}remove(){return this.isDragging()&&this.stopDrag(),An.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Rr),this._clearSelfAndDescendantCache(Hu),this._clearSelfAndDescendantCache(Zy),this._clearSelfAndDescendantCache(n2),this._clearSelfAndDescendantCache(J0),this._clearSelfAndDescendantCache(q0)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const n="get"+Pe.Util._capitalize(e);return Pe.Util._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){let e=this.getParent(),n=[];for(;e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let n,r;if(!e)return this;for(n in e)n!==uS&&(r=e2+Pe.Util._capitalize(n),Pe.Util._isFunction(this[r])?this[r](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache(q0,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(J0,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);const r=this.getLayer();let i=!1;An.DD._dragElements.forEach(l=>{l.dragStatus==="dragging"&&(l.node.nodeType==="Stage"||l.node.getLayer()===r)&&(i=!0)});const s=!n&&!li.Konva.hitOnDragEnabled&&(i||li.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),n=this,r=0,i,s,l,c;function u(p){for(i=[],s=p.length,l=0;l<s;l++)c=p[l],r++,c.nodeType!==t2&&(i=i.concat(c.getChildren().slice())),c._id===n._id&&(l=s);i.length>0&&i[0].getDepth()<=e&&u(i)}const f=this.getStage();return n.nodeType!==dS&&f&&u(f.getChildren()),r}getDepth(){let e=0,n=this.parent;for(;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ui),this._clearSelfAndDescendantCache(Rr)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const n=e.getPointerPosition();if(!n)return null;const r=this.getAbsoluteTransform().copy();return r.invert(),r.point(n)}getAbsolutePosition(e){let n=!1,r=this.parent;for(;r;){if(r.isCached()){n=!0;break}r=r.parent}n&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),s=new Pe.Transform,l=this.offset();return s.m=i.slice(),s.translate(l.x,l.y),s.getTranslation()}setAbsolutePosition(e){const{x:n,y:r,...i}=this._clearTransform();this.attrs.x=n,this.attrs.y=r,this._clearCache(ui);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(ui),this._clearSelfAndDescendantCache(Rr),this}_setTransform(e){let n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let n=e.x,r=e.y,i=this.x(),s=this.y();return n!==void 0&&(i+=n),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,n){let r=[],i=this.getParent(),s,l;if(!(n&&n._id===this._id)){for(r.unshift(this);i&&(!n||i._id!==n._id);)r.unshift(i),i=i.parent;for(s=r.length,l=0;l<s;l++)e(r[l])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return Pe.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Pe.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Pe.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Pe.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return Pe.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&Pe.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Hu,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),n,r,i,s,l;const c={attrs:{},className:this.getClassName()};for(n in e)r=e[n],l=Pe.Util.isObject(r)&&!Pe.Util._isPlainObject(r)&&!Pe.Util._isArray(r),!l&&(i=typeof this[n]=="function"&&this[n],delete e[n],s=i?i.call(this):null,e[n]=r,s!==r&&(c.attrs[n]=r));return Pe.Util._prepareToStringify(c)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,r){const i=[];n&&this._isMatch(e)&&i.push(this);let s=this.parent;for(;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,n,r){return this.findAncestors(e,n,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let n=e.replace(/ /g,"").split(","),r=n.length,i,s;for(i=0;i<r;i++)if(s=n[i],Pe.Util.isValidSelector(s)||(Pe.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Pe.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Pe.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(n2,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,n={},r){return n.target=n.target||this,r?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Rr,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let n;if(e)return n=new Pe.Transform,this._eachAncestorReverse(function(r){const i=r.transformsEnabled();i==="all"?n.multiply(r.getTransform()):i==="position"&&n.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),n;{n=this._cache.get(Rr)||new Pe.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const r=this.transformsEnabled();if(r==="all")n.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,l=this.attrs.offsetX||0,c=this.attrs.offsetY||0;n.translate(i-l,s-c)}return n.dirty=!1,n}}getAbsoluteScale(e){let n=this;for(;n;)n._isUnderCache&&(e=n),n=n.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ui,this._getTransform)}_getTransform(){var e,n;const r=this._cache.get(ui)||new Pe.Transform;r.reset();const i=this.x(),s=this.y(),l=li.Konva.getAngle(this.rotation()),c=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,u=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,f=this.attrs.skewX||0,p=this.attrs.skewY||0,m=this.attrs.offsetX||0,x=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),l!==0&&r.rotate(l),(f!==0||p!==0)&&r.skew(f,p),(c!==1||u!==1)&&r.scale(c,u),(m!==0||x!==0)&&r.translate(-1*m,-1*x),r.dirty=!1,r}clone(e){let n=Pe.Util.cloneObject(this.attrs),r,i,s,l,c;for(r in e)n[r]=e[r];const u=new this.constructor(n);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,l=0;l<s;l++)c=i[l],c.name.indexOf(cS)<0&&(u.eventListeners[r]||(u.eventListeners[r]=[]),u.eventListeners[r].push(c));return u}_toKonvaCanvas(e){e=e||{};const n=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(n.x),s=e.y!==void 0?e.y:Math.floor(n.y),l=e.pixelRatio||1,c=new ha.SceneCanvas({width:e.width||Math.ceil(n.width)||(r?r.width():0),height:e.height||Math.ceil(n.height)||(r?r.height():0),pixelRatio:l}),u=c.getContext(),f=new ha.SceneCanvas({width:c.width/c.pixelRatio+Math.abs(i),height:c.height/c.pixelRatio+Math.abs(s),pixelRatio:c.pixelRatio});return e.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(i||s)&&u.translate(-1*i,-1*s),this.drawScene(c,void 0,f),u.restore(),c}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const n=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(n,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((n,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,Pe.Util._urlToImage(this.toDataURL(e),function(s){n(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((n,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{n(s),i==null||i(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():li.Konva.dragDistance}_off(e,n,r){let i=this.eventListeners[e],s,l,c;for(s=0;s<i.length;s++)if(l=i[s].name,c=i[s].handler,(l!=="konva"||n==="konva")&&(!n||l===n)&&(!r||r===c)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,n,r){this._fire(e+lS,{oldVal:n,newVal:r})}addName(e){if(!this.hasName(e)){const n=this.name(),r=n?n+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const n=(this.name()||"").split(/\s/g),r=n.indexOf(e);return r!==-1&&(n.splice(r,1),this.name(n.join(" "))),this}setAttr(e,n){const r=this[e2+Pe.Util._capitalize(e)];return Pe.Util._isFunction(r)?r.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(li.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,n){const r=this.attrs[e];r===n&&!Pe.Util.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,n),this._requestDraw())}_setComponentAttr(e,n,r){let i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,n,r){if(n&&this.nodeType===t2&&(n.target=this),!((e===qy||e===Jy)&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r))){this._fire(e,n);const s=(e===qy||e===Jy)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!s&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,n,r):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){var n,r,i;const s=(n=this._cache.get(bu))!==null&&n!==void 0?n:{};let l=s==null?void 0:s[e];if(l===void 0){l=[];let c=Object.getPrototypeOf(this);for(;c;){const u=(i=(r=c.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];l.push(...u),c=Object.getPrototypeOf(c)}s[e]=l,this._cache.set(bu,s)}return l}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const r=this._getProtoListeners(e);if(r)for(var i=0;i<r.length;i++)r[i].handler.call(this,n);const s=this.eventListeners[e];if(s)for(var i=0;i<s.length;i++)s[i].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const n=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;const s=r._getPointerById(n)||r._changedPointerPositions[0]||i;An.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:n})}startDrag(e,n=!0){An.DD._dragElements.has(this._id)||this._createDragElement(e);const r=An.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const r=this.getStage()._getPointerById(n.pointerId);if(!r)return;let i={x:r.x-n.offset.x,y:r.y-n.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const l=s.call(this,i,e);l?i=l:Pe.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const n=An.DD._dragElements.get(this._id);n&&(n.dragStatus="stopped"),An.DD._endDragBefore(e),An.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=An.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||li.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;An.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=An.DD._dragElements.get(this._id),r=n&&n.dragStatus==="dragging",i=n&&n.dragStatus==="ready";r?this.stopDrag():i&&An.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const r={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return Pe.Util.haveIntersection(r,this.getClientRect())}static create(e,n){return Pe.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){let r=ve.prototype.getClassName.call(e),i=e.children,s,l,c;n&&(e.attrs.container=n),li.Konva[r]||(Pe.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const u=li.Konva[r];if(s=new u(e.attrs),i)for(l=i.length,c=0;c<l;c++)s.add(ve._createNode(i[c]));return s}}Ze.Node=ve;ve.prototype.nodeType="Node";ve.prototype._attrsAffectingSize=[];ve.prototype.eventListeners={};ve.prototype.on.call(ve.prototype,fS,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ui),this._clearSelfAndDescendantCache(Rr)});ve.prototype.on.call(ve.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(J0)});ve.prototype.on.call(ve.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(q0)});ve.prototype.on.call(ve.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Hu)});const Be=cl.Factory.addGetterSetter;Be(ve,"zIndex");Be(ve,"absolutePosition");Be(ve,"position");Be(ve,"x",0,(0,ut.getNumberValidator)());Be(ve,"y",0,(0,ut.getNumberValidator)());Be(ve,"globalCompositeOperation","source-over",(0,ut.getStringValidator)());Be(ve,"opacity",1,(0,ut.getNumberValidator)());Be(ve,"name","",(0,ut.getStringValidator)());Be(ve,"id","",(0,ut.getStringValidator)());Be(ve,"rotation",0,(0,ut.getNumberValidator)());cl.Factory.addComponentsGetterSetter(ve,"scale",["x","y"]);Be(ve,"scaleX",1,(0,ut.getNumberValidator)());Be(ve,"scaleY",1,(0,ut.getNumberValidator)());cl.Factory.addComponentsGetterSetter(ve,"skew",["x","y"]);Be(ve,"skewX",0,(0,ut.getNumberValidator)());Be(ve,"skewY",0,(0,ut.getNumberValidator)());cl.Factory.addComponentsGetterSetter(ve,"offset",["x","y"]);Be(ve,"offsetX",0,(0,ut.getNumberValidator)());Be(ve,"offsetY",0,(0,ut.getNumberValidator)());Be(ve,"dragDistance",void 0,(0,ut.getNumberValidator)());Be(ve,"width",0,(0,ut.getNumberValidator)());Be(ve,"height",0,(0,ut.getNumberValidator)());Be(ve,"listening",!0,(0,ut.getBooleanValidator)());Be(ve,"preventDefault",!0,(0,ut.getBooleanValidator)());Be(ve,"filters",void 0,function(t){return this._filterUpToDate=!1,t});Be(ve,"visible",!0,(0,ut.getBooleanValidator)());Be(ve,"transformsEnabled","all",(0,ut.getStringValidator)());Be(ve,"size");Be(ve,"dragBoundFunc");Be(ve,"draggable",!1,(0,ut.getBooleanValidator)());cl.Factory.backCompat(ve,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var ds={};Object.defineProperty(ds,"__esModule",{value:!0});ds.Container=void 0;const No=Ee,Dh=Ze,Qc=ye;class fs extends Dh.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const n=this.children||[],r=[];return n.forEach(function(i){e(i)&&r.push(i)}),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let r=0;r<e.length;r++)this.add(e[r]);return this}const n=e[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){const r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&n)}),r}_descendants(e){let n=!1;const r=this.getChildren();for(const i of r){if(n=e(i),n)return!0;if(i.hasChildren()&&(n=i._descendants(e),n))return!0}return!1}toObject(){const e=Dh.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){let n=e.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){const n=Dh.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){n.add(r.clone())}),n}getAllIntersections(e){const n=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&n.push(r)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,r){n.index=r}),this._requestDraw()}drawScene(e,n,r){const i=this.getLayer(),s=e||i&&i.getCanvas(),l=s&&s.getContext(),c=this._getCanvasCache(),u=c&&c.scene,f=s&&s.isCache;if(!this.isVisible()&&!f)return this;if(u){l.save();const p=this.getAbsoluteTransform(n).getMatrix();l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(l),l.restore()}else this._drawChildren("drawScene",s,n,r);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;const r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),l=this._getCanvasCache();if(l&&l.hit){s.save();const u=this.getAbsoluteTransform(n).getMatrix();s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,n);return this}_drawChildren(e,n,r,i){var s;const l=n&&n.getContext(),c=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),p=typeof c=="number"&&typeof u=="number"||f,m=r===this;if(p){l.save();const v=this.getAbsoluteTransform(r);let w=v.getMatrix();l.transform(w[0],w[1],w[2],w[3],w[4],w[5]),l.beginPath();let T;if(f)T=f.call(this,l,this);else{const k=this.clipX(),S=this.clipY();l.rect(k||0,S||0,c,u)}l.clip.apply(l,T),w=v.copy().invert().getMatrix(),l.transform(w[0],w[1],w[2],w[3],w[4],w[5])}const x=!m&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";x&&(l.save(),l._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(v){v[e](n,r,i)}),x&&l.restore(),p&&l.restore()}getClientRect(e={}){var n;const r=e.skipTransform,i=e.relativeTo;let s,l,c,u,f={x:1/0,y:1/0,width:0,height:0};const p=this;(n=this.children)===null||n===void 0||n.forEach(function(v){if(!v.visible())return;const w=v.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});w.width===0&&w.height===0||(s===void 0?(s=w.x,l=w.y,c=w.x+w.width,u=w.y+w.height):(s=Math.min(s,w.x),l=Math.min(l,w.y),c=Math.max(c,w.x+w.width),u=Math.max(u,w.y+w.height)))});const m=this.find("Shape");let x=!1;for(let v=0;v<m.length;v++)if(m[v]._isVisible(this)){x=!0;break}return x&&s!==void 0?f={x:s,y:l,width:c-s,height:u-l}:f={x:0,y:0,width:0,height:0},r?f:this._transformedRect(f,i)}}ds.Container=fs;No.Factory.addComponentsGetterSetter(fs,"clip",["x","y","width","height"]);No.Factory.addGetterSetter(fs,"clipX",void 0,(0,Qc.getNumberValidator)());No.Factory.addGetterSetter(fs,"clipY",void 0,(0,Qc.getNumberValidator)());No.Factory.addGetterSetter(fs,"clipWidth",void 0,(0,Qc.getNumberValidator)());No.Factory.addGetterSetter(fs,"clipHeight",void 0,(0,Qc.getNumberValidator)());No.Factory.addGetterSetter(fs,"clipFunc");var M5={},Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});Ri.getCapturedShape=gS;Ri.createEvent=ag;Ri.hasPointerCapture=mS;Ri.setPointerCapture=yS;Ri.releaseCapture=I5;const pS=ke,qa=new Map,R5=pS.Konva._global.PointerEvent!==void 0;function gS(t){return qa.get(t)}function ag(t){return{evt:t,pointerId:t.pointerId}}function mS(t,e){return qa.get(t)===e}function yS(t,e){I5(t),e.getStage()&&(qa.set(t,e),R5&&e._fire("gotpointercapture",ag(new PointerEvent("gotpointercapture"))))}function I5(t,e){const n=qa.get(t);if(!n)return;const r=n.getStage();r&&r.content,qa.delete(t),R5&&n._fire("lostpointercapture",ag(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=rt,n=Ee,r=ds,i=ke,s=nr,l=Kc,c=ke,u=Ri,f="Stage",p="string",m="px",x="mouseout",v="mouseleave",w="mouseover",T="mouseenter",k="mousemove",S="mousedown",C="mouseup",h="pointermove",_="pointerdown",E="pointerup",P="pointercancel",I="lostpointercapture",A="pointerout",F="pointerleave",N="pointerover",R="pointerenter",D="contextmenu",V="touchstart",j="touchend",z="touchmove",G="touchcancel",Y="wheel",O=5,W=[[T,"_pointerenter"],[S,"_pointerdown"],[k,"_pointermove"],[C,"_pointerup"],[v,"_pointerleave"],[V,"_pointerdown"],[z,"_pointermove"],[j,"_pointerup"],[G,"_pointercancel"],[w,"_pointerover"],[Y,"_wheel"],[D,"_contextmenu"],[_,"_pointerdown"],[h,"_pointermove"],[E,"_pointerup"],[P,"_pointercancel"],[I,"_lostpointercapture"]],X={mouse:{[A]:x,[F]:v,[N]:w,[R]:T,[h]:k,[_]:S,[E]:C,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[A]:"touchout",[F]:"touchleave",[N]:"touchover",[R]:"touchenter",[h]:z,[_]:V,[E]:j,[P]:G,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[A]:A,[F]:F,[N]:N,[R]:R,[h]:h,[_]:_,[E]:E,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ee=oe=>oe.indexOf("pointer")>=0?"pointer":oe.indexOf("touch")>=0?"touch":"mouse",J=oe=>{const U=ee(oe);if(U==="pointer")return i.Konva.pointerEventsEnabled&&X.pointer;if(U==="touch")return X.touch;if(U==="mouse")return X.mouse};function te(oe={}){return(oe.clipFunc||oe.clipWidth||oe.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),oe}const ae="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class ne extends r.Container{constructor(U){super(te(U)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{te(this.attrs)}),this._checkVisibility()}_validateAdd(U){const q=U.getType()==="Layer",re=U.getType()==="FastLayer";q||re||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const U=this.visible()?"":"none";this.content.style.display=U}setContainer(U){if(typeof U===p){if(U.charAt(0)==="."){const re=U.slice(1);U=document.getElementsByClassName(re)[0]}else{var q;U.charAt(0)!=="#"?q=U:q=U.slice(1),U=document.getElementById(q)}if(!U)throw"Can not find container in document with id "+q}return this._setAttr("container",U),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),U.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const U=this.children,q=U.length;for(let re=0;re<q;re++)U[re].clear();return this}clone(U){return U||(U={}),U.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,U)}destroy(){super.destroy();const U=this.content;U&&e.Util._isInDocument(U)&&this.container().removeChild(U);const q=t.stages.indexOf(this);return q>-1&&t.stages.splice(q,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const U=this._pointerPositions[0]||this._changedPointerPositions[0];return U?{x:U.x,y:U.y}:(e.Util.warn(ae),null)}_getPointerById(U){return this._pointerPositions.find(q=>q.id===U)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(U){U=U||{},U.x=U.x||0,U.y=U.y||0,U.width=U.width||this.width(),U.height=U.height||this.height();const q=new s.SceneCanvas({width:U.width,height:U.height,pixelRatio:U.pixelRatio||1}),re=q.getContext()._context,pe=this.children;return(U.x||U.y)&&re.translate(-1*U.x,-1*U.y),pe.forEach(function(me){if(!me.isVisible())return;const Ae=me._toKonvaCanvas(U);re.drawImage(Ae._canvas,U.x,U.y,Ae.getWidth()/Ae.getPixelRatio(),Ae.getHeight()/Ae.getPixelRatio())}),q}getIntersection(U){if(!U)return null;const q=this.children,re=q.length,pe=re-1;for(let me=pe;me>=0;me--){const Ae=q[me].getIntersection(U);if(Ae)return Ae}return null}_resizeDOM(){const U=this.width(),q=this.height();this.content&&(this.content.style.width=U+m,this.content.style.height=q+m),this.bufferCanvas.setSize(U,q),this.bufferHitCanvas.setSize(U,q),this.children.forEach(re=>{re.setSize({width:U,height:q}),re.draw()})}add(U,...q){if(arguments.length>1){for(let pe=0;pe<arguments.length;pe++)this.add(arguments[pe]);return this}super.add(U);const re=this.children.length;return re>O&&e.Util.warn("The stage has "+re+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),U.setSize({width:this.width(),height:this.height()}),U.draw(),i.Konva.isBrowser&&this.content.appendChild(U.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(U){return u.hasPointerCapture(U,this)}setPointerCapture(U){u.setPointerCapture(U,this)}releaseCapture(U){u.releaseCapture(U,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&W.forEach(([U,q])=>{this.content.addEventListener(U,re=>{this[q](re)},{passive:!1})})}_pointerenter(U){this.setPointersPositions(U);const q=J(U.type);q&&this._fire(q.pointerenter,{evt:U,target:this,currentTarget:this})}_pointerover(U){this.setPointersPositions(U);const q=J(U.type);q&&this._fire(q.pointerover,{evt:U,target:this,currentTarget:this})}_getTargetShape(U){let q=this[U+"targetShape"];return q&&!q.getStage()&&(q=null),q}_pointerleave(U){const q=J(U.type),re=ee(U.type);if(!q)return;this.setPointersPositions(U);const pe=this._getTargetShape(re),me=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;pe&&me?(pe._fireAndBubble(q.pointerout,{evt:U}),pe._fireAndBubble(q.pointerleave,{evt:U}),this._fire(q.pointerleave,{evt:U,target:this,currentTarget:this}),this[re+"targetShape"]=null):me&&(this._fire(q.pointerleave,{evt:U,target:this,currentTarget:this}),this._fire(q.pointerout,{evt:U,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(U){const q=J(U.type),re=ee(U.type);if(!q)return;this.setPointersPositions(U);let pe=!1;this._changedPointerPositions.forEach(me=>{const Ae=this.getIntersection(me);if(l.DD.justDragged=!1,i.Konva["_"+re+"ListenClick"]=!0,!Ae||!Ae.isListening()){this[re+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&Ae.setPointerCapture(me.id),this[re+"ClickStartShape"]=Ae,Ae._fireAndBubble(q.pointerdown,{evt:U,pointerId:me.id}),pe=!0;const Te=U.type.indexOf("touch")>=0;Ae.preventDefault()&&U.cancelable&&Te&&U.preventDefault()}),pe||this._fire(q.pointerdown,{evt:U,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(U){const q=J(U.type),re=ee(U.type);if(!q||(i.Konva.isDragging()&&l.DD.node.preventDefault()&&U.cancelable&&U.preventDefault(),this.setPointersPositions(U),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const me={};let Ae=!1;const Te=this._getTargetShape(re);this._changedPointerPositions.forEach(wt=>{const Me=u.getCapturedShape(wt.id)||this.getIntersection(wt),Ft=wt.id,ct={evt:U,pointerId:Ft},qt=Te!==Me;if(qt&&Te&&(Te._fireAndBubble(q.pointerout,{...ct},Me),Te._fireAndBubble(q.pointerleave,{...ct},Me)),Me){if(me[Me._id])return;me[Me._id]=!0}Me&&Me.isListening()?(Ae=!0,qt&&(Me._fireAndBubble(q.pointerover,{...ct},Te),Me._fireAndBubble(q.pointerenter,{...ct},Te),this[re+"targetShape"]=Me),Me._fireAndBubble(q.pointermove,{...ct})):Te&&(this._fire(q.pointerover,{evt:U,target:this,currentTarget:this,pointerId:Ft}),this[re+"targetShape"]=null)}),Ae||this._fire(q.pointermove,{evt:U,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(U){const q=J(U.type),re=ee(U.type);if(!q)return;this.setPointersPositions(U);const pe=this[re+"ClickStartShape"],me=this[re+"ClickEndShape"],Ae={};let Te=!1;this._changedPointerPositions.forEach(wt=>{const Me=u.getCapturedShape(wt.id)||this.getIntersection(wt);if(Me){if(Me.releaseCapture(wt.id),Ae[Me._id])return;Ae[Me._id]=!0}const Ft=wt.id,ct={evt:U,pointerId:Ft};let qt=!1;i.Konva["_"+re+"InDblClickWindow"]?(qt=!0,clearTimeout(this[re+"DblTimeout"])):l.DD.justDragged||(i.Konva["_"+re+"InDblClickWindow"]=!0,clearTimeout(this[re+"DblTimeout"])),this[re+"DblTimeout"]=setTimeout(function(){i.Konva["_"+re+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Me&&Me.isListening()?(Te=!0,this[re+"ClickEndShape"]=Me,Me._fireAndBubble(q.pointerup,{...ct}),i.Konva["_"+re+"ListenClick"]&&pe&&pe===Me&&(Me._fireAndBubble(q.pointerclick,{...ct}),qt&&me&&me===Me&&Me._fireAndBubble(q.pointerdblclick,{...ct}))):(this[re+"ClickEndShape"]=null,i.Konva["_"+re+"ListenClick"]&&this._fire(q.pointerclick,{evt:U,target:this,currentTarget:this,pointerId:Ft}),qt&&this._fire(q.pointerdblclick,{evt:U,target:this,currentTarget:this,pointerId:Ft}))}),Te||this._fire(q.pointerup,{evt:U,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+re+"ListenClick"]=!1,U.cancelable&&re!=="touch"&&re!=="pointer"&&U.preventDefault()}_contextmenu(U){this.setPointersPositions(U);const q=this.getIntersection(this.getPointerPosition());q&&q.isListening()?q._fireAndBubble(D,{evt:U}):this._fire(D,{evt:U,target:this,currentTarget:this})}_wheel(U){this.setPointersPositions(U);const q=this.getIntersection(this.getPointerPosition());q&&q.isListening()?q._fireAndBubble(Y,{evt:U}):this._fire(Y,{evt:U,target:this,currentTarget:this})}_pointercancel(U){this.setPointersPositions(U);const q=u.getCapturedShape(U.pointerId)||this.getIntersection(this.getPointerPosition());q&&q._fireAndBubble(E,u.createEvent(U)),u.releaseCapture(U.pointerId)}_lostpointercapture(U){u.releaseCapture(U.pointerId)}setPointersPositions(U){const q=this._getContentPosition();let re=null,pe=null;U=U||window.event,U.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(U.touches,me=>{this._pointerPositions.push({id:me.identifier,x:(me.clientX-q.left)/q.scaleX,y:(me.clientY-q.top)/q.scaleY})}),Array.prototype.forEach.call(U.changedTouches||U.touches,me=>{this._changedPointerPositions.push({id:me.identifier,x:(me.clientX-q.left)/q.scaleX,y:(me.clientY-q.top)/q.scaleY})})):(re=(U.clientX-q.left)/q.scaleX,pe=(U.clientY-q.top)/q.scaleY,this.pointerPos={x:re,y:pe},this._pointerPositions=[{x:re,y:pe,id:e.Util._getFirstPointerId(U)}],this._changedPointerPositions=[{x:re,y:pe,id:e.Util._getFirstPointerId(U)}])}_setPointerPosition(U){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(U)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const U=this.content.getBoundingClientRect();return{top:U.top,left:U.left,scaleX:U.width/this.content.clientWidth||1,scaleY:U.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const U=this.container();if(!U)throw"Stage has no container. A container is required.";U.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),U.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(U){U.batchDraw()}),this}}t.Stage=ne,ne.prototype.nodeType=f,(0,c._registerNode)(ne),n.Factory.addGetterSetter(ne,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(oe=>{oe.batchDraw()})})})(M5);var dl={},vt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=ke,n=rt,r=Ee,i=Ze,s=ye,l=ke,c=Ri,u="hasShadow",f="shadowRGBA",p="patternImage",m="linearGradient",x="radialGradient";let v;function w(){return v||(v=n.Util.createCanvasElement().getContext("2d"),v)}t.shapes={};function T(F){const N=this.attrs.fillRule;N?F.fill(N):F.fill()}function k(F){F.stroke()}function S(F){const N=this.attrs.fillRule;N?F.fill(N):F.fill()}function C(F){F.stroke()}function h(){this._clearCache(u)}function _(){this._clearCache(f)}function E(){this._clearCache(p)}function P(){this._clearCache(m)}function I(){this._clearCache(x)}class A extends i.Node{constructor(N){super(N);let R;for(;R=n.Util.getRandomColor(),!(R&&!(R in t.shapes)););this.colorKey=R,t.shapes[R]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const R=w().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(R&&R.setTransform){const D=new n.Transform;D.translate(this.fillPatternX(),this.fillPatternY()),D.rotate(e.Konva.getAngle(this.fillPatternRotation())),D.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),D.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const V=D.getMatrix(),j=typeof DOMMatrix>"u"?{a:V[0],b:V[1],c:V[2],d:V[3],e:V[4],f:V[5]}:new DOMMatrix(V);R.setTransform(j)}return R}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){const N=this.fillLinearGradientColorStops();if(N){const R=w(),D=this.fillLinearGradientStartPoint(),V=this.fillLinearGradientEndPoint(),j=R.createLinearGradient(D.x,D.y,V.x,V.y);for(let z=0;z<N.length;z+=2)j.addColorStop(N[z],N[z+1]);return j}}_getRadialGradient(){return this._getCache(x,this.__getRadialGradient)}__getRadialGradient(){const N=this.fillRadialGradientColorStops();if(N){const R=w(),D=this.fillRadialGradientStartPoint(),V=this.fillRadialGradientEndPoint(),j=R.createRadialGradient(D.x,D.y,this.fillRadialGradientStartRadius(),V.x,V.y,this.fillRadialGradientEndRadius());for(let z=0;z<N.length;z+=2)j.addColorStop(N[z],N[z+1]);return j}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const N=n.Util.colorToRGBA(this.shadowColor());if(N)return"rgba("+N.r+","+N.g+","+N.b+","+N.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const N=this.hitStrokeWidth();return N==="auto"?this.hasStroke():this.strokeEnabled()&&!!N}intersects(N){const R=this.getStage();if(!R)return!1;const D=R.bufferHitCanvas;return D.getContext().clear(),this.drawHit(D,void 0,!0),D.context.getImageData(Math.round(N.x),Math.round(N.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(N){var R;if(!((R=this.attrs.perfectDrawEnabled)!==null&&R!==void 0?R:!0))return!1;const V=N||this.hasFill(),j=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(V&&j&&z)return!0;const G=this.hasShadow(),Y=this.shadowForStrokeEnabled();return!!(V&&j&&G&&Y)}setStrokeHitEnabled(N){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),N?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const N=this.size();return{x:this._centroid?-N.width/2:0,y:this._centroid?-N.height/2:0,width:N.width,height:N.height}}getClientRect(N={}){let R=!1,D=this.getParent();for(;D;){if(D.isCached()){R=!0;break}D=D.getParent()}const V=N.skipTransform,j=N.relativeTo||R&&this.getStage()||void 0,z=this.getSelfRect(),Y=!N.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,O=z.width+Y,W=z.height+Y,X=!N.skipShadow&&this.hasShadow(),ee=X?this.shadowOffsetX():0,J=X?this.shadowOffsetY():0,te=O+Math.abs(ee),ae=W+Math.abs(J),ne=X&&this.shadowBlur()||0,oe=te+ne*2,U=ae+ne*2,q={width:oe,height:U,x:-(Y/2+ne)+Math.min(ee,0)+z.x,y:-(Y/2+ne)+Math.min(J,0)+z.y};return V?q:this._transformedRect(q,j)}drawScene(N,R,D){const V=this.getLayer();let j=N||V.getCanvas(),z=j.getContext(),G=this._getCanvasCache(),Y=this.getSceneFunc(),O=this.hasShadow(),W,X;const ee=j.isCache,J=R===this;if(!this.isVisible()&&!J)return this;if(G){z.save();const ae=this.getAbsoluteTransform(R).getMatrix();return z.transform(ae[0],ae[1],ae[2],ae[3],ae[4],ae[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!Y)return this;if(z.save(),this._useBufferCanvas()&&!ee){W=this.getStage();const ae=D||W.bufferCanvas;X=ae.getContext(),X.clear(),X.save(),X._applyLineJoin(this);var te=this.getAbsoluteTransform(R).getMatrix();X.transform(te[0],te[1],te[2],te[3],te[4],te[5]),Y.call(this,X,this),X.restore();const ne=ae.pixelRatio;O&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(ae._canvas,0,0,ae.width/ne,ae.height/ne)}else{if(z._applyLineJoin(this),!J){var te=this.getAbsoluteTransform(R).getMatrix();z.transform(te[0],te[1],te[2],te[3],te[4],te[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}O&&z._applyShadow(this),Y.call(this,z,this)}return z.restore(),this}drawHit(N,R,D=!1){if(!this.shouldDrawHit(R,D))return this;const V=this.getLayer(),j=N||V.hitCanvas,z=j&&j.getContext(),G=this.hitFunc()||this.sceneFunc(),Y=this._getCanvasCache(),O=Y&&Y.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),O){z.save();const X=this.getAbsoluteTransform(R).getMatrix();return z.transform(X[0],X[1],X[2],X[3],X[4],X[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!G)return this;if(z.save(),z._applyLineJoin(this),!(this===R)){const X=this.getAbsoluteTransform(R).getMatrix();z.transform(X[0],X[1],X[2],X[3],X[4],X[5])}return G.call(this,z,this),z.restore(),this}drawHitFromCache(N=0){const R=this._getCanvasCache(),D=this._getCachedSceneCanvas(),V=R.hit,j=V.getContext(),z=V.getWidth(),G=V.getHeight();j.clear(),j.drawImage(D._canvas,0,0,z,G);try{const Y=j.getImageData(0,0,z,G),O=Y.data,W=O.length,X=n.Util._hexToRgb(this.colorKey);for(let ee=0;ee<W;ee+=4)O[ee+3]>N?(O[ee]=X.r,O[ee+1]=X.g,O[ee+2]=X.b,O[ee+3]=255):O[ee+3]=0;j.putImageData(Y,0,0)}catch(Y){n.Util.error("Unable to draw hit graph from cached scene canvas. "+Y.message)}return this}hasPointerCapture(N){return c.hasPointerCapture(N,this)}setPointerCapture(N){c.setPointerCapture(N,this)}releaseCapture(N){c.releaseCapture(N,this)}}t.Shape=A,A.prototype._fillFunc=T,A.prototype._strokeFunc=k,A.prototype._fillFuncHit=S,A.prototype._strokeFuncHit=C,A.prototype._centroid=!1,A.prototype.nodeType="Shape",(0,l._registerNode)(A),A.prototype.eventListeners={},A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",h),A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",I),r.Factory.addGetterSetter(A,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(A,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(A,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(A,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(A,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(A,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(A,"lineJoin"),r.Factory.addGetterSetter(A,"lineCap"),r.Factory.addGetterSetter(A,"sceneFunc"),r.Factory.addGetterSetter(A,"hitFunc"),r.Factory.addGetterSetter(A,"dash"),r.Factory.addGetterSetter(A,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(A,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(A,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(A,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"fillPatternImage"),r.Factory.addGetterSetter(A,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(A,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(A,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(A,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(A,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(A,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(A,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(A,"fillEnabled",!0),r.Factory.addGetterSetter(A,"strokeEnabled",!0),r.Factory.addGetterSetter(A,"shadowEnabled",!0),r.Factory.addGetterSetter(A,"dashEnabled",!0),r.Factory.addGetterSetter(A,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(A,"fillPriority","color"),r.Factory.addComponentsGetterSetter(A,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(A,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(A,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(A,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(A,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(A,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(A,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(A,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(A,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(A,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(A,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(A,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(A,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(A,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(A,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(A,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(A,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(A,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(A,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(A,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(A,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(A,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(A,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(A,"fillPatternRotation",0),r.Factory.addGetterSetter(A,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(A,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(vt);Object.defineProperty(dl,"__esModule",{value:!0});dl.Layer=void 0;const Mr=rt,zh=ds,Bs=Ze,lg=Ee,r2=nr,vS=ye,xS=vt,wS=ke,_S="#",SS="beforeDraw",kS="draw",L5=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],CS=L5.length;let Ao=class extends zh.Container{constructor(e){super(e),this.canvas=new r2.SceneCanvas,this.hitCanvas=new r2.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),e<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[e+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Bs.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Bs.Node.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Bs.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Bs.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return Bs.Node.prototype.remove.call(this),e&&e.parentNode&&Mr.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:n}){return this.canvas.setSize(e,n),this.hitCanvas.setSize(e,n),this._setSmoothEnabled(),this}_validateAdd(e){const n=e.getType();n!=="Group"&&n!=="Shape"&&Mr.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),Bs.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Mr.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Mr.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Mr.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let n=1,r=!1;for(;;){for(let i=0;i<CS;i++){const s=L5[i],l=this._getIntersection({x:e.x+s.x*n,y:e.y+s.y*n}),c=l.shape;if(c)return c;if(r=!!l.antialiased,!l.antialiased)break}if(r)n+=1;else return null}}_getIntersection(e){const n=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*n),Math.round(e.y*n),1,1).data,i=r[3];if(i===255){const s=Mr.Util._rgbToHex(r[0],r[1],r[2]),l=xS.shapes[_S+s];return l?{shape:l}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,n){const r=this.getLayer(),i=e||r&&r.getCanvas();return this._fire(SS,{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),zh.Container.prototype.drawScene.call(this,i,n),this._fire(kS,{node:this}),this}drawHit(e,n){const r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),zh.Container.prototype.drawHit.call(this,i,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Mr.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Mr.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Mr.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};dl.Layer=Ao;Ao.prototype.nodeType="Layer";(0,wS._registerNode)(Ao);lg.Factory.addGetterSetter(Ao,"imageSmoothingEnabled",!0);lg.Factory.addGetterSetter(Ao,"clearBeforeDraw",!0);lg.Factory.addGetterSetter(Ao,"hitGraphEnabled",!0,(0,vS.getBooleanValidator)());var Zc={};Object.defineProperty(Zc,"__esModule",{value:!0});Zc.FastLayer=void 0;const ES=rt,TS=dl,bS=ke;class ug extends TS.Layer{constructor(e){super(e),this.listening(!1),ES.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Zc.FastLayer=ug;ug.prototype.nodeType="FastLayer";(0,bS._registerNode)(ug);var Mo={};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.Group=void 0;const PS=rt,NS=ds,AS=ke;let cg=class extends NS.Container{_validateAdd(e){const n=e.getType();n!=="Group"&&n!=="Shape"&&PS.Util.throw("You may only add groups and shapes to groups.")}};Mo.Group=cg;cg.prototype.nodeType="Group";(0,AS._registerNode)(cg);var Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.Animation=void 0;const Bh=ke,i2=rt,Uh=function(){return Bh.glob.performance&&Bh.glob.performance.now?function(){return Bh.glob.performance.now()}:function(){return new Date().getTime()}}();class xr{constructor(e,n){this.id=xr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Uh(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){let n=[];return e&&(n=Array.isArray(e)?e:[e]),this.layers=n,this}getLayers(){return this.layers}addLayer(e){const n=this.layers,r=n.length;for(let i=0;i<r;i++)if(n[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const n=xr.animations,r=n.length;for(let i=0;i<r;i++)if(n[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Uh(),xr._addAnimation(this),this}stop(){return xr._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const n=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===n){this.animations.splice(s,1);break}}static _runFrames(){const e={},n=this.animations;for(let r=0;r<n.length;r++){const i=n[r],s=i.layers,l=i.func;i._updateFrameObject(Uh());const c=s.length;let u;if(l?u=l.call(i,i.frame)!==!1:u=!0,!!u)for(let f=0;f<c;f++){const p=s[f];p._id!==void 0&&(e[p._id]=p)}}for(const r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=xr;e.animations.length?(e._runFrames(),i2.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,i2.Util.requestAnimFrame(this._animationLoop))}}Ro.Animation=xr;xr.animations=[];xr.animIdCounter=0;xr.animRunning=!1;var F5={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=rt,n=Ro,r=Ze,i=ke,s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},l=1,c=2,u=3,f=["fill","stroke","shadowColor"];let p=0;class m{constructor(w,T,k,S,C,h,_){this.prop=w,this.propFunc=T,this.begin=S,this._pos=S,this.duration=h,this._change=0,this.prevPos=0,this.yoyo=_,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=k,this._change=C-this.begin,this.pause()}fire(w){const T=this[w];T&&T()}setTime(w){w>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():w<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=w,this.update())}getTime(){return this._time}setPosition(w){this.prevPos=this._pos,this.propFunc(w),this._pos=w}getPosition(w){return w===void 0&&(w=this._time),this.func(w,this.begin,this._change,this.duration)}play(){this.state=c,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=u,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(w){this.pause(),this._time=w,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const w=this.getTimer()-this._startTime;this.state===c?this.setTime(w):this.state===u&&this.setTime(this.duration-w)}pause(){this.state=l,this.fire("onPause")}getTimer(){return new Date().getTime()}}class x{constructor(w){const T=this,k=w.node,S=k._id,C=w.easing||t.Easings.Linear,h=!!w.yoyo;let _,E;typeof w.duration>"u"?_=.3:w.duration===0?_=.001:_=w.duration,this.node=k,this._id=p++;const P=k.getLayer()||(k instanceof i.Konva.Stage?k.getLayers():null);P||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){T.tween.onEnterFrame()},P),this.tween=new m(E,function(I){T._tweenFunc(I)},C,0,1,_*1e3,h),this._addListeners(),x.attrs[S]||(x.attrs[S]={}),x.attrs[S][this._id]||(x.attrs[S][this._id]={}),x.tweens[S]||(x.tweens[S]={});for(E in w)s[E]===void 0&&this._addAttr(E,w[E]);this.reset(),this.onFinish=w.onFinish,this.onReset=w.onReset,this.onUpdate=w.onUpdate}_addAttr(w,T){const k=this.node,S=k._id;let C,h,_,E,P;const I=x.tweens[S][w];I&&delete x.attrs[S][I][w];let A=k.getAttr(w);if(e.Util._isArray(T))if(C=[],h=Math.max(T.length,A.length),w==="points"&&T.length!==A.length&&(T.length>A.length?(E=A,A=e.Util._prepareArrayForTween(A,T,k.closed())):(_=T,T=e.Util._prepareArrayForTween(T,A,k.closed()))),w.indexOf("fill")===0)for(let F=0;F<h;F++)if(F%2===0)C.push(T[F]-A[F]);else{const N=e.Util.colorToRGBA(A[F]);P=e.Util.colorToRGBA(T[F]),A[F]=N,C.push({r:P.r-N.r,g:P.g-N.g,b:P.b-N.b,a:P.a-N.a})}else for(let F=0;F<h;F++)C.push(T[F]-A[F]);else f.indexOf(w)!==-1?(A=e.Util.colorToRGBA(A),P=e.Util.colorToRGBA(T),C={r:P.r-A.r,g:P.g-A.g,b:P.b-A.b,a:P.a-A.a}):C=T-A;x.attrs[S][this._id][w]={start:A,diff:C,end:T,trueEnd:_,trueStart:E},x.tweens[S][w]=this._id}_tweenFunc(w){const T=this.node,k=x.attrs[T._id][this._id];let S,C,h,_,E,P,I,A;for(S in k){if(C=k[S],h=C.start,_=C.diff,A=C.end,e.Util._isArray(h))if(E=[],I=Math.max(h.length,A.length),S.indexOf("fill")===0)for(P=0;P<I;P++)P%2===0?E.push((h[P]||0)+_[P]*w):E.push("rgba("+Math.round(h[P].r+_[P].r*w)+","+Math.round(h[P].g+_[P].g*w)+","+Math.round(h[P].b+_[P].b*w)+","+(h[P].a+_[P].a*w)+")");else for(P=0;P<I;P++)E.push((h[P]||0)+_[P]*w);else f.indexOf(S)!==-1?E="rgba("+Math.round(h.r+_.r*w)+","+Math.round(h.g+_.g*w)+","+Math.round(h.b+_.b*w)+","+(h.a+_.a*w)+")":E=h+_*w;T.setAttr(S,E)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const w=this.node,T=x.attrs[w._id][this._id];T.points&&T.points.trueEnd&&w.setAttr("points",T.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const w=this.node,T=x.attrs[w._id][this._id];T.points&&T.points.trueStart&&w.points(T.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(w){return this.tween.seek(w*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const w=this.node._id,T=this._id,k=x.tweens[w];this.pause();for(const S in k)delete x.tweens[w][S];delete x.attrs[w][T]}}t.Tween=x,x.attrs={},x.tweens={},r.Node.prototype.to=function(v){const w=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),w&&w()},new x(v).play()},t.Easings={BackEaseIn(v,w,T,k){return T*(v/=k)*v*((1.70158+1)*v-1.70158)+w},BackEaseOut(v,w,T,k){return T*((v=v/k-1)*v*((1.70158+1)*v+1.70158)+1)+w},BackEaseInOut(v,w,T,k){let S=1.70158;return(v/=k/2)<1?T/2*(v*v*(((S*=1.525)+1)*v-S))+w:T/2*((v-=2)*v*(((S*=1.525)+1)*v+S)+2)+w},ElasticEaseIn(v,w,T,k,S,C){let h=0;return v===0?w:(v/=k)===1?w+T:(C||(C=k*.3),!S||S<Math.abs(T)?(S=T,h=C/4):h=C/(2*Math.PI)*Math.asin(T/S),-(S*Math.pow(2,10*(v-=1))*Math.sin((v*k-h)*(2*Math.PI)/C))+w)},ElasticEaseOut(v,w,T,k,S,C){let h=0;return v===0?w:(v/=k)===1?w+T:(C||(C=k*.3),!S||S<Math.abs(T)?(S=T,h=C/4):h=C/(2*Math.PI)*Math.asin(T/S),S*Math.pow(2,-10*v)*Math.sin((v*k-h)*(2*Math.PI)/C)+T+w)},ElasticEaseInOut(v,w,T,k,S,C){let h=0;return v===0?w:(v/=k/2)===2?w+T:(C||(C=k*(.3*1.5)),!S||S<Math.abs(T)?(S=T,h=C/4):h=C/(2*Math.PI)*Math.asin(T/S),v<1?-.5*(S*Math.pow(2,10*(v-=1))*Math.sin((v*k-h)*(2*Math.PI)/C))+w:S*Math.pow(2,-10*(v-=1))*Math.sin((v*k-h)*(2*Math.PI)/C)*.5+T+w)},BounceEaseOut(v,w,T,k){return(v/=k)<1/2.75?T*(7.5625*v*v)+w:v<2/2.75?T*(7.5625*(v-=1.5/2.75)*v+.75)+w:v<2.5/2.75?T*(7.5625*(v-=2.25/2.75)*v+.9375)+w:T*(7.5625*(v-=2.625/2.75)*v+.984375)+w},BounceEaseIn(v,w,T,k){return T-t.Easings.BounceEaseOut(k-v,0,T,k)+w},BounceEaseInOut(v,w,T,k){return v<k/2?t.Easings.BounceEaseIn(v*2,0,T,k)*.5+w:t.Easings.BounceEaseOut(v*2-k,0,T,k)*.5+T*.5+w},EaseIn(v,w,T,k){return T*(v/=k)*v+w},EaseOut(v,w,T,k){return-T*(v/=k)*(v-2)+w},EaseInOut(v,w,T,k){return(v/=k/2)<1?T/2*v*v+w:-T/2*(--v*(v-2)-1)+w},StrongEaseIn(v,w,T,k){return T*(v/=k)*v*v*v*v+w},StrongEaseOut(v,w,T,k){return T*((v=v/k-1)*v*v*v*v+1)+w},StrongEaseInOut(v,w,T,k){return(v/=k/2)<1?T/2*v*v*v*v*v+w:T/2*((v-=2)*v*v*v*v+2)+w},Linear(v,w,T,k){return T*v/k+w}}})(F5);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=ke,n=rt,r=Ze,i=ds,s=M5,l=dl,c=Zc,u=Mo,f=Kc,p=vt,m=Ro,x=F5,v=Dr,w=nr;t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:l.Layer,FastLayer:c.FastLayer,Group:u.Group,DD:f.DD,Shape:p.Shape,shapes:p.shapes,Animation:m.Animation,Tween:x.Tween,Easings:x.Easings,Context:v.Context,Canvas:w.Canvas}),t.default=t.Konva})(Cc);var qc={};Object.defineProperty(qc,"__esModule",{value:!0});qc.Arc=void 0;const Jc=Ee,MS=vt,s2=ke,ed=ye,RS=ke;class Hr extends MS.Shape{_sceneFunc(e){const n=s2.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,r),e.arc(0,0,this.innerRadius(),n,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),r=this.clockwise(),i=s2.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),l=1,c=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),u=Math.sin(Math.min(i,Math.PI/2)),f=s*(s>0?e:n),p=l*n,m=c*(c>0?e:n),x=u*(u>0?n:e);return{x:f,y:r?-1*x:m,width:p-f,height:x-m}}}qc.Arc=Hr;Hr.prototype._centroid=!0;Hr.prototype.className="Arc";Hr.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,RS._registerNode)(Hr);Jc.Factory.addGetterSetter(Hr,"innerRadius",0,(0,ed.getNumberValidator)());Jc.Factory.addGetterSetter(Hr,"outerRadius",0,(0,ed.getNumberValidator)());Jc.Factory.addGetterSetter(Hr,"angle",0,(0,ed.getNumberValidator)());Jc.Factory.addGetterSetter(Hr,"clockwise",!1,(0,ed.getBooleanValidator)());var td={},fl={};Object.defineProperty(fl,"__esModule",{value:!0});fl.Line=void 0;const nd=Ee,IS=ke,LS=vt,O5=ye;function ep(t,e,n,r,i,s,l){const c=Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2)),u=Math.sqrt(Math.pow(i-n,2)+Math.pow(s-r,2)),f=l*c/(c+u),p=l*u/(c+u),m=n-f*(i-t),x=r-f*(s-e),v=n+p*(i-t),w=r+p*(s-e);return[m,x,v,w]}function o2(t,e){const n=t.length,r=[];for(let i=2;i<n-2;i+=2){const s=ep(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e);isNaN(s[0])||(r.push(s[0]),r.push(s[1]),r.push(t[i]),r.push(t[i+1]),r.push(s[2]),r.push(s[3]))}return r}let Ii=class extends LS.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){let n=this.points(),r=n.length,i=this.tension(),s=this.closed(),l=this.bezier(),c,u,f;if(r){if(e.beginPath(),e.moveTo(n[0],n[1]),i!==0&&r>4){for(c=this.getTensionPoints(),u=c.length,f=s?0:4,s||e.quadraticCurveTo(c[0],c[1],c[2],c[3]);f<u-2;)e.bezierCurveTo(c[f++],c[f++],c[f++],c[f++],c[f++],c[f++]);s||e.quadraticCurveTo(c[u-2],c[u-1],n[r-2],n[r-1])}else if(l)for(f=2;f<r;)e.bezierCurveTo(n[f++],n[f++],n[f++],n[f++],n[f++],n[f++]);else for(f=2;f<r;f+=2)e.lineTo(n[f],n[f+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():o2(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),n=e.length,r=this.tension(),i=ep(e[n-2],e[n-1],e[0],e[1],e[2],e[3],r),s=ep(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],r),l=o2(e,r);return[i[2],i[3]].concat(l).concat([s[0],s[1],e[n-2],e[n-1],s[2],s[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let n=e[0],r=e[0],i=e[1],s=e[1],l,c;for(let u=0;u<e.length/2;u++)l=e[u*2],c=e[u*2+1],n=Math.min(n,l),r=Math.max(r,l),i=Math.min(i,c),s=Math.max(s,c);return{x:n,y:i,width:r-n,height:s-i}}};fl.Line=Ii;Ii.prototype.className="Line";Ii.prototype._attrsAffectingSize=["points","bezier","tension"];(0,IS._registerNode)(Ii);nd.Factory.addGetterSetter(Ii,"closed",!1);nd.Factory.addGetterSetter(Ii,"bezier",!1);nd.Factory.addGetterSetter(Ii,"tension",0,(0,O5.getNumberValidator)());nd.Factory.addGetterSetter(Ii,"points",[],(0,O5.getNumberArrayValidator)());var Io={},j5={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(l,c,u)=>{let f,p;const x=u/2;f=0;for(let v=0;v<20;v++)p=x*t.tValues[20][v]+x,f+=t.cValues[20][v]*r(l,c,p);return x*f};t.getCubicArcLength=e;const n=(l,c,u)=>{u===void 0&&(u=1);const f=l[0]-2*l[1]+l[2],p=c[0]-2*c[1]+c[2],m=2*l[1]-2*l[0],x=2*c[1]-2*c[0],v=4*(f*f+p*p),w=4*(f*m+p*x),T=m*m+x*x;if(v===0)return u*Math.sqrt(Math.pow(l[2]-l[0],2)+Math.pow(c[2]-c[0],2));const k=w/(2*v),S=T/v,C=u+k,h=S-k*k,_=C*C+h>0?Math.sqrt(C*C+h):0,E=k*k+h>0?Math.sqrt(k*k+h):0,P=k+Math.sqrt(k*k+h)!==0?h*Math.log(Math.abs((C+_)/(k+E))):0;return Math.sqrt(v)/2*(C*_-k*E+P)};t.getQuadraticArcLength=n;function r(l,c,u){const f=i(1,u,l),p=i(1,u,c),m=f*f+p*p;return Math.sqrt(m)}const i=(l,c,u)=>{const f=u.length-1;let p,m;if(f===0)return 0;if(l===0){m=0;for(let x=0;x<=f;x++)m+=t.binomialCoefficients[f][x]*Math.pow(1-c,f-x)*Math.pow(c,x)*u[x];return m}else{p=new Array(f);for(let x=0;x<f;x++)p[x]=f*(u[x+1]-u[x]);return i(l-1,c,p)}},s=(l,c,u)=>{let f=1,p=l/c,m=(l-u(p))/c,x=0;for(;f>.001;){const v=u(p+m),w=Math.abs(l-v)/c;if(w<f)f=w,p+=m;else{const T=u(p-m),k=Math.abs(l-T)/c;k<f?(f=k,p-=m):m/=2}if(x++,x>500)break}return p};t.t2length=s})(j5);Object.defineProperty(Io,"__esModule",{value:!0});Io.Path=void 0;const FS=Ee,OS=vt,jS=ke,Us=j5;class gt extends OS.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=gt.parsePathData(this.data()),this.pathLength=gt.getPathLength(this.dataArray)}_sceneFunc(e){const n=this.dataArray;e.beginPath();let r=!1;for(let T=0;T<n.length;T++){const k=n[T].command,S=n[T].points;switch(k){case"L":e.lineTo(S[0],S[1]);break;case"M":e.moveTo(S[0],S[1]);break;case"C":e.bezierCurveTo(S[0],S[1],S[2],S[3],S[4],S[5]);break;case"Q":e.quadraticCurveTo(S[0],S[1],S[2],S[3]);break;case"A":var i=S[0],s=S[1],l=S[2],c=S[3],u=S[4],f=S[5],p=S[6],m=S[7],x=l>c?l:c,v=l>c?1:l/c,w=l>c?c/l:1;e.translate(i,s),e.rotate(p),e.scale(v,w),e.arc(0,0,x,u,u+f,1-m),e.scale(1/v,1/w),e.rotate(-p),e.translate(-i,-s);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],p=u.points[5],m=u.points[4]+p;let x=Math.PI/180;if(Math.abs(f-m)<x&&(x=Math.abs(f-m)),p<0)for(let v=f-x;v>m;v-=x){const w=gt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);e.push(w.x,w.y)}else for(let v=f+x;v<m;v+=x){const w=gt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],v,0);e.push(w.x,w.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const p=gt.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);e.push(p.x,p.y)}else e=e.concat(u.points)});let n=e[0],r=e[0],i=e[1],s=e[1],l,c;for(let u=0;u<e.length/2;u++)l=e[u*2],c=e[u*2+1],isNaN(l)||(n=Math.min(n,l),r=Math.max(r,l)),isNaN(c)||(i=Math.min(i,c),s=Math.max(s,c));return{x:n,y:i,width:r-n,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return gt.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,n,r,i){return Math.sqrt((r-e)*(r-e)+(i-n)*(i-n))}static getPathLength(e){let n=0;for(let r=0;r<e.length;++r)n+=e[r].pathLength;return n}static getPointAtLengthOfDataArray(e,n){let r,i=0,s=n.length;if(!s)return null;for(;i<s&&e>n[i].pathLength;)e-=n[i].pathLength,++i;if(i===s)return r=n[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return r=n[i].points.slice(0,2),{x:r[0],y:r[1]};const l=n[i],c=l.points;switch(l.command){case"L":return gt.getPointOnLine(e,l.start.x,l.start.y,c[0],c[1]);case"C":return gt.getPointOnCubicBezier((0,Us.t2length)(e,gt.getPathLength(n),T=>(0,Us.getCubicArcLength)([l.start.x,c[0],c[2],c[4]],[l.start.y,c[1],c[3],c[5]],T)),l.start.x,l.start.y,c[0],c[1],c[2],c[3],c[4],c[5]);case"Q":return gt.getPointOnQuadraticBezier((0,Us.t2length)(e,gt.getPathLength(n),T=>(0,Us.getQuadraticArcLength)([l.start.x,c[0],c[2]],[l.start.y,c[1],c[3]],T)),l.start.x,l.start.y,c[0],c[1],c[2],c[3]);case"A":var u=c[0],f=c[1],p=c[2],m=c[3],x=c[4],v=c[5],w=c[6];return x+=v*e/l.pathLength,gt.getPointOnEllipticalArc(u,f,p,m,x,w)}return null}static getPointOnLine(e,n,r,i,s,l,c){l=l??n,c=c??r;const u=this.getLineLength(n,r,i,s);if(u<1e-10)return{x:n,y:r};if(i===n)return{x:l,y:c+(s>r?e:-e)};const f=(s-r)/(i-n),p=Math.sqrt(e*e/(1+f*f))*(i<n?-1:1),m=f*p;if(Math.abs(c-r-f*(l-n))<1e-10)return{x:l+p,y:c+m};const x=((l-n)*(i-n)+(c-r)*(s-r))/(u*u),v=n+x*(i-n),w=r+x*(s-r),T=this.getLineLength(l,c,v,w),k=Math.sqrt(e*e-T*T),S=Math.sqrt(k*k/(1+f*f))*(i<n?-1:1),C=f*S;return{x:v+S,y:w+C}}static getPointOnCubicBezier(e,n,r,i,s,l,c,u,f){function p(k){return k*k*k}function m(k){return 3*k*k*(1-k)}function x(k){return 3*k*(1-k)*(1-k)}function v(k){return(1-k)*(1-k)*(1-k)}const w=u*p(e)+l*m(e)+i*x(e)+n*v(e),T=f*p(e)+c*m(e)+s*x(e)+r*v(e);return{x:w,y:T}}static getPointOnQuadraticBezier(e,n,r,i,s,l,c){function u(v){return v*v}function f(v){return 2*v*(1-v)}function p(v){return(1-v)*(1-v)}const m=l*u(e)+i*f(e)+n*p(e),x=c*u(e)+s*f(e)+r*p(e);return{x:m,y:x}}static getPointOnEllipticalArc(e,n,r,i,s,l){const c=Math.cos(l),u=Math.sin(l),f={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(f.x*c-f.y*u),y:n+(f.x*u+f.y*c)}}static parsePathData(e){if(!e)return[];let n=e;const r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(var i=0;i<r.length;i++)n=n.replace(new RegExp(r[i],"g"),"|"+r[i]);const s=n.split("|"),l=[],c=[];let u=0,f=0;const p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let m;for(i=1;i<s.length;i++){let A=s[i],F=A.charAt(0);for(A=A.slice(1),c.length=0;m=p.exec(A);)c.push(m[0]);const N=[];for(let R=0,D=c.length;R<D;R++){if(c[R]==="00"){N.push(0,0);continue}const V=parseFloat(c[R]);isNaN(V)?N.push(0):N.push(V)}for(;N.length>0&&!isNaN(N[0]);){let R="",D=[];const V=u,j=f;var x,v,w,T,k,S,C,h,_,E;switch(F){case"l":u+=N.shift(),f+=N.shift(),R="L",D.push(u,f);break;case"L":u=N.shift(),f=N.shift(),D.push(u,f);break;case"m":var P=N.shift(),I=N.shift();if(u+=P,f+=I,R="M",l.length>2&&l[l.length-1].command==="z"){for(let z=l.length-2;z>=0;z--)if(l[z].command==="M"){u=l[z].points[0]+P,f=l[z].points[1]+I;break}}D.push(u,f),F="l";break;case"M":u=N.shift(),f=N.shift(),R="M",D.push(u,f),F="L";break;case"h":u+=N.shift(),R="L",D.push(u,f);break;case"H":u=N.shift(),R="L",D.push(u,f);break;case"v":f+=N.shift(),R="L",D.push(u,f);break;case"V":f=N.shift(),R="L",D.push(u,f);break;case"C":D.push(N.shift(),N.shift(),N.shift(),N.shift()),u=N.shift(),f=N.shift(),D.push(u,f);break;case"c":D.push(u+N.shift(),f+N.shift(),u+N.shift(),f+N.shift()),u+=N.shift(),f+=N.shift(),R="C",D.push(u,f);break;case"S":v=u,w=f,x=l[l.length-1],x.command==="C"&&(v=u+(u-x.points[2]),w=f+(f-x.points[3])),D.push(v,w,N.shift(),N.shift()),u=N.shift(),f=N.shift(),R="C",D.push(u,f);break;case"s":v=u,w=f,x=l[l.length-1],x.command==="C"&&(v=u+(u-x.points[2]),w=f+(f-x.points[3])),D.push(v,w,u+N.shift(),f+N.shift()),u+=N.shift(),f+=N.shift(),R="C",D.push(u,f);break;case"Q":D.push(N.shift(),N.shift()),u=N.shift(),f=N.shift(),D.push(u,f);break;case"q":D.push(u+N.shift(),f+N.shift()),u+=N.shift(),f+=N.shift(),R="Q",D.push(u,f);break;case"T":v=u,w=f,x=l[l.length-1],x.command==="Q"&&(v=u+(u-x.points[0]),w=f+(f-x.points[1])),u=N.shift(),f=N.shift(),R="Q",D.push(v,w,u,f);break;case"t":v=u,w=f,x=l[l.length-1],x.command==="Q"&&(v=u+(u-x.points[0]),w=f+(f-x.points[1])),u+=N.shift(),f+=N.shift(),R="Q",D.push(v,w,u,f);break;case"A":T=N.shift(),k=N.shift(),S=N.shift(),C=N.shift(),h=N.shift(),_=u,E=f,u=N.shift(),f=N.shift(),R="A",D=this.convertEndpointToCenterParameterization(_,E,u,f,C,h,T,k,S);break;case"a":T=N.shift(),k=N.shift(),S=N.shift(),C=N.shift(),h=N.shift(),_=u,E=f,u+=N.shift(),f+=N.shift(),R="A",D=this.convertEndpointToCenterParameterization(_,E,u,f,C,h,T,k,S);break}l.push({command:R||F,points:D,start:{x:V,y:j},pathLength:this.calcLength(V,j,R||F,D)})}(F==="z"||F==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(e,n,r,i){let s,l,c,u;const f=gt;switch(r){case"L":return f.getLineLength(e,n,i[0],i[1]);case"C":return(0,Us.getCubicArcLength)([e,i[0],i[2],i[4]],[n,i[1],i[3],i[5]],1);case"Q":return(0,Us.getQuadraticArcLength)([e,i[0],i[2]],[n,i[1],i[3]],1);case"A":s=0;var p=i[4],m=i[5],x=i[4]+m,v=Math.PI/180;if(Math.abs(p-x)<v&&(v=Math.abs(p-x)),l=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),m<0)for(u=p-v;u>x;u-=v)c=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),s+=f.getLineLength(l.x,l.y,c.x,c.y),l=c;else for(u=p+v;u<x;u+=v)c=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),s+=f.getLineLength(l.x,l.y,c.x,c.y),l=c;return c=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],x,0),s+=f.getLineLength(l.x,l.y,c.x,c.y),s}return 0}static convertEndpointToCenterParameterization(e,n,r,i,s,l,c,u,f){const p=f*(Math.PI/180),m=Math.cos(p)*(e-r)/2+Math.sin(p)*(n-i)/2,x=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(n-i)/2,v=m*m/(c*c)+x*x/(u*u);v>1&&(c*=Math.sqrt(v),u*=Math.sqrt(v));let w=Math.sqrt((c*c*(u*u)-c*c*(x*x)-u*u*(m*m))/(c*c*(x*x)+u*u*(m*m)));s===l&&(w*=-1),isNaN(w)&&(w=0);const T=w*c*x/u,k=w*-u*m/c,S=(e+r)/2+Math.cos(p)*T-Math.sin(p)*k,C=(n+i)/2+Math.sin(p)*T+Math.cos(p)*k,h=function(N){return Math.sqrt(N[0]*N[0]+N[1]*N[1])},_=function(N,R){return(N[0]*R[0]+N[1]*R[1])/(h(N)*h(R))},E=function(N,R){return(N[0]*R[1]<N[1]*R[0]?-1:1)*Math.acos(_(N,R))},P=E([1,0],[(m-T)/c,(x-k)/u]),I=[(m-T)/c,(x-k)/u],A=[(-1*m-T)/c,(-1*x-k)/u];let F=E(I,A);return _(I,A)<=-1&&(F=Math.PI),_(I,A)>=1&&(F=0),l===0&&F>0&&(F=F-2*Math.PI),l===1&&F<0&&(F=F+2*Math.PI),[S,C,c,u,P,F,p,l]}}Io.Path=gt;gt.prototype.className="Path";gt.prototype._attrsAffectingSize=["data"];(0,jS._registerNode)(gt);FS.Factory.addGetterSetter(gt,"data");Object.defineProperty(td,"__esModule",{value:!0});td.Arrow=void 0;const rd=Ee,DS=fl,D5=ye,zS=ke,a2=Io;let hs=class extends DS.Line{_sceneFunc(e){super._sceneFunc(e);const n=Math.PI*2,r=this.points();let i=r;const s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());const l=this.pointerLength(),c=r.length;let u,f;if(s){const x=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[c-2],r[c-1]],v=a2.Path.calcLength(i[i.length-4],i[i.length-3],"C",x),w=a2.Path.getPointOnQuadraticBezier(Math.min(1,1-l/v),x[0],x[1],x[2],x[3],x[4],x[5]);u=r[c-2]-w.x,f=r[c-1]-w.y}else u=r[c-2]-r[c-4],f=r[c-1]-r[c-3];const p=(Math.atan2(f,u)+n)%n,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[c-2],r[c-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-l,m/2),e.lineTo(-l,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(u=(i[0]+i[2])/2-r[0],f=(i[1]+i[3])/2-r[1]):(u=r[2]-r[0],f=r[3]-r[1]),e.rotate((Math.atan2(-f,-u)+n)%n),e.moveTo(0,0),e.lineTo(-l,m/2),e.lineTo(-l,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x,y:e.y-n,width:e.width,height:e.height+n*2}}};td.Arrow=hs;hs.prototype.className="Arrow";(0,zS._registerNode)(hs);rd.Factory.addGetterSetter(hs,"pointerLength",10,(0,D5.getNumberValidator)());rd.Factory.addGetterSetter(hs,"pointerWidth",10,(0,D5.getNumberValidator)());rd.Factory.addGetterSetter(hs,"pointerAtBeginning",!1);rd.Factory.addGetterSetter(hs,"pointerAtEnding",!0);var id={};Object.defineProperty(id,"__esModule",{value:!0});id.Circle=void 0;const BS=Ee,US=vt,GS=ye,VS=ke;let Lo=class extends US.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};id.Circle=Lo;Lo.prototype._centroid=!0;Lo.prototype.className="Circle";Lo.prototype._attrsAffectingSize=["radius"];(0,VS._registerNode)(Lo);BS.Factory.addGetterSetter(Lo,"radius",0,(0,GS.getNumberValidator)());var sd={};Object.defineProperty(sd,"__esModule",{value:!0});sd.Ellipse=void 0;const dg=Ee,WS=vt,z5=ye,$S=ke;class Li extends WS.Shape{_sceneFunc(e){const n=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),n!==r&&e.scale(1,r/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}sd.Ellipse=Li;Li.prototype.className="Ellipse";Li.prototype._centroid=!0;Li.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,$S._registerNode)(Li);dg.Factory.addComponentsGetterSetter(Li,"radius",["x","y"]);dg.Factory.addGetterSetter(Li,"radiusX",0,(0,z5.getNumberValidator)());dg.Factory.addGetterSetter(Li,"radiusY",0,(0,z5.getNumberValidator)());var od={};Object.defineProperty(od,"__esModule",{value:!0});od.Image=void 0;const Gh=rt,ps=Ee,HS=vt,XS=ke,hl=ye;class Bn extends HS.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),n=this.hasShadow();return e&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let l;if(s){const c=this.attrs.cropWidth,u=this.attrs.cropHeight;c&&u?l=[s,this.cropX(),this.cropY(),c,u,0,0,n,r]:l=[s,0,0,n,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?Gh.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,l))}_hitFunc(e){const n=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?Gh.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n;return(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width}getHeight(){var e,n;return(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height}static fromURL(e,n,r=null){const i=Gh.Util.createImageElement();i.onload=function(){const s=new Bn({image:i});n(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}}od.Image=Bn;Bn.prototype.className="Image";(0,XS._registerNode)(Bn);ps.Factory.addGetterSetter(Bn,"cornerRadius",0,(0,hl.getNumberOrArrayOfNumbersValidator)(4));ps.Factory.addGetterSetter(Bn,"image");ps.Factory.addComponentsGetterSetter(Bn,"crop",["x","y","width","height"]);ps.Factory.addGetterSetter(Bn,"cropX",0,(0,hl.getNumberValidator)());ps.Factory.addGetterSetter(Bn,"cropY",0,(0,hl.getNumberValidator)());ps.Factory.addGetterSetter(Bn,"cropWidth",0,(0,hl.getNumberValidator)());ps.Factory.addGetterSetter(Bn,"cropHeight",0,(0,hl.getNumberValidator)());var wo={};Object.defineProperty(wo,"__esModule",{value:!0});wo.Tag=wo.Label=void 0;const ad=Ee,YS=vt,KS=Mo,fg=ye,B5=ke,U5=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],QS="Change.konva",ZS="none",tp="up",np="right",rp="down",ip="left",qS=U5.length;class hg extends KS.Group{constructor(e){super(e),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let n=this,r;const i=function(){n._sync()};for(r=0;r<qS;r++)e.on(U5[r]+QS,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),n=this.getTag(),r,i,s,l,c,u,f;if(e&&n){switch(r=e.width(),i=e.height(),s=n.pointerDirection(),l=n.pointerWidth(),f=n.pointerHeight(),c=0,u=0,s){case tp:c=r/2,u=-1*f;break;case np:c=r+l,u=i/2;break;case rp:c=r/2,u=i+f;break;case ip:c=-1*l,u=i/2;break}n.setAttrs({x:-1*c,y:-1*u,width:r,height:i}),e.setAttrs({x:-1*c,y:-1*u})}}}wo.Label=hg;hg.prototype.className="Label";(0,B5._registerNode)(hg);class gs extends YS.Shape{_sceneFunc(e){const n=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),l=this.pointerHeight(),c=this.cornerRadius();let u=0,f=0,p=0,m=0;typeof c=="number"?u=f=p=m=Math.min(c,n/2,r/2):(u=Math.min(c[0]||0,n/2,r/2),f=Math.min(c[1]||0,n/2,r/2),m=Math.min(c[2]||0,n/2,r/2),p=Math.min(c[3]||0,n/2,r/2)),e.beginPath(),e.moveTo(u,0),i===tp&&(e.lineTo((n-s)/2,0),e.lineTo(n/2,-1*l),e.lineTo((n+s)/2,0)),e.lineTo(n-f,0),e.arc(n-f,f,f,Math.PI*3/2,0,!1),i===np&&(e.lineTo(n,(r-l)/2),e.lineTo(n+s,r/2),e.lineTo(n,(r+l)/2)),e.lineTo(n,r-m),e.arc(n-m,r-m,m,0,Math.PI/2,!1),i===rp&&(e.lineTo((n+s)/2,r),e.lineTo(n/2,r+l),e.lineTo((n-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===ip&&(e.lineTo(0,(r+l)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-l)/2)),e.lineTo(0,u),e.arc(u,u,u,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,n=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),l=this.width(),c=this.height();return s===tp?(n-=i,c+=i):s===rp?c+=i:s===ip?(e-=r*1.5,l+=r):s===np&&(l+=r*1.5),{x:e,y:n,width:l,height:c}}}wo.Tag=gs;gs.prototype.className="Tag";(0,B5._registerNode)(gs);ad.Factory.addGetterSetter(gs,"pointerDirection",ZS);ad.Factory.addGetterSetter(gs,"pointerWidth",0,(0,fg.getNumberValidator)());ad.Factory.addGetterSetter(gs,"pointerHeight",0,(0,fg.getNumberValidator)());ad.Factory.addGetterSetter(gs,"cornerRadius",0,(0,fg.getNumberOrArrayOfNumbersValidator)(4));var pl={};Object.defineProperty(pl,"__esModule",{value:!0});pl.Rect=void 0;const JS=Ee,ek=vt,tk=ke,nk=rt,rk=ye;let ld=class extends ek.Shape{_sceneFunc(e){const n=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),n?nk.Util.drawRoundedRectPath(e,r,i,n):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};pl.Rect=ld;ld.prototype.className="Rect";(0,tk._registerNode)(ld);JS.Factory.addGetterSetter(ld,"cornerRadius",0,(0,rk.getNumberOrArrayOfNumbersValidator)(4));var ud={};Object.defineProperty(ud,"__esModule",{value:!0});ud.RegularPolygon=void 0;const G5=Ee,ik=vt,V5=ye,sk=ke;class ms extends ik.Shape{_sceneFunc(e){const n=this._getPoints();e.beginPath(),e.moveTo(n[0].x,n[0].y);for(let r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,r=[];for(let i=0;i<e;i++)r.push({x:n*Math.sin(i*2*Math.PI/e),y:-1*n*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();let n=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(l=>{n=Math.min(n,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),s=Math.max(s,l.y)}),{x:n,y:i,width:r-n,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}ud.RegularPolygon=ms;ms.prototype.className="RegularPolygon";ms.prototype._centroid=!0;ms.prototype._attrsAffectingSize=["radius"];(0,sk._registerNode)(ms);G5.Factory.addGetterSetter(ms,"radius",0,(0,V5.getNumberValidator)());G5.Factory.addGetterSetter(ms,"sides",0,(0,V5.getNumberValidator)());var cd={};Object.defineProperty(cd,"__esModule",{value:!0});cd.Ring=void 0;const W5=Ee,ok=vt,$5=ye,ak=ke,l2=Math.PI*2;class ys extends ok.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,l2,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),l2,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}cd.Ring=ys;ys.prototype.className="Ring";ys.prototype._centroid=!0;ys.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,ak._registerNode)(ys);W5.Factory.addGetterSetter(ys,"innerRadius",0,(0,$5.getNumberValidator)());W5.Factory.addGetterSetter(ys,"outerRadius",0,(0,$5.getNumberValidator)());var dd={};Object.defineProperty(dd,"__esModule",{value:!0});dd.Sprite=void 0;const vs=Ee,lk=vt,uk=Ro,H5=ye,ck=ke;class kr extends lk.Shape{constructor(e){super(e),this._updated=!0,this.anim=new uk.Animation(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const n=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[n],l=this.frameOffsets(),c=s[i+0],u=s[i+1],f=s[i+2],p=s[i+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,f,p),e.closePath(),e.fillStrokeShape(this)),m)if(l){const x=l[n],v=r*2;e.drawImage(m,c,u,f,p,x[v+0],x[v+1],f,p)}else e.drawImage(m,c,u,f,p,0,0,f,p)}_hitFunc(e){const n=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[n],l=this.frameOffsets(),c=s[i+2],u=s[i+3];if(e.beginPath(),l){const f=l[n],p=r*2;e.rect(f[p+0],f[p+1],c,u)}else e.rect(0,0,c,u);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),n=this.animation(),r=this.animations(),i=r[n],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}dd.Sprite=kr;kr.prototype.className="Sprite";(0,ck._registerNode)(kr);vs.Factory.addGetterSetter(kr,"animation");vs.Factory.addGetterSetter(kr,"animations");vs.Factory.addGetterSetter(kr,"frameOffsets");vs.Factory.addGetterSetter(kr,"image");vs.Factory.addGetterSetter(kr,"frameIndex",0,(0,H5.getNumberValidator)());vs.Factory.addGetterSetter(kr,"frameRate",17,(0,H5.getNumberValidator)());vs.Factory.backCompat(kr,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var fd={};Object.defineProperty(fd,"__esModule",{value:!0});fd.Star=void 0;const pg=Ee,dk=vt,gg=ye,fk=ke;class Fi extends dk.Shape{_sceneFunc(e){const n=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(let s=1;s<i*2;s++){const l=s%2===0?r:n,c=l*Math.sin(s*Math.PI/i),u=-1*l*Math.cos(s*Math.PI/i);e.lineTo(c,u)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}fd.Star=Fi;Fi.prototype.className="Star";Fi.prototype._centroid=!0;Fi.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,fk._registerNode)(Fi);pg.Factory.addGetterSetter(Fi,"numPoints",5,(0,gg.getNumberValidator)());pg.Factory.addGetterSetter(Fi,"innerRadius",0,(0,gg.getNumberValidator)());pg.Factory.addGetterSetter(Fi,"outerRadius",0,(0,gg.getNumberValidator)());var Fo={};Object.defineProperty(Fo,"__esModule",{value:!0});Fo.Text=void 0;Fo.stringToArray=qi;const sp=rt,Ht=Ee,hk=vt,Vh=ke,Oi=ye,pk=ke;function qi(t){return[...t].reduce((e,n,r,i)=>{if(/\p{Emoji}/u.test(n)){const s=i[r+1];s&&/\p{Emoji_Modifier}|\u200D/u.test(s)?(e.push(n+s),i[r+1]=""):e.push(n)}else/\p{Regional_Indicator}{2}/u.test(n+(i[r+1]||""))?e.push(n+i[r+1]):r>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(n)?e[e.length-1]+=n:n&&e.push(n);return e},[])}const Gs="auto",gk="center",X5="inherit",pa="justify",mk="Change.konva",yk="2d",u2="-",Y5="left",vk="text",xk="Text",wk="top",_k="bottom",c2="middle",K5="normal",Sk="px ",Pu=" ",kk="right",d2="rtl",Ck="word",Ek="char",f2="none",Wh="",Q5=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Tk=Q5.length;function bk(t){return t.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!r&&(e=`"${e}"`),e}).join(", ")}let Nu;function $h(){return Nu||(Nu=sp.Util.createCanvasElement().getContext(yk),Nu)}function Pk(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Nk(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Ak(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let ot=class extends hk.Shape{constructor(e){super(Ak(e)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<Tk;n++)this.on(Q5[n]+mk,this._setTextData);this._setTextData()}_sceneFunc(e){const n=this.textArr,r=n.length;if(!this.text())return;let i=this.padding(),s=this.fontSize(),l=this.lineHeight()*s,c=this.verticalAlign(),u=this.direction(),f=0,p=this.align(),m=this.getWidth(),x=this.letterSpacing(),v=this.fill(),w=this.textDecoration(),T=w.indexOf("underline")!==-1,k=w.indexOf("line-through")!==-1,S;u=u===X5?e.direction:u;let C=l/2,h=c2;if(Vh.Konva._fixTextRendering){const D=this.measureSize("M");h="alphabetic",C=(D.fontBoundingBoxAscent-D.fontBoundingBoxDescent)/2+l/2}var _=0,E=0;for(u===d2&&e.setAttr("direction",u),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",h),e.setAttr("textAlign",Y5),c===c2?f=(this.getHeight()-r*l-i*2)/2:c===_k&&(f=this.getHeight()-r*l-i*2),e.translate(i,f+i),S=0;S<r;S++){var _=0,E=0,P=n[S],I=P.text,A=P.width,F=P.lastInParagraph,N,R;if(e.save(),p===kk?_+=m-A-i*2:p===gk&&(_+=(m-A-i*2)/2),T){e.save(),e.beginPath();const j=Vh.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),z=_,G=C+E+j;e.moveTo(z,G),N=I.split(" ").length-1,R=p===pa&&!F?m-i*2:A,e.lineTo(z+Math.round(R),G),e.lineWidth=s/15;const Y=this._getLinearGradient();e.strokeStyle=Y||v,e.stroke(),e.restore()}if(k){e.save(),e.beginPath();const j=Vh.Konva._fixTextRendering?-Math.round(s/4):0;e.moveTo(_,C+E+j),N=I.split(" ").length-1,R=p===pa&&!F?m-i*2:A,e.lineTo(_+Math.round(R),C+E+j),e.lineWidth=s/15;const z=this._getLinearGradient();e.strokeStyle=z||v,e.stroke(),e.restore()}if(u!==d2&&(x!==0||p===pa)){N=I.split(" ").length-1;const j=qi(I);for(let z=0;z<j.length;z++){const G=j[z];G===" "&&!F&&p===pa&&(_+=(m-i*2-A)/N),this._partialTextX=_,this._partialTextY=C+E,this._partialText=G,e.fillStrokeShape(this),_+=this.measureSize(G).width+x}}else x!==0&&e.setAttr("letterSpacing",`${x}px`),this._partialTextX=_,this._partialTextY=C+E,this._partialText=I,e.fillStrokeShape(this);e.restore(),r>1&&(C+=l)}}_hitFunc(e){const n=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}setText(e){const n=sp.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(vk,n),this}getWidth(){return this.attrs.width===Gs||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Gs||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return sp.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n,r,i,s,l,c,u,f,p,m,x;let v=$h(),w=this.fontSize(),T;v.save(),v.font=this._getContextFont(),T=v.measureText(e),v.restore();const k=w/100;return{actualBoundingBoxAscent:(n=T.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*k,actualBoundingBoxDescent:(r=T.actualBoundingBoxDescent)!==null&&r!==void 0?r:0,actualBoundingBoxLeft:(i=T.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*k,actualBoundingBoxRight:(s=T.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*k,alphabeticBaseline:(l=T.alphabeticBaseline)!==null&&l!==void 0?l:0,emHeightAscent:(c=T.emHeightAscent)!==null&&c!==void 0?c:100*k,emHeightDescent:(u=T.emHeightDescent)!==null&&u!==void 0?u:-20*k,fontBoundingBoxAscent:(f=T.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*k,fontBoundingBoxDescent:(p=T.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*k,hangingBaseline:(m=T.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*k,ideographicBaseline:(x=T.ideographicBaseline)!==null&&x!==void 0?x:-21*k,width:T.width,height:w}}_getContextFont(){return this.fontStyle()+Pu+this.fontVariant()+Pu+(this.fontSize()+Sk)+bk(this.fontFamily())}_addTextLine(e){this.align()===pa&&(e=e.trim());const r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){const n=this.letterSpacing(),r=e.length;return $h().measureText(e).width+n*r}_setTextData(){let e=this.text().split(`
`),n=+this.fontSize(),r=0,i=this.lineHeight()*n,s=this.attrs.width,l=this.attrs.height,c=s!==Gs&&s!==void 0,u=l!==Gs&&l!==void 0,f=this.padding(),p=s-f*2,m=l-f*2,x=0,v=this.wrap(),w=v!==f2,T=v!==Ek&&w,k=this.ellipsis();this.textArr=[],$h().font=this._getContextFont();const S=k?this._getTextWidth(Wh):0;for(let C=0,h=e.length;C<h;++C){let _=e[C],E=this._getTextWidth(_);if(c&&E>p)for(;_.length>0;){let P=0,I=qi(_).length,A="",F=0;for(;P<I;){const N=P+I>>>1,R=qi(_),D=R.slice(0,N+1).join(""),V=this._getTextWidth(D);(k&&u&&x+i>m?V+S:V)<=p?(P=N+1,A=D,F=V):I=N}if(A){if(T){const D=qi(_),V=qi(A),j=D[V.length],z=j===Pu||j===u2;let G;if(z&&F<=p)G=V.length;else{const Y=V.lastIndexOf(Pu),O=V.lastIndexOf(u2);G=Math.max(Y,O)+1}G>0&&(P=G,A=D.slice(0,P).join(""),F=this._getTextWidth(A))}if(A=A.trimRight(),this._addTextLine(A),r=Math.max(r,F),x+=i,this._shouldHandleEllipsis(x)){this._tryToAddEllipsisToLastLine();break}if(_=qi(_).slice(P).join("").trimLeft(),_.length>0&&(E=this._getTextWidth(_),E<=p)){this._addTextLine(_),x+=i,r=Math.max(r,E);break}}else break}else this._addTextLine(_),x+=i,r=Math.max(r,E),this._shouldHandleEllipsis(x)&&C<h-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&x+i>m)break}this.textHeight=n,this.textWidth=r}_shouldHandleEllipsis(e){const n=+this.fontSize(),r=this.lineHeight()*n,i=this.attrs.height,s=i!==Gs&&i!==void 0,l=this.padding(),c=i-l*2;return!(this.wrap()!==f2)||s&&e+r>c}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,n=e!==Gs&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),l=this.textArr[this.textArr.length-1];!l||!s||(n&&(this._getTextWidth(l.text+Wh)<i||(l.text=l.text.slice(0,l.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(l.text+Wh))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return e&&n?!0:super._useBufferCanvas()}};Fo.Text=ot;ot.prototype._fillFunc=Pk;ot.prototype._strokeFunc=Nk;ot.prototype.className=xk;ot.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,pk._registerNode)(ot);Ht.Factory.overWriteSetter(ot,"width",(0,Oi.getNumberOrAutoValidator)());Ht.Factory.overWriteSetter(ot,"height",(0,Oi.getNumberOrAutoValidator)());Ht.Factory.addGetterSetter(ot,"direction",X5);Ht.Factory.addGetterSetter(ot,"fontFamily","Arial");Ht.Factory.addGetterSetter(ot,"fontSize",12,(0,Oi.getNumberValidator)());Ht.Factory.addGetterSetter(ot,"fontStyle",K5);Ht.Factory.addGetterSetter(ot,"fontVariant",K5);Ht.Factory.addGetterSetter(ot,"padding",0,(0,Oi.getNumberValidator)());Ht.Factory.addGetterSetter(ot,"align",Y5);Ht.Factory.addGetterSetter(ot,"verticalAlign",wk);Ht.Factory.addGetterSetter(ot,"lineHeight",1,(0,Oi.getNumberValidator)());Ht.Factory.addGetterSetter(ot,"wrap",Ck);Ht.Factory.addGetterSetter(ot,"ellipsis",!1,(0,Oi.getBooleanValidator)());Ht.Factory.addGetterSetter(ot,"letterSpacing",0,(0,Oi.getNumberValidator)());Ht.Factory.addGetterSetter(ot,"text","",(0,Oi.getStringValidator)());Ht.Factory.addGetterSetter(ot,"textDecoration","");var hd={};Object.defineProperty(hd,"__esModule",{value:!0});hd.TextPath=void 0;const Hh=rt,ir=Ee,Mk=vt,ga=Io,Xh=Fo,Z5=ye,Rk=ke,Ik="",q5="normal";function J5(t){t.fillText(this.partialText,0,0)}function e4(t){t.strokeText(this.partialText,0,0)}class xt extends Mk.Shape{constructor(e){super(e),this.dummyCanvas=Hh.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return ga.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const n=this.pathLength;return e-1>n?null:ga.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=ga.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const n=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;n==="underline"&&e.beginPath();for(let l=0;l<s.length;l++){e.save();const c=s[l].p0;e.translate(c.x,c.y),e.rotate(s[l].rotation),this.partialText=s[l].text,e.fillStrokeShape(this),n==="underline"&&(l===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}n==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const n=this.glyphInfo;if(n.length>=1){const r=n[0].p0;e.moveTo(r.x,r.y)}for(let r=0;r<n.length;r++){const i=n[r].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Hh.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Xh.Text.prototype.setText.call(this,e)}_getContextFont(){return Xh.Text.prototype._getContextFont.call(this)}_getTextSize(e){const r=this.dummyCanvas.getContext("2d");r.save(),r.font=this._getContextFont();const i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:n}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=n,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),l=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let c=0;i==="center"&&(c=Math.max(0,this.pathLength/2-l/2)),i==="right"&&(c=Math.max(0,this.pathLength-l));const u=(0,Xh.stringToArray)(this.text());let f=c;for(let p=0;p<u.length;p++){const m=this._getPointAtLength(f);if(!m)return;let x=this._getTextSize(u[p]).width+r;if(u[p]===" "&&i==="justify"){const C=this.text().split(" ").length-1;x+=(this.pathLength-l)/C}const v=this._getPointAtLength(f+x);if(!v)return;const w=ga.Path.getLineLength(m.x,m.y,v.x,v.y);let T=0;if(s)try{T=s(u[p-1],u[p])*this.fontSize()}catch{T=0}m.x+=T,v.x+=T,this.textWidth+=T;const k=ga.Path.getPointOnLine(T+w/2,m.x,m.y,v.x,v.y),S=Math.atan2(v.y-m.y,v.x-m.x);this.glyphInfo.push({transposeX:k.x,transposeY:k.y,text:u[p],rotation:S,p0:m,p1:v}),f+=x}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(f){e.push(f.p0.x),e.push(f.p0.y),e.push(f.p1.x),e.push(f.p1.y)});let n=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,l,c;for(let f=0;f<e.length/2;f++)l=e[f*2],c=e[f*2+1],n=Math.min(n,l),r=Math.max(r,l),i=Math.min(i,c),s=Math.max(s,c);const u=this.fontSize();return{x:n-u/2,y:i-u/2,width:r-n+u,height:s-i+u}}destroy(){return Hh.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}hd.TextPath=xt;xt.prototype._fillFunc=J5;xt.prototype._strokeFunc=e4;xt.prototype._fillFuncHit=J5;xt.prototype._strokeFuncHit=e4;xt.prototype.className="TextPath";xt.prototype._attrsAffectingSize=["text","fontSize","data"];(0,Rk._registerNode)(xt);ir.Factory.addGetterSetter(xt,"data");ir.Factory.addGetterSetter(xt,"fontFamily","Arial");ir.Factory.addGetterSetter(xt,"fontSize",12,(0,Z5.getNumberValidator)());ir.Factory.addGetterSetter(xt,"fontStyle",q5);ir.Factory.addGetterSetter(xt,"align","left");ir.Factory.addGetterSetter(xt,"letterSpacing",0,(0,Z5.getNumberValidator)());ir.Factory.addGetterSetter(xt,"textBaseline","middle");ir.Factory.addGetterSetter(xt,"fontVariant",q5);ir.Factory.addGetterSetter(xt,"text",Ik);ir.Factory.addGetterSetter(xt,"textDecoration","");ir.Factory.addGetterSetter(xt,"kerningFunc",void 0);var pd={};Object.defineProperty(pd,"__esModule",{value:!0});pd.Transformer=void 0;const De=rt,Oe=Ee,h2=Ze,Lk=vt,Fk=pl,p2=Mo,Yn=ke,ji=ye,Ok=ke,t4="tr-konva",jk=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${t4}`).join(" "),g2="nodesRect",Dk=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],zk={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Bk="ontouchstart"in Yn.Konva._global;function Uk(t,e,n){if(t==="rotater")return n;e+=De.Util.degToRad(zk[t]||0);const r=(De.Util.radToDeg(e)%360+360)%360;return De.Util._inRange(r,315+22.5,360)||De.Util._inRange(r,0,22.5)?"ns-resize":De.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":De.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":De.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":De.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":De.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":De.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":De.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(De.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}const Tc=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],m2=1e8;function Gk(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function n4(t,e,n){const r=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),i=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:r,y:i}}function Vk(t,e){const n=Gk(t);return n4(t,e,n)}function Wk(t,e,n){let r=e;for(let i=0;i<t.length;i++){const s=Yn.Konva.getAngle(t[i]),l=Math.abs(s-e)%(Math.PI*2);Math.min(l,Math.PI*2-l)<n&&(r=s)}return r}let op=0;class Ne extends p2.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(jk,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return De.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return t4+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const n=e.filter(i=>i.isAncestorOf(this)?(De.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=n,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const l=i._attrsAffectingSize.map(c=>c+"Change."+this._getEventNamespace()).join(" ");i.on(l,s)}i.on(Dk.map(l=>l+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let n;e.on(`dragstart.${this._getEventNamespace()}`,r=>{n=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!n)return;const i=e.getAbsolutePosition(),s=i.x-n.x,l=i.y-n.y;this.nodes().forEach(c=>{if(c===e||c.isDragging())return;const u=c.getAbsolutePosition();c.setAbsolutePosition({x:u.x+s,y:u.y+l}),c.startDrag(r)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(g2),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(g2,this.__getNodeRect)}__getNodeShape(e,n=this.rotation(),r){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),l=e.getAbsolutePosition(r),c=i.x*s.x-e.offsetX()*s.x,u=i.y*s.y-e.offsetY()*s.y,f=(Yn.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:l.x+c*Math.cos(f)+u*Math.sin(-f),y:l.y+u*Math.cos(f)+c*Math.sin(f),width:i.width*s.x,height:i.height*s.y,rotation:f};return n4(p,-Yn.Konva.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-m2,y:-m2,width:0,height:0,rotation:0};const n=[];this.nodes().map(f=>{const p=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),m=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],x=f.getAbsoluteTransform();m.forEach(function(v){const w=x.point(v);n.push(w)})});const r=new De.Transform;r.rotate(-Yn.Konva.getAngle(this.rotation()));let i=1/0,s=1/0,l=-1/0,c=-1/0;n.forEach(function(f){const p=r.point(f);i===void 0&&(i=l=p.x,s=c=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),l=Math.max(l,p.x),c=Math.max(c,p.y)}),r.invert();const u=r.point({x:i,y:s});return{x:u.x,y:u.y,width:l-i,height:c-s,rotation:Yn.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Tc.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const n=new Fk.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Bk?10:"auto"}),r=this;n.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),n.on("dragstart",i=>{n.stopDrag(),i.cancelBubble=!0}),n.on("dragend",i=>{i.cancelBubble=!0}),n.on("mouseenter",()=>{const i=Yn.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),l=Uk(e,i,s);n.getStage().content&&(n.getStage().content.style.cursor=l),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const e=new Lk.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(n,r){const i=r.getParent(),s=i.padding();n.beginPath(),n.rect(-s,-s,r.width()+s*2,r.height()+s*2),n.moveTo(r.width()/2,-s),i.rotateEnabled()&&i.rotateLineVisible()&&n.lineTo(r.width()/2,-i.rotateAnchorOffset()*De.Util._sign(r.height())-s),n.fillStrokeShape(r)},hitFunc:(n,r)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();n.beginPath(),n.rect(-i,-i,r.width()+i*2,r.height()+i*2),n.fillStrokeShape(r)}});this.add(e),this._proxyDrag(e),e.on("dragstart",n=>{n.cancelBubble=!0}),e.on("dragmove",n=>{n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const n=this._getNodeRect(),r=n.width,i=n.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const l=e.target.getAbsolutePosition(),c=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:c.x-l.x,y:c.y-l.y},op++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(u=>{u._fire("transformstart",{evt:e.evt,target:u})})}_handleMouseMove(e){let n,r,i;const s=this.findOne("."+this._movingAnchorName),l=s.getStage();l.setPointersPositions(e);const c=l.getPointerPosition();let u={x:c.x-this._anchorDragOffset.x,y:c.y-this._anchorDragOffset.y};const f=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(f,u,e)),s.setAbsolutePosition(u);const p=s.getAbsolutePosition();if(f.x===p.x&&f.y===p.y)return;if(this._movingAnchorName==="rotater"){const E=this._getNodeRect();n=s.x()-E.width/2,r=-s.y()+E.height/2;let P=Math.atan2(-r,n)+Math.PI/2;E.height<0&&(P-=Math.PI);const A=Yn.Konva.getAngle(this.rotation())+P,F=Yn.Konva.getAngle(this.rotationSnapTolerance()),R=Wk(this.rotationSnaps(),A,F)-E.rotation,D=Vk(E,R);this._fitNodesInto(D,e);return}const m=this.shiftBehavior();let x;m==="inverted"?x=this.keepRatio()&&!e.shiftKey:m==="none"?x=this.keepRatio():x=this.keepRatio()||e.shiftKey;var S=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(x){var v=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(v.y-s.y(),2));var w=this.findOne(".top-left").x()>v.x?-1:1,T=this.findOne(".top-left").y()>v.y?-1:1;n=i*this.cos*w,r=i*this.sin*T,this.findOne(".top-left").x(v.x-n),this.findOne(".top-left").y(v.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(x){var v=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(v.y-s.y(),2));var w=this.findOne(".top-right").x()<v.x?-1:1,T=this.findOne(".top-right").y()>v.y?-1:1;n=i*this.cos*w,r=i*this.sin*T,this.findOne(".top-right").x(v.x+n),this.findOne(".top-right").y(v.y-r)}var k=s.position();this.findOne(".top-left").y(k.y),this.findOne(".bottom-right").x(k.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(x){var v=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(s.y()-v.y,2));var w=v.x<s.x()?-1:1,T=s.y()<v.y?-1:1;n=i*this.cos*w,r=i*this.sin*T,s.x(v.x-n),s.y(v.y+r)}k=s.position(),this.findOne(".top-left").x(k.x),this.findOne(".bottom-right").y(k.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(x){var v=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(s.y()-v.y,2));var w=this.findOne(".bottom-right").x()<v.x?-1:1,T=this.findOne(".bottom-right").y()<v.y?-1:1;n=i*this.cos*w,r=i*this.sin*T,this.findOne(".bottom-right").x(v.x+n),this.findOne(".bottom-right").y(v.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var S=this.centeredScaling()||e.altKey;if(S){const E=this.findOne(".top-left"),P=this.findOne(".bottom-right"),I=E.x(),A=E.y(),F=this.getWidth()-P.x(),N=this.getHeight()-P.y();P.move({x:-I,y:-A}),E.move({x:F,y:N})}const C=this.findOne(".top-left").getAbsolutePosition();n=C.x,r=C.y;const h=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),_=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:r,width:h,height:_,rotation:Yn.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();op--,this._fire("transformend",{evt:e,target:r}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),r&&this._nodes.forEach(i=>{var s;i._fire("transformend",{evt:e,target:i}),(s=i.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,n){const r=this._getNodeRect(),i=1;if(De.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(De.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const s=new De.Transform;if(s.rotate(Yn.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const x=s.point({x:-this.padding()*2,y:0});e.x+=x.x,e.y+=x.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=x.x,this._anchorDragOffset.y-=x.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const x=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=x.x,this._anchorDragOffset.y-=x.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const x=s.point({x:0,y:-this.padding()*2});e.x+=x.x,e.y+=x.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=x.x,this._anchorDragOffset.y-=x.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const x=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=x.x,this._anchorDragOffset.y-=x.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const x=this.boundBoxFunc()(r,e);x?e=x:De.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const l=1e7,c=new De.Transform;c.translate(r.x,r.y),c.rotate(r.rotation),c.scale(r.width/l,r.height/l);const u=new De.Transform,f=e.width/l,p=e.height/l;this.flipEnabled()===!1?(u.translate(e.x,e.y),u.rotate(e.rotation),u.translate(e.width<0?e.width:0,e.height<0?e.height:0),u.scale(Math.abs(f),Math.abs(p))):(u.translate(e.x,e.y),u.rotate(e.rotation),u.scale(f,p));const m=u.multiply(c.invert());this._nodes.forEach(x=>{var v;const w=x.getParent().getAbsoluteTransform(),T=x.getTransform().copy();T.translate(x.offsetX(),x.offsetY());const k=new De.Transform;k.multiply(w.copy().invert()).multiply(m).multiply(w).multiply(T);const S=k.decompose();x.setAttrs(S),(v=x.getLayer())===null||v===void 0||v.batchDraw()}),this.rotation(De.Util._getRotation(e.rotation)),this._nodes.forEach(x=>{this._fire("transform",{evt:n,target:x}),x._fire("transform",{evt:n,target:x})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,n){this.findOne(e).setAttrs(n)}update(){var e;const n=this._getNodeRect();this.rotation(De.Util._getRotation(n.rotation));const r=n.width,i=n.height,s=this.enabledAnchors(),l=this.resizeEnabled(),c=this.padding(),u=this.anchorSize(),f=this.find("._anchor");f.forEach(m=>{m.setAttrs({width:u,height:u,offsetX:u/2,offsetY:u/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:u/2+c,offsetY:u/2+c,visible:l&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:u/2+c,visible:l&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:u/2-c,offsetY:u/2+c,visible:l&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:u/2+c,visible:l&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:u/2-c,visible:l&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:u/2+c,offsetY:u/2-c,visible:l&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:u/2-c,visible:l&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:u/2-c,offsetY:u/2-c,visible:l&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*De.Util._sign(i)-c,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&f.forEach(m=>{p(m)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),p2.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return h2.Node.prototype.toObject.call(this)}clone(e){return h2.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}pd.Transformer=Ne;Ne.isTransforming=()=>op>0;function $k(t){return t instanceof Array||De.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){Tc.indexOf(e)===-1&&De.Util.warn("Unknown anchor name: "+e+". Available names are: "+Tc.join(", "))}),t||[]}Ne.prototype.className="Transformer";(0,Ok._registerNode)(Ne);Oe.Factory.addGetterSetter(Ne,"enabledAnchors",Tc,$k);Oe.Factory.addGetterSetter(Ne,"flipEnabled",!0,(0,ji.getBooleanValidator)());Oe.Factory.addGetterSetter(Ne,"resizeEnabled",!0);Oe.Factory.addGetterSetter(Ne,"anchorSize",10,(0,ji.getNumberValidator)());Oe.Factory.addGetterSetter(Ne,"rotateEnabled",!0);Oe.Factory.addGetterSetter(Ne,"rotateLineVisible",!0);Oe.Factory.addGetterSetter(Ne,"rotationSnaps",[]);Oe.Factory.addGetterSetter(Ne,"rotateAnchorOffset",50,(0,ji.getNumberValidator)());Oe.Factory.addGetterSetter(Ne,"rotateAnchorCursor","crosshair");Oe.Factory.addGetterSetter(Ne,"rotationSnapTolerance",5,(0,ji.getNumberValidator)());Oe.Factory.addGetterSetter(Ne,"borderEnabled",!0);Oe.Factory.addGetterSetter(Ne,"anchorStroke","rgb(0, 161, 255)");Oe.Factory.addGetterSetter(Ne,"anchorStrokeWidth",1,(0,ji.getNumberValidator)());Oe.Factory.addGetterSetter(Ne,"anchorFill","white");Oe.Factory.addGetterSetter(Ne,"anchorCornerRadius",0,(0,ji.getNumberValidator)());Oe.Factory.addGetterSetter(Ne,"borderStroke","rgb(0, 161, 255)");Oe.Factory.addGetterSetter(Ne,"borderStrokeWidth",1,(0,ji.getNumberValidator)());Oe.Factory.addGetterSetter(Ne,"borderDash");Oe.Factory.addGetterSetter(Ne,"keepRatio",!0);Oe.Factory.addGetterSetter(Ne,"shiftBehavior","default");Oe.Factory.addGetterSetter(Ne,"centeredScaling",!1);Oe.Factory.addGetterSetter(Ne,"ignoreStroke",!1);Oe.Factory.addGetterSetter(Ne,"padding",0,(0,ji.getNumberValidator)());Oe.Factory.addGetterSetter(Ne,"nodes");Oe.Factory.addGetterSetter(Ne,"node");Oe.Factory.addGetterSetter(Ne,"boundBoxFunc");Oe.Factory.addGetterSetter(Ne,"anchorDragBoundFunc");Oe.Factory.addGetterSetter(Ne,"anchorStyleFunc");Oe.Factory.addGetterSetter(Ne,"shouldOverdrawWholeArea",!1);Oe.Factory.addGetterSetter(Ne,"useSingleNodeRotation",!0);Oe.Factory.backCompat(Ne,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var gd={};Object.defineProperty(gd,"__esModule",{value:!0});gd.Wedge=void 0;const md=Ee,Hk=vt,Xk=ke,r4=ye,Yk=ke;class Xr extends Hk.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,Xk.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}gd.Wedge=Xr;Xr.prototype.className="Wedge";Xr.prototype._centroid=!0;Xr.prototype._attrsAffectingSize=["radius"];(0,Yk._registerNode)(Xr);md.Factory.addGetterSetter(Xr,"radius",0,(0,r4.getNumberValidator)());md.Factory.addGetterSetter(Xr,"angle",0,(0,r4.getNumberValidator)());md.Factory.addGetterSetter(Xr,"clockwise",!1);md.Factory.backCompat(Xr,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var yd={};Object.defineProperty(yd,"__esModule",{value:!0});yd.Blur=void 0;const y2=Ee,Kk=Ze,Qk=ye;function v2(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const Zk=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],qk=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Jk(t,e){const n=t.data,r=t.width,i=t.height;let s,l,c,u,f,p,m,x,v,w,T,k,S,C,h,_,E,P,I,A,F,N,R,D;const V=e+e+1,j=r-1,z=i-1,G=e+1,Y=G*(G+1)/2,O=new v2,W=Zk[e],X=qk[e];let ee=null,J=O,te=null,ae=null;for(c=1;c<V;c++)J=J.next=new v2,c===G&&(ee=J);for(J.next=O,m=p=0,l=0;l<i;l++){for(_=E=P=I=x=v=w=T=0,k=G*(A=n[p]),S=G*(F=n[p+1]),C=G*(N=n[p+2]),h=G*(R=n[p+3]),x+=Y*A,v+=Y*F,w+=Y*N,T+=Y*R,J=O,c=0;c<G;c++)J.r=A,J.g=F,J.b=N,J.a=R,J=J.next;for(c=1;c<G;c++)u=p+((j<c?j:c)<<2),x+=(J.r=A=n[u])*(D=G-c),v+=(J.g=F=n[u+1])*D,w+=(J.b=N=n[u+2])*D,T+=(J.a=R=n[u+3])*D,_+=A,E+=F,P+=N,I+=R,J=J.next;for(te=O,ae=ee,s=0;s<r;s++)n[p+3]=R=T*W>>X,R!==0?(R=255/R,n[p]=(x*W>>X)*R,n[p+1]=(v*W>>X)*R,n[p+2]=(w*W>>X)*R):n[p]=n[p+1]=n[p+2]=0,x-=k,v-=S,w-=C,T-=h,k-=te.r,S-=te.g,C-=te.b,h-=te.a,u=m+((u=s+e+1)<j?u:j)<<2,_+=te.r=n[u],E+=te.g=n[u+1],P+=te.b=n[u+2],I+=te.a=n[u+3],x+=_,v+=E,w+=P,T+=I,te=te.next,k+=A=ae.r,S+=F=ae.g,C+=N=ae.b,h+=R=ae.a,_-=A,E-=F,P-=N,I-=R,ae=ae.next,p+=4;m+=r}for(s=0;s<r;s++){for(E=P=I=_=v=w=T=x=0,p=s<<2,k=G*(A=n[p]),S=G*(F=n[p+1]),C=G*(N=n[p+2]),h=G*(R=n[p+3]),x+=Y*A,v+=Y*F,w+=Y*N,T+=Y*R,J=O,c=0;c<G;c++)J.r=A,J.g=F,J.b=N,J.a=R,J=J.next;for(f=r,c=1;c<=e;c++)p=f+s<<2,x+=(J.r=A=n[p])*(D=G-c),v+=(J.g=F=n[p+1])*D,w+=(J.b=N=n[p+2])*D,T+=(J.a=R=n[p+3])*D,_+=A,E+=F,P+=N,I+=R,J=J.next,c<z&&(f+=r);for(p=s,te=O,ae=ee,l=0;l<i;l++)u=p<<2,n[u+3]=R=T*W>>X,R>0?(R=255/R,n[u]=(x*W>>X)*R,n[u+1]=(v*W>>X)*R,n[u+2]=(w*W>>X)*R):n[u]=n[u+1]=n[u+2]=0,x-=k,v-=S,w-=C,T-=h,k-=te.r,S-=te.g,C-=te.b,h-=te.a,u=s+((u=l+G)<z?u:z)*r<<2,x+=_+=te.r=n[u],v+=E+=te.g=n[u+1],w+=P+=te.b=n[u+2],T+=I+=te.a=n[u+3],te=te.next,k+=A=ae.r,S+=F=ae.g,C+=N=ae.b,h+=R=ae.a,_-=A,E-=F,P-=N,I-=R,ae=ae.next,p+=r}}const eC=function(e){const n=Math.round(this.blurRadius());n>0&&Jk(e,n)};yd.Blur=eC;y2.Factory.addGetterSetter(Kk.Node,"blurRadius",0,(0,Qk.getNumberValidator)(),y2.Factory.afterSetFilter);var vd={};Object.defineProperty(vd,"__esModule",{value:!0});vd.Brighten=void 0;const x2=Ee,tC=Ze,nC=ye,rC=function(t){const e=this.brightness()*255,n=t.data,r=n.length;for(let i=0;i<r;i+=4)n[i]+=e,n[i+1]+=e,n[i+2]+=e};vd.Brighten=rC;x2.Factory.addGetterSetter(tC.Node,"brightness",0,(0,nC.getNumberValidator)(),x2.Factory.afterSetFilter);var xd={};Object.defineProperty(xd,"__esModule",{value:!0});xd.Contrast=void 0;const w2=Ee,iC=Ze,sC=ye,oC=function(t){const e=Math.pow((this.contrast()+100)/100,2),n=t.data,r=n.length;let i=150,s=150,l=150;for(let c=0;c<r;c+=4)i=n[c],s=n[c+1],l=n[c+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,l/=255,l-=.5,l*=e,l+=.5,l*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,l=l<0?0:l>255?255:l,n[c]=i,n[c+1]=s,n[c+2]=l};xd.Contrast=oC;w2.Factory.addGetterSetter(iC.Node,"contrast",0,(0,sC.getNumberValidator)(),w2.Factory.afterSetFilter);var wd={};Object.defineProperty(wd,"__esModule",{value:!0});wd.Emboss=void 0;const Pi=Ee,_d=Ze,aC=rt,i4=ye,lC=function(t){const e=this.embossStrength()*10,n=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=t.data,l=t.width,c=t.height,u=l*4;let f=0,p=0,m=c;switch(r){case"top-left":f=-1,p=-1;break;case"top":f=-1,p=0;break;case"top-right":f=-1,p=1;break;case"right":f=0,p=1;break;case"bottom-right":f=1,p=1;break;case"bottom":f=1,p=0;break;case"bottom-left":f=1,p=-1;break;case"left":f=0,p=-1;break;default:aC.Util.error("Unknown emboss direction: "+r)}do{const x=(m-1)*u;let v=f;m+v<1&&(v=0),m+v>c&&(v=0);const w=(m-1+v)*l*4;let T=l;do{const k=x+(T-1)*4;let S=p;T+S<1&&(S=0),T+S>l&&(S=0);const C=w+(T-1+S)*4,h=s[k]-s[C],_=s[k+1]-s[C+1],E=s[k+2]-s[C+2];let P=h;const I=P>0?P:-P,A=_>0?_:-_,F=E>0?E:-E;if(A>I&&(P=_),F>I&&(P=E),P*=e,i){const N=s[k]+P,R=s[k+1]+P,D=s[k+2]+P;s[k]=N>255?255:N<0?0:N,s[k+1]=R>255?255:R<0?0:R,s[k+2]=D>255?255:D<0?0:D}else{let N=n-P;N<0?N=0:N>255&&(N=255),s[k]=s[k+1]=s[k+2]=N}}while(--T)}while(--m)};wd.Emboss=lC;Pi.Factory.addGetterSetter(_d.Node,"embossStrength",.5,(0,i4.getNumberValidator)(),Pi.Factory.afterSetFilter);Pi.Factory.addGetterSetter(_d.Node,"embossWhiteLevel",.5,(0,i4.getNumberValidator)(),Pi.Factory.afterSetFilter);Pi.Factory.addGetterSetter(_d.Node,"embossDirection","top-left",void 0,Pi.Factory.afterSetFilter);Pi.Factory.addGetterSetter(_d.Node,"embossBlend",!1,void 0,Pi.Factory.afterSetFilter);var Sd={};Object.defineProperty(Sd,"__esModule",{value:!0});Sd.Enhance=void 0;const _2=Ee,uC=Ze,cC=ye;function Yh(t,e,n,r,i){const s=n-e,l=i-r;if(s===0)return r+l/2;if(l===0)return r;let c=(t-e)/s;return c=l*c+r,c}const dC=function(t){const e=t.data,n=e.length;let r=e[0],i=r,s,l=e[1],c=l,u,f=e[2],p=f,m;const x=this.enhance();if(x===0)return;for(let P=0;P<n;P+=4)s=e[P+0],s<r?r=s:s>i&&(i=s),u=e[P+1],u<l?l=u:u>c&&(c=u),m=e[P+2],m<f?f=m:m>p&&(p=m);i===r&&(i=255,r=0),c===l&&(c=255,l=0),p===f&&(p=255,f=0);let v,w,T,k,S,C,h,_,E;x>0?(w=i+x*(255-i),T=r-x*(r-0),S=c+x*(255-c),C=l-x*(l-0),_=p+x*(255-p),E=f-x*(f-0)):(v=(i+r)*.5,w=i+x*(i-v),T=r+x*(r-v),k=(c+l)*.5,S=c+x*(c-k),C=l+x*(l-k),h=(p+f)*.5,_=p+x*(p-h),E=f+x*(f-h));for(let P=0;P<n;P+=4)e[P+0]=Yh(e[P+0],r,i,T,w),e[P+1]=Yh(e[P+1],l,c,C,S),e[P+2]=Yh(e[P+2],f,p,E,_)};Sd.Enhance=dC;_2.Factory.addGetterSetter(uC.Node,"enhance",0,(0,cC.getNumberValidator)(),_2.Factory.afterSetFilter);var kd={};Object.defineProperty(kd,"__esModule",{value:!0});kd.Grayscale=void 0;const fC=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=.34*e[r]+.5*e[r+1]+.16*e[r+2];e[r]=i,e[r+1]=i,e[r+2]=i}};kd.Grayscale=fC;var Cd={};Object.defineProperty(Cd,"__esModule",{value:!0});Cd.HSL=void 0;const _o=Ee,mg=Ze,yg=ye;_o.Factory.addGetterSetter(mg.Node,"hue",0,(0,yg.getNumberValidator)(),_o.Factory.afterSetFilter);_o.Factory.addGetterSetter(mg.Node,"saturation",0,(0,yg.getNumberValidator)(),_o.Factory.afterSetFilter);_o.Factory.addGetterSetter(mg.Node,"luminance",0,(0,yg.getNumberValidator)(),_o.Factory.afterSetFilter);const hC=function(t){const e=t.data,n=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,l=this.luminance()*127,c=r*i*Math.cos(s*Math.PI/180),u=r*i*Math.sin(s*Math.PI/180),f=.299*r+.701*c+.167*u,p=.587*r-.587*c+.33*u,m=.114*r-.114*c-.497*u,x=.299*r-.299*c-.328*u,v=.587*r+.413*c+.035*u,w=.114*r-.114*c+.293*u,T=.299*r-.3*c+1.25*u,k=.587*r-.586*c-1.05*u,S=.114*r+.886*c-.2*u;let C,h,_,E;for(let P=0;P<n;P+=4)C=e[P+0],h=e[P+1],_=e[P+2],E=e[P+3],e[P+0]=f*C+p*h+m*_+l,e[P+1]=x*C+v*h+w*_+l,e[P+2]=T*C+k*h+S*_+l,e[P+3]=E};Cd.HSL=hC;var Ed={};Object.defineProperty(Ed,"__esModule",{value:!0});Ed.HSV=void 0;const So=Ee,vg=Ze,xg=ye,pC=function(t){const e=t.data,n=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,l=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),u=.299*r+.701*l+.167*c,f=.587*r-.587*l+.33*c,p=.114*r-.114*l-.497*c,m=.299*r-.299*l-.328*c,x=.587*r+.413*l+.035*c,v=.114*r-.114*l+.293*c,w=.299*r-.3*l+1.25*c,T=.587*r-.586*l-1.05*c,k=.114*r+.886*l-.2*c;let S,C,h,_;for(let E=0;E<n;E+=4)S=e[E+0],C=e[E+1],h=e[E+2],_=e[E+3],e[E+0]=u*S+f*C+p*h,e[E+1]=m*S+x*C+v*h,e[E+2]=w*S+T*C+k*h,e[E+3]=_};Ed.HSV=pC;So.Factory.addGetterSetter(vg.Node,"hue",0,(0,xg.getNumberValidator)(),So.Factory.afterSetFilter);So.Factory.addGetterSetter(vg.Node,"saturation",0,(0,xg.getNumberValidator)(),So.Factory.afterSetFilter);So.Factory.addGetterSetter(vg.Node,"value",0,(0,xg.getNumberValidator)(),So.Factory.afterSetFilter);var Td={};Object.defineProperty(Td,"__esModule",{value:!0});Td.Invert=void 0;const gC=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};Td.Invert=gC;var bd={};Object.defineProperty(bd,"__esModule",{value:!0});bd.Kaleidoscope=void 0;const bc=Ee,s4=Ze,S2=rt,o4=ye,mC=function(t,e,n){const r=t.data,i=e.data,s=t.width,l=t.height,c=n.polarCenterX||s/2,u=n.polarCenterY||l/2;let f=Math.sqrt(c*c+u*u),p=s-c,m=l-u;const x=Math.sqrt(p*p+m*m);f=x>f?x:f;const v=l,w=s,T=360/w*Math.PI/180;for(let k=0;k<w;k+=1){const S=Math.sin(k*T),C=Math.cos(k*T);for(let h=0;h<v;h+=1){p=Math.floor(c+f*h/v*C),m=Math.floor(u+f*h/v*S);let _=(m*s+p)*4;const E=r[_+0],P=r[_+1],I=r[_+2],A=r[_+3];_=(k+h*s)*4,i[_+0]=E,i[_+1]=P,i[_+2]=I,i[_+3]=A}}},yC=function(t,e,n){const r=t.data,i=e.data,s=t.width,l=t.height,c=n.polarCenterX||s/2,u=n.polarCenterY||l/2;let f=Math.sqrt(c*c+u*u),p=s-c,m=l-u;const x=Math.sqrt(p*p+m*m);f=x>f?x:f;const v=l,w=s,T=n.polarRotation||0;let k,S;for(p=0;p<s;p+=1)for(m=0;m<l;m+=1){const C=p-c,h=m-u,_=Math.sqrt(C*C+h*h)*v/f;let E=(Math.atan2(h,C)*180/Math.PI+360+T)%360;E=E*w/360,k=Math.floor(E),S=Math.floor(_);let P=(S*s+k)*4;const I=r[P+0],A=r[P+1],F=r[P+2],N=r[P+3];P=(m*s+p)*4,i[P+0]=I,i[P+1]=A,i[P+2]=F,i[P+3]=N}},vC=function(t){const e=t.width,n=t.height;let r,i,s,l,c,u,f,p,m,x,v=Math.round(this.kaleidoscopePower());const w=Math.round(this.kaleidoscopeAngle()),T=Math.floor(e*(w%360)/360);if(v<1)return;const k=S2.Util.createCanvasElement();k.width=e,k.height=n;const S=k.getContext("2d").getImageData(0,0,e,n);S2.Util.releaseCanvas(k),mC(t,S,{polarCenterX:e/2,polarCenterY:n/2});let C=e/Math.pow(2,v);for(;C<=8;)C=C*2,v-=1;C=Math.ceil(C);let h=C,_=0,E=h,P=1;for(T+C>e&&(_=h,E=0,P=-1),i=0;i<n;i+=1)for(r=_;r!==E;r+=P)s=Math.round(r+T)%e,m=(e*i+s)*4,c=S.data[m+0],u=S.data[m+1],f=S.data[m+2],p=S.data[m+3],x=(e*i+r)*4,S.data[x+0]=c,S.data[x+1]=u,S.data[x+2]=f,S.data[x+3]=p;for(i=0;i<n;i+=1)for(h=Math.floor(C),l=0;l<v;l+=1){for(r=0;r<h+1;r+=1)m=(e*i+r)*4,c=S.data[m+0],u=S.data[m+1],f=S.data[m+2],p=S.data[m+3],x=(e*i+h*2-r-1)*4,S.data[x+0]=c,S.data[x+1]=u,S.data[x+2]=f,S.data[x+3]=p;h*=2}yC(S,t,{polarRotation:0})};bd.Kaleidoscope=vC;bc.Factory.addGetterSetter(s4.Node,"kaleidoscopePower",2,(0,o4.getNumberValidator)(),bc.Factory.afterSetFilter);bc.Factory.addGetterSetter(s4.Node,"kaleidoscopeAngle",0,(0,o4.getNumberValidator)(),bc.Factory.afterSetFilter);var Pd={};Object.defineProperty(Pd,"__esModule",{value:!0});Pd.Mask=void 0;const k2=Ee,xC=Ze,wC=ye;function Au(t,e,n){let r=(n*t.width+e)*4;const i=[];return i.push(t.data[r++],t.data[r++],t.data[r++],t.data[r++]),i}function ma(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function _C(t){const e=[0,0,0];for(let n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function SC(t,e){const n=Au(t,0,0),r=Au(t,t.width-1,0),i=Au(t,0,t.height-1),s=Au(t,t.width-1,t.height-1),l=e||10;if(ma(n,r)<l&&ma(r,s)<l&&ma(s,i)<l&&ma(i,n)<l){const c=_C([r,n,s,i]),u=[];for(let f=0;f<t.width*t.height;f++){const p=ma(c,[t.data[f*4],t.data[f*4+1],t.data[f*4+2]]);u[f]=p<l?0:255}return u}}function kC(t,e){for(let n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function CC(t,e,n){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let c=0;c<n;c++)for(let u=0;u<e;u++){const f=c*e+u;let p=0;for(let m=0;m<i;m++)for(let x=0;x<i;x++){const v=c+m-s,w=u+x-s;if(v>=0&&v<n&&w>=0&&w<e){const T=v*e+w,k=r[m*i+x];p+=t[T]*k}}l[f]=p===255*8?255:0}return l}function EC(t,e,n){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let c=0;c<n;c++)for(let u=0;u<e;u++){const f=c*e+u;let p=0;for(let m=0;m<i;m++)for(let x=0;x<i;x++){const v=c+m-s,w=u+x-s;if(v>=0&&v<n&&w>=0&&w<e){const T=v*e+w,k=r[m*i+x];p+=t[T]*k}}l[f]=p>=255*4?255:0}return l}function TC(t,e,n){const r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let c=0;c<n;c++)for(let u=0;u<e;u++){const f=c*e+u;let p=0;for(let m=0;m<i;m++)for(let x=0;x<i;x++){const v=c+m-s,w=u+x-s;if(v>=0&&v<n&&w>=0&&w<e){const T=v*e+w,k=r[m*i+x];p+=t[T]*k}}l[f]=p}return l}const bC=function(t){const e=this.threshold();let n=SC(t,e);return n&&(n=CC(n,t.width,t.height),n=EC(n,t.width,t.height),n=TC(n,t.width,t.height),kC(t,n)),t};Pd.Mask=bC;k2.Factory.addGetterSetter(xC.Node,"threshold",0,(0,wC.getNumberValidator)(),k2.Factory.afterSetFilter);var Nd={};Object.defineProperty(Nd,"__esModule",{value:!0});Nd.Noise=void 0;const C2=Ee,PC=Ze,NC=ye,AC=function(t){const e=this.noise()*255,n=t.data,r=n.length,i=e/2;for(let s=0;s<r;s+=4)n[s+0]+=i-2*i*Math.random(),n[s+1]+=i-2*i*Math.random(),n[s+2]+=i-2*i*Math.random()};Nd.Noise=AC;C2.Factory.addGetterSetter(PC.Node,"noise",.2,(0,NC.getNumberValidator)(),C2.Factory.afterSetFilter);var Ad={};Object.defineProperty(Ad,"__esModule",{value:!0});Ad.Pixelate=void 0;const E2=Ee,MC=rt,RC=Ze,IC=ye,LC=function(t){let e=Math.ceil(this.pixelSize()),n=t.width,r=t.height,i,s,l,c,u,f,p,m=Math.ceil(n/e),x=Math.ceil(r/e),v,w,T,k,S,C,h,_=t.data;if(e<=0){MC.Util.error("pixelSize value can not be <= 0");return}for(S=0;S<m;S+=1)for(C=0;C<x;C+=1){for(c=0,u=0,f=0,p=0,v=S*e,w=v+e,T=C*e,k=T+e,h=0,i=v;i<w;i+=1)if(!(i>=n))for(s=T;s<k;s+=1)s>=r||(l=(n*s+i)*4,c+=_[l+0],u+=_[l+1],f+=_[l+2],p+=_[l+3],h+=1);for(c=c/h,u=u/h,f=f/h,p=p/h,i=v;i<w;i+=1)if(!(i>=n))for(s=T;s<k;s+=1)s>=r||(l=(n*s+i)*4,_[l+0]=c,_[l+1]=u,_[l+2]=f,_[l+3]=p)}};Ad.Pixelate=LC;E2.Factory.addGetterSetter(RC.Node,"pixelSize",8,(0,IC.getNumberValidator)(),E2.Factory.afterSetFilter);var Md={};Object.defineProperty(Md,"__esModule",{value:!0});Md.Posterize=void 0;const T2=Ee,FC=Ze,OC=ye,jC=function(t){const e=Math.round(this.levels()*254)+1,n=t.data,r=n.length,i=255/e;for(let s=0;s<r;s+=1)n[s]=Math.floor(n[s]/i)*i};Md.Posterize=jC;T2.Factory.addGetterSetter(FC.Node,"levels",.5,(0,OC.getNumberValidator)(),T2.Factory.afterSetFilter);var Rd={};Object.defineProperty(Rd,"__esModule",{value:!0});Rd.RGB=void 0;const Pc=Ee,wg=Ze,DC=ye,zC=function(t){const e=t.data,n=e.length,r=this.red(),i=this.green(),s=this.blue();for(let l=0;l<n;l+=4){const c=(.34*e[l]+.5*e[l+1]+.16*e[l+2])/255;e[l]=c*r,e[l+1]=c*i,e[l+2]=c*s,e[l+3]=e[l+3]}};Rd.RGB=zC;Pc.Factory.addGetterSetter(wg.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Pc.Factory.addGetterSetter(wg.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Pc.Factory.addGetterSetter(wg.Node,"blue",0,DC.RGBComponent,Pc.Factory.afterSetFilter);var Id={};Object.defineProperty(Id,"__esModule",{value:!0});Id.RGBA=void 0;const Ja=Ee,Ld=Ze,BC=ye,UC=function(t){const e=t.data,n=e.length,r=this.red(),i=this.green(),s=this.blue(),l=this.alpha();for(let c=0;c<n;c+=4){const u=1-l;e[c]=r*l+e[c]*u,e[c+1]=i*l+e[c+1]*u,e[c+2]=s*l+e[c+2]*u}};Id.RGBA=UC;Ja.Factory.addGetterSetter(Ld.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Ja.Factory.addGetterSetter(Ld.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Ja.Factory.addGetterSetter(Ld.Node,"blue",0,BC.RGBComponent,Ja.Factory.afterSetFilter);Ja.Factory.addGetterSetter(Ld.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var Fd={};Object.defineProperty(Fd,"__esModule",{value:!0});Fd.Sepia=void 0;const GC=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=e[r+0],s=e[r+1],l=e[r+2];e[r+0]=Math.min(255,i*.393+s*.769+l*.189),e[r+1]=Math.min(255,i*.349+s*.686+l*.168),e[r+2]=Math.min(255,i*.272+s*.534+l*.131)}};Fd.Sepia=GC;var Od={};Object.defineProperty(Od,"__esModule",{value:!0});Od.Solarize=void 0;const VC=function(t){const e=t.data,n=t.width,r=t.height,i=n*4;let s=r;do{const l=(s-1)*i;let c=n;do{const u=l+(c-1)*4;let f=e[u],p=e[u+1],m=e[u+2];f>127&&(f=255-f),p>127&&(p=255-p),m>127&&(m=255-m),e[u]=f,e[u+1]=p,e[u+2]=m}while(--c)}while(--s)};Od.Solarize=VC;var jd={};Object.defineProperty(jd,"__esModule",{value:!0});jd.Threshold=void 0;const b2=Ee,WC=Ze,$C=ye,HC=function(t){const e=this.threshold()*255,n=t.data,r=n.length;for(let i=0;i<r;i+=1)n[i]=n[i]<e?0:255};jd.Threshold=HC;b2.Factory.addGetterSetter(WC.Node,"threshold",.5,(0,$C.getNumberValidator)(),b2.Factory.afterSetFilter);Object.defineProperty(Xc,"__esModule",{value:!0});Xc.Konva=void 0;const P2=Cc,XC=qc,YC=td,KC=id,QC=sd,ZC=od,N2=wo,qC=fl,JC=Io,eE=pl,tE=ud,nE=cd,rE=dd,iE=fd,sE=Fo,oE=hd,aE=pd,lE=gd,uE=yd,cE=vd,dE=xd,fE=wd,hE=Sd,pE=kd,gE=Cd,mE=Ed,yE=Td,vE=bd,xE=Pd,wE=Nd,_E=Ad,SE=Md,kE=Rd,CE=Id,EE=Fd,TE=Od,bE=jd;Xc.Konva=P2.Konva.Util._assign(P2.Konva,{Arc:XC.Arc,Arrow:YC.Arrow,Circle:KC.Circle,Ellipse:QC.Ellipse,Image:ZC.Image,Label:N2.Label,Tag:N2.Tag,Line:qC.Line,Path:JC.Path,Rect:eE.Rect,RegularPolygon:tE.RegularPolygon,Ring:nE.Ring,Sprite:rE.Sprite,Star:iE.Star,Text:sE.Text,TextPath:oE.TextPath,Transformer:aE.Transformer,Wedge:lE.Wedge,Filters:{Blur:uE.Blur,Brighten:cE.Brighten,Contrast:dE.Contrast,Emboss:fE.Emboss,Enhance:hE.Enhance,Grayscale:pE.Grayscale,HSL:gE.HSL,HSV:mE.HSV,Invert:yE.Invert,Kaleidoscope:vE.Kaleidoscope,Mask:xE.Mask,Noise:wE.Noise,Pixelate:_E.Pixelate,Posterize:SE.Posterize,RGB:kE.RGB,RGBA:CE.RGBA,Sepia:EE.Sepia,Solarize:TE.Solarize,Threshold:bE.Threshold}});var PE=b5.exports;Object.defineProperty(PE,"__esModule",{value:!0});const NE=Xc;b5.exports=NE.Konva;var ap={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var n=Cc;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return n.Konva}});const r=Cc;t.exports=r.Konva})(ap,ap.exports);var AE=ap.exports;const el=nl(AE);var a4={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ME=function(e){var n={},r=B,i=Sa,s=Object.assign;function l(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,d=1;d<arguments.length;d++)a+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),f=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),w=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),_=Symbol.for("react.offscreen"),E=Symbol.iterator;function P(o){return o===null||typeof o!="object"?null:(o=E&&o[E]||o["@@iterator"],typeof o=="function"?o:null)}function I(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case p:return"Fragment";case f:return"Portal";case x:return"Profiler";case m:return"StrictMode";case k:return"Suspense";case S:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case w:return(o.displayName||"Context")+".Consumer";case v:return(o._context.displayName||"Context")+".Provider";case T:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case C:return a=o.displayName||null,a!==null?a:I(o.type)||"Memo";case h:a=o._payload,o=o._init;try{return I(o(a))}catch{}}return null}function A(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(a);case 8:return a===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function F(o){var a=o,d=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,a.flags&4098&&(d=a.return),o=a.return;while(o)}return a.tag===3?d:null}function N(o){if(F(o)!==o)throw Error(l(188))}function R(o){var a=o.alternate;if(!a){if(a=F(o),a===null)throw Error(l(188));return a!==o?null:o}for(var d=o,g=a;;){var y=d.return;if(y===null)break;var b=y.alternate;if(b===null){if(g=y.return,g!==null){d=g;continue}break}if(y.child===b.child){for(b=y.child;b;){if(b===d)return N(y),o;if(b===g)return N(y),a;b=b.sibling}throw Error(l(188))}if(d.return!==g.return)d=y,g=b;else{for(var L=!1,$=y.child;$;){if($===d){L=!0,d=y,g=b;break}if($===g){L=!0,g=y,d=b;break}$=$.sibling}if(!L){for($=b.child;$;){if($===d){L=!0,d=b,g=y;break}if($===g){L=!0,g=b,d=y;break}$=$.sibling}if(!L)throw Error(l(189))}}if(d.alternate!==g)throw Error(l(190))}if(d.tag!==3)throw Error(l(188));return d.stateNode.current===d?o:a}function D(o){return o=R(o),o!==null?V(o):null}function V(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=V(o);if(a!==null)return a;o=o.sibling}return null}function j(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){if(o.tag!==4){var a=j(o);if(a!==null)return a}o=o.sibling}return null}var z=Array.isArray,G=e.getPublicInstance,Y=e.getRootHostContext,O=e.getChildHostContext,W=e.prepareForCommit,X=e.resetAfterCommit,ee=e.createInstance,J=e.appendInitialChild,te=e.finalizeInitialChildren,ae=e.prepareUpdate,ne=e.shouldSetTextContent,oe=e.createTextInstance,U=e.scheduleTimeout,q=e.cancelTimeout,re=e.noTimeout,pe=e.isPrimaryRenderer,me=e.supportsMutation,Ae=e.supportsPersistence,Te=e.supportsHydration,wt=e.getInstanceFromNode,Me=e.preparePortalMount,Ft=e.getCurrentEventPriority,ct=e.detachDeletedInstance,qt=e.supportsMicrotasks,Yr=e.scheduleMicrotask,sr=e.supportsTestSelectors,ws=e.findFiberRoot,_s=e.getBoundingRect,Ss=e.getTextContent,or=e.isHiddenSubtree,ks=e.matchAccessibilityRole,bt=e.setFocusIfFocusable,Kr=e.setupIntersectionObserver,Cs=e.appendChild,gl=e.appendChildToContainer,xe=e.commitTextUpdate,Ve=e.commitMount,Jt=e.commitUpdate,Qr=e.insertBefore,w4=e.insertInContainerBefore,_4=e.removeChild,S4=e.removeChildFromContainer,Tg=e.resetTextContent,k4=e.hideInstance,C4=e.hideTextInstance,E4=e.unhideInstance,T4=e.unhideTextInstance,b4=e.clearContainer,P4=e.cloneInstance,bg=e.createContainerChildSet,Pg=e.appendChildToContainerChildSet,N4=e.finalizeContainerChildren,Bd=e.replaceContainerChildren,Ng=e.cloneHiddenInstance,Ag=e.cloneHiddenTextInstance,A4=e.canHydrateInstance,M4=e.canHydrateTextInstance,R4=e.canHydrateSuspenseInstance,Mg=e.isSuspenseInstancePending,Ud=e.isSuspenseInstanceFallback,I4=e.getSuspenseInstanceFallbackErrorDetails,L4=e.registerSuspenseInstanceRetry,ml=e.getNextHydratableSibling,F4=e.getFirstHydratableChild,O4=e.getFirstHydratableChildWithinContainer,j4=e.getFirstHydratableChildWithinSuspenseInstance,D4=e.hydrateInstance,z4=e.hydrateTextInstance,B4=e.hydrateSuspenseInstance,U4=e.getNextHydratableInstanceAfterSuspenseInstance,G4=e.commitHydratedContainer,V4=e.commitHydratedSuspenseInstance,W4=e.clearSuspenseBoundary,$4=e.clearSuspenseBoundaryFromContainer,H4=e.shouldDeleteUnhydratedTailInstances,X4=e.didNotMatchHydratedContainerTextInstance,Y4=e.didNotMatchHydratedTextInstance,Gd;function Oo(o){if(Gd===void 0)try{throw Error()}catch(d){var a=d.stack.trim().match(/\n( *(at )?)/);Gd=a&&a[1]||""}return`
`+Gd+o}var Vd=!1;function Wd(o,a){if(!o||Vd)return"";Vd=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(se){var g=se}Reflect.construct(o,[],a)}else{try{a.call()}catch(se){g=se}o.call(a.prototype)}else{try{throw Error()}catch(se){g=se}o()}}catch(se){if(se&&g&&typeof se.stack=="string"){for(var y=se.stack.split(`
`),b=g.stack.split(`
`),L=y.length-1,$=b.length-1;1<=L&&0<=$&&y[L]!==b[$];)$--;for(;1<=L&&0<=$;L--,$--)if(y[L]!==b[$]){if(L!==1||$!==1)do if(L--,$--,0>$||y[L]!==b[$]){var Q=`
`+y[L].replace(" at new "," at ");return o.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",o.displayName)),Q}while(1<=L&&0<=$);break}}}finally{Vd=!1,Error.prepareStackTrace=d}return(o=o?o.displayName||o.name:"")?Oo(o):""}var K4=Object.prototype.hasOwnProperty,$d=[],Es=-1;function Zr(o){return{current:o}}function We(o){0>Es||(o.current=$d[Es],$d[Es]=null,Es--)}function Ue(o,a){Es++,$d[Es]=o.current,o.current=a}var qr={},Ot=Zr(qr),en=Zr(!1),zi=qr;function Ts(o,a){var d=o.type.contextTypes;if(!d)return qr;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===a)return g.__reactInternalMemoizedMaskedChildContext;var y={},b;for(b in d)y[b]=a[b];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=y),y}function tn(o){return o=o.childContextTypes,o!=null}function yl(){We(en),We(Ot)}function Rg(o,a,d){if(Ot.current!==qr)throw Error(l(168));Ue(Ot,a),Ue(en,d)}function Ig(o,a,d){var g=o.stateNode;if(a=a.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var y in g)if(!(y in a))throw Error(l(108,A(o)||"Unknown",y));return s({},d,g)}function vl(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||qr,zi=Ot.current,Ue(Ot,o),Ue(en,en.current),!0}function Lg(o,a,d){var g=o.stateNode;if(!g)throw Error(l(169));d?(o=Ig(o,a,zi),g.__reactInternalMemoizedMergedChildContext=o,We(en),We(Ot),Ue(Ot,o)):We(en),Ue(en,d)}var Un=Math.clz32?Math.clz32:q4,Q4=Math.log,Z4=Math.LN2;function q4(o){return o>>>=0,o===0?32:31-(Q4(o)/Z4|0)|0}var xl=64,wl=4194304;function jo(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function _l(o,a){var d=o.pendingLanes;if(d===0)return 0;var g=0,y=o.suspendedLanes,b=o.pingedLanes,L=d&268435455;if(L!==0){var $=L&~y;$!==0?g=jo($):(b&=L,b!==0&&(g=jo(b)))}else L=d&~y,L!==0?g=jo(L):b!==0&&(g=jo(b));if(g===0)return 0;if(a!==0&&a!==g&&!(a&y)&&(y=g&-g,b=a&-a,y>=b||y===16&&(b&4194240)!==0))return a;if(g&4&&(g|=d&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=g;0<a;)d=31-Un(a),y=1<<d,g|=o[d],a&=~y;return g}function J4(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function e6(o,a){for(var d=o.suspendedLanes,g=o.pingedLanes,y=o.expirationTimes,b=o.pendingLanes;0<b;){var L=31-Un(b),$=1<<L,Q=y[L];Q===-1?(!($&d)||$&g)&&(y[L]=J4($,a)):Q<=a&&(o.expiredLanes|=$),b&=~$}}function Hd(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Fg(){var o=xl;return xl<<=1,!(xl&4194240)&&(xl=64),o}function Xd(o){for(var a=[],d=0;31>d;d++)a.push(o);return a}function Do(o,a,d){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-Un(a),o[a]=d}function t6(o,a){var d=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<d;){var y=31-Un(d),b=1<<y;a[y]=0,g[y]=-1,o[y]=-1,d&=~b}}function Yd(o,a){var d=o.entangledLanes|=a;for(o=o.entanglements;d;){var g=31-Un(d),y=1<<g;y&a|o[g]&a&&(o[g]|=a),d&=~y}}var Ie=0;function Og(o){return o&=-o,1<o?4<o?o&268435455?16:536870912:4:1}var Kd=i.unstable_scheduleCallback,jg=i.unstable_cancelCallback,n6=i.unstable_shouldYield,r6=i.unstable_requestPaint,_t=i.unstable_now,Qd=i.unstable_ImmediatePriority,i6=i.unstable_UserBlockingPriority,Zd=i.unstable_NormalPriority,s6=i.unstable_IdlePriority,Sl=null,ar=null;function o6(o){if(ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(Sl,o,void 0,(o.current.flags&128)===128)}catch{}}function a6(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var Gn=typeof Object.is=="function"?Object.is:a6,Cr=null,kl=!1,qd=!1;function Dg(o){Cr===null?Cr=[o]:Cr.push(o)}function l6(o){kl=!0,Dg(o)}function lr(){if(!qd&&Cr!==null){qd=!0;var o=0,a=Ie;try{var d=Cr;for(Ie=1;o<d.length;o++){var g=d[o];do g=g(!0);while(g!==null)}Cr=null,kl=!1}catch(y){throw Cr!==null&&(Cr=Cr.slice(o+1)),Kd(Qd,lr),y}finally{Ie=a,qd=!1}}return null}var bs=[],Ps=0,Cl=null,El=0,Sn=[],kn=0,Bi=null,Er=1,Tr="";function Ui(o,a){bs[Ps++]=El,bs[Ps++]=Cl,Cl=o,El=a}function zg(o,a,d){Sn[kn++]=Er,Sn[kn++]=Tr,Sn[kn++]=Bi,Bi=o;var g=Er;o=Tr;var y=32-Un(g)-1;g&=~(1<<y),d+=1;var b=32-Un(a)+y;if(30<b){var L=y-y%5;b=(g&(1<<L)-1).toString(32),g>>=L,y-=L,Er=1<<32-Un(a)+y|d<<y|g,Tr=b+o}else Er=1<<b|d<<y|g,Tr=o}function Jd(o){o.return!==null&&(Ui(o,1),zg(o,1,0))}function ef(o){for(;o===Cl;)Cl=bs[--Ps],bs[Ps]=null,El=bs[--Ps],bs[Ps]=null;for(;o===Bi;)Bi=Sn[--kn],Sn[kn]=null,Tr=Sn[--kn],Sn[kn]=null,Er=Sn[--kn],Sn[kn]=null}var hn=null,Cn=null,Ye=!1,zo=!1,Vn=null;function Bg(o,a){var d=Nn(5,null,null,0);d.elementType="DELETED",d.stateNode=a,d.return=o,a=o.deletions,a===null?(o.deletions=[d],o.flags|=16):a.push(d)}function Ug(o,a){switch(o.tag){case 5:return a=A4(a,o.type,o.pendingProps),a!==null?(o.stateNode=a,hn=o,Cn=F4(a),!0):!1;case 6:return a=M4(a,o.pendingProps),a!==null?(o.stateNode=a,hn=o,Cn=null,!0):!1;case 13:if(a=R4(a),a!==null){var d=Bi!==null?{id:Er,overflow:Tr}:null;return o.memoizedState={dehydrated:a,treeContext:d,retryLane:1073741824},d=Nn(18,null,null,0),d.stateNode=a,d.return=o,o.child=d,hn=o,Cn=null,!0}return!1;default:return!1}}function tf(o){return(o.mode&1)!==0&&(o.flags&128)===0}function nf(o){if(Ye){var a=Cn;if(a){var d=a;if(!Ug(o,a)){if(tf(o))throw Error(l(418));a=ml(d);var g=hn;a&&Ug(o,a)?Bg(g,d):(o.flags=o.flags&-4097|2,Ye=!1,hn=o)}}else{if(tf(o))throw Error(l(418));o.flags=o.flags&-4097|2,Ye=!1,hn=o}}}function Gg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;hn=o}function Tl(o){if(!Te||o!==hn)return!1;if(!Ye)return Gg(o),Ye=!0,!1;if(o.tag!==3&&(o.tag!==5||H4(o.type)&&!ne(o.type,o.memoizedProps))){var a=Cn;if(a){if(tf(o))throw Vg(),Error(l(418));for(;a;)Bg(o,a),a=ml(a)}}if(Gg(o),o.tag===13){if(!Te)throw Error(l(316));if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(l(317));Cn=U4(o)}else Cn=hn?ml(o.stateNode):null;return!0}function Vg(){for(var o=Cn;o;)o=ml(o)}function Ns(){Te&&(Cn=hn=null,zo=Ye=!1)}function rf(o){Vn===null?Vn=[o]:Vn.push(o)}var u6=c.ReactCurrentBatchConfig;function bl(o,a){if(Gn(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var d=Object.keys(o),g=Object.keys(a);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var y=d[g];if(!K4.call(a,y)||!Gn(o[y],a[y]))return!1}return!0}function c6(o){switch(o.tag){case 5:return Oo(o.type);case 16:return Oo("Lazy");case 13:return Oo("Suspense");case 19:return Oo("SuspenseList");case 0:case 2:case 15:return o=Wd(o.type,!1),o;case 11:return o=Wd(o.type.render,!1),o;case 1:return o=Wd(o.type,!0),o;default:return""}}function Bo(o,a,d){if(o=d.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(l(309));var g=d.stateNode}if(!g)throw Error(l(147,o));var y=g,b=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===b?a.ref:(a=function(L){var $=y.refs;L===null?delete $[b]:$[b]=L},a._stringRef=b,a)}if(typeof o!="string")throw Error(l(284));if(!d._owner)throw Error(l(290,o))}return o}function Pl(o,a){throw o=Object.prototype.toString.call(a),Error(l(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function Wg(o){var a=o._init;return a(o._payload)}function $g(o){function a(K,H){if(o){var Z=K.deletions;Z===null?(K.deletions=[H],K.flags|=16):Z.push(H)}}function d(K,H){if(!o)return null;for(;H!==null;)a(K,H),H=H.sibling;return null}function g(K,H){for(K=new Map;H!==null;)H.key!==null?K.set(H.key,H):K.set(H.index,H),H=H.sibling;return K}function y(K,H){return K=si(K,H),K.index=0,K.sibling=null,K}function b(K,H,Z){return K.index=Z,o?(Z=K.alternate,Z!==null?(Z=Z.index,Z<H?(K.flags|=2,H):Z):(K.flags|=2,H)):(K.flags|=1048576,H)}function L(K){return o&&K.alternate===null&&(K.flags|=2),K}function $(K,H,Z,ue){return H===null||H.tag!==6?(H=Jf(Z,K.mode,ue),H.return=K,H):(H=y(H,Z),H.return=K,H)}function Q(K,H,Z,ue){var ge=Z.type;return ge===p?he(K,H,Z.props.children,ue,Z.key):H!==null&&(H.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===h&&Wg(ge)===H.type)?(ue=y(H,Z.props),ue.ref=Bo(K,H,Z),ue.return=K,ue):(ue=su(Z.type,Z.key,Z.props,null,K.mode,ue),ue.ref=Bo(K,H,Z),ue.return=K,ue)}function se(K,H,Z,ue){return H===null||H.tag!==4||H.stateNode.containerInfo!==Z.containerInfo||H.stateNode.implementation!==Z.implementation?(H=eh(Z,K.mode,ue),H.return=K,H):(H=y(H,Z.children||[]),H.return=K,H)}function he(K,H,Z,ue,ge){return H===null||H.tag!==7?(H=Yi(Z,K.mode,ue,ge),H.return=K,H):(H=y(H,Z),H.return=K,H)}function we(K,H,Z){if(typeof H=="string"&&H!==""||typeof H=="number")return H=Jf(""+H,K.mode,Z),H.return=K,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case u:return Z=su(H.type,H.key,H.props,null,K.mode,Z),Z.ref=Bo(K,null,H),Z.return=K,Z;case f:return H=eh(H,K.mode,Z),H.return=K,H;case h:var ue=H._init;return we(K,ue(H._payload),Z)}if(z(H)||P(H))return H=Yi(H,K.mode,Z,null),H.return=K,H;Pl(K,H)}return null}function le(K,H,Z,ue){var ge=H!==null?H.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number")return ge!==null?null:$(K,H,""+Z,ue);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case u:return Z.key===ge?Q(K,H,Z,ue):null;case f:return Z.key===ge?se(K,H,Z,ue):null;case h:return ge=Z._init,le(K,H,ge(Z._payload),ue)}if(z(Z)||P(Z))return ge!==null?null:he(K,H,Z,ue,null);Pl(K,Z)}return null}function $e(K,H,Z,ue,ge){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return K=K.get(Z)||null,$(H,K,""+ue,ge);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case u:return K=K.get(ue.key===null?Z:ue.key)||null,Q(H,K,ue,ge);case f:return K=K.get(ue.key===null?Z:ue.key)||null,se(H,K,ue,ge);case h:var Se=ue._init;return $e(K,H,Z,Se(ue._payload),ge)}if(z(ue)||P(ue))return K=K.get(Z)||null,he(H,K,ue,ge,null);Pl(H,ue)}return null}function ze(K,H,Z,ue){for(var ge=null,Se=null,_e=H,Le=H=0,Ct=null;_e!==null&&Le<Z.length;Le++){_e.index>Le?(Ct=_e,_e=null):Ct=_e.sibling;var Fe=le(K,_e,Z[Le],ue);if(Fe===null){_e===null&&(_e=Ct);break}o&&_e&&Fe.alternate===null&&a(K,_e),H=b(Fe,H,Le),Se===null?ge=Fe:Se.sibling=Fe,Se=Fe,_e=Ct}if(Le===Z.length)return d(K,_e),Ye&&Ui(K,Le),ge;if(_e===null){for(;Le<Z.length;Le++)_e=we(K,Z[Le],ue),_e!==null&&(H=b(_e,H,Le),Se===null?ge=_e:Se.sibling=_e,Se=_e);return Ye&&Ui(K,Le),ge}for(_e=g(K,_e);Le<Z.length;Le++)Ct=$e(_e,K,Le,Z[Le],ue),Ct!==null&&(o&&Ct.alternate!==null&&_e.delete(Ct.key===null?Le:Ct.key),H=b(Ct,H,Le),Se===null?ge=Ct:Se.sibling=Ct,Se=Ct);return o&&_e.forEach(function(oi){return a(K,oi)}),Ye&&Ui(K,Le),ge}function on(K,H,Z,ue){var ge=P(Z);if(typeof ge!="function")throw Error(l(150));if(Z=ge.call(Z),Z==null)throw Error(l(151));for(var Se=ge=null,_e=H,Le=H=0,Ct=null,Fe=Z.next();_e!==null&&!Fe.done;Le++,Fe=Z.next()){_e.index>Le?(Ct=_e,_e=null):Ct=_e.sibling;var oi=le(K,_e,Fe.value,ue);if(oi===null){_e===null&&(_e=Ct);break}o&&_e&&oi.alternate===null&&a(K,_e),H=b(oi,H,Le),Se===null?ge=oi:Se.sibling=oi,Se=oi,_e=Ct}if(Fe.done)return d(K,_e),Ye&&Ui(K,Le),ge;if(_e===null){for(;!Fe.done;Le++,Fe=Z.next())Fe=we(K,Fe.value,ue),Fe!==null&&(H=b(Fe,H,Le),Se===null?ge=Fe:Se.sibling=Fe,Se=Fe);return Ye&&Ui(K,Le),ge}for(_e=g(K,_e);!Fe.done;Le++,Fe=Z.next())Fe=$e(_e,K,Le,Fe.value,ue),Fe!==null&&(o&&Fe.alternate!==null&&_e.delete(Fe.key===null?Le:Fe.key),H=b(Fe,H,Le),Se===null?ge=Fe:Se.sibling=Fe,Se=Fe);return o&&_e.forEach(function(B6){return a(K,B6)}),Ye&&Ui(K,Le),ge}function Ar(K,H,Z,ue){if(typeof Z=="object"&&Z!==null&&Z.type===p&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case u:e:{for(var ge=Z.key,Se=H;Se!==null;){if(Se.key===ge){if(ge=Z.type,ge===p){if(Se.tag===7){d(K,Se.sibling),H=y(Se,Z.props.children),H.return=K,K=H;break e}}else if(Se.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===h&&Wg(ge)===Se.type){d(K,Se.sibling),H=y(Se,Z.props),H.ref=Bo(K,Se,Z),H.return=K,K=H;break e}d(K,Se);break}else a(K,Se);Se=Se.sibling}Z.type===p?(H=Yi(Z.props.children,K.mode,ue,Z.key),H.return=K,K=H):(ue=su(Z.type,Z.key,Z.props,null,K.mode,ue),ue.ref=Bo(K,H,Z),ue.return=K,K=ue)}return L(K);case f:e:{for(Se=Z.key;H!==null;){if(H.key===Se)if(H.tag===4&&H.stateNode.containerInfo===Z.containerInfo&&H.stateNode.implementation===Z.implementation){d(K,H.sibling),H=y(H,Z.children||[]),H.return=K,K=H;break e}else{d(K,H);break}else a(K,H);H=H.sibling}H=eh(Z,K.mode,ue),H.return=K,K=H}return L(K);case h:return Se=Z._init,Ar(K,H,Se(Z._payload),ue)}if(z(Z))return ze(K,H,Z,ue);if(P(Z))return on(K,H,Z,ue);Pl(K,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"?(Z=""+Z,H!==null&&H.tag===6?(d(K,H.sibling),H=y(H,Z),H.return=K,K=H):(d(K,H),H=Jf(Z,K.mode,ue),H.return=K,K=H),L(K)):d(K,H)}return Ar}var As=$g(!0),Hg=$g(!1),Nl=Zr(null),Al=null,Ms=null,sf=null;function of(){sf=Ms=Al=null}function Xg(o,a,d){pe?(Ue(Nl,a._currentValue),a._currentValue=d):(Ue(Nl,a._currentValue2),a._currentValue2=d)}function af(o){var a=Nl.current;We(Nl),pe?o._currentValue=a:o._currentValue2=a}function lf(o,a,d){for(;o!==null;){var g=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),o===d)break;o=o.return}}function Rs(o,a){Al=o,sf=Ms=null,o=o.dependencies,o!==null&&o.firstContext!==null&&(o.lanes&a&&(nn=!0),o.firstContext=null)}function En(o){var a=pe?o._currentValue:o._currentValue2;if(sf!==o)if(o={context:o,memoizedValue:a,next:null},Ms===null){if(Al===null)throw Error(l(308));Ms=o,Al.dependencies={lanes:0,firstContext:o}}else Ms=Ms.next=o;return a}var Gi=null;function uf(o){Gi===null?Gi=[o]:Gi.push(o)}function Yg(o,a,d,g){var y=a.interleaved;return y===null?(d.next=d,uf(a)):(d.next=y.next,y.next=d),a.interleaved=d,ur(o,g)}function ur(o,a){o.lanes|=a;var d=o.alternate;for(d!==null&&(d.lanes|=a),d=o,o=o.return;o!==null;)o.childLanes|=a,d=o.alternate,d!==null&&(d.childLanes|=a),d=o,o=o.return;return d.tag===3?d.stateNode:null}var Jr=!1;function cf(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kg(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function br(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function ei(o,a,d){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,Ce&2){var y=g.pending;return y===null?a.next=a:(a.next=y.next,y.next=a),g.pending=a,ur(o,d)}return y=g.interleaved,y===null?(a.next=a,uf(g)):(a.next=y.next,y.next=a),g.interleaved=a,ur(o,d)}function Ml(o,a,d){if(a=a.updateQueue,a!==null&&(a=a.shared,(d&4194240)!==0)){var g=a.lanes;g&=o.pendingLanes,d|=g,a.lanes=d,Yd(o,d)}}function Qg(o,a){var d=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var y=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var L={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};b===null?y=b=L:b=b.next=L,d=d.next}while(d!==null);b===null?y=b=a:b=b.next=a}else y=b=a;d={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:b,shared:g.shared,effects:g.effects},o.updateQueue=d;return}o=d.lastBaseUpdate,o===null?d.firstBaseUpdate=a:o.next=a,d.lastBaseUpdate=a}function Rl(o,a,d,g){var y=o.updateQueue;Jr=!1;var b=y.firstBaseUpdate,L=y.lastBaseUpdate,$=y.shared.pending;if($!==null){y.shared.pending=null;var Q=$,se=Q.next;Q.next=null,L===null?b=se:L.next=se,L=Q;var he=o.alternate;he!==null&&(he=he.updateQueue,$=he.lastBaseUpdate,$!==L&&($===null?he.firstBaseUpdate=se:$.next=se,he.lastBaseUpdate=Q))}if(b!==null){var we=y.baseState;L=0,he=se=Q=null,$=b;do{var le=$.lane,$e=$.eventTime;if((g&le)===le){he!==null&&(he=he.next={eventTime:$e,lane:0,tag:$.tag,payload:$.payload,callback:$.callback,next:null});e:{var ze=o,on=$;switch(le=a,$e=d,on.tag){case 1:if(ze=on.payload,typeof ze=="function"){we=ze.call($e,we,le);break e}we=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=on.payload,le=typeof ze=="function"?ze.call($e,we,le):ze,le==null)break e;we=s({},we,le);break e;case 2:Jr=!0}}$.callback!==null&&$.lane!==0&&(o.flags|=64,le=y.effects,le===null?y.effects=[$]:le.push($))}else $e={eventTime:$e,lane:le,tag:$.tag,payload:$.payload,callback:$.callback,next:null},he===null?(se=he=$e,Q=we):he=he.next=$e,L|=le;if($=$.next,$===null){if($=y.shared.pending,$===null)break;le=$,$=le.next,le.next=null,y.lastBaseUpdate=le,y.shared.pending=null}}while(1);if(he===null&&(Q=we),y.baseState=Q,y.firstBaseUpdate=se,y.lastBaseUpdate=he,a=y.shared.interleaved,a!==null){y=a;do L|=y.lane,y=y.next;while(y!==a)}else b===null&&(y.shared.lanes=0);Wi|=L,o.lanes=L,o.memoizedState=we}}function Zg(o,a,d){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var g=o[a],y=g.callback;if(y!==null){if(g.callback=null,g=d,typeof y!="function")throw Error(l(191,y));y.call(g)}}}var Uo={},Tn=Zr(Uo),Go=Zr(Uo),Is=Zr(Uo);function cr(o){if(o===Uo)throw Error(l(174));return o}function df(o,a){Ue(Is,a),Ue(Go,o),Ue(Tn,Uo),o=Y(a),We(Tn),Ue(Tn,o)}function Ls(){We(Tn),We(Go),We(Is)}function qg(o){var a=cr(Is.current),d=cr(Tn.current);a=O(d,o.type,a),d!==a&&(Ue(Go,o),Ue(Tn,a))}function ff(o){Go.current===o&&(We(Tn),We(Go))}var qe=Zr(0);function Il(o){for(var a=o;a!==null;){if(a.tag===13){var d=a.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||Mg(d)||Ud(d)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var hf=[];function pf(){for(var o=0;o<hf.length;o++){var a=hf[o];pe?a._workInProgressVersionPrimary=null:a._workInProgressVersionSecondary=null}hf.length=0}var Ll=c.ReactCurrentDispatcher,gf=c.ReactCurrentBatchConfig,Vi=0,Je=null,ht=null,St=null,Fl=!1,Vo=!1,Wo=0,d6=0;function jt(){throw Error(l(321))}function mf(o,a){if(a===null)return!1;for(var d=0;d<a.length&&d<o.length;d++)if(!Gn(o[d],a[d]))return!1;return!0}function yf(o,a,d,g,y,b){if(Vi=b,Je=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Ll.current=o===null||o.memoizedState===null?g6:m6,o=d(g,y),Vo){b=0;do{if(Vo=!1,Wo=0,25<=b)throw Error(l(301));b+=1,St=ht=null,a.updateQueue=null,Ll.current=y6,o=d(g,y)}while(Vo)}if(Ll.current=Dl,a=ht!==null&&ht.next!==null,Vi=0,St=ht=Je=null,Fl=!1,a)throw Error(l(300));return o}function vf(){var o=Wo!==0;return Wo=0,o}function dr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?Je.memoizedState=St=o:St=St.next=o,St}function bn(){if(ht===null){var o=Je.alternate;o=o!==null?o.memoizedState:null}else o=ht.next;var a=St===null?Je.memoizedState:St.next;if(a!==null)St=a,ht=o;else{if(o===null)throw Error(l(310));ht=o,o={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},St===null?Je.memoizedState=St=o:St=St.next=o}return St}function $o(o,a){return typeof a=="function"?a(o):a}function xf(o){var a=bn(),d=a.queue;if(d===null)throw Error(l(311));d.lastRenderedReducer=o;var g=ht,y=g.baseQueue,b=d.pending;if(b!==null){if(y!==null){var L=y.next;y.next=b.next,b.next=L}g.baseQueue=y=b,d.pending=null}if(y!==null){b=y.next,g=g.baseState;var $=L=null,Q=null,se=b;do{var he=se.lane;if((Vi&he)===he)Q!==null&&(Q=Q.next={lane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),g=se.hasEagerState?se.eagerState:o(g,se.action);else{var we={lane:he,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null};Q===null?($=Q=we,L=g):Q=Q.next=we,Je.lanes|=he,Wi|=he}se=se.next}while(se!==null&&se!==b);Q===null?L=g:Q.next=$,Gn(g,a.memoizedState)||(nn=!0),a.memoizedState=g,a.baseState=L,a.baseQueue=Q,d.lastRenderedState=g}if(o=d.interleaved,o!==null){y=o;do b=y.lane,Je.lanes|=b,Wi|=b,y=y.next;while(y!==o)}else y===null&&(d.lanes=0);return[a.memoizedState,d.dispatch]}function wf(o){var a=bn(),d=a.queue;if(d===null)throw Error(l(311));d.lastRenderedReducer=o;var g=d.dispatch,y=d.pending,b=a.memoizedState;if(y!==null){d.pending=null;var L=y=y.next;do b=o(b,L.action),L=L.next;while(L!==y);Gn(b,a.memoizedState)||(nn=!0),a.memoizedState=b,a.baseQueue===null&&(a.baseState=b),d.lastRenderedState=b}return[b,g]}function Jg(){}function e1(o,a){var d=Je,g=bn(),y=a(),b=!Gn(g.memoizedState,y);if(b&&(g.memoizedState=y,nn=!0),g=g.queue,_f(r1.bind(null,d,g,o),[o]),g.getSnapshot!==a||b||St!==null&&St.memoizedState.tag&1){if(d.flags|=2048,Ho(9,n1.bind(null,d,g,y,a),void 0,null),kt===null)throw Error(l(349));Vi&30||t1(d,a,y)}return y}function t1(o,a,d){o.flags|=16384,o={getSnapshot:a,value:d},a=Je.updateQueue,a===null?(a={lastEffect:null,stores:null},Je.updateQueue=a,a.stores=[o]):(d=a.stores,d===null?a.stores=[o]:d.push(o))}function n1(o,a,d,g){a.value=d,a.getSnapshot=g,i1(a)&&s1(o)}function r1(o,a,d){return d(function(){i1(a)&&s1(o)})}function i1(o){var a=o.getSnapshot;o=o.value;try{var d=a();return!Gn(o,d)}catch{return!0}}function s1(o){var a=ur(o,1);a!==null&&Pn(a,o,1,-1)}function o1(o){var a=dr();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$o,lastRenderedState:o},a.queue=o,o=o.dispatch=p6.bind(null,Je,o),[a.memoizedState,o]}function Ho(o,a,d,g){return o={tag:o,create:a,destroy:d,deps:g,next:null},a=Je.updateQueue,a===null?(a={lastEffect:null,stores:null},Je.updateQueue=a,a.lastEffect=o.next=o):(d=a.lastEffect,d===null?a.lastEffect=o.next=o:(g=d.next,d.next=o,o.next=g,a.lastEffect=o)),o}function a1(){return bn().memoizedState}function Ol(o,a,d,g){var y=dr();Je.flags|=o,y.memoizedState=Ho(1|a,d,void 0,g===void 0?null:g)}function jl(o,a,d,g){var y=bn();g=g===void 0?null:g;var b=void 0;if(ht!==null){var L=ht.memoizedState;if(b=L.destroy,g!==null&&mf(g,L.deps)){y.memoizedState=Ho(a,d,b,g);return}}Je.flags|=o,y.memoizedState=Ho(1|a,d,b,g)}function l1(o,a){return Ol(8390656,8,o,a)}function _f(o,a){return jl(2048,8,o,a)}function u1(o,a){return jl(4,2,o,a)}function c1(o,a){return jl(4,4,o,a)}function d1(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function f1(o,a,d){return d=d!=null?d.concat([o]):null,jl(4,4,d1.bind(null,a,o),d)}function Sf(){}function h1(o,a){var d=bn();a=a===void 0?null:a;var g=d.memoizedState;return g!==null&&a!==null&&mf(a,g[1])?g[0]:(d.memoizedState=[o,a],o)}function p1(o,a){var d=bn();a=a===void 0?null:a;var g=d.memoizedState;return g!==null&&a!==null&&mf(a,g[1])?g[0]:(o=o(),d.memoizedState=[o,a],o)}function g1(o,a,d){return Vi&21?(Gn(d,a)||(d=Fg(),Je.lanes|=d,Wi|=d,o.baseState=!0),a):(o.baseState&&(o.baseState=!1,nn=!0),o.memoizedState=d)}function f6(o,a){var d=Ie;Ie=d!==0&&4>d?d:4,o(!0);var g=gf.transition;gf.transition={};try{o(!1),a()}finally{Ie=d,gf.transition=g}}function m1(){return bn().memoizedState}function h6(o,a,d){var g=ri(o);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},y1(o))v1(a,d);else if(d=Yg(o,a,d,g),d!==null){var y=Bt();Pn(d,o,g,y),x1(d,a,g)}}function p6(o,a,d){var g=ri(o),y={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(y1(o))v1(a,y);else{var b=o.alternate;if(o.lanes===0&&(b===null||b.lanes===0)&&(b=a.lastRenderedReducer,b!==null))try{var L=a.lastRenderedState,$=b(L,d);if(y.hasEagerState=!0,y.eagerState=$,Gn($,L)){var Q=a.interleaved;Q===null?(y.next=y,uf(a)):(y.next=Q.next,Q.next=y),a.interleaved=y;return}}catch{}finally{}d=Yg(o,a,y,g),d!==null&&(y=Bt(),Pn(d,o,g,y),x1(d,a,g))}}function y1(o){var a=o.alternate;return o===Je||a!==null&&a===Je}function v1(o,a){Vo=Fl=!0;var d=o.pending;d===null?a.next=a:(a.next=d.next,d.next=a),o.pending=a}function x1(o,a,d){if(d&4194240){var g=a.lanes;g&=o.pendingLanes,d|=g,a.lanes=d,Yd(o,d)}}var Dl={readContext:En,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},g6={readContext:En,useCallback:function(o,a){return dr().memoizedState=[o,a===void 0?null:a],o},useContext:En,useEffect:l1,useImperativeHandle:function(o,a,d){return d=d!=null?d.concat([o]):null,Ol(4194308,4,d1.bind(null,a,o),d)},useLayoutEffect:function(o,a){return Ol(4194308,4,o,a)},useInsertionEffect:function(o,a){return Ol(4,2,o,a)},useMemo:function(o,a){var d=dr();return a=a===void 0?null:a,o=o(),d.memoizedState=[o,a],o},useReducer:function(o,a,d){var g=dr();return a=d!==void 0?d(a):a,g.memoizedState=g.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},g.queue=o,o=o.dispatch=h6.bind(null,Je,o),[g.memoizedState,o]},useRef:function(o){var a=dr();return o={current:o},a.memoizedState=o},useState:o1,useDebugValue:Sf,useDeferredValue:function(o){return dr().memoizedState=o},useTransition:function(){var o=o1(!1),a=o[0];return o=f6.bind(null,o[1]),dr().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,d){var g=Je,y=dr();if(Ye){if(d===void 0)throw Error(l(407));d=d()}else{if(d=a(),kt===null)throw Error(l(349));Vi&30||t1(g,a,d)}y.memoizedState=d;var b={value:d,getSnapshot:a};return y.queue=b,l1(r1.bind(null,g,b,o),[o]),g.flags|=2048,Ho(9,n1.bind(null,g,b,d,a),void 0,null),d},useId:function(){var o=dr(),a=kt.identifierPrefix;if(Ye){var d=Tr,g=Er;d=(g&~(1<<32-Un(g)-1)).toString(32)+d,a=":"+a+"R"+d,d=Wo++,0<d&&(a+="H"+d.toString(32)),a+=":"}else d=d6++,a=":"+a+"r"+d.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},m6={readContext:En,useCallback:h1,useContext:En,useEffect:_f,useImperativeHandle:f1,useInsertionEffect:u1,useLayoutEffect:c1,useMemo:p1,useReducer:xf,useRef:a1,useState:function(){return xf($o)},useDebugValue:Sf,useDeferredValue:function(o){var a=bn();return g1(a,ht.memoizedState,o)},useTransition:function(){var o=xf($o)[0],a=bn().memoizedState;return[o,a]},useMutableSource:Jg,useSyncExternalStore:e1,useId:m1,unstable_isNewReconciler:!1},y6={readContext:En,useCallback:h1,useContext:En,useEffect:_f,useImperativeHandle:f1,useInsertionEffect:u1,useLayoutEffect:c1,useMemo:p1,useReducer:wf,useRef:a1,useState:function(){return wf($o)},useDebugValue:Sf,useDeferredValue:function(o){var a=bn();return ht===null?a.memoizedState=o:g1(a,ht.memoizedState,o)},useTransition:function(){var o=wf($o)[0],a=bn().memoizedState;return[o,a]},useMutableSource:Jg,useSyncExternalStore:e1,useId:m1,unstable_isNewReconciler:!1};function Wn(o,a){if(o&&o.defaultProps){a=s({},a),o=o.defaultProps;for(var d in o)a[d]===void 0&&(a[d]=o[d]);return a}return a}function kf(o,a,d,g){a=o.memoizedState,d=d(g,a),d=d==null?a:s({},a,d),o.memoizedState=d,o.lanes===0&&(o.updateQueue.baseState=d)}var zl={isMounted:function(o){return(o=o._reactInternals)?F(o)===o:!1},enqueueSetState:function(o,a,d){o=o._reactInternals;var g=Bt(),y=ri(o),b=br(g,y);b.payload=a,d!=null&&(b.callback=d),a=ei(o,b,y),a!==null&&(Pn(a,o,y,g),Ml(a,o,y))},enqueueReplaceState:function(o,a,d){o=o._reactInternals;var g=Bt(),y=ri(o),b=br(g,y);b.tag=1,b.payload=a,d!=null&&(b.callback=d),a=ei(o,b,y),a!==null&&(Pn(a,o,y,g),Ml(a,o,y))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var d=Bt(),g=ri(o),y=br(d,g);y.tag=2,a!=null&&(y.callback=a),a=ei(o,y,g),a!==null&&(Pn(a,o,g,d),Ml(a,o,g))}};function w1(o,a,d,g,y,b,L){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,b,L):a.prototype&&a.prototype.isPureReactComponent?!bl(d,g)||!bl(y,b):!0}function _1(o,a,d){var g=!1,y=qr,b=a.contextType;return typeof b=="object"&&b!==null?b=En(b):(y=tn(a)?zi:Ot.current,g=a.contextTypes,b=(g=g!=null)?Ts(o,y):qr),a=new a(d,b),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=zl,o.stateNode=a,a._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=y,o.__reactInternalMemoizedMaskedChildContext=b),a}function S1(o,a,d,g){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(d,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(d,g),a.state!==o&&zl.enqueueReplaceState(a,a.state,null)}function Cf(o,a,d,g){var y=o.stateNode;y.props=d,y.state=o.memoizedState,y.refs={},cf(o);var b=a.contextType;typeof b=="object"&&b!==null?y.context=En(b):(b=tn(a)?zi:Ot.current,y.context=Ts(o,b)),y.state=o.memoizedState,b=a.getDerivedStateFromProps,typeof b=="function"&&(kf(o,a,b,d),y.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(a=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),a!==y.state&&zl.enqueueReplaceState(y,y.state,null),Rl(o,d,y,g),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308)}function Fs(o,a){try{var d="",g=a;do d+=c6(g),g=g.return;while(g);var y=d}catch(b){y=`
Error generating stack: `+b.message+`
`+b.stack}return{value:o,source:a,stack:y,digest:null}}function Ef(o,a,d){return{value:o,source:null,stack:d??null,digest:a??null}}function Tf(o,a){try{console.error(a.value)}catch(d){setTimeout(function(){throw d})}}var v6=typeof WeakMap=="function"?WeakMap:Map;function k1(o,a,d){d=br(-1,d),d.tag=3,d.payload={element:null};var g=a.value;return d.callback=function(){Jl||(Jl=!0,Hf=g),Tf(o,a)},d}function C1(o,a,d){d=br(-1,d),d.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var y=a.value;d.payload=function(){return g(y)},d.callback=function(){Tf(o,a)}}var b=o.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(d.callback=function(){Tf(o,a),typeof g!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var L=a.stack;this.componentDidCatch(a.value,{componentStack:L!==null?L:""})}),d}function E1(o,a,d){var g=o.pingCache;if(g===null){g=o.pingCache=new v6;var y=new Set;g.set(a,y)}else y=g.get(a),y===void 0&&(y=new Set,g.set(a,y));y.has(d)||(y.add(d),o=R6.bind(null,o,a,d),a.then(o,o))}function T1(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function b1(o,a,d,g,y){return o.mode&1?(o.flags|=65536,o.lanes=y,o):(o===a?o.flags|=65536:(o.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(a=br(-1,1),a.tag=2,ei(d,a,1))),d.lanes|=1),o)}var x6=c.ReactCurrentOwner,nn=!1;function Xt(o,a,d,g){a.child=o===null?Hg(a,null,d,g):As(a,o.child,d,g)}function P1(o,a,d,g,y){d=d.render;var b=a.ref;return Rs(a,y),g=yf(o,a,d,g,b,y),d=vf(),o!==null&&!nn?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~y,Pr(o,a,y)):(Ye&&d&&Jd(a),a.flags|=1,Xt(o,a,g,y),a.child)}function N1(o,a,d,g,y){if(o===null){var b=d.type;return typeof b=="function"&&!qf(b)&&b.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(a.tag=15,a.type=b,A1(o,a,b,g,y)):(o=su(d.type,null,g,a,a.mode,y),o.ref=a.ref,o.return=a,a.child=o)}if(b=o.child,!(o.lanes&y)){var L=b.memoizedProps;if(d=d.compare,d=d!==null?d:bl,d(L,g)&&o.ref===a.ref)return Pr(o,a,y)}return a.flags|=1,o=si(b,g),o.ref=a.ref,o.return=a,a.child=o}function A1(o,a,d,g,y){if(o!==null){var b=o.memoizedProps;if(bl(b,g)&&o.ref===a.ref)if(nn=!1,a.pendingProps=g=b,(o.lanes&y)!==0)o.flags&131072&&(nn=!0);else return a.lanes=o.lanes,Pr(o,a,y)}return bf(o,a,d,g,y)}function M1(o,a,d){var g=a.pendingProps,y=g.children,b=o!==null?o.memoizedState:null;if(g.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ue(js,pn),pn|=d;else{if(!(d&1073741824))return o=b!==null?b.baseLanes|d:d,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,Ue(js,pn),pn|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=b!==null?b.baseLanes:d,Ue(js,pn),pn|=g}else b!==null?(g=b.baseLanes|d,a.memoizedState=null):g=d,Ue(js,pn),pn|=g;return Xt(o,a,y,d),a.child}function R1(o,a){var d=a.ref;(o===null&&d!==null||o!==null&&o.ref!==d)&&(a.flags|=512,a.flags|=2097152)}function bf(o,a,d,g,y){var b=tn(d)?zi:Ot.current;return b=Ts(a,b),Rs(a,y),d=yf(o,a,d,g,b,y),g=vf(),o!==null&&!nn?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~y,Pr(o,a,y)):(Ye&&g&&Jd(a),a.flags|=1,Xt(o,a,d,y),a.child)}function I1(o,a,d,g,y){if(tn(d)){var b=!0;vl(a)}else b=!1;if(Rs(a,y),a.stateNode===null)Ul(o,a),_1(a,d,g),Cf(a,d,g,y),g=!0;else if(o===null){var L=a.stateNode,$=a.memoizedProps;L.props=$;var Q=L.context,se=d.contextType;typeof se=="object"&&se!==null?se=En(se):(se=tn(d)?zi:Ot.current,se=Ts(a,se));var he=d.getDerivedStateFromProps,we=typeof he=="function"||typeof L.getSnapshotBeforeUpdate=="function";we||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||($!==g||Q!==se)&&S1(a,L,g,se),Jr=!1;var le=a.memoizedState;L.state=le,Rl(a,g,L,y),Q=a.memoizedState,$!==g||le!==Q||en.current||Jr?(typeof he=="function"&&(kf(a,d,he,g),Q=a.memoizedState),($=Jr||w1(a,d,$,g,le,Q,se))?(we||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(a.flags|=4194308)):(typeof L.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=Q),L.props=g,L.state=Q,L.context=se,g=$):(typeof L.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{L=a.stateNode,Kg(o,a),$=a.memoizedProps,se=a.type===a.elementType?$:Wn(a.type,$),L.props=se,we=a.pendingProps,le=L.context,Q=d.contextType,typeof Q=="object"&&Q!==null?Q=En(Q):(Q=tn(d)?zi:Ot.current,Q=Ts(a,Q));var $e=d.getDerivedStateFromProps;(he=typeof $e=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||($!==we||le!==Q)&&S1(a,L,g,Q),Jr=!1,le=a.memoizedState,L.state=le,Rl(a,g,L,y);var ze=a.memoizedState;$!==we||le!==ze||en.current||Jr?(typeof $e=="function"&&(kf(a,d,$e,g),ze=a.memoizedState),(se=Jr||w1(a,d,se,g,le,ze,Q)||!1)?(he||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(g,ze,Q),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(g,ze,Q)),typeof L.componentDidUpdate=="function"&&(a.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof L.componentDidUpdate!="function"||$===o.memoizedProps&&le===o.memoizedState||(a.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||$===o.memoizedProps&&le===o.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=ze),L.props=g,L.state=ze,L.context=Q,g=se):(typeof L.componentDidUpdate!="function"||$===o.memoizedProps&&le===o.memoizedState||(a.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||$===o.memoizedProps&&le===o.memoizedState||(a.flags|=1024),g=!1)}return Pf(o,a,d,g,b,y)}function Pf(o,a,d,g,y,b){R1(o,a);var L=(a.flags&128)!==0;if(!g&&!L)return y&&Lg(a,d,!1),Pr(o,a,b);g=a.stateNode,x6.current=a;var $=L&&typeof d.getDerivedStateFromError!="function"?null:g.render();return a.flags|=1,o!==null&&L?(a.child=As(a,o.child,null,b),a.child=As(a,null,$,b)):Xt(o,a,$,b),a.memoizedState=g.state,y&&Lg(a,d,!0),a.child}function L1(o){var a=o.stateNode;a.pendingContext?Rg(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Rg(o,a.context,!1),df(o,a.containerInfo)}function F1(o,a,d,g,y){return Ns(),rf(y),a.flags|=256,Xt(o,a,d,g),a.child}var Nf={dehydrated:null,treeContext:null,retryLane:0};function Af(o){return{baseLanes:o,cachePool:null,transitions:null}}function O1(o,a,d){var g=a.pendingProps,y=qe.current,b=!1,L=(a.flags&128)!==0,$;if(($=L)||($=o!==null&&o.memoizedState===null?!1:(y&2)!==0),$?(b=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(y|=1),Ue(qe,y&1),o===null)return nf(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?(a.mode&1?Ud(o)?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(L=g.children,o=g.fallback,b?(g=a.mode,b=a.child,L={mode:"hidden",children:L},!(g&1)&&b!==null?(b.childLanes=0,b.pendingProps=L):b=ou(L,g,0,null),o=Yi(o,g,d,null),b.return=a,o.return=a,b.sibling=o,a.child=b,a.child.memoizedState=Af(d),a.memoizedState=Nf,o):Mf(a,L));if(y=o.memoizedState,y!==null&&($=y.dehydrated,$!==null))return w6(o,a,L,g,$,y,d);if(b){b=g.fallback,L=a.mode,y=o.child,$=y.sibling;var Q={mode:"hidden",children:g.children};return!(L&1)&&a.child!==y?(g=a.child,g.childLanes=0,g.pendingProps=Q,a.deletions=null):(g=si(y,Q),g.subtreeFlags=y.subtreeFlags&14680064),$!==null?b=si($,b):(b=Yi(b,L,d,null),b.flags|=2),b.return=a,g.return=a,g.sibling=b,a.child=g,g=b,b=a.child,L=o.child.memoizedState,L=L===null?Af(d):{baseLanes:L.baseLanes|d,cachePool:null,transitions:L.transitions},b.memoizedState=L,b.childLanes=o.childLanes&~d,a.memoizedState=Nf,g}return b=o.child,o=b.sibling,g=si(b,{mode:"visible",children:g.children}),!(a.mode&1)&&(g.lanes=d),g.return=a,g.sibling=null,o!==null&&(d=a.deletions,d===null?(a.deletions=[o],a.flags|=16):d.push(o)),a.child=g,a.memoizedState=null,g}function Mf(o,a){return a=ou({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function Bl(o,a,d,g){return g!==null&&rf(g),As(a,o.child,null,d),o=Mf(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function w6(o,a,d,g,y,b,L){if(d)return a.flags&256?(a.flags&=-257,g=Ef(Error(l(422))),Bl(o,a,L,g)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(b=g.fallback,y=a.mode,g=ou({mode:"visible",children:g.children},y,0,null),b=Yi(b,y,L,null),b.flags|=2,g.return=a,b.return=a,g.sibling=b,a.child=g,a.mode&1&&As(a,o.child,null,L),a.child.memoizedState=Af(L),a.memoizedState=Nf,b);if(!(a.mode&1))return Bl(o,a,L,null);if(Ud(y))return g=I4(y).digest,b=Error(l(419)),g=Ef(b,g,void 0),Bl(o,a,L,g);if(d=(L&o.childLanes)!==0,nn||d){if(g=kt,g!==null){switch(L&-L){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=y&(g.suspendedLanes|L)?0:y,y!==0&&y!==b.retryLane&&(b.retryLane=y,ur(o,y),Pn(g,o,y,-1))}return Zf(),g=Ef(Error(l(421))),Bl(o,a,L,g)}return Mg(y)?(a.flags|=128,a.child=o.child,a=I6.bind(null,o),L4(y,a),null):(o=b.treeContext,Te&&(Cn=j4(y),hn=a,Ye=!0,Vn=null,zo=!1,o!==null&&(Sn[kn++]=Er,Sn[kn++]=Tr,Sn[kn++]=Bi,Er=o.id,Tr=o.overflow,Bi=a)),a=Mf(a,g.children),a.flags|=4096,a)}function j1(o,a,d){o.lanes|=a;var g=o.alternate;g!==null&&(g.lanes|=a),lf(o.return,a,d)}function Rf(o,a,d,g,y){var b=o.memoizedState;b===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:y}:(b.isBackwards=a,b.rendering=null,b.renderingStartTime=0,b.last=g,b.tail=d,b.tailMode=y)}function D1(o,a,d){var g=a.pendingProps,y=g.revealOrder,b=g.tail;if(Xt(o,a,g.children,d),g=qe.current,g&2)g=g&1|2,a.flags|=128;else{if(o!==null&&o.flags&128)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&j1(o,d,a);else if(o.tag===19)j1(o,d,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(Ue(qe,g),!(a.mode&1))a.memoizedState=null;else switch(y){case"forwards":for(d=a.child,y=null;d!==null;)o=d.alternate,o!==null&&Il(o)===null&&(y=d),d=d.sibling;d=y,d===null?(y=a.child,a.child=null):(y=d.sibling,d.sibling=null),Rf(a,!1,y,d,b);break;case"backwards":for(d=null,y=a.child,a.child=null;y!==null;){if(o=y.alternate,o!==null&&Il(o)===null){a.child=y;break}o=y.sibling,y.sibling=d,d=y,y=o}Rf(a,!0,d,null,b);break;case"together":Rf(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Ul(o,a){!(a.mode&1)&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Pr(o,a,d){if(o!==null&&(a.dependencies=o.dependencies),Wi|=a.lanes,!(d&a.childLanes))return null;if(o!==null&&a.child!==o.child)throw Error(l(153));if(a.child!==null){for(o=a.child,d=si(o,o.pendingProps),a.child=d,d.return=a;o.sibling!==null;)o=o.sibling,d=d.sibling=si(o,o.pendingProps),d.return=a;d.sibling=null}return a.child}function _6(o,a,d){switch(a.tag){case 3:L1(a),Ns();break;case 5:qg(a);break;case 1:tn(a.type)&&vl(a);break;case 4:df(a,a.stateNode.containerInfo);break;case 10:Xg(a,a.type._context,a.memoizedProps.value);break;case 13:var g=a.memoizedState;if(g!==null)return g.dehydrated!==null?(Ue(qe,qe.current&1),a.flags|=128,null):d&a.child.childLanes?O1(o,a,d):(Ue(qe,qe.current&1),o=Pr(o,a,d),o!==null?o.sibling:null);Ue(qe,qe.current&1);break;case 19:if(g=(d&a.childLanes)!==0,o.flags&128){if(g)return D1(o,a,d);a.flags|=128}var y=a.memoizedState;if(y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Ue(qe,qe.current),g)break;return null;case 22:case 23:return a.lanes=0,M1(o,a,d)}return Pr(o,a,d)}function fr(o){o.flags|=4}function z1(o,a){if(o!==null&&o.child===a.child)return!0;if(a.flags&16)return!1;for(o=a.child;o!==null;){if(o.flags&12854||o.subtreeFlags&12854)return!1;o=o.sibling}return!0}var Xo,Yo,Gl,Vl;if(me)Xo=function(o,a){for(var d=a.child;d!==null;){if(d.tag===5||d.tag===6)J(o,d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===a)break;for(;d.sibling===null;){if(d.return===null||d.return===a)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Yo=function(){},Gl=function(o,a,d,g,y){if(o=o.memoizedProps,o!==g){var b=a.stateNode,L=cr(Tn.current);d=ae(b,d,o,g,y,L),(a.updateQueue=d)&&fr(a)}},Vl=function(o,a,d,g){d!==g&&fr(a)};else if(Ae){Xo=function(o,a,d,g){for(var y=a.child;y!==null;){if(y.tag===5){var b=y.stateNode;d&&g&&(b=Ng(b,y.type,y.memoizedProps,y)),J(o,b)}else if(y.tag===6)b=y.stateNode,d&&g&&(b=Ag(b,y.memoizedProps,y)),J(o,b);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)b=y.child,b!==null&&(b.return=y),Xo(o,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===a)break;for(;y.sibling===null;){if(y.return===null||y.return===a)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};var B1=function(o,a,d,g){for(var y=a.child;y!==null;){if(y.tag===5){var b=y.stateNode;d&&g&&(b=Ng(b,y.type,y.memoizedProps,y)),Pg(o,b)}else if(y.tag===6)b=y.stateNode,d&&g&&(b=Ag(b,y.memoizedProps,y)),Pg(o,b);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)b=y.child,b!==null&&(b.return=y),B1(o,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===a)break;for(;y.sibling===null;){if(y.return===null||y.return===a)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};Yo=function(o,a){var d=a.stateNode;if(!z1(o,a)){o=d.containerInfo;var g=bg(o);B1(g,a,!1,!1),d.pendingChildren=g,fr(a),N4(o,g)}},Gl=function(o,a,d,g,y){var b=o.stateNode,L=o.memoizedProps;if((o=z1(o,a))&&L===g)a.stateNode=b;else{var $=a.stateNode,Q=cr(Tn.current),se=null;L!==g&&(se=ae($,d,L,g,y,Q)),o&&se===null?a.stateNode=b:(b=P4(b,se,d,L,g,a,o,$),te(b,d,g,y,Q)&&fr(a),a.stateNode=b,o?fr(a):Xo(b,a,!1,!1))}},Vl=function(o,a,d,g){d!==g?(o=cr(Is.current),d=cr(Tn.current),a.stateNode=oe(g,o,d,a),fr(a)):a.stateNode=o.stateNode}}else Yo=function(){},Gl=function(){},Vl=function(){};function Ko(o,a){if(!Ye)switch(o.tailMode){case"hidden":a=o.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?o.tail=null:d.sibling=null;break;case"collapsed":d=o.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Dt(o){var a=o.alternate!==null&&o.alternate.child===o.child,d=0,g=0;if(a)for(var y=o.child;y!==null;)d|=y.lanes|y.childLanes,g|=y.subtreeFlags&14680064,g|=y.flags&14680064,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)d|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=g,o.childLanes=d,a}function S6(o,a,d){var g=a.pendingProps;switch(ef(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(a),null;case 1:return tn(a.type)&&yl(),Dt(a),null;case 3:return d=a.stateNode,Ls(),We(en),We(Ot),pf(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(o===null||o.child===null)&&(Tl(a)?fr(a):o===null||o.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,Vn!==null&&(Kf(Vn),Vn=null))),Yo(o,a),Dt(a),null;case 5:ff(a),d=cr(Is.current);var y=a.type;if(o!==null&&a.stateNode!=null)Gl(o,a,y,g,d),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!g){if(a.stateNode===null)throw Error(l(166));return Dt(a),null}if(o=cr(Tn.current),Tl(a)){if(!Te)throw Error(l(175));o=D4(a.stateNode,a.type,a.memoizedProps,d,o,a,!zo),a.updateQueue=o,o!==null&&fr(a)}else{var b=ee(y,g,d,o,a);Xo(b,a,!1,!1),a.stateNode=b,te(b,y,g,d,o)&&fr(a)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Dt(a),null;case 6:if(o&&a.stateNode!=null)Vl(o,a,o.memoizedProps,g);else{if(typeof g!="string"&&a.stateNode===null)throw Error(l(166));if(o=cr(Is.current),d=cr(Tn.current),Tl(a)){if(!Te)throw Error(l(176));if(o=a.stateNode,d=a.memoizedProps,(g=z4(o,d,a,!zo))&&(y=hn,y!==null))switch(y.tag){case 3:X4(y.stateNode.containerInfo,o,d,(y.mode&1)!==0);break;case 5:Y4(y.type,y.memoizedProps,y.stateNode,o,d,(y.mode&1)!==0)}g&&fr(a)}else a.stateNode=oe(g,o,d,a)}return Dt(a),null;case 13:if(We(qe),g=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Ye&&Cn!==null&&a.mode&1&&!(a.flags&128))Vg(),Ns(),a.flags|=98560,y=!1;else if(y=Tl(a),g!==null&&g.dehydrated!==null){if(o===null){if(!y)throw Error(l(318));if(!Te)throw Error(l(344));if(y=a.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(l(317));B4(y,a)}else Ns(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Dt(a),y=!1}else Vn!==null&&(Kf(Vn),Vn=null),y=!0;if(!y)return a.flags&65536?a:null}return a.flags&128?(a.lanes=d,a):(d=g!==null,d!==(o!==null&&o.memoizedState!==null)&&d&&(a.child.flags|=8192,a.mode&1&&(o===null||qe.current&1?pt===0&&(pt=3):Zf())),a.updateQueue!==null&&(a.flags|=4),Dt(a),null);case 4:return Ls(),Yo(o,a),o===null&&Me(a.stateNode.containerInfo),Dt(a),null;case 10:return af(a.type._context),Dt(a),null;case 17:return tn(a.type)&&yl(),Dt(a),null;case 19:if(We(qe),y=a.memoizedState,y===null)return Dt(a),null;if(g=(a.flags&128)!==0,b=y.rendering,b===null)if(g)Ko(y,!1);else{if(pt!==0||o!==null&&o.flags&128)for(o=a.child;o!==null;){if(b=Il(o),b!==null){for(a.flags|=128,Ko(y,!1),o=b.updateQueue,o!==null&&(a.updateQueue=o,a.flags|=4),a.subtreeFlags=0,o=d,d=a.child;d!==null;)g=d,y=o,g.flags&=14680066,b=g.alternate,b===null?(g.childLanes=0,g.lanes=y,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=b.childLanes,g.lanes=b.lanes,g.child=b.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=b.memoizedProps,g.memoizedState=b.memoizedState,g.updateQueue=b.updateQueue,g.type=b.type,y=b.dependencies,g.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),d=d.sibling;return Ue(qe,qe.current&1|2),a.child}o=o.sibling}y.tail!==null&&_t()>$f&&(a.flags|=128,g=!0,Ko(y,!1),a.lanes=4194304)}else{if(!g)if(o=Il(b),o!==null){if(a.flags|=128,g=!0,o=o.updateQueue,o!==null&&(a.updateQueue=o,a.flags|=4),Ko(y,!0),y.tail===null&&y.tailMode==="hidden"&&!b.alternate&&!Ye)return Dt(a),null}else 2*_t()-y.renderingStartTime>$f&&d!==1073741824&&(a.flags|=128,g=!0,Ko(y,!1),a.lanes=4194304);y.isBackwards?(b.sibling=a.child,a.child=b):(o=y.last,o!==null?o.sibling=b:a.child=b,y.last=b)}return y.tail!==null?(a=y.tail,y.rendering=a,y.tail=a.sibling,y.renderingStartTime=_t(),a.sibling=null,o=qe.current,Ue(qe,g?o&1|2:o&1),a):(Dt(a),null);case 22:case 23:return Qf(),d=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==d&&(a.flags|=8192),d&&a.mode&1?pn&1073741824&&(Dt(a),me&&a.subtreeFlags&6&&(a.flags|=8192)):Dt(a),null;case 24:return null;case 25:return null}throw Error(l(156,a.tag))}function k6(o,a){switch(ef(a),a.tag){case 1:return tn(a.type)&&yl(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return Ls(),We(en),We(Ot),pf(),o=a.flags,o&65536&&!(o&128)?(a.flags=o&-65537|128,a):null;case 5:return ff(a),null;case 13:if(We(qe),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(l(340));Ns()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return We(qe),null;case 4:return Ls(),null;case 10:return af(a.type._context),null;case 22:case 23:return Qf(),null;case 24:return null;default:return null}}var Wl=!1,zt=!1,C6=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Os(o,a){var d=o.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){Ke(o,a,g)}else d.current=null}function If(o,a,d){try{d()}catch(g){Ke(o,a,g)}}var U1=!1;function E6(o,a){for(W(o.containerInfo),ce=a;ce!==null;)if(o=ce,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,ce=a;else for(;ce!==null;){o=ce;try{var d=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(d!==null){var g=d.memoizedProps,y=d.memoizedState,b=o.stateNode,L=b.getSnapshotBeforeUpdate(o.elementType===o.type?g:Wn(o.type,g),y);b.__reactInternalSnapshotBeforeUpdate=L}break;case 3:me&&b4(o.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch($){Ke(o,o.return,$)}if(a=o.sibling,a!==null){a.return=o.return,ce=a;break}ce=o.return}return d=U1,U1=!1,d}function Qo(o,a,d){var g=a.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var y=g=g.next;do{if((y.tag&o)===o){var b=y.destroy;y.destroy=void 0,b!==void 0&&If(a,d,b)}y=y.next}while(y!==g)}}function $l(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var d=a=a.next;do{if((d.tag&o)===o){var g=d.create;d.destroy=g()}d=d.next}while(d!==a)}}function Lf(o){var a=o.ref;if(a!==null){var d=o.stateNode;switch(o.tag){case 5:o=G(d);break;default:o=d}typeof a=="function"?a(o):a.current=o}}function G1(o){var a=o.alternate;a!==null&&(o.alternate=null,G1(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&ct(a)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function V1(o){return o.tag===5||o.tag===3||o.tag===4}function W1(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||V1(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Ff(o,a,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?w4(d,o,a):gl(d,o);else if(g!==4&&(o=o.child,o!==null))for(Ff(o,a,d),o=o.sibling;o!==null;)Ff(o,a,d),o=o.sibling}function Of(o,a,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?Qr(d,o,a):Cs(d,o);else if(g!==4&&(o=o.child,o!==null))for(Of(o,a,d),o=o.sibling;o!==null;)Of(o,a,d),o=o.sibling}var Pt=null,$n=!1;function hr(o,a,d){for(d=d.child;d!==null;)jf(o,a,d),d=d.sibling}function jf(o,a,d){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(Sl,d)}catch{}switch(d.tag){case 5:zt||Os(d,a);case 6:if(me){var g=Pt,y=$n;Pt=null,hr(o,a,d),Pt=g,$n=y,Pt!==null&&($n?S4(Pt,d.stateNode):_4(Pt,d.stateNode))}else hr(o,a,d);break;case 18:me&&Pt!==null&&($n?$4(Pt,d.stateNode):W4(Pt,d.stateNode));break;case 4:me?(g=Pt,y=$n,Pt=d.stateNode.containerInfo,$n=!0,hr(o,a,d),Pt=g,$n=y):(Ae&&(g=d.stateNode.containerInfo,y=bg(g),Bd(g,y)),hr(o,a,d));break;case 0:case 11:case 14:case 15:if(!zt&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){y=g=g.next;do{var b=y,L=b.destroy;b=b.tag,L!==void 0&&(b&2||b&4)&&If(d,a,L),y=y.next}while(y!==g)}hr(o,a,d);break;case 1:if(!zt&&(Os(d,a),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch($){Ke(d,a,$)}hr(o,a,d);break;case 21:hr(o,a,d);break;case 22:d.mode&1?(zt=(g=zt)||d.memoizedState!==null,hr(o,a,d),zt=g):hr(o,a,d);break;default:hr(o,a,d)}}function $1(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var d=o.stateNode;d===null&&(d=o.stateNode=new C6),a.forEach(function(g){var y=L6.bind(null,o,g);d.has(g)||(d.add(g),g.then(y,y))})}}function Hn(o,a){var d=a.deletions;if(d!==null)for(var g=0;g<d.length;g++){var y=d[g];try{var b=o,L=a;if(me){var $=L;e:for(;$!==null;){switch($.tag){case 5:Pt=$.stateNode,$n=!1;break e;case 3:Pt=$.stateNode.containerInfo,$n=!0;break e;case 4:Pt=$.stateNode.containerInfo,$n=!0;break e}$=$.return}if(Pt===null)throw Error(l(160));jf(b,L,y),Pt=null,$n=!1}else jf(b,L,y);var Q=y.alternate;Q!==null&&(Q.return=null),y.return=null}catch(se){Ke(y,a,se)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)H1(a,o),a=a.sibling}function H1(o,a){var d=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Hn(a,o),pr(o),g&4){try{Qo(3,o,o.return),$l(3,o)}catch(le){Ke(o,o.return,le)}try{Qo(5,o,o.return)}catch(le){Ke(o,o.return,le)}}break;case 1:Hn(a,o),pr(o),g&512&&d!==null&&Os(d,d.return);break;case 5:if(Hn(a,o),pr(o),g&512&&d!==null&&Os(d,d.return),me){if(o.flags&32){var y=o.stateNode;try{Tg(y)}catch(le){Ke(o,o.return,le)}}if(g&4&&(y=o.stateNode,y!=null)){var b=o.memoizedProps;if(d=d!==null?d.memoizedProps:b,g=o.type,a=o.updateQueue,o.updateQueue=null,a!==null)try{Jt(y,a,g,d,b,o)}catch(le){Ke(o,o.return,le)}}}break;case 6:if(Hn(a,o),pr(o),g&4&&me){if(o.stateNode===null)throw Error(l(162));y=o.stateNode,b=o.memoizedProps,d=d!==null?d.memoizedProps:b;try{xe(y,d,b)}catch(le){Ke(o,o.return,le)}}break;case 3:if(Hn(a,o),pr(o),g&4){if(me&&Te&&d!==null&&d.memoizedState.isDehydrated)try{G4(a.containerInfo)}catch(le){Ke(o,o.return,le)}if(Ae){y=a.containerInfo,b=a.pendingChildren;try{Bd(y,b)}catch(le){Ke(o,o.return,le)}}}break;case 4:if(Hn(a,o),pr(o),g&4&&Ae){b=o.stateNode,y=b.containerInfo,b=b.pendingChildren;try{Bd(y,b)}catch(le){Ke(o,o.return,le)}}break;case 13:Hn(a,o),pr(o),y=o.child,y.flags&8192&&(b=y.memoizedState!==null,y.stateNode.isHidden=b,!b||y.alternate!==null&&y.alternate.memoizedState!==null||(Wf=_t())),g&4&&$1(o);break;case 22:var L=d!==null&&d.memoizedState!==null;if(o.mode&1?(zt=(d=zt)||L,Hn(a,o),zt=d):Hn(a,o),pr(o),g&8192){if(d=o.memoizedState!==null,(o.stateNode.isHidden=d)&&!L&&o.mode&1)for(ce=o,g=o.child;g!==null;){for(a=ce=g;ce!==null;){L=ce;var $=L.child;switch(L.tag){case 0:case 11:case 14:case 15:Qo(4,L,L.return);break;case 1:Os(L,L.return);var Q=L.stateNode;if(typeof Q.componentWillUnmount=="function"){var se=L,he=L.return;try{var we=se;Q.props=we.memoizedProps,Q.state=we.memoizedState,Q.componentWillUnmount()}catch(le){Ke(se,he,le)}}break;case 5:Os(L,L.return);break;case 22:if(L.memoizedState!==null){K1(a);continue}}$!==null?($.return=L,ce=$):K1(a)}g=g.sibling}if(me){e:if(g=null,me)for(a=o;;){if(a.tag===5){if(g===null){g=a;try{y=a.stateNode,d?k4(y):E4(a.stateNode,a.memoizedProps)}catch(le){Ke(o,o.return,le)}}}else if(a.tag===6){if(g===null)try{b=a.stateNode,d?C4(b):T4(b,a.memoizedProps)}catch(le){Ke(o,o.return,le)}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===o)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;g===a&&(g=null),a=a.return}g===a&&(g=null),a.sibling.return=a.return,a=a.sibling}}}break;case 19:Hn(a,o),pr(o),g&4&&$1(o);break;case 21:break;default:Hn(a,o),pr(o)}}function pr(o){var a=o.flags;if(a&2){try{if(me){e:{for(var d=o.return;d!==null;){if(V1(d)){var g=d;break e}d=d.return}throw Error(l(160))}switch(g.tag){case 5:var y=g.stateNode;g.flags&32&&(Tg(y),g.flags&=-33);var b=W1(o);Of(o,b,y);break;case 3:case 4:var L=g.stateNode.containerInfo,$=W1(o);Ff(o,$,L);break;default:throw Error(l(161))}}}catch(Q){Ke(o,o.return,Q)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function T6(o,a,d){ce=o,X1(o)}function X1(o,a,d){for(var g=(o.mode&1)!==0;ce!==null;){var y=ce,b=y.child;if(y.tag===22&&g){var L=y.memoizedState!==null||Wl;if(!L){var $=y.alternate,Q=$!==null&&$.memoizedState!==null||zt;$=Wl;var se=zt;if(Wl=L,(zt=Q)&&!se)for(ce=y;ce!==null;)L=ce,Q=L.child,L.tag===22&&L.memoizedState!==null?Q1(y):Q!==null?(Q.return=L,ce=Q):Q1(y);for(;b!==null;)ce=b,X1(b),b=b.sibling;ce=y,Wl=$,zt=se}Y1(o)}else y.subtreeFlags&8772&&b!==null?(b.return=y,ce=b):Y1(o)}}function Y1(o){for(;ce!==null;){var a=ce;if(a.flags&8772){var d=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:zt||$l(5,a);break;case 1:var g=a.stateNode;if(a.flags&4&&!zt)if(d===null)g.componentDidMount();else{var y=a.elementType===a.type?d.memoizedProps:Wn(a.type,d.memoizedProps);g.componentDidUpdate(y,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var b=a.updateQueue;b!==null&&Zg(a,b,g);break;case 3:var L=a.updateQueue;if(L!==null){if(d=null,a.child!==null)switch(a.child.tag){case 5:d=G(a.child.stateNode);break;case 1:d=a.child.stateNode}Zg(a,L,d)}break;case 5:var $=a.stateNode;d===null&&a.flags&4&&Ve($,a.type,a.memoizedProps,a);break;case 6:break;case 4:break;case 12:break;case 13:if(Te&&a.memoizedState===null){var Q=a.alternate;if(Q!==null){var se=Q.memoizedState;if(se!==null){var he=se.dehydrated;he!==null&&V4(he)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(l(163))}zt||a.flags&512&&Lf(a)}catch(we){Ke(a,a.return,we)}}if(a===o){ce=null;break}if(d=a.sibling,d!==null){d.return=a.return,ce=d;break}ce=a.return}}function K1(o){for(;ce!==null;){var a=ce;if(a===o){ce=null;break}var d=a.sibling;if(d!==null){d.return=a.return,ce=d;break}ce=a.return}}function Q1(o){for(;ce!==null;){var a=ce;try{switch(a.tag){case 0:case 11:case 15:var d=a.return;try{$l(4,a)}catch(Q){Ke(a,d,Q)}break;case 1:var g=a.stateNode;if(typeof g.componentDidMount=="function"){var y=a.return;try{g.componentDidMount()}catch(Q){Ke(a,y,Q)}}var b=a.return;try{Lf(a)}catch(Q){Ke(a,b,Q)}break;case 5:var L=a.return;try{Lf(a)}catch(Q){Ke(a,L,Q)}}}catch(Q){Ke(a,a.return,Q)}if(a===o){ce=null;break}var $=a.sibling;if($!==null){$.return=a.return,ce=$;break}ce=a.return}}var Hl=0,Xl=1,Yl=2,Kl=3,Ql=4;if(typeof Symbol=="function"&&Symbol.for){var Zo=Symbol.for;Hl=Zo("selector.component"),Xl=Zo("selector.has_pseudo_class"),Yl=Zo("selector.role"),Kl=Zo("selector.test_id"),Ql=Zo("selector.text")}function Df(o){var a=wt(o);if(a!=null){if(typeof a.memoizedProps["data-testname"]!="string")throw Error(l(364));return a}if(o=ws(o),o===null)throw Error(l(362));return o.stateNode.current}function zf(o,a){switch(a.$$typeof){case Hl:if(o.type===a.value)return!0;break;case Xl:e:{a=a.value,o=[o,0];for(var d=0;d<o.length;){var g=o[d++],y=o[d++],b=a[y];if(g.tag!==5||!or(g)){for(;b!=null&&zf(g,b);)y++,b=a[y];if(y===a.length){a=!0;break e}else for(g=g.child;g!==null;)o.push(g,y),g=g.sibling}}a=!1}return a;case Yl:if(o.tag===5&&ks(o.stateNode,a.value))return!0;break;case Ql:if((o.tag===5||o.tag===6)&&(o=Ss(o),o!==null&&0<=o.indexOf(a.value)))return!0;break;case Kl:if(o.tag===5&&(o=o.memoizedProps["data-testname"],typeof o=="string"&&o.toLowerCase()===a.value.toLowerCase()))return!0;break;default:throw Error(l(365))}return!1}function Bf(o){switch(o.$$typeof){case Hl:return"<"+(I(o.value)||"Unknown")+">";case Xl:return":has("+(Bf(o)||"")+")";case Yl:return'[role="'+o.value+'"]';case Ql:return'"'+o.value+'"';case Kl:return'[data-testname="'+o.value+'"]';default:throw Error(l(365))}}function Z1(o,a){var d=[];o=[o,0];for(var g=0;g<o.length;){var y=o[g++],b=o[g++],L=a[b];if(y.tag!==5||!or(y)){for(;L!=null&&zf(y,L);)b++,L=a[b];if(b===a.length)d.push(y);else for(y=y.child;y!==null;)o.push(y,b),y=y.sibling}}return d}function Uf(o,a){if(!sr)throw Error(l(363));o=Df(o),o=Z1(o,a),a=[],o=Array.from(o);for(var d=0;d<o.length;){var g=o[d++];if(g.tag===5)or(g)||a.push(g.stateNode);else for(g=g.child;g!==null;)o.push(g),g=g.sibling}return a}var b6=Math.ceil,Zl=c.ReactCurrentDispatcher,Gf=c.ReactCurrentOwner,at=c.ReactCurrentBatchConfig,Ce=0,kt=null,dt=null,Nt=0,pn=0,js=Zr(0),pt=0,qo=null,Wi=0,ql=0,Vf=0,Jo=null,rn=null,Wf=0,$f=1/0,Nr=null;function Ds(){$f=_t()+500}var Jl=!1,Hf=null,ti=null,eu=!1,ni=null,tu=0,ea=0,Xf=null,nu=-1,ru=0;function Bt(){return Ce&6?_t():nu!==-1?nu:nu=_t()}function ri(o){return o.mode&1?Ce&2&&Nt!==0?Nt&-Nt:u6.transition!==null?(ru===0&&(ru=Fg()),ru):(o=Ie,o!==0?o:Ft()):1}function Pn(o,a,d,g){if(50<ea)throw ea=0,Xf=null,Error(l(185));Do(o,d,g),(!(Ce&2)||o!==kt)&&(o===kt&&(!(Ce&2)&&(ql|=d),pt===4&&ii(o,Nt)),sn(o,g),d===1&&Ce===0&&!(a.mode&1)&&(Ds(),kl&&lr()))}function sn(o,a){var d=o.callbackNode;e6(o,a);var g=_l(o,o===kt?Nt:0);if(g===0)d!==null&&jg(d),o.callbackNode=null,o.callbackPriority=0;else if(a=g&-g,o.callbackPriority!==a){if(d!=null&&jg(d),a===1)o.tag===0?l6(J1.bind(null,o)):Dg(J1.bind(null,o)),qt?Yr(function(){!(Ce&6)&&lr()}):Kd(Qd,lr),d=null;else{switch(Og(g)){case 1:d=Qd;break;case 4:d=i6;break;case 16:d=Zd;break;case 536870912:d=s6;break;default:d=Zd}d=lm(d,q1.bind(null,o))}o.callbackPriority=a,o.callbackNode=d}}function q1(o,a){if(nu=-1,ru=0,Ce&6)throw Error(l(327));var d=o.callbackNode;if(Xi()&&o.callbackNode!==d)return null;var g=_l(o,o===kt?Nt:0);if(g===0)return null;if(g&30||g&o.expiredLanes||a)a=iu(o,g);else{a=g;var y=Ce;Ce|=2;var b=nm();(kt!==o||Nt!==a)&&(Nr=null,Ds(),$i(o,a));do try{A6();break}catch($){tm(o,$)}while(1);of(),Zl.current=b,Ce=y,dt!==null?a=0:(kt=null,Nt=0,a=pt)}if(a!==0){if(a===2&&(y=Hd(o),y!==0&&(g=y,a=Yf(o,y))),a===1)throw d=qo,$i(o,0),ii(o,g),sn(o,_t()),d;if(a===6)ii(o,g);else{if(y=o.current.alternate,!(g&30)&&!P6(y)&&(a=iu(o,g),a===2&&(b=Hd(o),b!==0&&(g=b,a=Yf(o,b))),a===1))throw d=qo,$i(o,0),ii(o,g),sn(o,_t()),d;switch(o.finishedWork=y,o.finishedLanes=g,a){case 0:case 1:throw Error(l(345));case 2:Hi(o,rn,Nr);break;case 3:if(ii(o,g),(g&130023424)===g&&(a=Wf+500-_t(),10<a)){if(_l(o,0)!==0)break;if(y=o.suspendedLanes,(y&g)!==g){Bt(),o.pingedLanes|=o.suspendedLanes&y;break}o.timeoutHandle=U(Hi.bind(null,o,rn,Nr),a);break}Hi(o,rn,Nr);break;case 4:if(ii(o,g),(g&4194240)===g)break;for(a=o.eventTimes,y=-1;0<g;){var L=31-Un(g);b=1<<L,L=a[L],L>y&&(y=L),g&=~b}if(g=y,g=_t()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*b6(g/1960))-g,10<g){o.timeoutHandle=U(Hi.bind(null,o,rn,Nr),g);break}Hi(o,rn,Nr);break;case 5:Hi(o,rn,Nr);break;default:throw Error(l(329))}}}return sn(o,_t()),o.callbackNode===d?q1.bind(null,o):null}function Yf(o,a){var d=Jo;return o.current.memoizedState.isDehydrated&&($i(o,a).flags|=256),o=iu(o,a),o!==2&&(a=rn,rn=d,a!==null&&Kf(a)),o}function Kf(o){rn===null?rn=o:rn.push.apply(rn,o)}function P6(o){for(var a=o;;){if(a.flags&16384){var d=a.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var y=d[g],b=y.getSnapshot;y=y.value;try{if(!Gn(b(),y))return!1}catch{return!1}}}if(d=a.child,a.subtreeFlags&16384&&d!==null)d.return=a,a=d;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ii(o,a){for(a&=~Vf,a&=~ql,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var d=31-Un(a),g=1<<d;o[d]=-1,a&=~g}}function J1(o){if(Ce&6)throw Error(l(327));Xi();var a=_l(o,0);if(!(a&1))return sn(o,_t()),null;var d=iu(o,a);if(o.tag!==0&&d===2){var g=Hd(o);g!==0&&(a=g,d=Yf(o,g))}if(d===1)throw d=qo,$i(o,0),ii(o,a),sn(o,_t()),d;if(d===6)throw Error(l(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,Hi(o,rn,Nr),sn(o,_t()),null}function em(o){ni!==null&&ni.tag===0&&!(Ce&6)&&Xi();var a=Ce;Ce|=1;var d=at.transition,g=Ie;try{if(at.transition=null,Ie=1,o)return o()}finally{Ie=g,at.transition=d,Ce=a,!(Ce&6)&&lr()}}function Qf(){pn=js.current,We(js)}function $i(o,a){o.finishedWork=null,o.finishedLanes=0;var d=o.timeoutHandle;if(d!==re&&(o.timeoutHandle=re,q(d)),dt!==null)for(d=dt.return;d!==null;){var g=d;switch(ef(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&yl();break;case 3:Ls(),We(en),We(Ot),pf();break;case 5:ff(g);break;case 4:Ls();break;case 13:We(qe);break;case 19:We(qe);break;case 10:af(g.type._context);break;case 22:case 23:Qf()}d=d.return}if(kt=o,dt=o=si(o.current,null),Nt=pn=a,pt=0,qo=null,Vf=ql=Wi=0,rn=Jo=null,Gi!==null){for(a=0;a<Gi.length;a++)if(d=Gi[a],g=d.interleaved,g!==null){d.interleaved=null;var y=g.next,b=d.pending;if(b!==null){var L=b.next;b.next=y,g.next=L}d.pending=g}Gi=null}return o}function tm(o,a){do{var d=dt;try{if(of(),Ll.current=Dl,Fl){for(var g=Je.memoizedState;g!==null;){var y=g.queue;y!==null&&(y.pending=null),g=g.next}Fl=!1}if(Vi=0,St=ht=Je=null,Vo=!1,Wo=0,Gf.current=null,d===null||d.return===null){pt=1,qo=a,dt=null;break}e:{var b=o,L=d.return,$=d,Q=a;if(a=Nt,$.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var se=Q,he=$,we=he.tag;if(!(he.mode&1)&&(we===0||we===11||we===15)){var le=he.alternate;le?(he.updateQueue=le.updateQueue,he.memoizedState=le.memoizedState,he.lanes=le.lanes):(he.updateQueue=null,he.memoizedState=null)}var $e=T1(L);if($e!==null){$e.flags&=-257,b1($e,L,$,b,a),$e.mode&1&&E1(b,se,a),a=$e,Q=se;var ze=a.updateQueue;if(ze===null){var on=new Set;on.add(Q),a.updateQueue=on}else ze.add(Q);break e}else{if(!(a&1)){E1(b,se,a),Zf();break e}Q=Error(l(426))}}else if(Ye&&$.mode&1){var Ar=T1(L);if(Ar!==null){!(Ar.flags&65536)&&(Ar.flags|=256),b1(Ar,L,$,b,a),rf(Fs(Q,$));break e}}b=Q=Fs(Q,$),pt!==4&&(pt=2),Jo===null?Jo=[b]:Jo.push(b),b=L;do{switch(b.tag){case 3:b.flags|=65536,a&=-a,b.lanes|=a;var K=k1(b,Q,a);Qg(b,K);break e;case 1:$=Q;var H=b.type,Z=b.stateNode;if(!(b.flags&128)&&(typeof H.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(ti===null||!ti.has(Z)))){b.flags|=65536,a&=-a,b.lanes|=a;var ue=C1(b,$,a);Qg(b,ue);break e}}b=b.return}while(b!==null)}im(d)}catch(ge){a=ge,dt===d&&d!==null&&(dt=d=d.return);continue}break}while(1)}function nm(){var o=Zl.current;return Zl.current=Dl,o===null?Dl:o}function Zf(){(pt===0||pt===3||pt===2)&&(pt=4),kt===null||!(Wi&268435455)&&!(ql&268435455)||ii(kt,Nt)}function iu(o,a){var d=Ce;Ce|=2;var g=nm();(kt!==o||Nt!==a)&&(Nr=null,$i(o,a));do try{N6();break}catch(y){tm(o,y)}while(1);if(of(),Ce=d,Zl.current=g,dt!==null)throw Error(l(261));return kt=null,Nt=0,pt}function N6(){for(;dt!==null;)rm(dt)}function A6(){for(;dt!==null&&!n6();)rm(dt)}function rm(o){var a=am(o.alternate,o,pn);o.memoizedProps=o.pendingProps,a===null?im(o):dt=a,Gf.current=null}function im(o){var a=o;do{var d=a.alternate;if(o=a.return,a.flags&32768){if(d=k6(d,a),d!==null){d.flags&=32767,dt=d;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{pt=6,dt=null;return}}else if(d=S6(d,a,pn),d!==null){dt=d;return}if(a=a.sibling,a!==null){dt=a;return}dt=a=o}while(a!==null);pt===0&&(pt=5)}function Hi(o,a,d){var g=Ie,y=at.transition;try{at.transition=null,Ie=1,M6(o,a,d,g)}finally{at.transition=y,Ie=g}return null}function M6(o,a,d,g){do Xi();while(ni!==null);if(Ce&6)throw Error(l(327));d=o.finishedWork;var y=o.finishedLanes;if(d===null)return null;if(o.finishedWork=null,o.finishedLanes=0,d===o.current)throw Error(l(177));o.callbackNode=null,o.callbackPriority=0;var b=d.lanes|d.childLanes;if(t6(o,b),o===kt&&(dt=kt=null,Nt=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||eu||(eu=!0,lm(Zd,function(){return Xi(),null})),b=(d.flags&15990)!==0,d.subtreeFlags&15990||b){b=at.transition,at.transition=null;var L=Ie;Ie=1;var $=Ce;Ce|=4,Gf.current=null,E6(o,d),H1(d,o),X(o.containerInfo),o.current=d,T6(d),r6(),Ce=$,Ie=L,at.transition=b}else o.current=d;if(eu&&(eu=!1,ni=o,tu=y),b=o.pendingLanes,b===0&&(ti=null),o6(d.stateNode),sn(o,_t()),a!==null)for(g=o.onRecoverableError,d=0;d<a.length;d++)y=a[d],g(y.value,{componentStack:y.stack,digest:y.digest});if(Jl)throw Jl=!1,o=Hf,Hf=null,o;return tu&1&&o.tag!==0&&Xi(),b=o.pendingLanes,b&1?o===Xf?ea++:(ea=0,Xf=o):ea=0,lr(),null}function Xi(){if(ni!==null){var o=Og(tu),a=at.transition,d=Ie;try{if(at.transition=null,Ie=16>o?16:o,ni===null)var g=!1;else{if(o=ni,ni=null,tu=0,Ce&6)throw Error(l(331));var y=Ce;for(Ce|=4,ce=o.current;ce!==null;){var b=ce,L=b.child;if(ce.flags&16){var $=b.deletions;if($!==null){for(var Q=0;Q<$.length;Q++){var se=$[Q];for(ce=se;ce!==null;){var he=ce;switch(he.tag){case 0:case 11:case 15:Qo(8,he,b)}var we=he.child;if(we!==null)we.return=he,ce=we;else for(;ce!==null;){he=ce;var le=he.sibling,$e=he.return;if(G1(he),he===se){ce=null;break}if(le!==null){le.return=$e,ce=le;break}ce=$e}}}var ze=b.alternate;if(ze!==null){var on=ze.child;if(on!==null){ze.child=null;do{var Ar=on.sibling;on.sibling=null,on=Ar}while(on!==null)}}ce=b}}if(b.subtreeFlags&2064&&L!==null)L.return=b,ce=L;else e:for(;ce!==null;){if(b=ce,b.flags&2048)switch(b.tag){case 0:case 11:case 15:Qo(9,b,b.return)}var K=b.sibling;if(K!==null){K.return=b.return,ce=K;break e}ce=b.return}}var H=o.current;for(ce=H;ce!==null;){L=ce;var Z=L.child;if(L.subtreeFlags&2064&&Z!==null)Z.return=L,ce=Z;else e:for(L=H;ce!==null;){if($=ce,$.flags&2048)try{switch($.tag){case 0:case 11:case 15:$l(9,$)}}catch(ge){Ke($,$.return,ge)}if($===L){ce=null;break e}var ue=$.sibling;if(ue!==null){ue.return=$.return,ce=ue;break e}ce=$.return}}if(Ce=y,lr(),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(Sl,o)}catch{}g=!0}return g}finally{Ie=d,at.transition=a}}return!1}function sm(o,a,d){a=Fs(d,a),a=k1(o,a,1),o=ei(o,a,1),a=Bt(),o!==null&&(Do(o,1,a),sn(o,a))}function Ke(o,a,d){if(o.tag===3)sm(o,o,d);else for(;a!==null;){if(a.tag===3){sm(a,o,d);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(ti===null||!ti.has(g))){o=Fs(d,o),o=C1(a,o,1),a=ei(a,o,1),o=Bt(),a!==null&&(Do(a,1,o),sn(a,o));break}}a=a.return}}function R6(o,a,d){var g=o.pingCache;g!==null&&g.delete(a),a=Bt(),o.pingedLanes|=o.suspendedLanes&d,kt===o&&(Nt&d)===d&&(pt===4||pt===3&&(Nt&130023424)===Nt&&500>_t()-Wf?$i(o,0):Vf|=d),sn(o,a)}function om(o,a){a===0&&(o.mode&1?(a=wl,wl<<=1,!(wl&130023424)&&(wl=4194304)):a=1);var d=Bt();o=ur(o,a),o!==null&&(Do(o,a,d),sn(o,d))}function I6(o){var a=o.memoizedState,d=0;a!==null&&(d=a.retryLane),om(o,d)}function L6(o,a){var d=0;switch(o.tag){case 13:var g=o.stateNode,y=o.memoizedState;y!==null&&(d=y.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(l(314))}g!==null&&g.delete(a),om(o,d)}var am;am=function(o,a,d){if(o!==null)if(o.memoizedProps!==a.pendingProps||en.current)nn=!0;else{if(!(o.lanes&d)&&!(a.flags&128))return nn=!1,_6(o,a,d);nn=!!(o.flags&131072)}else nn=!1,Ye&&a.flags&1048576&&zg(a,El,a.index);switch(a.lanes=0,a.tag){case 2:var g=a.type;Ul(o,a),o=a.pendingProps;var y=Ts(a,Ot.current);Rs(a,d),y=yf(null,a,g,o,y,d);var b=vf();return a.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,tn(g)?(b=!0,vl(a)):b=!1,a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,cf(a),y.updater=zl,a.stateNode=y,y._reactInternals=a,Cf(a,g,o,d),a=Pf(null,a,g,!0,b,d)):(a.tag=0,Ye&&b&&Jd(a),Xt(null,a,y,d),a=a.child),a;case 16:g=a.elementType;e:{switch(Ul(o,a),o=a.pendingProps,y=g._init,g=y(g._payload),a.type=g,y=a.tag=O6(g),o=Wn(g,o),y){case 0:a=bf(null,a,g,o,d);break e;case 1:a=I1(null,a,g,o,d);break e;case 11:a=P1(null,a,g,o,d);break e;case 14:a=N1(null,a,g,Wn(g.type,o),d);break e}throw Error(l(306,g,""))}return a;case 0:return g=a.type,y=a.pendingProps,y=a.elementType===g?y:Wn(g,y),bf(o,a,g,y,d);case 1:return g=a.type,y=a.pendingProps,y=a.elementType===g?y:Wn(g,y),I1(o,a,g,y,d);case 3:e:{if(L1(a),o===null)throw Error(l(387));g=a.pendingProps,b=a.memoizedState,y=b.element,Kg(o,a),Rl(a,g,null,d);var L=a.memoizedState;if(g=L.element,Te&&b.isDehydrated)if(b={element:g,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},a.updateQueue.baseState=b,a.memoizedState=b,a.flags&256){y=Fs(Error(l(423)),a),a=F1(o,a,g,d,y);break e}else if(g!==y){y=Fs(Error(l(424)),a),a=F1(o,a,g,d,y);break e}else for(Te&&(Cn=O4(a.stateNode.containerInfo),hn=a,Ye=!0,Vn=null,zo=!1),d=Hg(a,null,g,d),a.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Ns(),g===y){a=Pr(o,a,d);break e}Xt(o,a,g,d)}a=a.child}return a;case 5:return qg(a),o===null&&nf(a),g=a.type,y=a.pendingProps,b=o!==null?o.memoizedProps:null,L=y.children,ne(g,y)?L=null:b!==null&&ne(g,b)&&(a.flags|=32),R1(o,a),Xt(o,a,L,d),a.child;case 6:return o===null&&nf(a),null;case 13:return O1(o,a,d);case 4:return df(a,a.stateNode.containerInfo),g=a.pendingProps,o===null?a.child=As(a,null,g,d):Xt(o,a,g,d),a.child;case 11:return g=a.type,y=a.pendingProps,y=a.elementType===g?y:Wn(g,y),P1(o,a,g,y,d);case 7:return Xt(o,a,a.pendingProps,d),a.child;case 8:return Xt(o,a,a.pendingProps.children,d),a.child;case 12:return Xt(o,a,a.pendingProps.children,d),a.child;case 10:e:{if(g=a.type._context,y=a.pendingProps,b=a.memoizedProps,L=y.value,Xg(a,g,L),b!==null)if(Gn(b.value,L)){if(b.children===y.children&&!en.current){a=Pr(o,a,d);break e}}else for(b=a.child,b!==null&&(b.return=a);b!==null;){var $=b.dependencies;if($!==null){L=b.child;for(var Q=$.firstContext;Q!==null;){if(Q.context===g){if(b.tag===1){Q=br(-1,d&-d),Q.tag=2;var se=b.updateQueue;if(se!==null){se=se.shared;var he=se.pending;he===null?Q.next=Q:(Q.next=he.next,he.next=Q),se.pending=Q}}b.lanes|=d,Q=b.alternate,Q!==null&&(Q.lanes|=d),lf(b.return,d,a),$.lanes|=d;break}Q=Q.next}}else if(b.tag===10)L=b.type===a.type?null:b.child;else if(b.tag===18){if(L=b.return,L===null)throw Error(l(341));L.lanes|=d,$=L.alternate,$!==null&&($.lanes|=d),lf(L,d,a),L=b.sibling}else L=b.child;if(L!==null)L.return=b;else for(L=b;L!==null;){if(L===a){L=null;break}if(b=L.sibling,b!==null){b.return=L.return,L=b;break}L=L.return}b=L}Xt(o,a,y.children,d),a=a.child}return a;case 9:return y=a.type,g=a.pendingProps.children,Rs(a,d),y=En(y),g=g(y),a.flags|=1,Xt(o,a,g,d),a.child;case 14:return g=a.type,y=Wn(g,a.pendingProps),y=Wn(g.type,y),N1(o,a,g,y,d);case 15:return A1(o,a,a.type,a.pendingProps,d);case 17:return g=a.type,y=a.pendingProps,y=a.elementType===g?y:Wn(g,y),Ul(o,a),a.tag=1,tn(g)?(o=!0,vl(a)):o=!1,Rs(a,d),_1(a,g,y),Cf(a,g,y,d),Pf(null,a,g,!0,o,d);case 19:return D1(o,a,d);case 22:return M1(o,a,d)}throw Error(l(156,a.tag))};function lm(o,a){return Kd(o,a)}function F6(o,a,d,g){this.tag=o,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nn(o,a,d,g){return new F6(o,a,d,g)}function qf(o){return o=o.prototype,!(!o||!o.isReactComponent)}function O6(o){if(typeof o=="function")return qf(o)?1:0;if(o!=null){if(o=o.$$typeof,o===T)return 11;if(o===C)return 14}return 2}function si(o,a){var d=o.alternate;return d===null?(d=Nn(o.tag,a,o.key,o.mode),d.elementType=o.elementType,d.type=o.type,d.stateNode=o.stateNode,d.alternate=o,o.alternate=d):(d.pendingProps=a,d.type=o.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=o.flags&14680064,d.childLanes=o.childLanes,d.lanes=o.lanes,d.child=o.child,d.memoizedProps=o.memoizedProps,d.memoizedState=o.memoizedState,d.updateQueue=o.updateQueue,a=o.dependencies,d.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},d.sibling=o.sibling,d.index=o.index,d.ref=o.ref,d}function su(o,a,d,g,y,b){var L=2;if(g=o,typeof o=="function")qf(o)&&(L=1);else if(typeof o=="string")L=5;else e:switch(o){case p:return Yi(d.children,y,b,a);case m:L=8,y|=8;break;case x:return o=Nn(12,d,a,y|2),o.elementType=x,o.lanes=b,o;case k:return o=Nn(13,d,a,y),o.elementType=k,o.lanes=b,o;case S:return o=Nn(19,d,a,y),o.elementType=S,o.lanes=b,o;case _:return ou(d,y,b,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case v:L=10;break e;case w:L=9;break e;case T:L=11;break e;case C:L=14;break e;case h:L=16,g=null;break e}throw Error(l(130,o==null?o:typeof o,""))}return a=Nn(L,d,a,y),a.elementType=o,a.type=g,a.lanes=b,a}function Yi(o,a,d,g){return o=Nn(7,o,g,a),o.lanes=d,o}function ou(o,a,d,g){return o=Nn(22,o,g,a),o.elementType=_,o.lanes=d,o.stateNode={isHidden:!1},o}function Jf(o,a,d){return o=Nn(6,o,null,a),o.lanes=d,o}function eh(o,a,d){return a=Nn(4,o.children!==null?o.children:[],o.key,a),a.lanes=d,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function j6(o,a,d,g,y){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=re,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xd(0),this.expirationTimes=Xd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xd(0),this.identifierPrefix=g,this.onRecoverableError=y,Te&&(this.mutableSourceEagerHydrationData=null)}function um(o,a,d,g,y,b,L,$,Q){return o=new j6(o,a,d,$,Q),a===1?(a=1,b===!0&&(a|=8)):a=0,b=Nn(3,null,null,a),o.current=b,b.stateNode=o,b.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},cf(b),o}function cm(o){if(!o)return qr;o=o._reactInternals;e:{if(F(o)!==o||o.tag!==1)throw Error(l(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(tn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(l(171))}if(o.tag===1){var d=o.type;if(tn(d))return Ig(o,d,a)}return a}function dm(o){var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(l(188)):(o=Object.keys(o).join(","),Error(l(268,o)));return o=D(a),o===null?null:o.stateNode}function fm(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var d=o.retryLane;o.retryLane=d!==0&&d<a?d:a}}function au(o,a){fm(o,a),(o=o.alternate)&&fm(o,a)}function D6(o){return o=D(o),o===null?null:o.stateNode}function z6(){return null}return n.attemptContinuousHydration=function(o){if(o.tag===13){var a=ur(o,134217728);if(a!==null){var d=Bt();Pn(a,o,134217728,d)}au(o,134217728)}},n.attemptDiscreteHydration=function(o){if(o.tag===13){var a=ur(o,1);if(a!==null){var d=Bt();Pn(a,o,1,d)}au(o,1)}},n.attemptHydrationAtCurrentPriority=function(o){if(o.tag===13){var a=ri(o),d=ur(o,a);if(d!==null){var g=Bt();Pn(d,o,a,g)}au(o,a)}},n.attemptSynchronousHydration=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var d=jo(a.pendingLanes);d!==0&&(Yd(a,d|1),sn(a,_t()),!(Ce&6)&&(Ds(),lr()))}break;case 13:em(function(){var g=ur(o,1);if(g!==null){var y=Bt();Pn(g,o,1,y)}}),au(o,1)}},n.batchedUpdates=function(o,a){var d=Ce;Ce|=1;try{return o(a)}finally{Ce=d,Ce===0&&(Ds(),kl&&lr())}},n.createComponentSelector=function(o){return{$$typeof:Hl,value:o}},n.createContainer=function(o,a,d,g,y,b,L){return um(o,a,!1,null,d,g,y,b,L)},n.createHasPseudoClassSelector=function(o){return{$$typeof:Xl,value:o}},n.createHydrationContainer=function(o,a,d,g,y,b,L,$,Q){return o=um(d,g,!0,o,y,b,L,$,Q),o.context=cm(null),d=o.current,g=Bt(),y=ri(d),b=br(g,y),b.callback=a??null,ei(d,b,y),o.current.lanes=y,Do(o,y,g),sn(o,g),o},n.createPortal=function(o,a,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:g==null?null:""+g,children:o,containerInfo:a,implementation:d}},n.createRoleSelector=function(o){return{$$typeof:Yl,value:o}},n.createTestNameSelector=function(o){return{$$typeof:Kl,value:o}},n.createTextSelector=function(o){return{$$typeof:Ql,value:o}},n.deferredUpdates=function(o){var a=Ie,d=at.transition;try{return at.transition=null,Ie=16,o()}finally{Ie=a,at.transition=d}},n.discreteUpdates=function(o,a,d,g,y){var b=Ie,L=at.transition;try{return at.transition=null,Ie=1,o(a,d,g,y)}finally{Ie=b,at.transition=L,Ce===0&&Ds()}},n.findAllNodes=Uf,n.findBoundingRects=function(o,a){if(!sr)throw Error(l(363));a=Uf(o,a),o=[];for(var d=0;d<a.length;d++)o.push(_s(a[d]));for(a=o.length-1;0<a;a--){d=o[a];for(var g=d.x,y=g+d.width,b=d.y,L=b+d.height,$=a-1;0<=$;$--)if(a!==$){var Q=o[$],se=Q.x,he=se+Q.width,we=Q.y,le=we+Q.height;if(g>=se&&b>=we&&y<=he&&L<=le){o.splice(a,1);break}else if(g!==se||d.width!==Q.width||le<b||we>L){if(!(b!==we||d.height!==Q.height||he<g||se>y)){se>g&&(Q.width+=se-g,Q.x=g),he<y&&(Q.width=y-se),o.splice(a,1);break}}else{we>b&&(Q.height+=we-b,Q.y=b),le<L&&(Q.height=L-we),o.splice(a,1);break}}}return o},n.findHostInstance=dm,n.findHostInstanceWithNoPortals=function(o){return o=R(o),o=o!==null?j(o):null,o===null?null:o.stateNode},n.findHostInstanceWithWarning=function(o){return dm(o)},n.flushControlled=function(o){var a=Ce;Ce|=1;var d=at.transition,g=Ie;try{at.transition=null,Ie=1,o()}finally{Ie=g,at.transition=d,Ce=a,Ce===0&&(Ds(),lr())}},n.flushPassiveEffects=Xi,n.flushSync=em,n.focusWithin=function(o,a){if(!sr)throw Error(l(363));for(o=Df(o),a=Z1(o,a),a=Array.from(a),o=0;o<a.length;){var d=a[o++];if(!or(d)){if(d.tag===5&&bt(d.stateNode))return!0;for(d=d.child;d!==null;)a.push(d),d=d.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Ie},n.getFindAllNodesFailureDescription=function(o,a){if(!sr)throw Error(l(363));var d=0,g=[];o=[Df(o),0];for(var y=0;y<o.length;){var b=o[y++],L=o[y++],$=a[L];if((b.tag!==5||!or(b))&&(zf(b,$)&&(g.push(Bf($)),L++,L>d&&(d=L)),L<a.length))for(b=b.child;b!==null;)o.push(b,L),b=b.sibling}if(d<a.length){for(o=[];d<a.length;d++)o.push(Bf(a[d]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+o.join(" > ")}return null},n.getPublicRootInstance=function(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return G(o.child.stateNode);default:return o.child.stateNode}},n.injectIntoDevTools=function(o){if(o={bundleType:o.bundleType,version:o.version,rendererPackageName:o.rendererPackageName,rendererConfig:o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:D6,findFiberByHostInstance:o.findFiberByHostInstance||z6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")o=!1;else{var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled||!a.supportsFiber)o=!0;else{try{Sl=a.inject(o),ar=a}catch{}o=!!a.checkDCE}}return o},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(o,a,d,g){if(!sr)throw Error(l(363));o=Uf(o,a);var y=Kr(o,d,g).disconnect;return{disconnect:function(){y()}}},n.registerMutableSourceForHydration=function(o,a){var d=a._getVersion;d=d(a._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[a,d]:o.mutableSourceEagerHydrationData.push(a,d)},n.runWithPriority=function(o,a){var d=Ie;try{return Ie=o,a()}finally{Ie=d}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(o,a,d,g){var y=a.current,b=Bt(),L=ri(y);return d=cm(d),a.context===null?a.context=d:a.pendingContext=d,a=br(b,L),a.payload={element:o},g=g===void 0?null:g,g!==null&&(a.callback=g),o=ei(y,a,L),o!==null&&(Pn(o,y,L,b),Ml(o,y,L)),L},n};a4.exports=ME;var RE=a4.exports;const IE=nl(RE);var l4={exports:{}},xs={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */xs.ConcurrentRoot=1;xs.ContinuousEventPriority=4;xs.DefaultEventPriority=16;xs.DiscreteEventPriority=1;xs.IdleEventPriority=536870912;xs.LegacyRoot=0;l4.exports=xs;var u4=l4.exports;const A2={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let M2=!1,R2=!1;const _g=".react-konva-event",LE=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,FE=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,OE={};function Dd(t,e,n=OE){if(!M2&&"zIndex"in e&&(console.warn(FE),M2=!0),!R2&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(LE),R2=!0)}for(var s in n)if(!A2[s]){var l=s.slice(0,2)==="on",c=n[s]!==e[s];if(l&&c){var u=s.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),t.off(u,n[s])}var f=!e.hasOwnProperty(s);f&&t.setAttr(s,void 0)}var p=e._useStrictMode,m={},x=!1;const v={};for(var s in e)if(!A2[s]){var l=s.slice(0,2)==="on",w=n[s]!==e[s];if(l&&w){var u=s.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e[s]&&(v[u]=e[s])}!l&&(e[s]!==n[s]||p&&e[s]!==t.getAttr(s))&&(x=!0,m[s]=e[s])}x&&(t.setAttrs(m),Di(t));for(var u in v)t.on(u+_g,v[u])}function Di(t){if(!ke.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const c4={},jE={};el.Node.prototype._applyProps=Dd;function DE(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),Di(t)}function zE(t,e,n){let r=el[t];r||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=el.Group);const i={},s={};for(var l in e){var c=l.slice(0,2)==="on";c?s[l]=e[l]:i[l]=e[l]}const u=new r(i);return Dd(u,s),u}function BE(t,e,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function UE(t,e,n){return!1}function GE(t){return t}function VE(){return null}function WE(){return null}function $E(t,e,n,r){return jE}function HE(){}function XE(t){}function YE(t,e){return!1}function KE(){return c4}function QE(){return c4}const ZE=setTimeout,qE=clearTimeout,JE=-1;function eT(t,e){return!1}const tT=!1,nT=!0,rT=!0;function iT(t,e){e.parent===t?e.moveToTop():t.add(e),Di(t)}function sT(t,e){e.parent===t?e.moveToTop():t.add(e),Di(t)}function d4(t,e,n){e._remove(),t.add(e),e.setZIndex(n.getZIndex()),Di(t)}function oT(t,e,n){d4(t,e,n)}function aT(t,e){e.destroy(),e.off(_g),Di(t)}function lT(t,e){e.destroy(),e.off(_g),Di(t)}function uT(t,e,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function cT(t,e,n){}function dT(t,e,n,r,i){Dd(t,i,r)}function fT(t){t.hide(),Di(t)}function hT(t){}function pT(t,e){(e.visible==null||e.visible)&&t.show()}function gT(t,e){}function mT(t){}function yT(){}const vT=()=>u4.DefaultEventPriority,xT=Object.freeze(Object.defineProperty({__proto__:null,appendChild:iT,appendChildToContainer:sT,appendInitialChild:DE,cancelTimeout:qE,clearContainer:mT,commitMount:cT,commitTextUpdate:uT,commitUpdate:dT,createInstance:zE,createTextInstance:BE,detachDeletedInstance:yT,finalizeInitialChildren:UE,getChildHostContext:QE,getCurrentEventPriority:vT,getPublicInstance:GE,getRootHostContext:KE,hideInstance:fT,hideTextInstance:hT,idlePriority:Sa.unstable_IdlePriority,insertBefore:d4,insertInContainerBefore:oT,isPrimaryRenderer:tT,noTimeout:JE,now:Sa.unstable_now,prepareForCommit:VE,preparePortalMount:WE,prepareUpdate:$E,removeChild:aT,removeChildFromContainer:lT,resetAfterCommit:HE,resetTextContent:XE,run:Sa.unstable_runWithPriority,scheduleTimeout:ZE,shouldDeprioritizeSubtree:YE,shouldSetTextContent:eT,supportsMutation:rT,unhideInstance:pT,unhideTextInstance:gT,warnsIfNotActing:nT},Symbol.toStringTag,{value:"Module"}));var wT=Object.defineProperty,_T=Object.defineProperties,ST=Object.getOwnPropertyDescriptors,I2=Object.getOwnPropertySymbols,kT=Object.prototype.hasOwnProperty,CT=Object.prototype.propertyIsEnumerable,L2=(t,e,n)=>e in t?wT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,F2=(t,e)=>{for(var n in e||(e={}))kT.call(e,n)&&L2(t,n,e[n]);if(I2)for(var n of I2(e))CT.call(e,n)&&L2(t,n,e[n]);return t},ET=(t,e)=>_T(t,ST(e)),O2,j2;typeof window<"u"&&((O2=window.document)!=null&&O2.createElement||((j2=window.navigator)==null?void 0:j2.product)==="ReactNative")?B.useLayoutEffect:B.useEffect;function f4(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=e?t.return:t.child;for(;r;){const i=f4(r,e,n);if(i)return i;r=e?null:r.sibling}}function h4(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const D2=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=D2;return}return D2.apply(this,arguments)};const Sg=h4(B.createContext(null));class p4 extends B.Component{render(){return B.createElement(Sg.Provider,{value:this._reactInternals},this.props.children)}}function TT(){const t=B.useContext(Sg);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=B.useId();return B.useMemo(()=>{for(const r of[t,t==null?void 0:t.alternate]){if(!r)continue;const i=f4(r,!1,s=>{let l=s.memoizedState;for(;l;){if(l.memoizedState===e)return!0;l=l.next}});if(i)return i}},[t,e])}function bT(){const t=TT(),[e]=B.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){const i=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;i&&i!==Sg&&!e.has(i)&&e.set(i,B.useContext(h4(i)))}n=n.return}return e}function PT(){const t=bT();return B.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>B.createElement(e,null,B.createElement(n.Provider,ET(F2({},r),{value:t.get(n)}))),e=>B.createElement(p4,F2({},e))),[t])}function NT(t){const e=Vt.useRef({});return Vt.useLayoutEffect(()=>{e.current=t}),Vt.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const AT=t=>{const e=Vt.useRef(),n=Vt.useRef(),r=Vt.useRef(),i=NT(t),s=PT(),l=c=>{const{forwardedRef:u}=t;u&&(typeof u=="function"?u(c):u.current=c)};return Vt.useLayoutEffect(()=>(n.current=new el.Stage({width:t.width,height:t.height,container:e.current}),l(n.current),r.current=_a.createContainer(n.current,u4.LegacyRoot,!1,null),_a.updateContainer(Vt.createElement(s,{},t.children),r.current),()=>{el.isBrowser&&(l(null),_a.updateContainer(null,r.current,null),n.current.destroy())}),[]),Vt.useLayoutEffect(()=>{l(n.current),Dd(n.current,t,i),_a.updateContainer(Vt.createElement(s,{},t.children),r.current,null)}),Vt.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},Nc="Layer",zd="Group",Ac="Rect",tl="Circle",lp="Line",Ln="Text",MT="Arrow",_a=IE(xT);_a.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Vt.version,rendererPackageName:"react-konva"});const RT=Vt.forwardRef((t,e)=>Vt.createElement(p4,{},Vt.createElement(AT,{...t,forwardedRef:e}))),g4=()=>{const{elements:t,setElements:e,arcStart:n,setArcStart:r,setTempArcEnd:i,setSelectedElement:s,snapToGrid:l,gridSnappingEnabled:c}=_n(),u=B.useCallback((x,v)=>{if(x.id===v.id)return;if(x.type===v.type){console.warn("Invalid arc: Cannot connect elements of the same type."),r(null),i(null),s(null);return}const w={id:co(),source:x.id,target:v.id,weight:1,anglePoints:[],sourceType:x.type,targetType:v.type};e(T=>({...T,arcs:[...T.arcs,w]})),r(null),i(null),s(null)},[e,r,i,s]),f=B.useCallback((x,v)=>{e(w=>{const T=w.arcs.map(k=>{if(k.id===x){const S=c?l(v.x,v.y):v,C=k.anglePoints?[...k.anglePoints]:[];return C.push(S),{...k,anglePoints:C}}return k});return{...w,arcs:T}})},[e,c,l]),p=B.useCallback((x,v,w)=>{e(T=>{const k=T.arcs.map(S=>{if(S.id===x&&S.anglePoints&&S.anglePoints[v]){const C=c?l(w.x,w.y):w,h=[...S.anglePoints];return h[v]=C,{...S,anglePoints:h}}return S});return{...T,arcs:k}})},[e,c,l]),m=B.useCallback((x,v)=>{e(w=>{const T=w.arcs.map(k=>{if(k.id===x&&k.anglePoints&&k.anglePoints[v]){const S=[...k.anglePoints];return S.splice(v,1),{...k,anglePoints:S}}return k});return{...w,arcs:T}})},[e]);return{handleCompleteArc:u,handleAddAnglePoint:f,handleDragAnglePoint:p,handleDeleteAnglePoint:m}};function z2(t,e){if(!t||!e)return!1;const n=Math.min(e.x,e.x+e.w),r=Math.min(e.y,e.y+e.h),i=Math.max(e.x,e.x+e.w),s=Math.max(e.y,e.y+e.h);return t.x>=n&&t.x<=i&&t.y>=r&&t.y<=s}function IT(t,e){if(!t||!e)return[];const n=[];return(t.places||[]).forEach(r=>{z2({x:r.x,y:r.y},e)&&n.push({id:r.id,type:"place"})}),(t.transitions||[]).forEach(r=>{z2({x:r.x,y:r.y},e)&&n.push({id:r.id,type:"transition"})}),n}function LT(t,e){return t.some(r=>r.id===e.id&&r.type===e.type)?t.filter(r=>!(r.id===e.id&&r.type===e.type)):[...t,e]}function m4(t,e,n,r={}){if(!e||!e.startPositions)return t;const{dx:i,dy:s}=n||{dx:0,dy:0},{gridSnappingEnabled:l=!1,snapToGrid:c=(f,p)=>({x:f,y:p})}=r,u={...t};return u.places=(t.places||[]).map(f=>{const p=e.startPositions.get(f.id);if(!p||p.type!=="place")return f;const m=p.x+i,x=p.y+s,v=l?c(m,x):{x:m,y:x};return{...f,x:v.x,y:v.y}}),u.transitions=(t.transitions||[]).map(f=>{const p=e.startPositions.get(f.id);if(!p||p.type!=="transition")return f;const m=p.x+i,x=p.y+s,v=l?c(m,x):{x:m,y:x};return{...f,x:v.x,y:v.y}}),e.startArcPoints&&(u.arcs=(t.arcs||[]).map(f=>{const p=e.startArcPoints.get(f.id);if(!p)return f;const m=p.map(x=>({x:x.x+i,y:x.y+s}));return{...f,anglePoints:m}})),u}const kg=()=>{var A,F;const{gridSnappingEnabled:t}=Po(),{elements:e,setElements:n,selectedElement:r,setSelectedElement:i,selectedElements:s,setSelectedElements:l,isIdSelected:c,setSelection:u,mode:f,arcStart:p,setArcStart:m,tempArcEnd:x,setTempArcEnd:v,snapToGrid:w,isShiftPressedRef:T}=_n(),{handleCompleteArc:k}=g4(),S=B.useCallback(()=>{if(!r)return;const{type:N,id:R}=r;let D=JSON.parse(JSON.stringify(e));N==="place"?(D.places=D.places.filter(V=>V.id!==R),D.arcs=D.arcs.filter(V=>V.source!==R&&V.target!==R)):N==="transition"?(D.transitions=D.transitions.filter(V=>V.id!==R),D.arcs=D.arcs.filter(V=>V.source!==R&&V.target!==R)):N==="arc"&&(D.arcs=D.arcs.filter(V=>V.id!==R)),n(D),i(null)},[r,e,n,i]),C=B.useCallback(()=>{n({places:[],transitions:[],arcs:[]}),i(null),m(null),v(null)},[n,i,m,v]),h=B.useCallback(N=>{var D,V;if(!N)return;let R=t?w(N.x,N.y):N;if(f==="place"){const j=((D=e==null?void 0:e.places)==null?void 0:D.length)||0,z={id:co(),x:R.x,y:R.y,label:`P${j+1}`,tokens:0};n(G=>({...G,places:[...(G==null?void 0:G.places)||[],z]}))}else if(f==="transition"){const j=((V=e==null?void 0:e.transitions)==null?void 0:V.length)||0,z={id:co(),x:R.x,y:R.y,label:`T${j+1}`};n(G=>({...G,transitions:[...(G==null?void 0:G.transitions)||[],z]}))}},[f,(A=e==null?void 0:e.places)==null?void 0:A.length,(F=e==null?void 0:e.transitions)==null?void 0:F.length,n,w,t]),_=B.useCallback((N,R,D)=>{var G,Y;let V=null,j=null,z=null;typeof D<"u"?(V=N,j=R,z=D):(j=N,z=R),f==="select"||f==="arc_angle"?(!!(V&&((G=V.evt)!=null&&G.shiftKey||(Y=V.evt)!=null&&Y.getModifierState&&V.evt.getModifierState("Shift")))||!!(T&&T.current)?(l(W=>LT(W,{id:j.id,type:z})),i({...j,type:z})):u([{id:j.id,type:z}]),m(null),v(null)):f==="arc"&&(p?k(p.element,{...j,type:z}):(i({...j,type:z}),m({element:{id:j.id,type:z},point:{x:j.x,y:j.y}}),v({sourcePoint:{x:j.x,y:j.y},x:j.x,y:j.y,potentialTarget:null})))},[f,p,i,l,c,u,m,v,k]),E=B.useCallback((N,R,D)=>{const V=t?w(D.x,D.y):D;n(j=>{const z={...j};return R==="place"?z.places=j.places.map(G=>G.id===N.id?{...G,x:V.x,y:V.y}:G):R==="transition"&&(z.transitions=j.transitions.map(G=>G.id===N.id?{...G,x:V.x,y:V.y}:G)),z})},[n,t,w]),P=B.useCallback(N=>y5(e,N),[e]),I=B.useCallback((N,R={x:40,y:40})=>{if(!N)return null;const{newPlaces:D,newTransitions:V,newArcs:j,newSelection:z}=v5(N,co,R);return n(G=>({...G,places:[...G.places,...D],transitions:[...G.transitions,...V],arcs:[...G.arcs,...j]})),z},[n]);return{handleDeleteElement:S,clearAllElements:C,handleCreateElement:h,handleElementClick:_,handleElementDragEnd:E,collectClipboard:P,pasteClipboard:I}},FT=30,OT=4,jT=4,Cg=4,qn=2,DT=12,up=10,zT=10,Eg=.48,Kh=.25,BT={},y4=new WeakMap;function Mu(t,e,n){return y4.set(t,{baseRadius:e,visuals:n}),n}function UT(t,e,n=2){const r=t.x+t.width,i=t.y+t.height,s=e.x+e.width,l=e.y+e.height;return!(r+n<=e.x||s+n<=t.x||i+n<=e.y||l+n<=t.y)}function GT(t){if(t<=0)return[];const e=[[t]];if(t>=4){const n=Math.min(6,t-1);for(let r=n;r>=Math.ceil(t/2);r-=1){const i=t-r;i>=1&&e.push([r,i])}}if(t>=7){const n=Math.min(6,t-3),r=Math.max(2,Math.ceil((t-n)/2)),i=t-n-r;i>0&&e.push([n,r,i])}return e}function VT(t,e,n){const r=[...e].sort((l,c)=>n[c].width-n[l].width),i=[];let s=0;for(let l=0;l<t.length;l+=1){const c=t[l],u=r.slice(s,s+c);if(u.length<c)return null;i.push(u),s+=c}return i}function WT(t,e,n,r,i){const s=t.length;if(s===0)return[];const l=new Array(s),c=t[0],u=Math.max(...c.map(k=>e[k].diagonal),r);let f=n-u-qn;if(f<=0)return null;const p=i?i+r+qn:r+qn;if(s===1)return l[0]=Math.max(f,p),l;const m=t[s-1],x=Math.max(...m.map(k=>e[k].diagonal),r),v=Math.max(p,x+qn),w=f-v,T=Math.max(r+qn,w/s);l[0]=f;for(let k=1;k<s;k+=1){const C=l[k-1]-T,h=t[k],_=Math.max(...h.map(P=>e[P].diagonal),r),E=Math.max(_+qn,p);if(l[k]=Math.max(C,E),l[k]<=0)return null}return l[s-1]<v&&(l[s-1]=v),l}function Yu(t,e,n){if(!t||t.length===0)return e;let r=0;t.forEach(s=>{const l=s.x+s.width/2,c=s.y+s.height/2,u=Math.hypot(s.width/2,s.height/2),f=Math.hypot(l,c)+u+Cg;f>r&&(r=f)});const i=Math.ceil(r);return i>n&&n>=e?n:Math.max(e,i)}function Ku(t){return typeof t=="boolean"?t?"T":"F":typeof t=="string"?`'${t}'`:Array.isArray(t)?`[${t.map(Ku).join(", ")}]`:t&&typeof t=="object"&&t.__pair__?`(${Ku(t.fst)}, ${Ku(t.snd)})`:String(t)}function v4(t,e){return t.length?Math.max(e,t.length*e*Eg):e}function $T(t,e,n){const r=t.length;if(r===0)return null;const i=e-Cg;if(i<=0)return null;const s=i*2,l=[];for(let u=1;u<=r;u+=1){const f=Math.ceil(r/u);u===1&&r>4||f===1&&r>4||l.push({cols:u,rows:f})}l.sort((u,f)=>{const p=Math.abs(u.cols-u.rows)-Math.abs(f.cols-f.rows);return p!==0?p:u.cols-f.cols});const c=Math.max(...t.map(u=>u.length||1),1);for(const u of l){const f=u.cols,p=u.rows,m=s-qn*(f-1),x=s-qn*(p-1);if(m<=0||x<=0)continue;const v=m/f,w=x/p,T=w*.8,k=v/(c*Eg||1),S=Math.min(DT,T,k);if(S<up)continue;const C=[];let h=!0;const _=v+qn,E=w+qn,P=_*(f-1),I=E*(p-1),A=-P/2,F=-I/2;if(t.forEach((N,R)=>{if(!h)return;const D=Math.floor(R/f),V=R%f,j=r-D*f,z=D===p-1?Math.min(j,f):f,Y=A+(f-z)*_/2+V*_,O=F+D*E,X=v4(N,S)/2,ee=S/2,J=Math.hypot(X,ee);if(Math.hypot(Y,O)+J>i){h=!1;return}C.push({key:`token-${R}`,text:N,fontSize:S,x:Y-v/2,y:O-S/2,width:v,height:S})}),h)return{radius:Yu(C,n,e),layout:C}}return null}function HT(t,e,n){const r=t.length;if(r===0)return{layout:[],radius:n};const i=e-Cg;if(i<=0)return null;const s=Math.max(...t.map(f=>f.length||1),1),l=Math.max(up,Math.min(12,i*2/(s*Eg))),c=t.map((f,p)=>p),u=f=>{const p=c.map(S=>{const C=v4(t[S],f);return{width:C,halfWidth:C/2,halfHeight:f/2,diagonal:Math.hypot(C/2,f/2)}});if(r===1){const S=p[0];if(S.diagonal>i)return null;const C=S.width*(1+Kh),h=[{key:"token-0",text:t[0],fontSize:f,x:-C/2,y:-S.halfHeight,width:C,height:f}];return{layout:h,radius:Yu(h,n,e)}}let m=null,x=0;if(r%2===1&&r>1){const C=[...c].sort((A,F)=>p[F].width-p[A].width)[0],h=p[C].diagonal,_=c.filter(A=>A!==C),E=_.length?Math.max(..._.map(A=>p[A].diagonal)):0,P=h+f*.5;i-E-2>=P&&(m=C,x=h)}const v=new Array(r);if(m!==null){const S=p[m];if(S.diagonal>i)return null;const C=S.width*(1+Kh);v[m]={key:`token-${m}`,text:t[m],fontSize:f,x:-C/2,y:-S.halfHeight,width:C,height:f}}const w=c.filter(S=>S!==m);if(w.length===0){const S=v.filter(Boolean);return{layout:S,radius:Yu(S,n,e)}}const T=v.slice(),k=GT(w.length);for(const S of k){const C=VT(S,w,p);if(!C)continue;const h=WT(C,p,i,f,x);if(!h)continue;const _=T.slice();let E=!0;if(C.forEach((A,F)=>{const N=h[F],R=A.length;if(!R)return;const D=F%2===1?Math.PI/R:0;A.forEach((V,j)=>{if(!E)return;const z=p[V],G=z.width*(1+Kh),Y=G/2,O=-Math.PI/2+2*Math.PI*j/R+D,W=Math.cos(O)*N,X=Math.sin(O)*N;if(Math.hypot(W,X)+z.diagonal>i+qn){E=!1;return}_[V]={key:`token-${V}`,text:t[V],fontSize:f,x:W-Y,y:X-z.halfHeight,width:G,height:f}})}),!E)continue;const P=_.filter(Boolean);if(P.length!==r)continue;let I=!1;for(let A=0;A<P.length;A+=1){for(let F=A+1;F<P.length;F+=1)if(UT(P[A],P[F])){I=!0;break}if(I)break}if(!I){const A=Yu(P,n,e);return{layout:P,radius:A}}}return null};for(let f=l;f>=up;f-=.5){const p=u(f);if(p&&p.layout&&p.layout.length===r)return p}return null}function x4(t,e=FT){var c;const n=Array.isArray(t)?t:BT,r=y4.get(n);if(r&&r.baseRadius===e)return r.visuals;const i=Array.isArray(t)?t:[];if(i.length===0)return Mu(n,e,{radius:e,tokens:[],indicator:null});const s=i.map(Ku),l=e*OT;for(let u=e;u<=l;u+=jT){if(s.length<=zT){const p=HT(s,u,e);if(p&&((c=p.layout)==null?void 0:c.length)===s.length){const m=Math.max(e,Math.min(p.radius,u));return Mu(n,e,{radius:m,tokens:p.layout,indicator:null})}}const f=$T(s,u,e);if(f){const p=Math.max(e,Math.min(f.radius,u));return Mu(n,e,{radius:p,tokens:f.layout,indicator:null})}}return Mu(n,e,{radius:e,tokens:[],indicator:s.length})}const XT=({id:t,x:e,y:n,label:r,tokens:i,valueTokens:s,isSelected:l,onSelect:c,onChange:u})=>{const{setIsDragging:f,snapToGrid:p,netMode:m,elements:x,selectedElements:v,setElements:w,multiDragRef:T,isIdSelected:k}=_n(),{gridSnappingEnabled:S,setSnapIndicator:C}=Po(),h=30,_=B.useRef({pending:!1,rafId:null,delta:{dx:0,dy:0},lastApplied:{dx:0,dy:0}}),E=B.useCallback(()=>{const G=_.current;G.pending=!1,G.rafId=null,!(!T.current||!T.current.startPositions)&&w(Y=>{if(!T.current||!T.current.startPositions)return Y;const O=T.current,W=m4(Y,O,G.delta,{gridSnappingEnabled:S,snapToGrid:p});return G.lastApplied={...G.delta},W})},[S,p,w,T]),P=B.useCallback(G=>{const Y=_.current;if(!(Y.pending&&Y.delta&&Y.delta.dx===G.dx&&Y.delta.dy===G.dy||!Y.pending&&Y.lastApplied&&Y.lastApplied.dx===G.dx&&Y.lastApplied.dy===G.dy)){if(Y.delta=G,typeof window>"u"||typeof window.requestAnimationFrame!="function"){E();return}Y.pending||(Y.pending=!0,Y.rafId=window.requestAnimationFrame(E))}},[E]),I=B.useCallback(()=>{const G=_.current;typeof window<"u"&&typeof window.cancelAnimationFrame=="function"&&G.rafId!==null&&window.cancelAnimationFrame(G.rafId),(G.pending||G.rafId!==null)&&E()},[E]),A=m==="algebraic-int"||Array.isArray(s),F=B.useMemo(()=>A?x4(s||[],h):{radius:h,tokens:[],indicator:null},[A,s]),N=A?F.radius:h,R=B.useCallback(G=>{const Y=new Map;x.places.forEach(W=>{G.has(W.id)&&Y.set(W.id,{type:"place",x:W.x,y:W.y})}),x.transitions.forEach(W=>{G.has(W.id)&&Y.set(W.id,{type:"transition",x:W.x,y:W.y})});const O=new Map;return x.arcs.forEach(W=>{if(G.has(W.source)&&G.has(W.target)){const X=Array.isArray(W.anglePoints)?W.anglePoints.map(ee=>({x:ee.x,y:ee.y})):[];O.set(W.id,X)}}),{startPositions:Y,startArcPoints:O}},[x]),D=()=>{f(!0);const G=_.current;G.lastApplied={dx:0,dy:0};const Y=k(t,"place");let O;Y?O=new Set(v.filter(X=>X.type==="place"||X.type==="transition").map(X=>X.id)):(O=new Set([t]),typeof c=="function"&&c(t));const W=R(O);T.current={baseId:t,...W}},V=G=>{let Y={x:G.target.x(),y:G.target.y()};if(S){const O=p(Y.x,Y.y);C({visible:!0,position:O,elementType:"place"}),G.target.position({x:O.x,y:O.y}),Y=O}if(T.current&&T.current.startPositions&&T.current.baseId===t){const O=T.current.startPositions.get(t);if(!O)return;const W=Y.x-O.x,X=Y.y-O.y;P({dx:W,dy:X})}},j=G=>{const Y={x:G.target.x(),y:G.target.y()};f(!1),C({visible:!1,position:null,elementType:null}),I(),u(Y),T.current=null},z=()=>A?F.tokens.length>0?M.jsx(M.Fragment,{children:F.tokens.map(G=>M.jsx(Ln,{text:G.text,fontSize:G.fontSize,fill:"black",x:G.x,y:G.y,width:G.width,align:"center",wrap:"none",listening:!1},G.key))}):F.indicator?M.jsx(Ln,{text:`(${F.indicator})`,fontSize:12,fill:"black",x:-N,y:-7,width:N*2,align:"center",wrap:"none",listening:!1}):null:i===0?m==="algebraic-int"||Array.isArray(s)?null:M.jsx(Ln,{text:"0",fontSize:14,fill:"black",x:-N,y:-7,width:N*2,align:"center",listening:!1}):i<=5?M.jsxs(M.Fragment,{children:[Array.from({length:i}).map((G,Y)=>{const O=2*Math.PI*Y/i,W=4,X=N/2,ee=Math.cos(O)*X,J=Math.sin(O)*X;return M.jsx(tl,{x:ee,y:J,radius:W,fill:"black",listening:!1},Y)}),M.jsx(Ln,{text:i.toString(),fontSize:14,fill:"black",x:-N,y:-7,width:N*2,align:"center",listening:!1})]}):M.jsx(Ln,{text:i.toString(),fontSize:16,fill:"black",x:-N,y:-8,width:N*2,align:"center",listening:!1});return M.jsxs(zd,{x:e,y:n,draggable:!0,onDragStart:D,onDragMove:V,onDragEnd:j,onClick:()=>c(t),onTap:()=>c(t),id:t,name:"element",elementType:"place",children:[M.jsx(tl,{radius:N,fill:"white",stroke:l?"blue":"black",strokeWidth:2}),M.jsx(Ln,{text:r,fontSize:12,fill:"black",x:-N,y:N+5,width:N*2,align:"center",listening:!1}),z()]})},Qh=11,YT=.48,B2=160,KT=6,QT=({id:t,x:e,y:n,label:r,guard:i,isSelected:s,isEnabled:l,onSelect:c,onChange:u})=>{const{gridSnappingEnabled:m,setSnapIndicator:x}=Po(),{setIsDragging:v,snapToGrid:w,simulationSettings:T,netMode:k,elements:S,selectedElements:C,setElements:h,multiDragRef:_,isIdSelected:E,setSelection:P}=_n(),I=B.useRef({pending:!1,rafId:null,delta:{dx:0,dy:0},lastApplied:{dx:0,dy:0}}),A=B.useCallback(()=>{const O=I.current;O.pending=!1,O.rafId=null,!(!_.current||!_.current.startPositions)&&h(W=>{if(!_.current||!_.current.startPositions)return W;const X=_.current,ee=m4(W,X,O.delta,{gridSnappingEnabled:m,snapToGrid:w});return O.lastApplied={...O.delta},ee})},[m,w,h,_]),F=B.useCallback(O=>{const W=I.current;if(!(W.pending&&W.delta&&W.delta.dx===O.dx&&W.delta.dy===O.dy||!W.pending&&W.lastApplied&&W.lastApplied.dx===O.dx&&W.lastApplied.dy===O.dy)){if(W.delta=O,typeof window>"u"||typeof window.requestAnimationFrame!="function"){A();return}W.pending||(W.pending=!0,W.rafId=window.requestAnimationFrame(A))}},[A]),N=B.useCallback(()=>{const O=I.current;typeof window<"u"&&typeof window.cancelAnimationFrame=="function"&&O.rafId!==null&&window.cancelAnimationFrame(O.rafId),(O.pending||O.rafId!==null)&&A()},[A]),R=B.useCallback(O=>{const W=new Map;S.places.forEach(ee=>{O.has(ee.id)&&W.set(ee.id,{type:"place",x:ee.x,y:ee.y})}),S.transitions.forEach(ee=>{O.has(ee.id)&&W.set(ee.id,{type:"transition",x:ee.x,y:ee.y})});const X=new Map;return S.arcs.forEach(ee=>{if(O.has(ee.source)&&O.has(ee.target)){const J=Array.isArray(ee.anglePoints)?ee.anglePoints.map(te=>({x:te.x,y:te.y})):[];X.set(ee.id,J)}}),{startPositions:W,startArcPoints:X}},[S]),D=()=>{v(!0);const O=I.current;O.lastApplied={dx:0,dy:0};const W=E(t,"transition");let X;W?X=new Set(C.filter(J=>J.type==="place"||J.type==="transition").map(J=>J.id)):(X=new Set([t]),typeof c=="function"&&c(t));const ee=R(X);_.current={baseId:t,...ee}},V=O=>{let W={x:O.target.x(),y:O.target.y()};if(m){const X=w(W.x,W.y);x({visible:!0,position:X,elementType:"transition"}),O.target.position({x:X.x,y:X.y}),W=X}if(_.current&&_.current.startPositions&&_.current.baseId===t){const X=_.current.startPositions.get(t);if(!X)return;const ee=W.x-X.x,J=W.y-X.y;F({dx:ee,dy:J})}},j=O=>{const W={x:O.target.x(),y:O.target.y()};v(!1),x({visible:!1,position:null,elementType:null}),N(),u(W),_.current=null},z=k==="algebraic-int"?String(i||""):"";let G=40,Y="none";if(z){const O=z.length*Qh*YT+KT*2;O<=B2?G=Math.max(40,O):(G=B2,Y="char")}return M.jsxs(zd,{x:e,y:n,onClick:O=>c(t,O),onTap:O=>c(t,O),draggable:!0,onDragStart:D,onDragMove:V,onDragEnd:j,id:t,name:"element",elementType:"transition",children:[M.jsx(Ac,{x:-40/2,y:-50/2,width:40,height:50,fill:l?"rgba(255, 255, 0, 0.8)":"gray",stroke:s?"blue":l?"rgba(255, 180, 0, 1)":"black",strokeWidth:s||l?3:2}),M.jsx(Ln,{text:r,fontSize:14,fill:"black",x:-40/2,y:50/2+5,width:40,align:"center",listening:!1}),k==="algebraic-int"&&z&&M.jsx(Ln,{text:z,fontSize:Qh,fill:"#333",x:-G/2,y:-50/2-14,width:G,align:"center",wrap:Y,listening:!1,ellipsis:Y!=="none"}),k==="algebraic-int"&&!z&&M.jsx(Ln,{text:"",fontSize:Qh,fill:"gray",x:-40/2,y:-50/2-14,width:40,align:"center",listening:!1})]})},ZT=({elements:t,selectedElement:e,handleElementClick:n,handleElementDragEnd:r,enabledTransitionIds:i})=>{var l,c;const{isIdSelected:s}=_n();return M.jsxs(Nc,{children:[(l=t==null?void 0:t.places)==null?void 0:l.map(u=>M.jsx(XT,{...u,isSelected:s(u.id,"place"),onSelect:f=>n(u,"place"),onChange:f=>r(u,"place",f)},u.id)),(c=t==null?void 0:t.transitions)==null?void 0:c.map(u=>M.jsx(QT,{...u,isSelected:s(u.id,"transition"),onSelect:f=>n(u,"transition"),onChange:f=>r(u,"transition",f),isEnabled:Array.isArray(i)?i.includes(u.id):!1},u.id))]})};function qT(t){return t!=null&&t.sourceType?t.sourceType:(t==null?void 0:t.type)==="place-to-transition"?"place":(t==null?void 0:t.type)==="transition-to-place"?"transition":"place"}function JT(t){return t!=null&&t.targetType?t.targetType:(t==null?void 0:t.type)==="place-to-transition"?"transition":(t==null?void 0:t.type)==="transition-to-place"?"place":"transition"}const eb=.52,Zh=(t="",e=12,{padding:n=4,maxWidth:r=1/0}={})=>{if(!t.length)return{width:0,wrap:"none"};const i=t.length*e*eb+n*2;return i<=r?{width:i,wrap:"none"}:{width:r,wrap:"char"}},qh=(t,e)=>t.width||e*2,Vs=t=>Number.isFinite(t),tb=()=>{var S;const{elements:t,selectedElement:e,selectedElements:n,mode:r,tempArcEnd:i,getVirtualPointerPosition:s,gridSnappingEnabled:l,snapToGrid:c,simulationSettings:u}=_n(),f=(u==null?void 0:u.netMode)||"pt",{handleElementClick:p}=kg(),{handleAddAnglePoint:m,handleDragAnglePoint:x,handleDeleteAnglePoint:v}=g4(),w=C=>!C||typeof C!="string"?null:t.places.find(h=>h.id===C)||t.transitions.find(h=>h.id===C),T=C=>{if(!C)return 30;if(f==="algebraic-int"||Array.isArray(C.valueTokens)){const h=x4(C.valueTokens,30);if(h&&typeof h.radius=="number"&&Number.isFinite(h.radius))return h.radius}return 30},k=(C,h,_=[])=>{if(!C||!h||typeof C.x!="number"||typeof C.y!="number"||typeof h.x!="number"||typeof h.y!="number")return[0,0,100,100];const E={x:C.x,y:C.y},P={x:h.x,y:h.y},I=[{...C},..._,{...h}],A=40,F=50,N={...I[0]},R={...I[I.length-1]},D=I[1]||R,V=I[I.length-2]||N;let j=D.x-N.x,z=D.y-N.y,G=Math.atan2(z,j);if(C.type==="place"){const te=T(C);N.x+=te*Math.cos(G),N.y+=te*Math.sin(G)}else{const te=A/2,ae=F/2,ne=Math.abs(Math.cos(G)),oe=Math.abs(Math.sin(G)),U=Math.tan(G);if(te*oe<=ae*ne)N.x+=Math.sign(j)*te,N.y+=Math.sign(j)*te*U;else{const q=Math.abs(U)<1e-6?1e-6*Math.sign(U||1):U;N.x+=Math.sign(z)*ae/q,N.y+=Math.sign(z)*ae}}let Y=R.x-V.x,O=R.y-V.y,W=Math.atan2(O,Y);if(h.type==="place"){const te=T(h);R.x-=te*Math.cos(W),R.y-=te*Math.sin(W)}else{const te=A/2,ae=F/2,ne=Math.abs(Math.cos(W)),oe=Math.abs(Math.sin(W)),U=Math.tan(W);if(te*oe<=ae*ne)R.x-=Math.sign(Y)*te,R.y-=Math.sign(Y)*te*U;else{const q=Math.abs(U)<1e-6?1e-6*Math.sign(U||1):U;R.x-=Math.sign(O)*ae/q,R.y-=Math.sign(O)*ae}}const X=[N.x,N.y];if(_.forEach(te=>X.push(te.x,te.y)),X.push(R.x,R.y),X.every(te=>Number.isFinite(te)))return X;const J=[E.x,E.y];return _.forEach(te=>J.push(te.x,te.y)),J.push(P.x,P.y),J};return[M.jsxs(Nc,{children:[(S=t==null?void 0:t.arcs)==null?void 0:S.map(C=>{if(!C||!C.source||!C.target)return null;const h=w(C.source),_=w(C.target);if(!h||!_)return null;const E=k({...h,type:qT(C)},{..._,type:JT(C)},Array.isArray(C.anglePoints)?C.anglePoints:[]),P=(E[0]+E[E.length-2])/2,I=(E[1]+E[E.length-1])/2,A=(n==null?void 0:n.some(bt=>bt.id===C.id&&bt.type==="arc"))||(n==null?void 0:n.some(bt=>bt.id===h.id))&&(n==null?void 0:n.some(bt=>bt.id===_.id)),F=12,N=12,R=12,D=C.label?`${C.label}`:"",V=C.weight>1?`${C.weight}`:"",j=f==="algebraic-int"&&Array.isArray(C.bindings)&&C.bindings.length>0?C.bindings.map(n5).join(", "):"",z=Zh(D,F,{padding:6,maxWidth:220}),G=Zh(V,N,{padding:4,maxWidth:80}),Y=Zh(j,R,{padding:6,maxWidth:240}),O=E[0],W=E[1],X=E[E.length-2],ee=E[E.length-1],J=X-O,te=ee-W,ae=Math.hypot(J,te);let ne=0,oe=-1;ae>.001&&(ne=-te/ae,oe=J/ae);const U=6,q=9,re=8,pe=.66,me=Math.abs(ne),Ae=Math.abs(oe),Te=(bt,Kr,Cs=4)=>bt/2*me+Kr/2*Ae+Cs,wt=qh(G,N),Me=qh(z,F),Ft=qh(Y,R),ct=Math.max(U,Te(wt,N)),qt=Math.max(q,Te(Me,F)),Yr=Math.max(qt+re,Te(Ft,R,6)*pe),sr=P-ne*ct,ws=I-oe*ct,_s=P+ne*qt,Ss=I+oe*qt,or=P+ne*Yr,ks=I+oe*Yr;return!Vs(sr)||!Vs(ws)||!Vs(_s)||!Vs(Ss)||!Vs(or)||!Vs(ks)?null:M.jsxs(zd,{children:[M.jsx(MT,{points:E,stroke:(e==null?void 0:e.id)===C.id||A?"blue":"black",strokeWidth:2,fill:"black",pointerLength:10,pointerWidth:10,hitStrokeWidth:12,onClick:bt=>p(bt,C,"arc"),onTap:bt=>p(bt,C,"arc"),onDblClick:bt=>{if(r==="arc_angle"){const Kr=s();Kr&&m(C.id,Kr)}}}),C.weight>1&&M.jsx(Ln,{x:sr,y:ws,text:V,fontSize:N,width:wt,offsetX:wt/2,offsetY:N/2,align:"center",listening:!1}),C.label&&M.jsx(Ln,{x:_s,y:Ss,text:D,fontSize:F,fill:"gray",width:Me,offsetX:Me/2,offsetY:F/2,align:"center",wrap:z.wrap,ellipsis:z.wrap!=="none",listening:!1}),j&&M.jsx(Ln,{x:or,y:ks,text:j,fontSize:R,fill:"#333",width:Ft,offsetX:Ft/2,offsetY:R/2,align:"center",wrap:Y.wrap,ellipsis:Y.wrap!=="none",listening:!1})]},C.id)}),i&&i.sourcePoint&&M.jsx(lp,{points:[i.sourcePoint.x,i.sourcePoint.y,i.x,i.y],stroke:"grey",strokeWidth:2,dash:[5,5],listening:!1})]},"arcs-layer"),M.jsx(Nc,{children:(e==null?void 0:e.type)==="arc"&&r==="arc_angle"&&e.anglePoints.map((C,h)=>M.jsx(tl,{x:C.x,y:C.y,radius:6,fill:"red",stroke:"black",strokeWidth:1,draggable:!0,onDragEnd:_=>{const E={x:_.target.x(),y:_.target.y()},P=l?c(E.x,E.y):E;x(e.id,h,P)},onClick:_=>{_.evt.button===2&&(_.evt.preventDefault(),v(e.id,h))},onContextMenu:_=>{_.evt.preventDefault(),v(e.id,h)}},`angle-${e.id}-${h}`))},"handles-layer")]},nb=({width:t,height:e,gridSize:n})=>{const r=[],i=[],s=Math.ceil(e/n),l=Math.ceil(t/n);for(let c=0;c<=s;c++){const u=c*n;r.push(M.jsx(lp,{points:[0,u,t,u],stroke:"#ddd",strokeWidth:c%5===0?.5:.2,perfectDrawEnabled:!1,listening:!1},`h-${c}`))}for(let c=0;c<=l;c++){const u=c*n;i.push(M.jsx(lp,{points:[u,0,u,e],stroke:"#ddd",strokeWidth:c%5===0?.5:.2,perfectDrawEnabled:!1,listening:!1},`v-${c}`))}return M.jsxs(zd,{listening:!1,perfectDrawEnabled:!1,children:[r,i]})},U2=({orientation:t,contentSize:e,viewportSize:n,scrollPosition:r,onScroll:i})=>{const s=B.useRef(null),l=B.useRef(null),[c,u]=B.useState(!1),f=B.useRef(0),p=B.useRef(0),m=t==="horizontal",x=B.useCallback(A=>{A.preventDefault(),A.stopPropagation(),u(!0),f.current=r,p.current=m?A.clientX:A.clientY},[m,r]),v=B.useCallback(A=>{if(s.current&&l.current&&!l.current.contains(A.target)){const{left:F,top:N,width:R,height:D}=s.current.getBoundingClientRect(),V=m?R:D,j=Math.max(20,V*(n/e)),z=Math.max(0,e-n),G=Math.max(0,V-j);let O=((m?A.clientX-F:A.clientY-N)-j/2)/G*z;O=Math.max(0,Math.min(O,z)),i(O)}},[e,n,m,i]);if(B.useEffect(()=>{const A=N=>{if(!c||!s.current)return;const D=(m?N.clientX:N.clientY)-p.current,V=m?s.current.clientWidth:s.current.clientHeight,j=Math.max(20,V*(n/e)),z=Math.max(0,e-n),G=Math.max(0,V-j);if(G<=0)return;const Y=z/G,O=f.current+D*Y;i(Math.max(0,Math.min(O,z)))},F=()=>{c&&u(!1)};return c&&(document.addEventListener("mousemove",A),document.addEventListener("mouseup",F),document.body.style.cursor=m?"ew-resize":"ns-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",F),document.body.style.cursor="default",document.body.style.userSelect="auto"}},[c,m,i,e,n]),e<=n)return null;const w=s.current?m?s.current.clientWidth:s.current.clientHeight:0,T=w>0?w*(n/e):0,k=Math.max(20,Math.min(T,w)),S=Math.max(0,e-n),C=Math.max(0,w-k),h=Math.max(0,Math.min(r,S)),_=S>0?Math.min(h/S*C,C):0,E={position:"absolute",zIndex:50,padding:0,margin:0,...m?{left:"0px",right:"0px",bottom:"0px",height:"10px"}:{top:"0px",bottom:"0px",right:"0px",width:"10px"}},P={position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},I={position:"absolute",backgroundColor:"rgba(0,0,0,0.45)",borderRadius:"6px",cursor:"pointer",willChange:"transform",...m?{left:`${Math.round(_)}px`,top:"0px",width:`${Math.round(k)}px`,height:"100%"}:{top:`${Math.round(_)}px`,left:"0px",height:`${Math.round(k)}px`,width:"100%"}};return M.jsx("div",{style:E,children:M.jsx("div",{ref:s,style:P,onMouseDown:v,children:M.jsx("div",{ref:l,style:I,onMouseDown:x})})})},rb=({position:t,visible:e,elementType:n})=>!e||!t?null:n==="place"?M.jsx(tl,{x:t.x,y:t.y,radius:5,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}):n==="transition"?M.jsx(Ac,{x:t.x-5,y:t.y-5,width:10,height:10,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}):M.jsx(tl,{x:t.x,y:t.y,radius:5,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}),ib=({handleZoom:t,ZOOM_STEP:e})=>{const{stageDimensions:n,setStageDimensions:r,virtualCanvasDimensions:i,canvasScroll:s,setCanvasScroll:l,zoomLevel:c,setContainerRef:u,stageRef:f,gridSize:p,gridSnappingEnabled:m,snapIndicator:x,setSnapIndicator:v}=Po(),{mode:w,setMode:T,arcStart:k,setArcStart:S,tempArcEnd:C,setTempArcEnd:h,selectedElement:_,setSelectedElement:E,elements:P,enabledTransitionIds:I,snapToGrid:A,selectedElements:F,setSelection:N}=_n(),{handleCreateElement:R,handleElementClick:D,handleElementDragEnd:V}=kg(),j=B.useRef(null),z=B.useRef({isSelecting:!1,start:null}),[G,Y]=B.useState(null),[O,W]=B.useState(!1);B.useEffect(()=>{if(typeof window>"u")return;const ne=window.matchMedia("(pointer: coarse)"),oe=U=>W(U.matches);return oe(ne),ne.addEventListener?ne.addEventListener("change",oe):ne.addListener(oe),()=>{ne.removeEventListener?ne.removeEventListener("change",oe):ne.removeListener(oe)}},[]),B.useEffect(()=>{const ne=j.current;if(!ne)return;u(ne);const oe=new ResizeObserver(U=>{for(let q of U){const{width:re,height:pe}=q.contentRect;re>0&&pe>0&&r({width:re,height:pe})}});return oe.observe(ne),()=>{oe.disconnect()}},[r,u]);const X=()=>{const ne=f.current;if(!ne)return null;const oe=ne.getPointerPosition();if(!oe)return null;const U=ne.getAbsoluteTransform().copy();U.invert();const{x:q,y:re}=U.point(oe);return{x:q,y:re}},ee=ne=>{if(ne.target.name()!=="background")return;const oe=X();R(oe)},J=()=>{const ne=X();if(ne){if(w==="arc"&&k){let oe=null;const U=f.current;if(U){const q=U.getPointerPosition(),re=U.getIntersection(q);re&&(re.attrs.elementType==="place"||re.attrs.elementType==="transition")&&re.attrs.id!==k.element.id&&(oe={id:re.attrs.id,type:re.attrs.elementType})}h({sourcePoint:k.point,x:ne.x,y:ne.y,potentialTarget:oe})}if(w==="select"&&z.current.isSelecting&&z.current.start){const oe=z.current.start;Y({x:oe.x,y:oe.y,w:ne.x-oe.x,h:ne.y-oe.y})}if(m&&(w==="place"||w==="transition")){const oe=A(ne.x,ne.y);v({visible:!0,position:oe,elementType:w})}else x.visible&&v({visible:!1,position:null,elementType:null})}},te=B.useCallback(ne=>{if(ne.preventDefault(),ne.stopPropagation(),ne.ctrlKey||ne.metaKey){const oe=ne.deltaY>0?-e:e;t(oe,{clientX:ne.clientX,clientY:ne.clientY})}else{const oe=ne.deltaX/c,U=ne.deltaY/c;l(q=>{if(!i||!n)return q;const re=Math.max(0,i.width-n.width/c),pe=Math.max(0,i.height-n.height/c);return{x:Math.max(0,Math.min(re,q.x+oe)),y:Math.max(0,Math.min(pe,q.y+U))}})}},[e,t,l,c,i,n]);B.useEffect(()=>{const ne=j.current;if(!ne)return;const oe=U=>{ne.contains(U.target)&&te(U)};return document.addEventListener("wheel",oe,{passive:!1}),()=>{document.removeEventListener("wheel",oe)}},[te]);const ae=B.useCallback((ne,oe)=>{l(U=>{const q=Math.max(0,i.width-n.width/c),re=Math.max(0,i.height-n.height/c),pe=(Ae,Te)=>Math.max(0,Math.min(Ae,Te)),me={...U};return ne==="x"&&(me.x=pe(oe,q)),ne==="y"&&(me.y=pe(oe,re)),me})},[l,i,n,c]);return M.jsxs("div",{ref:j,className:"canvas-container",style:{width:"100%",height:"100%",position:"relative",backgroundColor:"#f0f0f0",overflow:"hidden",touchAction:O?"none":"auto"},children:[M.jsxs(RT,{ref:f,width:n.width,height:n.height,listening:!0,onClick:ee,onMouseMove:J,onMouseDown:ne=>{if(w!=="select"||ne.target&&ne.target.name&&ne.target.name()!=="background")return;const oe=X();oe&&(z.current={isSelecting:!0,start:oe},Y({x:oe.x,y:oe.y,w:0,h:0}))},onMouseUp:()=>{if(w!=="select"||!z.current.isSelecting||!G)return;const ne=IT(P,G);N(ne),z.current={isSelecting:!1,start:null},Y(null)},scaleX:c,scaleY:c,x:-s.x*c,y:-s.y*c,children:[M.jsxs(Nc,{children:[M.jsx(Ac,{x:0,y:0,width:i.width,height:i.height,fill:"#FFFFFF",name:"background",onClick:()=>{w==="arc"&&k&&(S(null),h(null)),E(null)}}),G&&M.jsx(Ac,{x:Math.min(G.x,G.x+G.w),y:Math.min(G.y,G.y+G.h),width:Math.abs(G.w),height:Math.abs(G.h),stroke:"#3399FF",strokeWidth:1,dash:[4,4],fill:"rgba(51,153,255,0.15)",listening:!1}),M.jsx(nb,{width:i.width,height:i.height,gridSize:p}),M.jsx(rb,{position:x.position,visible:x.visible,elementType:x.elementType})]}),M.jsx(ZT,{elements:P,selectedElement:_,handleElementClick:D,handleElementDragEnd:V,enabledTransitionIds:I}),M.jsx(tb,{})]}),!O&&n.width>0&&i.width>n.width/c&&M.jsx(U2,{orientation:"horizontal",contentSize:i.width,viewportSize:n.width/c,scrollPosition:s.x,onScroll:ne=>ae("x",ne)}),!O&&n.height>0&&i.height>n.height/c&&M.jsx(U2,{orientation:"vertical",contentSize:i.height,viewportSize:n.height/c,scrollPosition:s.y,onScroll:ne=>{fe.debug("Vertical scroll callback:",{newScroll:ne,currentScroll:s.y,maxScroll:Math.max(0,i.height-n.height/c)}),ae("y",ne)}})]})};function sb({MIN_ZOOM:t,MAX_ZOOM:e,zoomLevel:n,setZoomLevel:r,virtualCanvasDimensions:i,canvasScroll:s,setCanvasScroll:l,setContainerRef:c}){const u=B.useRef(null),f=B.useRef(!1),p=B.useRef({active:!1}),m=B.useRef(n);B.useEffect(()=>{m.current=n},[n]);const x=B.useCallback(h=>Math.max(t,Math.min(e,h)),[t,e]),v=B.useCallback((h,_,E)=>{if(!u.current||!i)return;const P=u.current,I=P.clientWidth||1,A=P.clientHeight||1,F=P.getBoundingClientRect(),N=E?Math.min(Math.max(E.clientX-F.left,0),I):I/2,R=E?Math.min(Math.max(E.clientY-F.top,0),A):A/2,D=(s.x+N)/h,V=(s.y+R)/h,j=Math.max(0,i.width-I/_),z=Math.max(0,i.height-A/_),G=Math.max(0,Math.min(j,D*_-N)),Y=Math.max(0,Math.min(z,V*_-R));l({x:G,y:Y})},[s,l,i]),w=B.useCallback((h,_,E)=>{if(!u.current||!i||!Number.isFinite(E)||E<=0)return;const P=u.current,I=P.clientWidth||1,A=P.clientHeight||1,F=Math.max(0,i.width-I/E),N=Math.max(0,i.height-A/E);l(R=>{const D=Math.max(0,Math.min(F,R.x-h/E)),V=Math.max(0,Math.min(N,R.y-_/E));return D===R.x&&V===R.y?R:{x:D,y:V}})},[l,i]),T=B.useCallback((h,_)=>{r(E=>{const P=x(h(E));return P!==E&&v(E,P,_),P})},[v,x,r]),k=B.useCallback((h,_)=>{typeof h!="number"||Number.isNaN(h)||h===0||T(E=>E+h,_)},[T]),S=B.useCallback((h,_)=>{typeof h!="number"||Number.isNaN(h)||T(()=>h,_)},[T]),C=B.useCallback(h=>{if(f.current){f.current=!1;return}l&&l({x:h.target.scrollLeft,y:h.target.scrollTop})},[l]);return B.useEffect(()=>{u.current&&(f.current=!0,u.current.scrollLeft!==s.x&&(u.current.scrollLeft=s.x),u.current.scrollTop!==s.y&&(u.current.scrollTop=s.y))},[s,u]),B.useEffect(()=>{u.current&&c&&c(u.current)},[u,c]),B.useEffect(()=>{const h=u.current;if(!h)return;const _=F=>{const[N,R]=F;return Math.hypot(N.clientX-R.clientX,N.clientY-R.clientY)},E=F=>{const[N,R]=F;return{clientX:(N.clientX+R.clientX)/2,clientY:(N.clientY+R.clientY)/2}},P=F=>{F.touches.length===2&&(p.current={active:!0,startDistance:_(F.touches),startZoom:m.current,lastCenter:E(F.touches)})},I=F=>{const N=p.current;if(!N.active)return;if(F.touches.length!==2){p.current={active:!1};return}F.preventDefault();const R=E(F.touches),D=_(F.touches),V=N.startDistance===0?1:D/N.startDistance,j=x(N.startZoom*V);S(j,R);const z=R.clientX-N.lastCenter.clientX,G=R.clientY-N.lastCenter.clientY;p.current={...N,active:!0,startDistance:N.startDistance,startZoom:N.startZoom,lastCenter:R},(Math.abs(z)>.5||Math.abs(G)>.5)&&w(z,G,j)},A=()=>{p.current={active:!1}};return h.addEventListener("touchstart",P,{passive:!0}),h.addEventListener("touchmove",I,{passive:!1}),h.addEventListener("touchend",A),h.addEventListener("touchcancel",A),()=>{h.removeEventListener("touchstart",P),h.removeEventListener("touchmove",I),h.removeEventListener("touchend",A),h.removeEventListener("touchcancel",A)}},[w,x,S]),{localCanvasContainerDivRef:u,handleZoom:k,handleNativeCanvasScroll:C}}function ob({elements:t,selectedElements:e,mode:n,clipboardRef:r,simulationSettings:i,simulatorCore:s}){try{if(t&&(window.__PETRI_NET_STATE__={places:t.places,transitions:t.transitions,arcs:t.arcs,selectedElements:e||[]}),typeof n<"u"&&(window.__PETRI_NET_MODE__=n),r&&(window.__PETRI_NET_CLIPBOARD__=r),i){const c=!!(i!=null&&i.batchMode),u=!!(i!=null&&i.limitIterations),f=Number(i==null?void 0:i.maxIterations),p=Number.isFinite(f)&&f>0?Math.floor(f):2e5,m=!!(i!=null&&i.useNonVisualRun||c);window.__PETRI_NET_NON_VISUAL_RUN__=m,window.__PETRI_NET_SETTINGS__={...window.__PETRI_NET_SETTINGS__||{},batchMode:c,limitIterations:u,maxIterations:p}}s&&!window.__PETRI_NET_SIM_CORE__&&(window.__PETRI_NET_SIM_CORE__=s)}catch{}}const ab=()=>{const{stageDimensions:e,virtualCanvasDimensions:n,canvasScroll:r,setCanvasScroll:i,zoomLevel:s,setZoomLevel:l,gridSnappingEnabled:c,toggleGridSnapping:u,MIN_ZOOM:f,MAX_ZOOM:p,appRef:m,containerRef:x,setContainerRef:v,stageRef:w}=Po(),{elements:T,setElements:k,selectedElement:S,setSelectedElement:C,selectedElements:h,mode:_,setMode:E,arcStart:P,setArcStart:I,tempArcEnd:A,setTempArcEnd:F,clearSelection:N,setSelection:R,isSettingsDialogOpen:D,setIsSettingsDialogOpen:V,simulationSettings:j,setSimulationSettings:z,historyManagerRef:G,canUndo:Y,canRedo:O,handleUndo:W,handleRedo:X,updateHistory:ee,snapToGrid:J,resetEditor:te,simulatorCore:ae,enabledTransitionIds:ne,clipboardRef:oe,setClipboard:U,getClipboard:q,isShiftPressedRef:re}=_n(),[pe,me]=B.useState(!1),{localCanvasContainerDivRef:Ae,handleZoom:Te,handleNativeCanvasScroll:wt}=sb({MIN_ZOOM:f,MAX_ZOOM:p,zoomLevel:s,setZoomLevel:l,virtualCanvasDimensions:n,canvasScroll:r,setCanvasScroll:i,setContainerRef:v}),{handleDeleteElement:Me,clearAllElements:Ft}=kg();return B.useEffect(()=>{ob({elements:T,selectedElements:h,mode:_,clipboardRef:oe,simulationSettings:j,simulatorCore:ae})},[T.places,T.transitions,T.arcs,h,_,j==null?void 0:j.useNonVisualRun,j==null?void 0:j.batchMode,j==null?void 0:j.limitIterations,j==null?void 0:j.maxIterations,oe,ae]),x5({elements:T,setElements:k,selectedElement:S,selectedElements:h,clearSelection:N,setSelection:R,clipboardRef:oe,netMode:(j==null?void 0:j.netMode)||"pt",setClipboard:U,getClipboard:q,onClipboardMismatch:void 0,handleUndo:W,handleRedo:X,setMode:E,arcStart:P,setArcStart:I,setTempArcEnd:F,setSelectedElement:C,isShiftPressedRef:re}),M.jsxs("div",{ref:m,className:"app-container h-screen max-h-screen overflow-hidden",tabIndex:-1,children:[M.jsx("button",{className:"fixed top-3 right-4 z-50 p-2 bg-white rounded-md shadow-md lg:hidden",onClick:()=>me(!pe),children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:pe?M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),M.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 bg-white",onWheel:ct=>ct.stopPropagation(),children:M.jsx(m_,{mode:_,setMode:E,onNew:Ft,onUndo:W,canUndo:Y,onRedo:X,canRedo:O,gridSnappingEnabled:c,onToggleGridSnapping:u,onOpenSettings:()=>V(!0),elements:T,setElements:k,updateHistory:ee,simulationSettings:j,setSimulationSettings:z,resetEditor:te})}),M.jsxs("div",{className:`fixed w-80 right-0 top-16 bottom-0 z-30 bg-gray-100 shadow-lg pt-4 flex flex-col overflow-hidden transform transition-transform duration-300 ease-in-out ${pe?"translate-x-0":"translate-x-full"} lg:translate-x-0`,onWheel:ct=>ct.stopPropagation(),children:[M.jsx("div",{className:"overflow-y-auto pr-2",children:M.jsx(P_,{selectedElement:S,elements:T,setElements:k,updateHistory:ee,simulationSettings:j})}),M.jsx("div",{className:"flex-1 overflow-y-auto pr-2 border-t-2 border-gray-200",children:M.jsx(A_,{elements:T,enabledTransitionIds:ne})}),M.jsx("div",{className:"border-t-2 border-gray-200 w-full"}),M.jsx("div",{className:"mt-auto sticky bottom-0 bg-gray-100",children:M.jsx(R_,{})})]}),M.jsxs("div",{className:"fixed top-20 left-0 bottom-0 right-0 lg:right-80 transition-all duration-300",children:[M.jsx("div",{className:"absolute inset-0 overflow-hidden stage-container bg-gray-200 dark:bg-gray-700","data-testid":"canvas-container",ref:Ae,onScroll:wt,children:M.jsx(ib,{handleZoom:Te,ZOOM_STEP:.1})}),M.jsxs("div",{className:"fixed top-24 right-[336px] z-10 flex flex-col space-y-2 pointer-events-auto",children:[M.jsx("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none",onClick:()=>Te(.1),title:"Zoom In",children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),M.jsx("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none",onClick:()=>Te(-.1),title:"Zoom Out",children:M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 12H6"})})}),M.jsxs("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none text-xs font-mono",onClick:()=>{l(1),i({x:0,y:0})},title:"Reset Zoom",children:[Math.round(s*100),"%"]})]})]}),M.jsx(L_,{isOpen:D,onClose:()=>V(!1)})]})},lb=()=>M.jsx(p9,{children:M.jsx(p_,{children:M.jsx(g_,{children:M.jsx(ab,{})})})});Jh.createRoot(document.getElementById("root")).render(M.jsx(Vt.StrictMode,{children:M.jsx(lb,{})}));export{xo as a,Mn as b,ua as c,uo as d,Jn as e,k9 as f,_9 as g,cb as h,ub as i,nl as j,S9 as p};
//# sourceMappingURL=index-92a28023.js.map
