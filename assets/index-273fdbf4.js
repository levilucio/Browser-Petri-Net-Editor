(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var _T=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function xl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function kT(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var ov={exports:{}},Yu={},av={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wl=Symbol.for("react.element"),Kx=Symbol.for("react.portal"),Qx=Symbol.for("react.fragment"),Zx=Symbol.for("react.strict_mode"),qx=Symbol.for("react.profiler"),Jx=Symbol.for("react.provider"),e6=Symbol.for("react.context"),t6=Symbol.for("react.forward_ref"),n6=Symbol.for("react.suspense"),r6=Symbol.for("react.memo"),i6=Symbol.for("react.lazy"),Tm=Symbol.iterator;function s6(t){return t===null||typeof t!="object"?null:(t=Tm&&t[Tm]||t["@@iterator"],typeof t=="function"?t:null)}var lv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cv=Object.assign,uv={};function Oo(t,e,n){this.props=t,this.context=e,this.refs=uv,this.updater=n||lv}Oo.prototype.isReactComponent={};Oo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Oo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dv(){}dv.prototype=Oo.prototype;function Ep(t,e,n){this.props=t,this.context=e,this.refs=uv,this.updater=n||lv}var Tp=Ep.prototype=new dv;Tp.constructor=Ep;cv(Tp,Oo.prototype);Tp.isPureReactComponent=!0;var Nm=Array.isArray,fv=Object.prototype.hasOwnProperty,Np={current:null},hv={key:!0,ref:!0,__self:!0,__source:!0};function pv(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)fv.call(e,r)&&!hv.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var c=Array(u),f=0;f<u;f++)c[f]=arguments[f+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:wl,type:t,key:s,ref:l,props:i,_owner:Np.current}}function o6(t,e){return{$$typeof:wl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Pp(t){return typeof t=="object"&&t!==null&&t.$$typeof===wl}function a6(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Pm=/\/+/g;function mh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?a6(""+t.key):e.toString(36)}function Xc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case wl:case Kx:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+mh(l,0):r,Nm(i)?(n="",t!=null&&(n=t.replace(Pm,"$&/")+"/"),Xc(i,e,n,"",function(f){return f})):i!=null&&(Pp(i)&&(i=o6(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Pm,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",Nm(t))for(var u=0;u<t.length;u++){s=t[u];var c=r+mh(s,u);l+=Xc(s,e,n,c,i)}else if(c=s6(t),typeof c=="function")for(t=c.call(t),u=0;!(s=t.next()).done;)s=s.value,c=r+mh(s,u++),l+=Xc(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function bc(t,e,n){if(t==null)return t;var r=[],i=0;return Xc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function l6(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cn={current:null},Kc={transition:null},c6={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:Kc,ReactCurrentOwner:Np};function gv(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:bc,forEach:function(t,e,n){bc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return bc(t,function(){e++}),e},toArray:function(t){return bc(t,function(e){return e})||[]},only:function(t){if(!Pp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=Oo;De.Fragment=Qx;De.Profiler=qx;De.PureComponent=Ep;De.StrictMode=Zx;De.Suspense=n6;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=c6;De.act=gv;De.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=cv({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=Np.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)fv.call(e,c)&&!hv.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var f=0;f<c;f++)u[f]=arguments[f+2];r.children=u}return{$$typeof:wl,type:t.type,key:i,ref:s,props:r,_owner:l}};De.createContext=function(t){return t={$$typeof:e6,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Jx,_context:t},t.Consumer=t};De.createElement=pv;De.createFactory=function(t){var e=pv.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:t6,render:t}};De.isValidElement=Pp;De.lazy=function(t){return{$$typeof:i6,_payload:{_status:-1,_result:t},_init:l6}};De.memo=function(t,e){return{$$typeof:r6,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=Kc.transition;Kc.transition={};try{t()}finally{Kc.transition=e}};De.unstable_act=gv;De.useCallback=function(t,e){return cn.current.useCallback(t,e)};De.useContext=function(t){return cn.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return cn.current.useDeferredValue(t)};De.useEffect=function(t,e){return cn.current.useEffect(t,e)};De.useId=function(){return cn.current.useId()};De.useImperativeHandle=function(t,e,n){return cn.current.useImperativeHandle(t,e,n)};De.useInsertionEffect=function(t,e){return cn.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return cn.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return cn.current.useMemo(t,e)};De.useReducer=function(t,e,n){return cn.current.useReducer(t,e,n)};De.useRef=function(t){return cn.current.useRef(t)};De.useState=function(t){return cn.current.useState(t)};De.useSyncExternalStore=function(t,e,n){return cn.current.useSyncExternalStore(t,e,n)};De.useTransition=function(){return cn.current.useTransition()};De.version="18.3.1";av.exports=De;var O=av.exports;const tn=xl(O);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u6=O,d6=Symbol.for("react.element"),f6=Symbol.for("react.fragment"),h6=Object.prototype.hasOwnProperty,p6=u6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,g6={key:!0,ref:!0,__self:!0,__source:!0};function mv(t,e,n){var r,i={},s=null,l=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)h6.call(e,r)&&!g6.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:d6,type:t,key:s,ref:l,props:i,_owner:p6.current}}Yu.Fragment=f6;Yu.jsx=mv;Yu.jsxs=mv;ov.exports=Yu;var C=ov.exports,g0={},yv={exports:{}},Rn={},vv={exports:{}},xv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,$){var X=j.length;j.push($);e:for(;0<X;){var ee=X-1>>>1,ne=j[ee];if(0<i(ne,$))j[ee]=$,j[X]=ne,X=ee;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var $=j[0],X=j.pop();if(X!==$){j[0]=X;e:for(var ee=0,ne=j.length,Z=ne>>>1;ee<Z;){var te=2*(ee+1)-1,de=j[te],fe=te+1,V=j[fe];if(0>i(de,X))fe<ne&&0>i(V,de)?(j[ee]=V,j[fe]=X,ee=fe):(j[ee]=de,j[te]=X,ee=te);else if(fe<ne&&0>i(V,X))j[ee]=V,j[fe]=X,ee=fe;else break e}}return $}function i(j,$){var X=j.sortIndex-$.sortIndex;return X!==0?X:j.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var c=[],f=[],p=1,m=null,w=3,y=!1,x=!1,b=!1,_=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function h(j){for(var $=n(f);$!==null;){if($.callback===null)r(f);else if($.startTime<=j)r(f),$.sortIndex=$.expirationTime,e(c,$);else break;$=n(f)}}function k(j){if(b=!1,h(j),!x)if(n(c)!==null)x=!0,z(E);else{var $=n(f);$!==null&&B(k,$.startTime-j)}}function E(j,$){x=!1,b&&(b=!1,S(M),M=-1),y=!0;var X=w;try{for(h($),m=n(c);m!==null&&(!(m.expirationTime>$)||j&&!F());){var ee=m.callback;if(typeof ee=="function"){m.callback=null,w=m.priorityLevel;var ne=ee(m.expirationTime<=$);$=t.unstable_now(),typeof ne=="function"?m.callback=ne:m===n(c)&&r(c),h($)}else r(c);m=n(c)}if(m!==null)var Z=!0;else{var te=n(f);te!==null&&B(k,te.startTime-$),Z=!1}return Z}finally{m=null,w=X,y=!1}}var N=!1,I=null,M=-1,L=5,A=-1;function F(){return!(t.unstable_now()-A<L)}function D(){if(I!==null){var j=t.unstable_now();A=j;var $=!0;try{$=I(!0,j)}finally{$?U():(N=!1,I=null)}}else N=!1}var U;if(typeof T=="function")U=function(){T(D)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,G=W.port2;W.port1.onmessage=D,U=function(){G.postMessage(null)}}else U=function(){_(D,0)};function z(j){I=j,N||(N=!0,U())}function B(j,$){M=_(function(){j(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){x||y||(x=!0,z(E))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(j){switch(w){case 1:case 2:case 3:var $=3;break;default:$=w}var X=w;w=$;try{return j()}finally{w=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,$){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=w;w=j;try{return $()}finally{w=X}},t.unstable_scheduleCallback=function(j,$,X){var ee=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ee+X:ee):X=ee,j){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=X+ne,j={id:p++,callback:$,priorityLevel:j,startTime:X,expirationTime:ne,sortIndex:-1},X>ee?(j.sortIndex=X,e(f,j),n(c)===null&&j===n(f)&&(b?(S(M),M=-1):b=!0,B(k,X-ee))):(j.sortIndex=ne,e(c,j),x||y||(x=!0,z(E))),j},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(j){var $=w;return function(){var X=w;w=$;try{return j.apply(this,arguments)}finally{w=X}}}})(xv);vv.exports=xv;var Oa=vv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m6=O,Ln=Oa;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wv=new Set,Za={};function Ps(t,e){Eo(t,e),Eo(t+"Capture",e)}function Eo(t,e){for(Za[t]=e,t=0;t<e.length;t++)wv.add(e[t])}var si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m0=Object.prototype.hasOwnProperty,y6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mm={},Am={};function v6(t){return m0.call(Am,t)?!0:m0.call(Mm,t)?!1:y6.test(t)?Am[t]=!0:(Mm[t]=!0,!1)}function x6(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function w6(t,e,n,r){if(e===null||typeof e>"u"||x6(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var Ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ht[t]=new un(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ht[e]=new un(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ht[t]=new un(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ht[t]=new un(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ht[t]=new un(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ht[t]=new un(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ht[t]=new un(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ht[t]=new un(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ht[t]=new un(t,5,!1,t.toLowerCase(),null,!1,!1)});var Mp=/[\-:]([a-z])/g;function Ap(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Mp,Ap);Ht[e]=new un(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Mp,Ap);Ht[e]=new un(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Mp,Ap);Ht[e]=new un(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ht[t]=new un(t,1,!1,t.toLowerCase(),null,!1,!1)});Ht.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ht[t]=new un(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ip(t,e,n,r){var i=Ht.hasOwnProperty(e)?Ht[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(w6(e,n,i,r)&&(n=null),r||i===null?v6(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ci=m6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cc=Symbol.for("react.element"),so=Symbol.for("react.portal"),oo=Symbol.for("react.fragment"),Lp=Symbol.for("react.strict_mode"),y0=Symbol.for("react.profiler"),Sv=Symbol.for("react.provider"),_v=Symbol.for("react.context"),Rp=Symbol.for("react.forward_ref"),v0=Symbol.for("react.suspense"),x0=Symbol.for("react.suspense_list"),jp=Symbol.for("react.memo"),Pi=Symbol.for("react.lazy"),kv=Symbol.for("react.offscreen"),Im=Symbol.iterator;function ma(t){return t===null||typeof t!="object"?null:(t=Im&&t[Im]||t["@@iterator"],typeof t=="function"?t:null)}var gt=Object.assign,yh;function Ia(t){if(yh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);yh=e&&e[1]||""}return`
`+yh+t}var vh=!1;function xh(t,e){if(!t||vh)return"";vh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var r=f}Reflect.construct(t,[],e)}else{try{e.call()}catch(f){r=f}t.call(e.prototype)}else{try{throw Error()}catch(f){r=f}t()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,u=s.length-1;1<=l&&0<=u&&i[l]!==s[u];)u--;for(;1<=l&&0<=u;l--,u--)if(i[l]!==s[u]){if(l!==1||u!==1)do if(l--,u--,0>u||i[l]!==s[u]){var c=`
`+i[l].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=l&&0<=u);break}}}finally{vh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ia(t):""}function S6(t){switch(t.tag){case 5:return Ia(t.type);case 16:return Ia("Lazy");case 13:return Ia("Suspense");case 19:return Ia("SuspenseList");case 0:case 2:case 15:return t=xh(t.type,!1),t;case 11:return t=xh(t.type.render,!1),t;case 1:return t=xh(t.type,!0),t;default:return""}}function w0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case oo:return"Fragment";case so:return"Portal";case y0:return"Profiler";case Lp:return"StrictMode";case v0:return"Suspense";case x0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _v:return(t.displayName||"Context")+".Consumer";case Sv:return(t._context.displayName||"Context")+".Provider";case Rp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case jp:return e=t.displayName||null,e!==null?e:w0(t.type)||"Memo";case Pi:e=t._payload,t=t._init;try{return w0(t(e))}catch{}}return null}function _6(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return w0(e);case 8:return e===Lp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $i(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function bv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function k6(t){var e=bv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ec(t){t._valueTracker||(t._valueTracker=k6(t))}function Cv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=bv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function fu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function S0(t,e){var n=e.checked;return gt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Lm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=$i(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ev(t,e){e=e.checked,e!=null&&Ip(t,"checked",e,!1)}function _0(t,e){Ev(t,e);var n=$i(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?k0(t,e.type,n):e.hasOwnProperty("defaultValue")&&k0(t,e.type,$i(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Rm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function k0(t,e,n){(e!=="number"||fu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var La=Array.isArray;function xo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$i(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function b0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return gt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function jm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ae(92));if(La(n)){if(1<n.length)throw Error(ae(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:$i(n)}}function Tv(t,e){var n=$i(e.value),r=$i(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Fm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Nv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function C0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Nv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Tc,Pv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Tc=Tc||document.createElement("div"),Tc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Da={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},b6=["Webkit","ms","Moz","O"];Object.keys(Da).forEach(function(t){b6.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Da[e]=Da[t]})});function Mv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Da.hasOwnProperty(t)&&Da[t]?(""+e).trim():e+"px"}function Av(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Mv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var C6=gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function E0(t,e){if(e){if(C6[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function T0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var N0=null;function Fp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var P0=null,wo=null,So=null;function Om(t){if(t=kl(t)){if(typeof P0!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=qu(e),P0(t.stateNode,t.type,e))}}function Iv(t){wo?So?So.push(t):So=[t]:wo=t}function Lv(){if(wo){var t=wo,e=So;if(So=wo=null,Om(t),e)for(t=0;t<e.length;t++)Om(e[t])}}function Rv(t,e){return t(e)}function jv(){}var wh=!1;function Fv(t,e,n){if(wh)return t(e,n);wh=!0;try{return Rv(t,e,n)}finally{wh=!1,(wo!==null||So!==null)&&(jv(),Lv())}}function Ja(t,e){var n=t.stateNode;if(n===null)return null;var r=qu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ae(231,e,typeof n));return n}var M0=!1;if(si)try{var ya={};Object.defineProperty(ya,"passive",{get:function(){M0=!0}}),window.addEventListener("test",ya,ya),window.removeEventListener("test",ya,ya)}catch{M0=!1}function E6(t,e,n,r,i,s,l,u,c){var f=Array.prototype.slice.call(arguments,3);try{e.apply(n,f)}catch(p){this.onError(p)}}var za=!1,hu=null,pu=!1,A0=null,T6={onError:function(t){za=!0,hu=t}};function N6(t,e,n,r,i,s,l,u,c){za=!1,hu=null,E6.apply(T6,arguments)}function P6(t,e,n,r,i,s,l,u,c){if(N6.apply(this,arguments),za){if(za){var f=hu;za=!1,hu=null}else throw Error(ae(198));pu||(pu=!0,A0=f)}}function Ms(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ov(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Dm(t){if(Ms(t)!==t)throw Error(ae(188))}function M6(t){var e=t.alternate;if(!e){if(e=Ms(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Dm(i),t;if(s===r)return Dm(i),e;s=s.sibling}throw Error(ae(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,u=i.child;u;){if(u===n){l=!0,n=i,r=s;break}if(u===r){l=!0,r=i,n=s;break}u=u.sibling}if(!l){for(u=s.child;u;){if(u===n){l=!0,n=s,r=i;break}if(u===r){l=!0,r=s,n=i;break}u=u.sibling}if(!l)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?t:e}function Dv(t){return t=M6(t),t!==null?zv(t):null}function zv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=zv(t);if(e!==null)return e;t=t.sibling}return null}var Bv=Ln.unstable_scheduleCallback,zm=Ln.unstable_cancelCallback,A6=Ln.unstable_shouldYield,I6=Ln.unstable_requestPaint,_t=Ln.unstable_now,L6=Ln.unstable_getCurrentPriorityLevel,Op=Ln.unstable_ImmediatePriority,Uv=Ln.unstable_UserBlockingPriority,gu=Ln.unstable_NormalPriority,R6=Ln.unstable_LowPriority,Gv=Ln.unstable_IdlePriority,Xu=null,Or=null;function j6(t){if(Or&&typeof Or.onCommitFiberRoot=="function")try{Or.onCommitFiberRoot(Xu,t,void 0,(t.current.flags&128)===128)}catch{}}var gr=Math.clz32?Math.clz32:D6,F6=Math.log,O6=Math.LN2;function D6(t){return t>>>=0,t===0?32:31-(F6(t)/O6|0)|0}var Nc=64,Pc=4194304;function Ra(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function mu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var u=l&~i;u!==0?r=Ra(u):(s&=l,s!==0&&(r=Ra(s)))}else l=n&~i,l!==0?r=Ra(l):s!==0&&(r=Ra(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-gr(e),i=1<<n,r|=t[n],e&=~i;return r}function z6(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B6(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-gr(s),u=1<<l,c=i[l];c===-1?(!(u&n)||u&r)&&(i[l]=z6(u,e)):c<=e&&(t.expiredLanes|=u),s&=~u}}function I0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Vv(){var t=Nc;return Nc<<=1,!(Nc&4194240)&&(Nc=64),t}function Sh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Sl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-gr(e),t[e]=n}function U6(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-gr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Dp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-gr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ye=0;function Wv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var $v,zp,Hv,Yv,Xv,L0=!1,Mc=[],Fi=null,Oi=null,Di=null,el=new Map,tl=new Map,Ii=[],G6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bm(t,e){switch(t){case"focusin":case"focusout":Fi=null;break;case"dragenter":case"dragleave":Oi=null;break;case"mouseover":case"mouseout":Di=null;break;case"pointerover":case"pointerout":el.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":tl.delete(e.pointerId)}}function va(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=kl(e),e!==null&&zp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function V6(t,e,n,r,i){switch(e){case"focusin":return Fi=va(Fi,t,e,n,r,i),!0;case"dragenter":return Oi=va(Oi,t,e,n,r,i),!0;case"mouseover":return Di=va(Di,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return el.set(s,va(el.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,tl.set(s,va(tl.get(s)||null,t,e,n,r,i)),!0}return!1}function Kv(t){var e=xs(t.target);if(e!==null){var n=Ms(e);if(n!==null){if(e=n.tag,e===13){if(e=Ov(n),e!==null){t.blockedOn=e,Xv(t.priority,function(){Hv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Qc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=R0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);N0=r,n.target.dispatchEvent(r),N0=null}else return e=kl(n),e!==null&&zp(e),t.blockedOn=n,!1;e.shift()}return!0}function Um(t,e,n){Qc(t)&&n.delete(e)}function W6(){L0=!1,Fi!==null&&Qc(Fi)&&(Fi=null),Oi!==null&&Qc(Oi)&&(Oi=null),Di!==null&&Qc(Di)&&(Di=null),el.forEach(Um),tl.forEach(Um)}function xa(t,e){t.blockedOn===e&&(t.blockedOn=null,L0||(L0=!0,Ln.unstable_scheduleCallback(Ln.unstable_NormalPriority,W6)))}function nl(t){function e(i){return xa(i,t)}if(0<Mc.length){xa(Mc[0],t);for(var n=1;n<Mc.length;n++){var r=Mc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Fi!==null&&xa(Fi,t),Oi!==null&&xa(Oi,t),Di!==null&&xa(Di,t),el.forEach(e),tl.forEach(e),n=0;n<Ii.length;n++)r=Ii[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ii.length&&(n=Ii[0],n.blockedOn===null);)Kv(n),n.blockedOn===null&&Ii.shift()}var _o=ci.ReactCurrentBatchConfig,yu=!0;function $6(t,e,n,r){var i=Ye,s=_o.transition;_o.transition=null;try{Ye=1,Bp(t,e,n,r)}finally{Ye=i,_o.transition=s}}function H6(t,e,n,r){var i=Ye,s=_o.transition;_o.transition=null;try{Ye=4,Bp(t,e,n,r)}finally{Ye=i,_o.transition=s}}function Bp(t,e,n,r){if(yu){var i=R0(t,e,n,r);if(i===null)Ah(t,e,r,vu,n),Bm(t,r);else if(V6(i,t,e,n,r))r.stopPropagation();else if(Bm(t,r),e&4&&-1<G6.indexOf(t)){for(;i!==null;){var s=kl(i);if(s!==null&&$v(s),s=R0(t,e,n,r),s===null&&Ah(t,e,r,vu,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ah(t,e,r,null,n)}}var vu=null;function R0(t,e,n,r){if(vu=null,t=Fp(r),t=xs(t),t!==null)if(e=Ms(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ov(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return vu=t,null}function Qv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(L6()){case Op:return 1;case Uv:return 4;case gu:case R6:return 16;case Gv:return 536870912;default:return 16}default:return 16}}var Ri=null,Up=null,Zc=null;function Zv(){if(Zc)return Zc;var t,e=Up,n=e.length,r,i="value"in Ri?Ri.value:Ri.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return Zc=i.slice(t,1<r?1-r:void 0)}function qc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ac(){return!0}function Gm(){return!1}function jn(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ac:Gm,this.isPropagationStopped=Gm,this}return gt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ac)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ac)},persist:function(){},isPersistent:Ac}),e}var Do={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gp=jn(Do),_l=gt({},Do,{view:0,detail:0}),Y6=jn(_l),_h,kh,wa,Ku=gt({},_l,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wa&&(wa&&t.type==="mousemove"?(_h=t.screenX-wa.screenX,kh=t.screenY-wa.screenY):kh=_h=0,wa=t),_h)},movementY:function(t){return"movementY"in t?t.movementY:kh}}),Vm=jn(Ku),X6=gt({},Ku,{dataTransfer:0}),K6=jn(X6),Q6=gt({},_l,{relatedTarget:0}),bh=jn(Q6),Z6=gt({},Do,{animationName:0,elapsedTime:0,pseudoElement:0}),q6=jn(Z6),J6=gt({},Do,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),e8=jn(J6),t8=gt({},Do,{data:0}),Wm=jn(t8),n8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},i8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function s8(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=i8[t])?!!e[t]:!1}function Vp(){return s8}var o8=gt({},_l,{key:function(t){if(t.key){var e=n8[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?r8[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vp,charCode:function(t){return t.type==="keypress"?qc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),a8=jn(o8),l8=gt({},Ku,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$m=jn(l8),c8=gt({},_l,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vp}),u8=jn(c8),d8=gt({},Do,{propertyName:0,elapsedTime:0,pseudoElement:0}),f8=jn(d8),h8=gt({},Ku,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),p8=jn(h8),g8=[9,13,27,32],Wp=si&&"CompositionEvent"in window,Ba=null;si&&"documentMode"in document&&(Ba=document.documentMode);var m8=si&&"TextEvent"in window&&!Ba,qv=si&&(!Wp||Ba&&8<Ba&&11>=Ba),Hm=String.fromCharCode(32),Ym=!1;function Jv(t,e){switch(t){case"keyup":return g8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function e3(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ao=!1;function y8(t,e){switch(t){case"compositionend":return e3(e);case"keypress":return e.which!==32?null:(Ym=!0,Hm);case"textInput":return t=e.data,t===Hm&&Ym?null:t;default:return null}}function v8(t,e){if(ao)return t==="compositionend"||!Wp&&Jv(t,e)?(t=Zv(),Zc=Up=Ri=null,ao=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qv&&e.locale!=="ko"?null:e.data;default:return null}}var x8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!x8[t.type]:e==="textarea"}function t3(t,e,n,r){Iv(r),e=xu(e,"onChange"),0<e.length&&(n=new Gp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ua=null,rl=null;function w8(t){f3(t,0)}function Qu(t){var e=uo(t);if(Cv(e))return t}function S8(t,e){if(t==="change")return e}var n3=!1;if(si){var Ch;if(si){var Eh="oninput"in document;if(!Eh){var Km=document.createElement("div");Km.setAttribute("oninput","return;"),Eh=typeof Km.oninput=="function"}Ch=Eh}else Ch=!1;n3=Ch&&(!document.documentMode||9<document.documentMode)}function Qm(){Ua&&(Ua.detachEvent("onpropertychange",r3),rl=Ua=null)}function r3(t){if(t.propertyName==="value"&&Qu(rl)){var e=[];t3(e,rl,t,Fp(t)),Fv(w8,e)}}function _8(t,e,n){t==="focusin"?(Qm(),Ua=e,rl=n,Ua.attachEvent("onpropertychange",r3)):t==="focusout"&&Qm()}function k8(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qu(rl)}function b8(t,e){if(t==="click")return Qu(e)}function C8(t,e){if(t==="input"||t==="change")return Qu(e)}function E8(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vr=typeof Object.is=="function"?Object.is:E8;function il(t,e){if(vr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!m0.call(e,i)||!vr(t[i],e[i]))return!1}return!0}function Zm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qm(t,e){var n=Zm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zm(n)}}function i3(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?i3(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function s3(){for(var t=window,e=fu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=fu(t.document)}return e}function $p(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function T8(t){var e=s3(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&i3(n.ownerDocument.documentElement,n)){if(r!==null&&$p(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=qm(n,s);var l=qm(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var N8=si&&"documentMode"in document&&11>=document.documentMode,lo=null,j0=null,Ga=null,F0=!1;function Jm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;F0||lo==null||lo!==fu(r)||(r=lo,"selectionStart"in r&&$p(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ga&&il(Ga,r)||(Ga=r,r=xu(j0,"onSelect"),0<r.length&&(e=new Gp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=lo)))}function Ic(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var co={animationend:Ic("Animation","AnimationEnd"),animationiteration:Ic("Animation","AnimationIteration"),animationstart:Ic("Animation","AnimationStart"),transitionend:Ic("Transition","TransitionEnd")},Th={},o3={};si&&(o3=document.createElement("div").style,"AnimationEvent"in window||(delete co.animationend.animation,delete co.animationiteration.animation,delete co.animationstart.animation),"TransitionEvent"in window||delete co.transitionend.transition);function Zu(t){if(Th[t])return Th[t];if(!co[t])return t;var e=co[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in o3)return Th[t]=e[n];return t}var a3=Zu("animationend"),l3=Zu("animationiteration"),c3=Zu("animationstart"),u3=Zu("transitionend"),d3=new Map,e2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xi(t,e){d3.set(t,e),Ps(e,[t])}for(var Nh=0;Nh<e2.length;Nh++){var Ph=e2[Nh],P8=Ph.toLowerCase(),M8=Ph[0].toUpperCase()+Ph.slice(1);Xi(P8,"on"+M8)}Xi(a3,"onAnimationEnd");Xi(l3,"onAnimationIteration");Xi(c3,"onAnimationStart");Xi("dblclick","onDoubleClick");Xi("focusin","onFocus");Xi("focusout","onBlur");Xi(u3,"onTransitionEnd");Eo("onMouseEnter",["mouseout","mouseover"]);Eo("onMouseLeave",["mouseout","mouseover"]);Eo("onPointerEnter",["pointerout","pointerover"]);Eo("onPointerLeave",["pointerout","pointerover"]);Ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ja="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),A8=new Set("cancel close invalid load scroll toggle".split(" ").concat(ja));function t2(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,P6(r,e,void 0,t),t.currentTarget=null}function f3(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var u=r[l],c=u.instance,f=u.currentTarget;if(u=u.listener,c!==s&&i.isPropagationStopped())break e;t2(i,u,f),s=c}else for(l=0;l<r.length;l++){if(u=r[l],c=u.instance,f=u.currentTarget,u=u.listener,c!==s&&i.isPropagationStopped())break e;t2(i,u,f),s=c}}}if(pu)throw t=A0,pu=!1,A0=null,t}function rt(t,e){var n=e[U0];n===void 0&&(n=e[U0]=new Set);var r=t+"__bubble";n.has(r)||(h3(e,t,2,!1),n.add(r))}function Mh(t,e,n){var r=0;e&&(r|=4),h3(n,t,r,e)}var Lc="_reactListening"+Math.random().toString(36).slice(2);function sl(t){if(!t[Lc]){t[Lc]=!0,wv.forEach(function(n){n!=="selectionchange"&&(A8.has(n)||Mh(n,!1,t),Mh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Lc]||(e[Lc]=!0,Mh("selectionchange",!1,e))}}function h3(t,e,n,r){switch(Qv(e)){case 1:var i=$6;break;case 4:i=H6;break;default:i=Bp}n=i.bind(null,e,n,t),i=void 0,!M0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ah(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;l=l.return}for(;u!==null;){if(l=xs(u),l===null)return;if(c=l.tag,c===5||c===6){r=s=l;continue e}u=u.parentNode}}r=r.return}Fv(function(){var f=s,p=Fp(n),m=[];e:{var w=d3.get(t);if(w!==void 0){var y=Gp,x=t;switch(t){case"keypress":if(qc(n)===0)break e;case"keydown":case"keyup":y=a8;break;case"focusin":x="focus",y=bh;break;case"focusout":x="blur",y=bh;break;case"beforeblur":case"afterblur":y=bh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Vm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=K6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=u8;break;case a3:case l3:case c3:y=q6;break;case u3:y=f8;break;case"scroll":y=Y6;break;case"wheel":y=p8;break;case"copy":case"cut":case"paste":y=e8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=$m}var b=(e&4)!==0,_=!b&&t==="scroll",S=b?w!==null?w+"Capture":null:w;b=[];for(var T=f,h;T!==null;){h=T;var k=h.stateNode;if(h.tag===5&&k!==null&&(h=k,S!==null&&(k=Ja(T,S),k!=null&&b.push(ol(T,k,h)))),_)break;T=T.return}0<b.length&&(w=new y(w,x,null,n,p),m.push({event:w,listeners:b}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",w&&n!==N0&&(x=n.relatedTarget||n.fromElement)&&(xs(x)||x[oi]))break e;if((y||w)&&(w=p.window===p?p:(w=p.ownerDocument)?w.defaultView||w.parentWindow:window,y?(x=n.relatedTarget||n.toElement,y=f,x=x?xs(x):null,x!==null&&(_=Ms(x),x!==_||x.tag!==5&&x.tag!==6)&&(x=null)):(y=null,x=f),y!==x)){if(b=Vm,k="onMouseLeave",S="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(b=$m,k="onPointerLeave",S="onPointerEnter",T="pointer"),_=y==null?w:uo(y),h=x==null?w:uo(x),w=new b(k,T+"leave",y,n,p),w.target=_,w.relatedTarget=h,k=null,xs(p)===f&&(b=new b(S,T+"enter",x,n,p),b.target=h,b.relatedTarget=_,k=b),_=k,y&&x)t:{for(b=y,S=x,T=0,h=b;h;h=eo(h))T++;for(h=0,k=S;k;k=eo(k))h++;for(;0<T-h;)b=eo(b),T--;for(;0<h-T;)S=eo(S),h--;for(;T--;){if(b===S||S!==null&&b===S.alternate)break t;b=eo(b),S=eo(S)}b=null}else b=null;y!==null&&n2(m,w,y,b,!1),x!==null&&_!==null&&n2(m,_,x,b,!0)}}e:{if(w=f?uo(f):window,y=w.nodeName&&w.nodeName.toLowerCase(),y==="select"||y==="input"&&w.type==="file")var E=S8;else if(Xm(w))if(n3)E=C8;else{E=k8;var N=_8}else(y=w.nodeName)&&y.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(E=b8);if(E&&(E=E(t,f))){t3(m,E,n,p);break e}N&&N(t,w,f),t==="focusout"&&(N=w._wrapperState)&&N.controlled&&w.type==="number"&&k0(w,"number",w.value)}switch(N=f?uo(f):window,t){case"focusin":(Xm(N)||N.contentEditable==="true")&&(lo=N,j0=f,Ga=null);break;case"focusout":Ga=j0=lo=null;break;case"mousedown":F0=!0;break;case"contextmenu":case"mouseup":case"dragend":F0=!1,Jm(m,n,p);break;case"selectionchange":if(N8)break;case"keydown":case"keyup":Jm(m,n,p)}var I;if(Wp)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else ao?Jv(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(qv&&n.locale!=="ko"&&(ao||M!=="onCompositionStart"?M==="onCompositionEnd"&&ao&&(I=Zv()):(Ri=p,Up="value"in Ri?Ri.value:Ri.textContent,ao=!0)),N=xu(f,M),0<N.length&&(M=new Wm(M,t,null,n,p),m.push({event:M,listeners:N}),I?M.data=I:(I=e3(n),I!==null&&(M.data=I)))),(I=m8?y8(t,n):v8(t,n))&&(f=xu(f,"onBeforeInput"),0<f.length&&(p=new Wm("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:f}),p.data=I))}f3(m,e)})}function ol(t,e,n){return{instance:t,listener:e,currentTarget:n}}function xu(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ja(t,n),s!=null&&r.unshift(ol(t,s,i)),s=Ja(t,e),s!=null&&r.push(ol(t,s,i))),t=t.return}return r}function eo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function n2(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var u=n,c=u.alternate,f=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&f!==null&&(u=f,i?(c=Ja(n,s),c!=null&&l.unshift(ol(n,c,u))):i||(c=Ja(n,s),c!=null&&l.push(ol(n,c,u)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var I8=/\r\n?/g,L8=/\u0000|\uFFFD/g;function r2(t){return(typeof t=="string"?t:""+t).replace(I8,`
`).replace(L8,"")}function Rc(t,e,n){if(e=r2(e),r2(t)!==e&&n)throw Error(ae(425))}function wu(){}var O0=null,D0=null;function z0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var B0=typeof setTimeout=="function"?setTimeout:void 0,R8=typeof clearTimeout=="function"?clearTimeout:void 0,i2=typeof Promise=="function"?Promise:void 0,j8=typeof queueMicrotask=="function"?queueMicrotask:typeof i2<"u"?function(t){return i2.resolve(null).then(t).catch(F8)}:B0;function F8(t){setTimeout(function(){throw t})}function Ih(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),nl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);nl(e)}function zi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function s2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var zo=Math.random().toString(36).slice(2),Rr="__reactFiber$"+zo,al="__reactProps$"+zo,oi="__reactContainer$"+zo,U0="__reactEvents$"+zo,O8="__reactListeners$"+zo,D8="__reactHandles$"+zo;function xs(t){var e=t[Rr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[oi]||n[Rr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=s2(t);t!==null;){if(n=t[Rr])return n;t=s2(t)}return e}t=n,n=t.parentNode}return null}function kl(t){return t=t[Rr]||t[oi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function uo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function qu(t){return t[al]||null}var G0=[],fo=-1;function Ki(t){return{current:t}}function it(t){0>fo||(t.current=G0[fo],G0[fo]=null,fo--)}function Je(t,e){fo++,G0[fo]=t.current,t.current=e}var Hi={},rn=Ki(Hi),bn=Ki(!1),bs=Hi;function To(t,e){var n=t.type.contextTypes;if(!n)return Hi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Cn(t){return t=t.childContextTypes,t!=null}function Su(){it(bn),it(rn)}function o2(t,e,n){if(rn.current!==Hi)throw Error(ae(168));Je(rn,e),Je(bn,n)}function p3(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ae(108,_6(t)||"Unknown",i));return gt({},n,r)}function _u(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Hi,bs=rn.current,Je(rn,t),Je(bn,bn.current),!0}function a2(t,e,n){var r=t.stateNode;if(!r)throw Error(ae(169));n?(t=p3(t,e,bs),r.__reactInternalMemoizedMergedChildContext=t,it(bn),it(rn),Je(rn,t)):it(bn),Je(bn,n)}var Jr=null,Ju=!1,Lh=!1;function g3(t){Jr===null?Jr=[t]:Jr.push(t)}function z8(t){Ju=!0,g3(t)}function Qi(){if(!Lh&&Jr!==null){Lh=!0;var t=0,e=Ye;try{var n=Jr;for(Ye=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Jr=null,Ju=!1}catch(i){throw Jr!==null&&(Jr=Jr.slice(t+1)),Bv(Op,Qi),i}finally{Ye=e,Lh=!1}}return null}var ho=[],po=0,ku=null,bu=0,Xn=[],Kn=0,Cs=null,ei=1,ti="";function ms(t,e){ho[po++]=bu,ho[po++]=ku,ku=t,bu=e}function m3(t,e,n){Xn[Kn++]=ei,Xn[Kn++]=ti,Xn[Kn++]=Cs,Cs=t;var r=ei;t=ti;var i=32-gr(r)-1;r&=~(1<<i),n+=1;var s=32-gr(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,ei=1<<32-gr(e)+i|n<<i|r,ti=s+t}else ei=1<<s|n<<i|r,ti=t}function Hp(t){t.return!==null&&(ms(t,1),m3(t,1,0))}function Yp(t){for(;t===ku;)ku=ho[--po],ho[po]=null,bu=ho[--po],ho[po]=null;for(;t===Cs;)Cs=Xn[--Kn],Xn[Kn]=null,ti=Xn[--Kn],Xn[Kn]=null,ei=Xn[--Kn],Xn[Kn]=null}var In=null,An=null,ct=!1,fr=null;function y3(t,e){var n=Zn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function l2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,In=t,An=zi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,In=t,An=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Cs!==null?{id:ei,overflow:ti}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Zn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,In=t,An=null,!0):!1;default:return!1}}function V0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function W0(t){if(ct){var e=An;if(e){var n=e;if(!l2(t,e)){if(V0(t))throw Error(ae(418));e=zi(n.nextSibling);var r=In;e&&l2(t,e)?y3(r,n):(t.flags=t.flags&-4097|2,ct=!1,In=t)}}else{if(V0(t))throw Error(ae(418));t.flags=t.flags&-4097|2,ct=!1,In=t}}}function c2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;In=t}function jc(t){if(t!==In)return!1;if(!ct)return c2(t),ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!z0(t.type,t.memoizedProps)),e&&(e=An)){if(V0(t))throw v3(),Error(ae(418));for(;e;)y3(t,e),e=zi(e.nextSibling)}if(c2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){An=zi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}An=null}}else An=In?zi(t.stateNode.nextSibling):null;return!0}function v3(){for(var t=An;t;)t=zi(t.nextSibling)}function No(){An=In=null,ct=!1}function Xp(t){fr===null?fr=[t]:fr.push(t)}var B8=ci.ReactCurrentBatchConfig;function Sa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var u=i.refs;l===null?delete u[s]:u[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,t))}return t}function Fc(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function u2(t){var e=t._init;return e(t._payload)}function x3(t){function e(S,T){if(t){var h=S.deletions;h===null?(S.deletions=[T],S.flags|=16):h.push(T)}}function n(S,T){if(!t)return null;for(;T!==null;)e(S,T),T=T.sibling;return null}function r(S,T){for(S=new Map;T!==null;)T.key!==null?S.set(T.key,T):S.set(T.index,T),T=T.sibling;return S}function i(S,T){return S=Vi(S,T),S.index=0,S.sibling=null,S}function s(S,T,h){return S.index=h,t?(h=S.alternate,h!==null?(h=h.index,h<T?(S.flags|=2,T):h):(S.flags|=2,T)):(S.flags|=1048576,T)}function l(S){return t&&S.alternate===null&&(S.flags|=2),S}function u(S,T,h,k){return T===null||T.tag!==6?(T=Bh(h,S.mode,k),T.return=S,T):(T=i(T,h),T.return=S,T)}function c(S,T,h,k){var E=h.type;return E===oo?p(S,T,h.props.children,k,h.key):T!==null&&(T.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Pi&&u2(E)===T.type)?(k=i(T,h.props),k.ref=Sa(S,T,h),k.return=S,k):(k=su(h.type,h.key,h.props,null,S.mode,k),k.ref=Sa(S,T,h),k.return=S,k)}function f(S,T,h,k){return T===null||T.tag!==4||T.stateNode.containerInfo!==h.containerInfo||T.stateNode.implementation!==h.implementation?(T=Uh(h,S.mode,k),T.return=S,T):(T=i(T,h.children||[]),T.return=S,T)}function p(S,T,h,k,E){return T===null||T.tag!==7?(T=ks(h,S.mode,k,E),T.return=S,T):(T=i(T,h),T.return=S,T)}function m(S,T,h){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Bh(""+T,S.mode,h),T.return=S,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Cc:return h=su(T.type,T.key,T.props,null,S.mode,h),h.ref=Sa(S,null,T),h.return=S,h;case so:return T=Uh(T,S.mode,h),T.return=S,T;case Pi:var k=T._init;return m(S,k(T._payload),h)}if(La(T)||ma(T))return T=ks(T,S.mode,h,null),T.return=S,T;Fc(S,T)}return null}function w(S,T,h,k){var E=T!==null?T.key:null;if(typeof h=="string"&&h!==""||typeof h=="number")return E!==null?null:u(S,T,""+h,k);if(typeof h=="object"&&h!==null){switch(h.$$typeof){case Cc:return h.key===E?c(S,T,h,k):null;case so:return h.key===E?f(S,T,h,k):null;case Pi:return E=h._init,w(S,T,E(h._payload),k)}if(La(h)||ma(h))return E!==null?null:p(S,T,h,k,null);Fc(S,h)}return null}function y(S,T,h,k,E){if(typeof k=="string"&&k!==""||typeof k=="number")return S=S.get(h)||null,u(T,S,""+k,E);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Cc:return S=S.get(k.key===null?h:k.key)||null,c(T,S,k,E);case so:return S=S.get(k.key===null?h:k.key)||null,f(T,S,k,E);case Pi:var N=k._init;return y(S,T,h,N(k._payload),E)}if(La(k)||ma(k))return S=S.get(h)||null,p(T,S,k,E,null);Fc(T,k)}return null}function x(S,T,h,k){for(var E=null,N=null,I=T,M=T=0,L=null;I!==null&&M<h.length;M++){I.index>M?(L=I,I=null):L=I.sibling;var A=w(S,I,h[M],k);if(A===null){I===null&&(I=L);break}t&&I&&A.alternate===null&&e(S,I),T=s(A,T,M),N===null?E=A:N.sibling=A,N=A,I=L}if(M===h.length)return n(S,I),ct&&ms(S,M),E;if(I===null){for(;M<h.length;M++)I=m(S,h[M],k),I!==null&&(T=s(I,T,M),N===null?E=I:N.sibling=I,N=I);return ct&&ms(S,M),E}for(I=r(S,I);M<h.length;M++)L=y(I,S,M,h[M],k),L!==null&&(t&&L.alternate!==null&&I.delete(L.key===null?M:L.key),T=s(L,T,M),N===null?E=L:N.sibling=L,N=L);return t&&I.forEach(function(F){return e(S,F)}),ct&&ms(S,M),E}function b(S,T,h,k){var E=ma(h);if(typeof E!="function")throw Error(ae(150));if(h=E.call(h),h==null)throw Error(ae(151));for(var N=E=null,I=T,M=T=0,L=null,A=h.next();I!==null&&!A.done;M++,A=h.next()){I.index>M?(L=I,I=null):L=I.sibling;var F=w(S,I,A.value,k);if(F===null){I===null&&(I=L);break}t&&I&&F.alternate===null&&e(S,I),T=s(F,T,M),N===null?E=F:N.sibling=F,N=F,I=L}if(A.done)return n(S,I),ct&&ms(S,M),E;if(I===null){for(;!A.done;M++,A=h.next())A=m(S,A.value,k),A!==null&&(T=s(A,T,M),N===null?E=A:N.sibling=A,N=A);return ct&&ms(S,M),E}for(I=r(S,I);!A.done;M++,A=h.next())A=y(I,S,M,A.value,k),A!==null&&(t&&A.alternate!==null&&I.delete(A.key===null?M:A.key),T=s(A,T,M),N===null?E=A:N.sibling=A,N=A);return t&&I.forEach(function(D){return e(S,D)}),ct&&ms(S,M),E}function _(S,T,h,k){if(typeof h=="object"&&h!==null&&h.type===oo&&h.key===null&&(h=h.props.children),typeof h=="object"&&h!==null){switch(h.$$typeof){case Cc:e:{for(var E=h.key,N=T;N!==null;){if(N.key===E){if(E=h.type,E===oo){if(N.tag===7){n(S,N.sibling),T=i(N,h.props.children),T.return=S,S=T;break e}}else if(N.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Pi&&u2(E)===N.type){n(S,N.sibling),T=i(N,h.props),T.ref=Sa(S,N,h),T.return=S,S=T;break e}n(S,N);break}else e(S,N);N=N.sibling}h.type===oo?(T=ks(h.props.children,S.mode,k,h.key),T.return=S,S=T):(k=su(h.type,h.key,h.props,null,S.mode,k),k.ref=Sa(S,T,h),k.return=S,S=k)}return l(S);case so:e:{for(N=h.key;T!==null;){if(T.key===N)if(T.tag===4&&T.stateNode.containerInfo===h.containerInfo&&T.stateNode.implementation===h.implementation){n(S,T.sibling),T=i(T,h.children||[]),T.return=S,S=T;break e}else{n(S,T);break}else e(S,T);T=T.sibling}T=Uh(h,S.mode,k),T.return=S,S=T}return l(S);case Pi:return N=h._init,_(S,T,N(h._payload),k)}if(La(h))return x(S,T,h,k);if(ma(h))return b(S,T,h,k);Fc(S,h)}return typeof h=="string"&&h!==""||typeof h=="number"?(h=""+h,T!==null&&T.tag===6?(n(S,T.sibling),T=i(T,h),T.return=S,S=T):(n(S,T),T=Bh(h,S.mode,k),T.return=S,S=T),l(S)):n(S,T)}return _}var Po=x3(!0),w3=x3(!1),Cu=Ki(null),Eu=null,go=null,Kp=null;function Qp(){Kp=go=Eu=null}function Zp(t){var e=Cu.current;it(Cu),t._currentValue=e}function $0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ko(t,e){Eu=t,Kp=go=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(_n=!0),t.firstContext=null)}function Jn(t){var e=t._currentValue;if(Kp!==t)if(t={context:t,memoizedValue:e,next:null},go===null){if(Eu===null)throw Error(ae(308));go=t,Eu.dependencies={lanes:0,firstContext:t}}else go=go.next=t;return e}var ws=null;function qp(t){ws===null?ws=[t]:ws.push(t)}function S3(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,qp(e)):(n.next=i.next,i.next=n),e.interleaved=n,ai(t,r)}function ai(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Mi=!1;function Jp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _3(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ni(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ai(t,n)}return i=r.interleaved,i===null?(e.next=e,qp(r)):(e.next=i.next,i.next=e),r.interleaved=e,ai(t,n)}function Jc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Dp(t,n)}}function d2(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Tu(t,e,n,r){var i=t.updateQueue;Mi=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var c=u,f=c.next;c.next=null,l===null?s=f:l.next=f,l=c;var p=t.alternate;p!==null&&(p=p.updateQueue,u=p.lastBaseUpdate,u!==l&&(u===null?p.firstBaseUpdate=f:u.next=f,p.lastBaseUpdate=c))}if(s!==null){var m=i.baseState;l=0,p=f=c=null,u=s;do{var w=u.lane,y=u.eventTime;if((r&w)===w){p!==null&&(p=p.next={eventTime:y,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var x=t,b=u;switch(w=e,y=n,b.tag){case 1:if(x=b.payload,typeof x=="function"){m=x.call(y,m,w);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=b.payload,w=typeof x=="function"?x.call(y,m,w):x,w==null)break e;m=gt({},m,w);break e;case 2:Mi=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,w=i.effects,w===null?i.effects=[u]:w.push(u))}else y={eventTime:y,lane:w,tag:u.tag,payload:u.payload,callback:u.callback,next:null},p===null?(f=p=y,c=m):p=p.next=y,l|=w;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;w=u,u=w.next,w.next=null,i.lastBaseUpdate=w,i.shared.pending=null}}while(1);if(p===null&&(c=m),i.baseState=c,i.firstBaseUpdate=f,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ts|=l,t.lanes=l,t.memoizedState=m}}function f2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ae(191,i));i.call(r)}}}var bl={},Dr=Ki(bl),ll=Ki(bl),cl=Ki(bl);function Ss(t){if(t===bl)throw Error(ae(174));return t}function eg(t,e){switch(Je(cl,e),Je(ll,t),Je(Dr,bl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:C0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=C0(e,t)}it(Dr),Je(Dr,e)}function Mo(){it(Dr),it(ll),it(cl)}function k3(t){Ss(cl.current);var e=Ss(Dr.current),n=C0(e,t.type);e!==n&&(Je(ll,t),Je(Dr,n))}function tg(t){ll.current===t&&(it(Dr),it(ll))}var ht=Ki(0);function Nu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rh=[];function ng(){for(var t=0;t<Rh.length;t++)Rh[t]._workInProgressVersionPrimary=null;Rh.length=0}var eu=ci.ReactCurrentDispatcher,jh=ci.ReactCurrentBatchConfig,Es=0,pt=null,Pt=null,Ot=null,Pu=!1,Va=!1,ul=0,U8=0;function Jt(){throw Error(ae(321))}function rg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!vr(t[n],e[n]))return!1;return!0}function ig(t,e,n,r,i,s){if(Es=s,pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,eu.current=t===null||t.memoizedState===null?$8:H8,t=n(r,i),Va){s=0;do{if(Va=!1,ul=0,25<=s)throw Error(ae(301));s+=1,Ot=Pt=null,e.updateQueue=null,eu.current=Y8,t=n(r,i)}while(Va)}if(eu.current=Mu,e=Pt!==null&&Pt.next!==null,Es=0,Ot=Pt=pt=null,Pu=!1,e)throw Error(ae(300));return t}function sg(){var t=ul!==0;return ul=0,t}function Ir(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?pt.memoizedState=Ot=t:Ot=Ot.next=t,Ot}function er(){if(Pt===null){var t=pt.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Ot===null?pt.memoizedState:Ot.next;if(e!==null)Ot=e,Pt=t;else{if(t===null)throw Error(ae(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Ot===null?pt.memoizedState=Ot=t:Ot=Ot.next=t}return Ot}function dl(t,e){return typeof e=="function"?e(t):e}function Fh(t){var e=er(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=Pt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=l=null,c=null,f=s;do{var p=f.lane;if((Es&p)===p)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:t(r,f.action);else{var m={lane:p,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(u=c=m,l=r):c=c.next=m,pt.lanes|=p,Ts|=p}f=f.next}while(f!==null&&f!==s);c===null?l=r:c.next=u,vr(r,e.memoizedState)||(_n=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,pt.lanes|=s,Ts|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Oh(t){var e=er(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);vr(s,e.memoizedState)||(_n=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function b3(){}function C3(t,e){var n=pt,r=er(),i=e(),s=!vr(r.memoizedState,i);if(s&&(r.memoizedState=i,_n=!0),r=r.queue,og(N3.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ot!==null&&Ot.memoizedState.tag&1){if(n.flags|=2048,fl(9,T3.bind(null,n,r,i,e),void 0,null),Dt===null)throw Error(ae(349));Es&30||E3(n,e,i)}return i}function E3(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function T3(t,e,n,r){e.value=n,e.getSnapshot=r,P3(e)&&M3(t)}function N3(t,e,n){return n(function(){P3(e)&&M3(t)})}function P3(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!vr(t,n)}catch{return!0}}function M3(t){var e=ai(t,1);e!==null&&mr(e,t,1,-1)}function h2(t){var e=Ir();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dl,lastRenderedState:t},e.queue=t,t=t.dispatch=W8.bind(null,pt,t),[e.memoizedState,t]}function fl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function A3(){return er().memoizedState}function tu(t,e,n,r){var i=Ir();pt.flags|=t,i.memoizedState=fl(1|e,n,void 0,r===void 0?null:r)}function ed(t,e,n,r){var i=er();r=r===void 0?null:r;var s=void 0;if(Pt!==null){var l=Pt.memoizedState;if(s=l.destroy,r!==null&&rg(r,l.deps)){i.memoizedState=fl(e,n,s,r);return}}pt.flags|=t,i.memoizedState=fl(1|e,n,s,r)}function p2(t,e){return tu(8390656,8,t,e)}function og(t,e){return ed(2048,8,t,e)}function I3(t,e){return ed(4,2,t,e)}function L3(t,e){return ed(4,4,t,e)}function R3(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function j3(t,e,n){return n=n!=null?n.concat([t]):null,ed(4,4,R3.bind(null,e,t),n)}function ag(){}function F3(t,e){var n=er();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&rg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function O3(t,e){var n=er();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&rg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function D3(t,e,n){return Es&21?(vr(n,e)||(n=Vv(),pt.lanes|=n,Ts|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,_n=!0),t.memoizedState=n)}function G8(t,e){var n=Ye;Ye=n!==0&&4>n?n:4,t(!0);var r=jh.transition;jh.transition={};try{t(!1),e()}finally{Ye=n,jh.transition=r}}function z3(){return er().memoizedState}function V8(t,e,n){var r=Gi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},B3(t))U3(e,n);else if(n=S3(t,e,n,r),n!==null){var i=ln();mr(n,t,r,i),G3(n,e,r)}}function W8(t,e,n){var r=Gi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(B3(t))U3(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,u=s(l,n);if(i.hasEagerState=!0,i.eagerState=u,vr(u,l)){var c=e.interleaved;c===null?(i.next=i,qp(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=S3(t,e,i,r),n!==null&&(i=ln(),mr(n,t,r,i),G3(n,e,r))}}function B3(t){var e=t.alternate;return t===pt||e!==null&&e===pt}function U3(t,e){Va=Pu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function G3(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Dp(t,n)}}var Mu={readContext:Jn,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},$8={readContext:Jn,useCallback:function(t,e){return Ir().memoizedState=[t,e===void 0?null:e],t},useContext:Jn,useEffect:p2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,tu(4194308,4,R3.bind(null,e,t),n)},useLayoutEffect:function(t,e){return tu(4194308,4,t,e)},useInsertionEffect:function(t,e){return tu(4,2,t,e)},useMemo:function(t,e){var n=Ir();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ir();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=V8.bind(null,pt,t),[r.memoizedState,t]},useRef:function(t){var e=Ir();return t={current:t},e.memoizedState=t},useState:h2,useDebugValue:ag,useDeferredValue:function(t){return Ir().memoizedState=t},useTransition:function(){var t=h2(!1),e=t[0];return t=G8.bind(null,t[1]),Ir().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pt,i=Ir();if(ct){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=e(),Dt===null)throw Error(ae(349));Es&30||E3(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,p2(N3.bind(null,r,s,t),[t]),r.flags|=2048,fl(9,T3.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ir(),e=Dt.identifierPrefix;if(ct){var n=ti,r=ei;n=(r&~(1<<32-gr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ul++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=U8++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},H8={readContext:Jn,useCallback:F3,useContext:Jn,useEffect:og,useImperativeHandle:j3,useInsertionEffect:I3,useLayoutEffect:L3,useMemo:O3,useReducer:Fh,useRef:A3,useState:function(){return Fh(dl)},useDebugValue:ag,useDeferredValue:function(t){var e=er();return D3(e,Pt.memoizedState,t)},useTransition:function(){var t=Fh(dl)[0],e=er().memoizedState;return[t,e]},useMutableSource:b3,useSyncExternalStore:C3,useId:z3,unstable_isNewReconciler:!1},Y8={readContext:Jn,useCallback:F3,useContext:Jn,useEffect:og,useImperativeHandle:j3,useInsertionEffect:I3,useLayoutEffect:L3,useMemo:O3,useReducer:Oh,useRef:A3,useState:function(){return Oh(dl)},useDebugValue:ag,useDeferredValue:function(t){var e=er();return Pt===null?e.memoizedState=t:D3(e,Pt.memoizedState,t)},useTransition:function(){var t=Oh(dl)[0],e=er().memoizedState;return[t,e]},useMutableSource:b3,useSyncExternalStore:C3,useId:z3,unstable_isNewReconciler:!1};function ur(t,e){if(t&&t.defaultProps){e=gt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function H0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:gt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var td={isMounted:function(t){return(t=t._reactInternals)?Ms(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ln(),i=Gi(t),s=ni(r,i);s.payload=e,n!=null&&(s.callback=n),e=Bi(t,s,i),e!==null&&(mr(e,t,i,r),Jc(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ln(),i=Gi(t),s=ni(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Bi(t,s,i),e!==null&&(mr(e,t,i,r),Jc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ln(),r=Gi(t),i=ni(n,r);i.tag=2,e!=null&&(i.callback=e),e=Bi(t,i,r),e!==null&&(mr(e,t,r,n),Jc(e,t,r))}};function g2(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!il(n,r)||!il(i,s):!0}function V3(t,e,n){var r=!1,i=Hi,s=e.contextType;return typeof s=="object"&&s!==null?s=Jn(s):(i=Cn(e)?bs:rn.current,r=e.contextTypes,s=(r=r!=null)?To(t,i):Hi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=td,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function m2(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&td.enqueueReplaceState(e,e.state,null)}function Y0(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Jp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Jn(s):(s=Cn(e)?bs:rn.current,i.context=To(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(H0(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&td.enqueueReplaceState(i,i.state,null),Tu(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ao(t,e){try{var n="",r=e;do n+=S6(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Dh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function X0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var X8=typeof WeakMap=="function"?WeakMap:Map;function W3(t,e,n){n=ni(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Iu||(Iu=!0,ip=r),X0(t,e)},n}function $3(t,e,n){n=ni(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){X0(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){X0(t,e),typeof r!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function y2(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new X8;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=lw.bind(null,t,e,n),e.then(t,t))}function v2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function x2(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ni(-1,1),e.tag=2,Bi(n,e,1))),n.lanes|=1),t)}var K8=ci.ReactCurrentOwner,_n=!1;function an(t,e,n,r){e.child=t===null?w3(e,null,n,r):Po(e,t.child,n,r)}function w2(t,e,n,r,i){n=n.render;var s=e.ref;return ko(e,i),r=ig(t,e,n,r,s,i),n=sg(),t!==null&&!_n?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,li(t,e,i)):(ct&&n&&Hp(e),e.flags|=1,an(t,e,r,i),e.child)}function S2(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!gg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,H3(t,e,s,r,i)):(t=su(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:il,n(l,r)&&t.ref===e.ref)return li(t,e,i)}return e.flags|=1,t=Vi(s,r),t.ref=e.ref,t.return=e,e.child=t}function H3(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(il(s,r)&&t.ref===e.ref)if(_n=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(_n=!0);else return e.lanes=t.lanes,li(t,e,i)}return K0(t,e,n,r,i)}function Y3(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(yo,Mn),Mn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Je(yo,Mn),Mn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Je(yo,Mn),Mn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Je(yo,Mn),Mn|=r;return an(t,e,i,n),e.child}function X3(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function K0(t,e,n,r,i){var s=Cn(n)?bs:rn.current;return s=To(e,s),ko(e,i),n=ig(t,e,n,r,s,i),r=sg(),t!==null&&!_n?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,li(t,e,i)):(ct&&r&&Hp(e),e.flags|=1,an(t,e,n,i),e.child)}function _2(t,e,n,r,i){if(Cn(n)){var s=!0;_u(e)}else s=!1;if(ko(e,i),e.stateNode===null)nu(t,e),V3(e,n,r),Y0(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,u=e.memoizedProps;l.props=u;var c=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=Jn(f):(f=Cn(n)?bs:rn.current,f=To(e,f));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof l.getSnapshotBeforeUpdate=="function";m||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==r||c!==f)&&m2(e,l,r,f),Mi=!1;var w=e.memoizedState;l.state=w,Tu(e,r,l,i),c=e.memoizedState,u!==r||w!==c||bn.current||Mi?(typeof p=="function"&&(H0(e,n,p,r),c=e.memoizedState),(u=Mi||g2(e,n,u,r,w,c,f))?(m||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),l.props=r,l.state=c,l.context=f,r=u):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,_3(t,e),u=e.memoizedProps,f=e.type===e.elementType?u:ur(e.type,u),l.props=f,m=e.pendingProps,w=l.context,c=n.contextType,typeof c=="object"&&c!==null?c=Jn(c):(c=Cn(n)?bs:rn.current,c=To(e,c));var y=n.getDerivedStateFromProps;(p=typeof y=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==m||w!==c)&&m2(e,l,r,c),Mi=!1,w=e.memoizedState,l.state=w,Tu(e,r,l,i);var x=e.memoizedState;u!==m||w!==x||bn.current||Mi?(typeof y=="function"&&(H0(e,n,y,r),x=e.memoizedState),(f=Mi||g2(e,n,f,r,w,x,c)||!1)?(p||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,x,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,x,c)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),l.props=r,l.state=x,l.context=c,r=f):(typeof l.componentDidUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return Q0(t,e,n,r,s,i)}function Q0(t,e,n,r,i,s){X3(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&a2(e,n,!1),li(t,e,s);r=e.stateNode,K8.current=e;var u=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=Po(e,t.child,null,s),e.child=Po(e,null,u,s)):an(t,e,u,s),e.memoizedState=r.state,i&&a2(e,n,!0),e.child}function K3(t){var e=t.stateNode;e.pendingContext?o2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&o2(t,e.context,!1),eg(t,e.containerInfo)}function k2(t,e,n,r,i){return No(),Xp(i),e.flags|=256,an(t,e,n,r),e.child}var Z0={dehydrated:null,treeContext:null,retryLane:0};function q0(t){return{baseLanes:t,cachePool:null,transitions:null}}function Q3(t,e,n){var r=e.pendingProps,i=ht.current,s=!1,l=(e.flags&128)!==0,u;if((u=l)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Je(ht,i&1),t===null)return W0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=id(l,r,0,null),t=ks(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=q0(n),e.memoizedState=Z0,t):lg(e,l));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return Q8(t,e,l,r,u,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,u=i.sibling;var c={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Vi(i,c),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=Vi(u,s):(s=ks(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?q0(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=Z0,r}return s=t.child,t=s.sibling,r=Vi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function lg(t,e){return e=id({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Oc(t,e,n,r){return r!==null&&Xp(r),Po(e,t.child,null,n),t=lg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Q8(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=Dh(Error(ae(422))),Oc(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=id({mode:"visible",children:r.children},i,0,null),s=ks(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Po(e,t.child,null,l),e.child.memoizedState=q0(l),e.memoizedState=Z0,s);if(!(e.mode&1))return Oc(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(ae(419)),r=Dh(s,r,void 0),Oc(t,e,l,r)}if(u=(l&t.childLanes)!==0,_n||u){if(r=Dt,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ai(t,i),mr(r,t,i,-1))}return pg(),r=Dh(Error(ae(421))),Oc(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=cw.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,An=zi(i.nextSibling),In=e,ct=!0,fr=null,t!==null&&(Xn[Kn++]=ei,Xn[Kn++]=ti,Xn[Kn++]=Cs,ei=t.id,ti=t.overflow,Cs=e),e=lg(e,r.children),e.flags|=4096,e)}function b2(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),$0(t.return,e,n)}function zh(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Z3(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(an(t,e,r.children,n),r=ht.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&b2(t,n,e);else if(t.tag===19)b2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Je(ht,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Nu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),zh(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Nu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}zh(e,!0,n,null,s);break;case"together":zh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function li(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ts|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,n=Vi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Vi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Z8(t,e,n){switch(e.tag){case 3:K3(e),No();break;case 5:k3(e);break;case 1:Cn(e.type)&&_u(e);break;case 4:eg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Je(Cu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Je(ht,ht.current&1),e.flags|=128,null):n&e.child.childLanes?Q3(t,e,n):(Je(ht,ht.current&1),t=li(t,e,n),t!==null?t.sibling:null);Je(ht,ht.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Z3(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Je(ht,ht.current),r)break;return null;case 22:case 23:return e.lanes=0,Y3(t,e,n)}return li(t,e,n)}var q3,J0,J3,e4;q3=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};J0=function(){};J3=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ss(Dr.current);var s=null;switch(n){case"input":i=S0(t,i),r=S0(t,r),s=[];break;case"select":i=gt({},i,{value:void 0}),r=gt({},r,{value:void 0}),s=[];break;case"textarea":i=b0(t,i),r=b0(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=wu)}E0(n,r);var l;n=null;for(f in i)if(!r.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var u=i[f];for(l in u)u.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Za.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in r){var c=r[f];if(u=i!=null?i[f]:void 0,r.hasOwnProperty(f)&&c!==u&&(c!=null||u!=null))if(f==="style")if(u){for(l in u)!u.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in c)c.hasOwnProperty(l)&&u[l]!==c[l]&&(n||(n={}),n[l]=c[l])}else n||(s||(s=[]),s.push(f,n)),n=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(s=s||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Za.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&rt("scroll",t),s||u===c||(s=[])):(s=s||[]).push(f,c))}n&&(s=s||[]).push("style",n);var f=s;(e.updateQueue=f)&&(e.flags|=4)}};e4=function(t,e,n,r){n!==r&&(e.flags|=4)};function _a(t,e){if(!ct)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function en(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function q8(t,e,n){var r=e.pendingProps;switch(Yp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(e),null;case 1:return Cn(e.type)&&Su(),en(e),null;case 3:return r=e.stateNode,Mo(),it(bn),it(rn),ng(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(jc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fr!==null&&(ap(fr),fr=null))),J0(t,e),en(e),null;case 5:tg(e);var i=Ss(cl.current);if(n=e.type,t!==null&&e.stateNode!=null)J3(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ae(166));return en(e),null}if(t=Ss(Dr.current),jc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Rr]=e,r[al]=s,t=(e.mode&1)!==0,n){case"dialog":rt("cancel",r),rt("close",r);break;case"iframe":case"object":case"embed":rt("load",r);break;case"video":case"audio":for(i=0;i<ja.length;i++)rt(ja[i],r);break;case"source":rt("error",r);break;case"img":case"image":case"link":rt("error",r),rt("load",r);break;case"details":rt("toggle",r);break;case"input":Lm(r,s),rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},rt("invalid",r);break;case"textarea":jm(r,s),rt("invalid",r)}E0(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var u=s[l];l==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&Rc(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&Rc(r.textContent,u,t),i=["children",""+u]):Za.hasOwnProperty(l)&&u!=null&&l==="onScroll"&&rt("scroll",r)}switch(n){case"input":Ec(r),Rm(r,s,!0);break;case"textarea":Ec(r),Fm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=wu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Nv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[Rr]=e,t[al]=r,q3(t,e,!1,!1),e.stateNode=t;e:{switch(l=T0(n,r),n){case"dialog":rt("cancel",t),rt("close",t),i=r;break;case"iframe":case"object":case"embed":rt("load",t),i=r;break;case"video":case"audio":for(i=0;i<ja.length;i++)rt(ja[i],t);i=r;break;case"source":rt("error",t),i=r;break;case"img":case"image":case"link":rt("error",t),rt("load",t),i=r;break;case"details":rt("toggle",t),i=r;break;case"input":Lm(t,r),i=S0(t,r),rt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=gt({},r,{value:void 0}),rt("invalid",t);break;case"textarea":jm(t,r),i=b0(t,r),rt("invalid",t);break;default:i=r}E0(n,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var c=u[s];s==="style"?Av(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Pv(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&qa(t,c):typeof c=="number"&&qa(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Za.hasOwnProperty(s)?c!=null&&s==="onScroll"&&rt("scroll",t):c!=null&&Ip(t,s,c,l))}switch(n){case"input":Ec(t),Rm(t,r,!1);break;case"textarea":Ec(t),Fm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+$i(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?xo(t,!!r.multiple,s,!1):r.defaultValue!=null&&xo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=wu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return en(e),null;case 6:if(t&&e.stateNode!=null)e4(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ae(166));if(n=Ss(cl.current),Ss(Dr.current),jc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Rr]=e,(s=r.nodeValue!==n)&&(t=In,t!==null))switch(t.tag){case 3:Rc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Rc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Rr]=e,e.stateNode=r}return en(e),null;case 13:if(it(ht),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ct&&An!==null&&e.mode&1&&!(e.flags&128))v3(),No(),e.flags|=98560,s=!1;else if(s=jc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ae(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ae(317));s[Rr]=e}else No(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;en(e),s=!1}else fr!==null&&(ap(fr),fr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ht.current&1?Mt===0&&(Mt=3):pg())),e.updateQueue!==null&&(e.flags|=4),en(e),null);case 4:return Mo(),J0(t,e),t===null&&sl(e.stateNode.containerInfo),en(e),null;case 10:return Zp(e.type._context),en(e),null;case 17:return Cn(e.type)&&Su(),en(e),null;case 19:if(it(ht),s=e.memoizedState,s===null)return en(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)_a(s,!1);else{if(Mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=Nu(t),l!==null){for(e.flags|=128,_a(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Je(ht,ht.current&1|2),e.child}t=t.sibling}s.tail!==null&&_t()>Io&&(e.flags|=128,r=!0,_a(s,!1),e.lanes=4194304)}else{if(!r)if(t=Nu(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),_a(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!ct)return en(e),null}else 2*_t()-s.renderingStartTime>Io&&n!==1073741824&&(e.flags|=128,r=!0,_a(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=_t(),e.sibling=null,n=ht.current,Je(ht,r?n&1|2:n&1),e):(en(e),null);case 22:case 23:return hg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mn&1073741824&&(en(e),e.subtreeFlags&6&&(e.flags|=8192)):en(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function J8(t,e){switch(Yp(e),e.tag){case 1:return Cn(e.type)&&Su(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mo(),it(bn),it(rn),ng(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return tg(e),null;case 13:if(it(ht),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));No()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return it(ht),null;case 4:return Mo(),null;case 10:return Zp(e.type._context),null;case 22:case 23:return hg(),null;case 24:return null;default:return null}}var Dc=!1,nn=!1,ew=typeof WeakSet=="function"?WeakSet:Set,Se=null;function mo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){vt(t,e,r)}else n.current=null}function ep(t,e,n){try{n()}catch(r){vt(t,e,r)}}var C2=!1;function tw(t,e){if(O0=yu,t=s3(),$p(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,u=-1,c=-1,f=0,p=0,m=t,w=null;t:for(;;){for(var y;m!==n||i!==0&&m.nodeType!==3||(u=l+i),m!==s||r!==0&&m.nodeType!==3||(c=l+r),m.nodeType===3&&(l+=m.nodeValue.length),(y=m.firstChild)!==null;)w=m,m=y;for(;;){if(m===t)break t;if(w===n&&++f===i&&(u=l),w===s&&++p===r&&(c=l),(y=m.nextSibling)!==null)break;m=w,w=m.parentNode}m=y}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(D0={focusedElem:t,selectionRange:n},yu=!1,Se=e;Se!==null;)if(e=Se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Se=t;else for(;Se!==null;){e=Se;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var b=x.memoizedProps,_=x.memoizedState,S=e.stateNode,T=S.getSnapshotBeforeUpdate(e.elementType===e.type?b:ur(e.type,b),_);S.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var h=e.stateNode.containerInfo;h.nodeType===1?h.textContent="":h.nodeType===9&&h.documentElement&&h.removeChild(h.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(k){vt(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Se=t;break}Se=e.return}return x=C2,C2=!1,x}function Wa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&ep(e,n,s)}i=i.next}while(i!==r)}}function nd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function tp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function t4(t){var e=t.alternate;e!==null&&(t.alternate=null,t4(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rr],delete e[al],delete e[U0],delete e[O8],delete e[D8])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function n4(t){return t.tag===5||t.tag===3||t.tag===4}function E2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||n4(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function np(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=wu));else if(r!==4&&(t=t.child,t!==null))for(np(t,e,n),t=t.sibling;t!==null;)np(t,e,n),t=t.sibling}function rp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(rp(t,e,n),t=t.sibling;t!==null;)rp(t,e,n),t=t.sibling}var Gt=null,dr=!1;function Ei(t,e,n){for(n=n.child;n!==null;)r4(t,e,n),n=n.sibling}function r4(t,e,n){if(Or&&typeof Or.onCommitFiberUnmount=="function")try{Or.onCommitFiberUnmount(Xu,n)}catch{}switch(n.tag){case 5:nn||mo(n,e);case 6:var r=Gt,i=dr;Gt=null,Ei(t,e,n),Gt=r,dr=i,Gt!==null&&(dr?(t=Gt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Gt.removeChild(n.stateNode));break;case 18:Gt!==null&&(dr?(t=Gt,n=n.stateNode,t.nodeType===8?Ih(t.parentNode,n):t.nodeType===1&&Ih(t,n),nl(t)):Ih(Gt,n.stateNode));break;case 4:r=Gt,i=dr,Gt=n.stateNode.containerInfo,dr=!0,Ei(t,e,n),Gt=r,dr=i;break;case 0:case 11:case 14:case 15:if(!nn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&ep(n,e,l),i=i.next}while(i!==r)}Ei(t,e,n);break;case 1:if(!nn&&(mo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){vt(n,e,u)}Ei(t,e,n);break;case 21:Ei(t,e,n);break;case 22:n.mode&1?(nn=(r=nn)||n.memoizedState!==null,Ei(t,e,n),nn=r):Ei(t,e,n);break;default:Ei(t,e,n)}}function T2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ew),e.forEach(function(r){var i=uw.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function lr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,u=l;e:for(;u!==null;){switch(u.tag){case 5:Gt=u.stateNode,dr=!1;break e;case 3:Gt=u.stateNode.containerInfo,dr=!0;break e;case 4:Gt=u.stateNode.containerInfo,dr=!0;break e}u=u.return}if(Gt===null)throw Error(ae(160));r4(s,l,i),Gt=null,dr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(f){vt(i,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)i4(e,t),e=e.sibling}function i4(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(lr(e,t),Ar(t),r&4){try{Wa(3,t,t.return),nd(3,t)}catch(b){vt(t,t.return,b)}try{Wa(5,t,t.return)}catch(b){vt(t,t.return,b)}}break;case 1:lr(e,t),Ar(t),r&512&&n!==null&&mo(n,n.return);break;case 5:if(lr(e,t),Ar(t),r&512&&n!==null&&mo(n,n.return),t.flags&32){var i=t.stateNode;try{qa(i,"")}catch(b){vt(t,t.return,b)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&Ev(i,s),T0(u,l);var f=T0(u,s);for(l=0;l<c.length;l+=2){var p=c[l],m=c[l+1];p==="style"?Av(i,m):p==="dangerouslySetInnerHTML"?Pv(i,m):p==="children"?qa(i,m):Ip(i,p,m,f)}switch(u){case"input":_0(i,s);break;case"textarea":Tv(i,s);break;case"select":var w=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var y=s.value;y!=null?xo(i,!!s.multiple,y,!1):w!==!!s.multiple&&(s.defaultValue!=null?xo(i,!!s.multiple,s.defaultValue,!0):xo(i,!!s.multiple,s.multiple?[]:"",!1))}i[al]=s}catch(b){vt(t,t.return,b)}}break;case 6:if(lr(e,t),Ar(t),r&4){if(t.stateNode===null)throw Error(ae(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(b){vt(t,t.return,b)}}break;case 3:if(lr(e,t),Ar(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{nl(e.containerInfo)}catch(b){vt(t,t.return,b)}break;case 4:lr(e,t),Ar(t);break;case 13:lr(e,t),Ar(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(dg=_t())),r&4&&T2(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(nn=(f=nn)||p,lr(e,t),nn=f):lr(e,t),Ar(t),r&8192){if(f=t.memoizedState!==null,(t.stateNode.isHidden=f)&&!p&&t.mode&1)for(Se=t,p=t.child;p!==null;){for(m=Se=p;Se!==null;){switch(w=Se,y=w.child,w.tag){case 0:case 11:case 14:case 15:Wa(4,w,w.return);break;case 1:mo(w,w.return);var x=w.stateNode;if(typeof x.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(b){vt(r,n,b)}}break;case 5:mo(w,w.return);break;case 22:if(w.memoizedState!==null){P2(m);continue}}y!==null?(y.return=w,Se=y):P2(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,f?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=m.stateNode,c=m.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=Mv("display",l))}catch(b){vt(t,t.return,b)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(b){vt(t,t.return,b)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:lr(e,t),Ar(t),r&4&&T2(t);break;case 21:break;default:lr(e,t),Ar(t)}}function Ar(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(n4(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(qa(i,""),r.flags&=-33);var s=E2(t);rp(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,u=E2(t);np(t,u,l);break;default:throw Error(ae(161))}}catch(c){vt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function nw(t,e,n){Se=t,s4(t)}function s4(t,e,n){for(var r=(t.mode&1)!==0;Se!==null;){var i=Se,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||Dc;if(!l){var u=i.alternate,c=u!==null&&u.memoizedState!==null||nn;u=Dc;var f=nn;if(Dc=l,(nn=c)&&!f)for(Se=i;Se!==null;)l=Se,c=l.child,l.tag===22&&l.memoizedState!==null?M2(i):c!==null?(c.return=l,Se=c):M2(i);for(;s!==null;)Se=s,s4(s),s=s.sibling;Se=i,Dc=u,nn=f}N2(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Se=s):N2(t)}}function N2(t){for(;Se!==null;){var e=Se;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nn||nd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!nn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ur(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&f2(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}f2(e,l,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var p=f.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&nl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}nn||e.flags&512&&tp(e)}catch(w){vt(e,e.return,w)}}if(e===t){Se=null;break}if(n=e.sibling,n!==null){n.return=e.return,Se=n;break}Se=e.return}}function P2(t){for(;Se!==null;){var e=Se;if(e===t){Se=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Se=n;break}Se=e.return}}function M2(t){for(;Se!==null;){var e=Se;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nd(4,e)}catch(c){vt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){vt(e,i,c)}}var s=e.return;try{tp(e)}catch(c){vt(e,s,c)}break;case 5:var l=e.return;try{tp(e)}catch(c){vt(e,l,c)}}}catch(c){vt(e,e.return,c)}if(e===t){Se=null;break}var u=e.sibling;if(u!==null){u.return=e.return,Se=u;break}Se=e.return}}var rw=Math.ceil,Au=ci.ReactCurrentDispatcher,cg=ci.ReactCurrentOwner,qn=ci.ReactCurrentBatchConfig,Ge=0,Dt=null,Ct=null,Wt=0,Mn=0,yo=Ki(0),Mt=0,hl=null,Ts=0,rd=0,ug=0,$a=null,Sn=null,dg=0,Io=1/0,qr=null,Iu=!1,ip=null,Ui=null,zc=!1,ji=null,Lu=0,Ha=0,sp=null,ru=-1,iu=0;function ln(){return Ge&6?_t():ru!==-1?ru:ru=_t()}function Gi(t){return t.mode&1?Ge&2&&Wt!==0?Wt&-Wt:B8.transition!==null?(iu===0&&(iu=Vv()),iu):(t=Ye,t!==0||(t=window.event,t=t===void 0?16:Qv(t.type)),t):1}function mr(t,e,n,r){if(50<Ha)throw Ha=0,sp=null,Error(ae(185));Sl(t,n,r),(!(Ge&2)||t!==Dt)&&(t===Dt&&(!(Ge&2)&&(rd|=n),Mt===4&&Li(t,Wt)),En(t,r),n===1&&Ge===0&&!(e.mode&1)&&(Io=_t()+500,Ju&&Qi()))}function En(t,e){var n=t.callbackNode;B6(t,e);var r=mu(t,t===Dt?Wt:0);if(r===0)n!==null&&zm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&zm(n),e===1)t.tag===0?z8(A2.bind(null,t)):g3(A2.bind(null,t)),j8(function(){!(Ge&6)&&Qi()}),n=null;else{switch(Wv(r)){case 1:n=Op;break;case 4:n=Uv;break;case 16:n=gu;break;case 536870912:n=Gv;break;default:n=gu}n=h4(n,o4.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function o4(t,e){if(ru=-1,iu=0,Ge&6)throw Error(ae(327));var n=t.callbackNode;if(bo()&&t.callbackNode!==n)return null;var r=mu(t,t===Dt?Wt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ru(t,r);else{e=r;var i=Ge;Ge|=2;var s=l4();(Dt!==t||Wt!==e)&&(qr=null,Io=_t()+500,_s(t,e));do try{ow();break}catch(u){a4(t,u)}while(1);Qp(),Au.current=s,Ge=i,Ct!==null?e=0:(Dt=null,Wt=0,e=Mt)}if(e!==0){if(e===2&&(i=I0(t),i!==0&&(r=i,e=op(t,i))),e===1)throw n=hl,_s(t,0),Li(t,r),En(t,_t()),n;if(e===6)Li(t,r);else{if(i=t.current.alternate,!(r&30)&&!iw(i)&&(e=Ru(t,r),e===2&&(s=I0(t),s!==0&&(r=s,e=op(t,s))),e===1))throw n=hl,_s(t,0),Li(t,r),En(t,_t()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ae(345));case 2:ys(t,Sn,qr);break;case 3:if(Li(t,r),(r&130023424)===r&&(e=dg+500-_t(),10<e)){if(mu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){ln(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=B0(ys.bind(null,t,Sn,qr),e);break}ys(t,Sn,qr);break;case 4:if(Li(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-gr(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=_t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*rw(r/1960))-r,10<r){t.timeoutHandle=B0(ys.bind(null,t,Sn,qr),r);break}ys(t,Sn,qr);break;case 5:ys(t,Sn,qr);break;default:throw Error(ae(329))}}}return En(t,_t()),t.callbackNode===n?o4.bind(null,t):null}function op(t,e){var n=$a;return t.current.memoizedState.isDehydrated&&(_s(t,e).flags|=256),t=Ru(t,e),t!==2&&(e=Sn,Sn=n,e!==null&&ap(e)),t}function ap(t){Sn===null?Sn=t:Sn.push.apply(Sn,t)}function iw(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!vr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Li(t,e){for(e&=~ug,e&=~rd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-gr(e),r=1<<n;t[n]=-1,e&=~r}}function A2(t){if(Ge&6)throw Error(ae(327));bo();var e=mu(t,0);if(!(e&1))return En(t,_t()),null;var n=Ru(t,e);if(t.tag!==0&&n===2){var r=I0(t);r!==0&&(e=r,n=op(t,r))}if(n===1)throw n=hl,_s(t,0),Li(t,e),En(t,_t()),n;if(n===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ys(t,Sn,qr),En(t,_t()),null}function fg(t,e){var n=Ge;Ge|=1;try{return t(e)}finally{Ge=n,Ge===0&&(Io=_t()+500,Ju&&Qi())}}function Ns(t){ji!==null&&ji.tag===0&&!(Ge&6)&&bo();var e=Ge;Ge|=1;var n=qn.transition,r=Ye;try{if(qn.transition=null,Ye=1,t)return t()}finally{Ye=r,qn.transition=n,Ge=e,!(Ge&6)&&Qi()}}function hg(){Mn=yo.current,it(yo)}function _s(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,R8(n)),Ct!==null)for(n=Ct.return;n!==null;){var r=n;switch(Yp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Su();break;case 3:Mo(),it(bn),it(rn),ng();break;case 5:tg(r);break;case 4:Mo();break;case 13:it(ht);break;case 19:it(ht);break;case 10:Zp(r.type._context);break;case 22:case 23:hg()}n=n.return}if(Dt=t,Ct=t=Vi(t.current,null),Wt=Mn=e,Mt=0,hl=null,ug=rd=Ts=0,Sn=$a=null,ws!==null){for(e=0;e<ws.length;e++)if(n=ws[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}ws=null}return t}function a4(t,e){do{var n=Ct;try{if(Qp(),eu.current=Mu,Pu){for(var r=pt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Pu=!1}if(Es=0,Ot=Pt=pt=null,Va=!1,ul=0,cg.current=null,n===null||n.return===null){Mt=1,hl=e,Ct=null;break}e:{var s=t,l=n.return,u=n,c=e;if(e=Wt,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,p=u,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var w=p.alternate;w?(p.updateQueue=w.updateQueue,p.memoizedState=w.memoizedState,p.lanes=w.lanes):(p.updateQueue=null,p.memoizedState=null)}var y=v2(l);if(y!==null){y.flags&=-257,x2(y,l,u,s,e),y.mode&1&&y2(s,f,e),e=y,c=f;var x=e.updateQueue;if(x===null){var b=new Set;b.add(c),e.updateQueue=b}else x.add(c);break e}else{if(!(e&1)){y2(s,f,e),pg();break e}c=Error(ae(426))}}else if(ct&&u.mode&1){var _=v2(l);if(_!==null){!(_.flags&65536)&&(_.flags|=256),x2(_,l,u,s,e),Xp(Ao(c,u));break e}}s=c=Ao(c,u),Mt!==4&&(Mt=2),$a===null?$a=[s]:$a.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=W3(s,c,e);d2(s,S);break e;case 1:u=c;var T=s.type,h=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(Ui===null||!Ui.has(h)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=$3(s,u,e);d2(s,k);break e}}s=s.return}while(s!==null)}u4(n)}catch(E){e=E,Ct===n&&n!==null&&(Ct=n=n.return);continue}break}while(1)}function l4(){var t=Au.current;return Au.current=Mu,t===null?Mu:t}function pg(){(Mt===0||Mt===3||Mt===2)&&(Mt=4),Dt===null||!(Ts&268435455)&&!(rd&268435455)||Li(Dt,Wt)}function Ru(t,e){var n=Ge;Ge|=2;var r=l4();(Dt!==t||Wt!==e)&&(qr=null,_s(t,e));do try{sw();break}catch(i){a4(t,i)}while(1);if(Qp(),Ge=n,Au.current=r,Ct!==null)throw Error(ae(261));return Dt=null,Wt=0,Mt}function sw(){for(;Ct!==null;)c4(Ct)}function ow(){for(;Ct!==null&&!A6();)c4(Ct)}function c4(t){var e=f4(t.alternate,t,Mn);t.memoizedProps=t.pendingProps,e===null?u4(t):Ct=e,cg.current=null}function u4(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=J8(n,e),n!==null){n.flags&=32767,Ct=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Mt=6,Ct=null;return}}else if(n=q8(n,e,Mn),n!==null){Ct=n;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=t}while(e!==null);Mt===0&&(Mt=5)}function ys(t,e,n){var r=Ye,i=qn.transition;try{qn.transition=null,Ye=1,aw(t,e,n,r)}finally{qn.transition=i,Ye=r}return null}function aw(t,e,n,r){do bo();while(ji!==null);if(Ge&6)throw Error(ae(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(U6(t,s),t===Dt&&(Ct=Dt=null,Wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zc||(zc=!0,h4(gu,function(){return bo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=qn.transition,qn.transition=null;var l=Ye;Ye=1;var u=Ge;Ge|=4,cg.current=null,tw(t,n),i4(n,t),T8(D0),yu=!!O0,D0=O0=null,t.current=n,nw(n),I6(),Ge=u,Ye=l,qn.transition=s}else t.current=n;if(zc&&(zc=!1,ji=t,Lu=i),s=t.pendingLanes,s===0&&(Ui=null),j6(n.stateNode),En(t,_t()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Iu)throw Iu=!1,t=ip,ip=null,t;return Lu&1&&t.tag!==0&&bo(),s=t.pendingLanes,s&1?t===sp?Ha++:(Ha=0,sp=t):Ha=0,Qi(),null}function bo(){if(ji!==null){var t=Wv(Lu),e=qn.transition,n=Ye;try{if(qn.transition=null,Ye=16>t?16:t,ji===null)var r=!1;else{if(t=ji,ji=null,Lu=0,Ge&6)throw Error(ae(331));var i=Ge;for(Ge|=4,Se=t.current;Se!==null;){var s=Se,l=s.child;if(Se.flags&16){var u=s.deletions;if(u!==null){for(var c=0;c<u.length;c++){var f=u[c];for(Se=f;Se!==null;){var p=Se;switch(p.tag){case 0:case 11:case 15:Wa(8,p,s)}var m=p.child;if(m!==null)m.return=p,Se=m;else for(;Se!==null;){p=Se;var w=p.sibling,y=p.return;if(t4(p),p===f){Se=null;break}if(w!==null){w.return=y,Se=w;break}Se=y}}}var x=s.alternate;if(x!==null){var b=x.child;if(b!==null){x.child=null;do{var _=b.sibling;b.sibling=null,b=_}while(b!==null)}}Se=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,Se=l;else e:for(;Se!==null;){if(s=Se,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Wa(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,Se=S;break e}Se=s.return}}var T=t.current;for(Se=T;Se!==null;){l=Se;var h=l.child;if(l.subtreeFlags&2064&&h!==null)h.return=l,Se=h;else e:for(l=T;Se!==null;){if(u=Se,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:nd(9,u)}}catch(E){vt(u,u.return,E)}if(u===l){Se=null;break e}var k=u.sibling;if(k!==null){k.return=u.return,Se=k;break e}Se=u.return}}if(Ge=i,Qi(),Or&&typeof Or.onPostCommitFiberRoot=="function")try{Or.onPostCommitFiberRoot(Xu,t)}catch{}r=!0}return r}finally{Ye=n,qn.transition=e}}return!1}function I2(t,e,n){e=Ao(n,e),e=W3(t,e,1),t=Bi(t,e,1),e=ln(),t!==null&&(Sl(t,1,e),En(t,e))}function vt(t,e,n){if(t.tag===3)I2(t,t,n);else for(;e!==null;){if(e.tag===3){I2(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ui===null||!Ui.has(r))){t=Ao(n,t),t=$3(e,t,1),e=Bi(e,t,1),t=ln(),e!==null&&(Sl(e,1,t),En(e,t));break}}e=e.return}}function lw(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ln(),t.pingedLanes|=t.suspendedLanes&n,Dt===t&&(Wt&n)===n&&(Mt===4||Mt===3&&(Wt&130023424)===Wt&&500>_t()-dg?_s(t,0):ug|=n),En(t,e)}function d4(t,e){e===0&&(t.mode&1?(e=Pc,Pc<<=1,!(Pc&130023424)&&(Pc=4194304)):e=1);var n=ln();t=ai(t,e),t!==null&&(Sl(t,e,n),En(t,n))}function cw(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),d4(t,n)}function uw(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(e),d4(t,n)}var f4;f4=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||bn.current)_n=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return _n=!1,Z8(t,e,n);_n=!!(t.flags&131072)}else _n=!1,ct&&e.flags&1048576&&m3(e,bu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;nu(t,e),t=e.pendingProps;var i=To(e,rn.current);ko(e,n),i=ig(null,e,r,t,i,n);var s=sg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Cn(r)?(s=!0,_u(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Jp(e),i.updater=td,e.stateNode=i,i._reactInternals=e,Y0(e,r,t,n),e=Q0(null,e,r,!0,s,n)):(e.tag=0,ct&&s&&Hp(e),an(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(nu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=fw(r),t=ur(r,t),i){case 0:e=K0(null,e,r,t,n);break e;case 1:e=_2(null,e,r,t,n);break e;case 11:e=w2(null,e,r,t,n);break e;case 14:e=S2(null,e,r,ur(r.type,t),n);break e}throw Error(ae(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),K0(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),_2(t,e,r,i,n);case 3:e:{if(K3(e),t===null)throw Error(ae(387));r=e.pendingProps,s=e.memoizedState,i=s.element,_3(t,e),Tu(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ao(Error(ae(423)),e),e=k2(t,e,r,n,i);break e}else if(r!==i){i=Ao(Error(ae(424)),e),e=k2(t,e,r,n,i);break e}else for(An=zi(e.stateNode.containerInfo.firstChild),In=e,ct=!0,fr=null,n=w3(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(No(),r===i){e=li(t,e,n);break e}an(t,e,r,n)}e=e.child}return e;case 5:return k3(e),t===null&&W0(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,z0(r,i)?l=null:s!==null&&z0(r,s)&&(e.flags|=32),X3(t,e),an(t,e,l,n),e.child;case 6:return t===null&&W0(e),null;case 13:return Q3(t,e,n);case 4:return eg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Po(e,null,r,n):an(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),w2(t,e,r,i,n);case 7:return an(t,e,e.pendingProps,n),e.child;case 8:return an(t,e,e.pendingProps.children,n),e.child;case 12:return an(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,Je(Cu,r._currentValue),r._currentValue=l,s!==null)if(vr(s.value,l)){if(s.children===i.children&&!bn.current){e=li(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){l=s.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=ni(-1,n&-n),c.tag=2;var f=s.updateQueue;if(f!==null){f=f.shared;var p=f.pending;p===null?c.next=c:(c.next=p.next,p.next=c),f.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),$0(s.return,n,e),u.lanes|=n;break}c=c.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(ae(341));l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),$0(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}an(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ko(e,n),i=Jn(i),r=r(i),e.flags|=1,an(t,e,r,n),e.child;case 14:return r=e.type,i=ur(r,e.pendingProps),i=ur(r.type,i),S2(t,e,r,i,n);case 15:return H3(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),nu(t,e),e.tag=1,Cn(r)?(t=!0,_u(e)):t=!1,ko(e,n),V3(e,r,i),Y0(e,r,i,n),Q0(null,e,r,!0,t,n);case 19:return Z3(t,e,n);case 22:return Y3(t,e,n)}throw Error(ae(156,e.tag))};function h4(t,e){return Bv(t,e)}function dw(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(t,e,n,r){return new dw(t,e,n,r)}function gg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fw(t){if(typeof t=="function")return gg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Rp)return 11;if(t===jp)return 14}return 2}function Vi(t,e){var n=t.alternate;return n===null?(n=Zn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function su(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")gg(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case oo:return ks(n.children,i,s,e);case Lp:l=8,i|=8;break;case y0:return t=Zn(12,n,e,i|2),t.elementType=y0,t.lanes=s,t;case v0:return t=Zn(13,n,e,i),t.elementType=v0,t.lanes=s,t;case x0:return t=Zn(19,n,e,i),t.elementType=x0,t.lanes=s,t;case kv:return id(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Sv:l=10;break e;case _v:l=9;break e;case Rp:l=11;break e;case jp:l=14;break e;case Pi:l=16,r=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=Zn(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ks(t,e,n,r){return t=Zn(7,t,r,e),t.lanes=n,t}function id(t,e,n,r){return t=Zn(22,t,r,e),t.elementType=kv,t.lanes=n,t.stateNode={isHidden:!1},t}function Bh(t,e,n){return t=Zn(6,t,null,e),t.lanes=n,t}function Uh(t,e,n){return e=Zn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hw(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sh(0),this.expirationTimes=Sh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function mg(t,e,n,r,i,s,l,u,c){return t=new hw(t,e,n,u,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Zn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jp(s),t}function pw(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:so,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function p4(t){if(!t)return Hi;t=t._reactInternals;e:{if(Ms(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var n=t.type;if(Cn(n))return p3(t,n,e)}return e}function g4(t,e,n,r,i,s,l,u,c){return t=mg(n,r,!0,t,i,s,l,u,c),t.context=p4(null),n=t.current,r=ln(),i=Gi(n),s=ni(r,i),s.callback=e??null,Bi(n,s,i),t.current.lanes=i,Sl(t,i,r),En(t,r),t}function sd(t,e,n,r){var i=e.current,s=ln(),l=Gi(i);return n=p4(n),e.context===null?e.context=n:e.pendingContext=n,e=ni(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Bi(i,e,l),t!==null&&(mr(t,i,l,s),Jc(t,i,l)),l}function ju(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function L2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function yg(t,e){L2(t,e),(t=t.alternate)&&L2(t,e)}function gw(){return null}var m4=typeof reportError=="function"?reportError:function(t){console.error(t)};function vg(t){this._internalRoot=t}od.prototype.render=vg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));sd(t,e,null,null)};od.prototype.unmount=vg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ns(function(){sd(null,t,null,null)}),e[oi]=null}};function od(t){this._internalRoot=t}od.prototype.unstable_scheduleHydration=function(t){if(t){var e=Yv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ii.length&&e!==0&&e<Ii[n].priority;n++);Ii.splice(n,0,t),n===0&&Kv(t)}};function xg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ad(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function R2(){}function mw(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var f=ju(l);s.call(f)}}var l=g4(e,r,t,0,null,!1,!1,"",R2);return t._reactRootContainer=l,t[oi]=l.current,sl(t.nodeType===8?t.parentNode:t),Ns(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var f=ju(c);u.call(f)}}var c=mg(t,0,!1,null,null,!1,!1,"",R2);return t._reactRootContainer=c,t[oi]=c.current,sl(t.nodeType===8?t.parentNode:t),Ns(function(){sd(e,c,n,r)}),c}function ld(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var u=i;i=function(){var c=ju(l);u.call(c)}}sd(e,l,t,i)}else l=mw(n,e,t,i,r);return ju(l)}$v=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ra(e.pendingLanes);n!==0&&(Dp(e,n|1),En(e,_t()),!(Ge&6)&&(Io=_t()+500,Qi()))}break;case 13:Ns(function(){var r=ai(t,1);if(r!==null){var i=ln();mr(r,t,1,i)}}),yg(t,1)}};zp=function(t){if(t.tag===13){var e=ai(t,134217728);if(e!==null){var n=ln();mr(e,t,134217728,n)}yg(t,134217728)}};Hv=function(t){if(t.tag===13){var e=Gi(t),n=ai(t,e);if(n!==null){var r=ln();mr(n,t,e,r)}yg(t,e)}};Yv=function(){return Ye};Xv=function(t,e){var n=Ye;try{return Ye=t,e()}finally{Ye=n}};P0=function(t,e,n){switch(e){case"input":if(_0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=qu(r);if(!i)throw Error(ae(90));Cv(r),_0(r,i)}}}break;case"textarea":Tv(t,n);break;case"select":e=n.value,e!=null&&xo(t,!!n.multiple,e,!1)}};Rv=fg;jv=Ns;var yw={usingClientEntryPoint:!1,Events:[kl,uo,qu,Iv,Lv,fg]},ka={findFiberByHostInstance:xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vw={bundleType:ka.bundleType,version:ka.version,rendererPackageName:ka.rendererPackageName,rendererConfig:ka.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ci.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Dv(t),t===null?null:t.stateNode},findFiberByHostInstance:ka.findFiberByHostInstance||gw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bc.isDisabled&&Bc.supportsFiber)try{Xu=Bc.inject(vw),Or=Bc}catch{}}Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yw;Rn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xg(e))throw Error(ae(200));return pw(t,e,null,n)};Rn.createRoot=function(t,e){if(!xg(t))throw Error(ae(299));var n=!1,r="",i=m4;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=mg(t,1,!1,null,null,n,!1,r,i),t[oi]=e.current,sl(t.nodeType===8?t.parentNode:t),new vg(e)};Rn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=Dv(e),t=t===null?null:t.stateNode,t};Rn.flushSync=function(t){return Ns(t)};Rn.hydrate=function(t,e,n){if(!ad(e))throw Error(ae(200));return ld(null,t,e,!0,n)};Rn.hydrateRoot=function(t,e,n){if(!xg(t))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=m4;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=g4(e,null,t,1,n??null,i,!1,s,l),t[oi]=e.current,sl(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new od(e)};Rn.render=function(t,e,n){if(!ad(e))throw Error(ae(200));return ld(null,t,e,!1,n)};Rn.unmountComponentAtNode=function(t){if(!ad(t))throw Error(ae(40));return t._reactRootContainer?(Ns(function(){ld(null,null,t,!1,function(){t._reactRootContainer=null,t[oi]=null})}),!0):!1};Rn.unstable_batchedUpdates=fg;Rn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ad(n))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return ld(t,e,n,!1,r)};Rn.version="18.3.1-next-f1338f8080-20240426";function y4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(y4)}catch(t){console.error(t)}}y4(),yv.exports=Rn;var xw=yv.exports,j2=xw;g0.createRoot=j2.createRoot,g0.hydrateRoot=j2.hydrateRoot;const F2=({isLoading:t,onSave:e,onSaveAs:n,canSaveAs:r,onLoad:i,onClear:s,onExamples:l,buttonStyle:u,isMobile:c=!1})=>C.jsxs("div",{className:c?"flex flex-col gap-2":"flex flex-wrap gap-2",children:[C.jsxs("button",{className:c?"menu-button-hover":"",style:{...u(!1,c?"file":void 0),opacity:t?.5:1},onClick:e,disabled:t,title:"Save as PNML",children:[c&&C.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"})}),"Save"]}),C.jsxs("button",{className:c?"menu-button-hover":"",style:{...u(!1,c?"file":void 0),opacity:t?.5:1},onClick:n,disabled:t,title:"Save As (choose location and filename)",children:[c&&C.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})}),"Save as"]}),C.jsxs("button",{className:c?"menu-button-hover":"",style:{...u(!1,c?"file":void 0),opacity:t?.5:1},onClick:i,disabled:t,title:"Load PNML file",children:[c&&C.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Load"]}),C.jsxs("button",{className:c?"menu-button-hover":"",style:{...u(!1,c?"file":void 0),opacity:t?.5:1},onClick:l,disabled:t,title:"Load example Petri net",children:[c&&C.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Examples"]}),C.jsxs("button",{className:c?"menu-button-hover":"",style:{...u(!1,c?"file":void 0)},onClick:s,title:"Clear canvas",children:[c&&C.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear"]})]}),ww=({mode:t,setMode:e,buttonStyle:n})=>C.jsxs("div",{className:"flex flex-wrap gap-2",children:[C.jsx("button",{style:{...n(t==="select")},"data-testid":"toolbar-select",onClick:()=>{t!=="select"&&e("select")},children:"Select"}),C.jsx("button",{style:n(t==="place"),"data-testid":"toolbar-place",onClick:()=>{t!=="place"&&e("place")},children:"Place"}),C.jsx("button",{style:n(t==="transition"),"data-testid":"toolbar-transition",onClick:()=>{t!=="transition"&&e("transition")},children:"Transition"}),C.jsx("button",{style:n(t==="arc"),"data-testid":"toolbar-arc",onClick:()=>{t!=="arc"&&e("arc")},children:"Arc"})]}),Sw=({canUndo:t,canRedo:e,onUndo:n,onRedo:r,buttonStyle:i})=>C.jsxs("div",{className:"flex flex-wrap gap-2",children:[C.jsx("button",{style:{...i(!1),opacity:t?1:.5},onClick:n,disabled:!t,title:"Undo (Ctrl+Z)",children:"Undo"}),C.jsx("button",{style:{...i(!1),opacity:e?1:.5},onClick:r,disabled:!e,title:"Redo (Ctrl+Y)",children:"Redo"})]}),O2=({onOpenSettings:t,buttonStyle:e,isMobile:n=!1})=>C.jsx("div",{className:"flex flex-wrap gap-2",children:C.jsxs("button",{className:n?"menu-button-hover":"",style:e(!1,n?"settings":void 0),onClick:t,title:"Simulation Settings","data-testid":"toolbar-settings",children:[n&&C.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Settings"]})});function Gh(t){const e={types:[]};try{const r=new DOMParser().parseFromString(t,"application/xml"),i=r.getElementsByTagName("parsererror")[0];if(i)throw new Error(i.textContent||"Invalid XML");const l=Array.from(r.getElementsByTagName("*")).filter(f=>f.localName==="algebraicDataTypes")[0];if(!l)return e;const c=Array.from(l.childNodes).filter(f=>f.nodeType===1).filter(f=>f.localName==="type");for(const f of c){const p=f.getAttribute("name")||"",w=Array.from(f.childNodes).filter(_=>_.nodeType===1&&_.localName==="operation").map(_=>{const T=Array.from(_.childNodes).filter(h=>h.nodeType===1&&h.localName==="param").map(h=>({index:Number(h.getAttribute("index")||"0"),type:h.getAttribute("type")||""}));return{name:_.getAttribute("name")||"",arity:Number(_.getAttribute("arity")||"0"),result:_.getAttribute("result")||"",params:T}}),y=Array.from(f.childNodes).find(_=>_.nodeType===1&&_.localName==="axioms"),b=(y?Array.from(y.childNodes).filter(_=>_.nodeType===1&&_.localName==="axiom"):[]).map(_=>({name:_.getAttribute("name")||"",equation:(_.textContent||"").trim()}));e.types.push({name:p,operations:w,axioms:b})}return e}catch(n){return console.error("Error parsing ADT XML:",n),e}}function _w(t){const e=[],n=new Set;for(const r of t.types||[]){r.name||e.push("Type missing name"),n.has(r.name)&&e.push(`Duplicate type: ${r.name}`),n.add(r.name);for(const i of r.operations||[])i.name||e.push(`Operation missing name in type ${r.name}`),(!Number.isInteger(i.arity)||i.arity<0)&&e.push(`Invalid arity for ${r.name}.${i.name}`),i.result||e.push(`Operation ${r.name}.${i.name} missing result type`);for(const i of r.axioms||[])(!i.equation||!i.equation.includes("="))&&e.push(`Axiom in ${r.name} must be an equation with '='`)}return{valid:e.length===0,errors:e}}const kw=`<?xml version="1.0"?>
<algebraicDataTypes xmlns="http://example.org/apn-adt">
  <type name="Int">
    <operation name="+" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="-" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="*" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&lt;" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&lt;=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&gt;" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&gt;=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <axioms>
      <axiom name="commutativity">x + y = y + x</axiom>
      <axiom name="associativity">(x + y) + z = x + (y + z)</axiom>
      <axiom name="multiplication_commutativity">x * y = y * x</axiom>
      <axiom name="multiplication_associativity">(x * y) * z = x * (y * z)</axiom>
      <axiom name="distributivity">x * (y + z) = (x * y) + (x * z)</axiom>
    </axioms>
  </type>
  <type name="Bool">
    <operation name="and" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="or" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="not" arity="1" result="Bool">
      <param index="0" type="Bool"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <axioms>
      <axiom name="and_commutativity">x and y = y and x</axiom>
      <axiom name="and_associativity">(x and y) and z = x and (y and z)</axiom>
      <axiom name="or_commutativity">x or y = y or x</axiom>
      <axiom name="or_associativity">(x or y) or z = x or (y or z)</axiom>
      <axiom name="de_morgan_and">not (x and y) = (not x) or (not y)</axiom>
      <axiom name="de_morgan_or">not (x or y) = (not x) and (not y)</axiom>
      <axiom name="double_negation">not (not x) = x</axiom>
    </axioms>
  </type>
  <type name="Pair">
    <operation name="fst" arity="1" result="Any">
      <param index="0" type="Pair"/>
    </operation>
    <operation name="snd" arity="1" result="Any">
      <param index="0" type="Pair"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Pair"/>
      <param index="1" type="Pair"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Pair"/>
      <param index="1" type="Pair"/>
    </operation>
    <axioms>
      <axiom name="pair_equality">(x, y) == (a, b) = (x == a) and (y == b)</axiom>
      <axiom name="fst_projection">fst((x, y)) = x</axiom>
      <axiom name="snd_projection">snd((x, y)) = y</axiom>
    </axioms>
  </type>
  <type name="String">
    <operation name="concat" arity="2" result="String">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="substring" arity="3" result="String">
      <param index="0" type="String"/>
      <param index="1" type="Int"/>
      <param index="2" type="Int"/>
    </operation>
    <operation name="isSubstringOf" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="length" arity="1" result="Int">
      <param index="0" type="String"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <axioms>
      <axiom name="concat_associativity">concat(concat(x, y), z) = concat(x, concat(y, z))</axiom>
      <axiom name="concat_empty_left">concat('', x) = x</axiom>
      <axiom name="concat_empty_right">concat(x, '') = x</axiom>
      <axiom name="substring_bounds">substring(x, 0, length(x)) = x</axiom>
      <axiom name="length_concat">length(concat(x, y)) = length(x) + length(y)</axiom>
    </axioms>
  </type>
  <type name="List">
    <operation name="length" arity="1" result="Int">
      <param index="0" type="List"/>
    </operation>
    <operation name="concat" arity="2" result="List">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="head" arity="1" result="Any">
      <param index="0" type="List"/>
    </operation>
    <operation name="tail" arity="1" result="List">
      <param index="0" type="List"/>
    </operation>
    <operation name="append" arity="2" result="List">
      <param index="0" type="List"/>
      <param index="1" type="Any"/>
    </operation>
    <operation name="sublist" arity="3" result="List">
      <param index="0" type="List"/>
      <param index="1" type="Int"/>
      <param index="2" type="Int"/>
    </operation>
    <operation name="isSublistOf" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <axioms>
      <axiom name="length_empty">length([]) = 0</axiom>
      <axiom name="concat_empty_left">concat([], x) = x</axiom>
      <axiom name="concat_empty_right">concat(x, []) = x</axiom>
      <axiom name="head_cons">head([h | t]) = h</axiom>
      <axiom name="tail_cons">tail([h | t]) = t</axiom>
      <axiom name="length_concat">length(concat(x, y)) = length(x) + length(y)</axiom>
    </axioms>
  </type>
</algebraicDataTypes>`,v4=O.createContext(null);function bw({children:t}){const e=O.useMemo(()=>Gh(kw),[]),[n,r]=O.useState([]),i=O.useMemo(()=>{const p=new Map;for(const m of e.types||[])p.set(m.name,{...m,__readonly:!0});for(const m of n){const w=Gh(m);for(const y of w.types||[])p.has(y.name)||p.set(y.name,{...y,__readonly:!1})}return p},[e,n]),s=O.useCallback(()=>Array.from(i.keys()),[i]),l=O.useCallback(p=>i.get(p)||null,[i]),u=O.useCallback(p=>{const m=Gh(p),w=_w(m);if(!w.valid)return{ok:!1,errors:w.errors};for(const y of m.types||[])if(i.has(y.name))return{ok:!1,errors:[`Duplicate type: ${y.name}`]};return r(y=>[...y,p]),{ok:!0}},[i]),c=O.useCallback(()=>n.join(`
`),[n]),f=O.useMemo(()=>({listTypes:s,getType:l,registerCustomADTXml:u,exportCustomADTXml:c,baseReadOnly:!0,addOrReplaceCustomADT:p=>u(p),clearCustomADTs:()=>r([])}),[s,l,u,c]);return C.jsx(v4.Provider,{value:f,children:t})}function Cw(){const t=O.useContext(v4);if(!t)throw new Error("useAdtRegistry must be used within AdtProvider");return t}function Vt(t){if(typeof t!="string")throw new Error("Expression must be a string");const e=t.trim();let n=0;function r(_){return _>="0"&&_<="9"}function i(){for(;n<e.length&&/\s/.test(e[n]);)n++}function s(){i();let _=n;for(;n<e.length&&r(e[n]);)n++;if(_===n)throw new Error(`Expected int at position ${n}`);const S=e.slice(_,n);return{type:"int",value:parseInt(S,10)}}function l(_){return/[A-Za-z_]/.test(_)}function u(_){return/[A-Za-z0-9_]/.test(_)}function c(){if(i(),e[n]!=="'")throw new Error(`Expected string literal at position ${n}`);n++;let _="";for(;n<e.length&&e[n]!=="'";){if(e[n]==="\\"&&n+1<e.length){n++;const S=e[n];S==="n"?_+=`
`:S==="t"?_+="	":S==="r"?_+="\r":S==="\\"?_+="\\":S==="'"?_+="'":_+=S}else _+=e[n];n++}if(n>=e.length)throw new Error("Unterminated string literal");return n++,{type:"string",value:_}}function f(){i();let _=n;if(!l(e[n]))throw new Error(`Expected identifier at position ${n}`);for(n++;n<e.length&&u(e[n]);)n++;const S=e.slice(_,n);if(S&&/^[A-Z]/.test(S))throw new Error(`Variable names must start with lowercase letter, got '${S}' (use 't' instead of 'T', 'f' instead of 'F')`);if(i(),e[n]==="("){n++;const h=[];if(i(),e[n]!==")")do if(i(),h.push(y()),i(),e[n]===",")n++;else break;while(n<e.length);if(i(),e[n]!==")")throw new Error(`Expected ')' after function arguments at position ${n}`);return n++,{type:"funcall",name:S,args:h}}const T=n;if(i(),e[n]===":"){n++,i();const h=n;for(;n<e.length&&/[A-Za-z]/.test(e[n]);)n++;const k=e.slice(h,n).toLowerCase();return k==="int"||k==="bool"||k==="pair"||k==="string"||k==="list"?{type:"var",name:S,varType:k}:(n=T,{type:"var",name:S})}return{type:"var",name:S}}function p(){if(i(),e[n]!=="[")throw new Error(`Expected '[' at position ${n}`);n++;const _=[];if(i(),e[n]==="]")return n++,{type:"list",elements:[]};for(;n<e.length;){if(i(),_.push(y()),i(),e[n]==="]")return n++,{type:"list",elements:_};if(e[n]===","){n++;continue}throw new Error(`Expected ',' or ']' at position ${n}`)}throw new Error("Unterminated list literal")}function m(){if(i(),n>=e.length)throw new Error(`Unexpected end of input at position ${n}`);if(e[n]==="("){n++,i();const _=y();if(i(),e[n]===","){n++;const S=y();if(i(),n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,{type:"pair",fst:_,snd:S}}if(n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,_}if(e[n]==="[")return p();if(e[n]==="'")return c();if(r(e[n]))return s();if(/[A-Za-z_]/.test(e[n]))return f();throw new Error(`Unexpected character '${e[n]}' at position ${n}`)}function w(){let _=m();for(i();n<e.length&&(e[n]==="*"||e[n]==="/");){const S=e[n++],T=m();_={type:"binop",op:S,left:_,right:T},i()}return _}function y(){let _=w();for(i();n<e.length&&(e[n]==="+"||e[n]==="-");){const S=e[n++],T=w();_={type:"binop",op:S,left:_,right:T},i()}return _}let x=y();if(i(),n<e.length)throw new Error(`Unexpected character '${e[n]}' at position ${n}`);function b(_){return!_||typeof _!="object"||(_.type==="bin"&&(_.type="binop"),_.left&&(_.left=b(_.left)),_.right&&(_.right=b(_.right)),Array.isArray(_.args)&&(_.args=_.args.map(b)),Array.isArray(_.elements)&&(_.elements=_.elements.map(b))),_}return x=b(x),x}function x4(t){if(typeof t!="string")throw new Error("Pattern must be a string");const e=t.trim();let n=0;function r(){for(;n<e.length&&/\s/.test(e[n]);)n++}function i(){if(r(),n>=e.length)throw new Error(`Unexpected end of input at position ${n}`);if(e.slice(n,n+1)==="T")return n++,{type:"boolLit",value:!0};if(e.slice(n,n+1)==="F")return n++,{type:"boolLit",value:!1};if(e.slice(n,n+4)==="true")return n+=4,{type:"boolLit",value:!0};if(e.slice(n,n+5)==="false")return n+=5,{type:"boolLit",value:!1};if(/[0-9]/.test(e[n])){let l=n;for(;n<e.length&&/[0-9]/.test(e[n]);)n++;return{type:"int",value:parseInt(e.slice(l,n),10)}}if(e[n]==="["){n++,r();const l=[];for(;n<e.length&&e[n]!=="]";)l.push(i()),r(),e[n]===","&&(n++,r());if(n>=e.length||e[n]!=="]")throw new Error(`Expected ']' at position ${n}`);return n++,{type:"listPattern",elements:l}}if(/[a-zA-Z_]/.test(e[n])){let l=n;for(;n<e.length&&/[a-zA-Z0-9_]/.test(e[n]);)n++;const u=e.slice(l,n);if(r(),e[n]===":"){n++,r();let c=n;for(;n<e.length&&/[a-zA-Z]/.test(e[n]);)n++;const f=e.slice(c,n).toLowerCase();if(f==="int"||f==="bool"||f==="pair"||f==="string"||f==="list")return{type:"var",name:u,varType:f};throw new Error(`Unknown type '${f}' at position ${c}`)}return{type:"var",name:u}}if(e[n]==="("){n++,r();const l=[];for(;n<e.length&&e[n]!==")";)l.push(i()),r(),n<e.length&&e[n]===","&&(n++,r());if(n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,l.length===2?{type:"pairPattern",fst:l[0],snd:l[1]}:{type:"tuplePattern",elements:l}}throw new Error(`Unexpected character '${e[n]}' at position ${n}`)}const s=i();if(r(),n<e.length)throw new Error(`Unexpected character '${e[n]}' at position ${n}`);return s}function D2(t,e){const n=new Map;function r(s,l){switch(s.type){case"int":return!(typeof l!="number"||l!==s.value);case"boolLit":return!(typeof l!="boolean"||l!==s.value);case"var":if(s.varType){const u=s.varType;if(u==="int"&&typeof l!="number"||u==="bool"&&typeof l!="boolean"||u==="string"&&typeof l!="string"||u==="list"&&!Array.isArray(l)||u==="pair"&&(!l||typeof l!="object"||!l.__pair__))return!1}if(n.has(s.name)){if(n.get(s.name)!==l)return!1}else n.set(s.name,l);return!0;case"pairPattern":return!(!l||typeof l!="object"||!l.__pair__||!r(s.fst,l.fst)||!r(s.snd,l.snd));case"tuplePattern":if(!Array.isArray(l)||l.length!==s.elements.length)return!1;for(let u=0;u<s.elements.length;u++)if(!r(s.elements[u],l[u]))return!1;return!0;case"listPattern":if(!Array.isArray(l)||l.length!==s.elements.length)return!1;for(let u=0;u<s.elements.length;u++)if(!r(s.elements[u],l[u]))return!1;return!0;default:return!1}}return r(t,e)?Object.fromEntries(n):null}function z2(t,e=20){if(!t)return[];if(Array.isArray(t.valueTokens))return t.valueTokens.slice(0,e);const n=Number(t.tokens||0);return Number.isFinite(n)&&n>0?Array.from({length:Math.min(n,e)},()=>1):[]}function w4(t){return t.replace(/:int\b/g,":Int").replace(/:bool\b/g,":Bool").replace(/:pair\b/g,":Pair").replace(/:string\b/g,":String").replace(/:list\b/g,":List")}function pl(t){return typeof t=="number"?"Int":typeof t=="boolean"?"Bool":typeof t=="string"?"String":Array.isArray(t)?"List":t&&typeof t=="object"&&t.__pair__?"Pair":"Int"}function ou(t,e,n=null,r={}){if(!t||(!e||e.size===0)&&!n)return t;let i=t;const{overwrite:s=!1}=r||{},l=t.match(/\b[a-z][a-zA-Z0-9_]*\b/g);return l&&l.forEach(u=>{if(u!=="true"&&u!=="false"&&u!=="and"&&u!=="or"&&u!=="not"){const c=e.get(u)||n;if(!c)return;if(s){const f=new RegExp(`\\b${u}(?::[A-Za-z]+)?\\b`,"g");i=i.replace(f,`${u}:${c}`)}else if(!t.includes(`${u}:`)){const f=new RegExp(`\\b${u}(?!:)\\b`,"g");i=i.replace(f,`${u}:${c}`)}}}),i}const Ew="modulepreload",Tw=function(t,e){return new URL(t,e).href},B2={},ri=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Tw(s,r),s in B2)return;B2[s]=!0;const l=s.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(!!r)for(let p=i.length-1;p>=0;p--){const m=i[p];if(m.href===s&&(!l||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${u}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":Ew,l||(f.as="script",f.crossOrigin=""),f.href=s,document.head.appendChild(f),l)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})},lp={silent:0,error:1,warn:2,info:3,debug:4},Nw=(()=>{var r,i,s;const t=typeof globalThis<"u"?globalThis.__PETRI_NET_LOG_LEVEL__:void 0,e=typeof process<"u"?((r=process.env)==null?void 0:r.VITE_LOG_LEVEL)||((i=process.env)==null?void 0:i.LOG_LEVEL):void 0,n=typeof process<"u"&&((s=process.env)==null?void 0:s.NODE_ENV)==="production"?"warn":"debug";return(t||e||n||"warn").toLowerCase()})();function S4(t){if(!t)return"warn";const e=String(t).toLowerCase();return lp[e]!==void 0?e:"warn"}let Pw=S4(Nw);function Uc(t){const e=S4(t);return lp[e]<=lp[Pw]}const _e={debug:(...t)=>{Uc("debug")&&console.debug(...t)},info:(...t)=>{Uc("info")&&console.info(...t)},warn:(...t)=>{Uc("warn")&&console.warn(...t)},error:(...t)=>{Uc("error")&&console.error(...t)}};let Vh=null;async function Mw(){if(typeof process<"u"&&process.env&&{}.JEST_WORKER_ID){_e.debug("Jest worker detected, skipping Z3 asset fetch");return}if(typeof document>"u"){if(typeof globalThis.initZ3=="function")return;const e=globalThis.Module;try{const r=(()=>{try{const{origin:y,pathname:x}=self.location||{};if(!y)return"";if(typeof x=="string"){const b=x.indexOf("/assets/");if(b!==-1)return`${y}${x.slice(0,b+1)}`;const _=x.lastIndexOf("/"),S=_>=0?x.slice(0,_+1):"/";return`${y}${S}`}return`${y}/`}catch{return""}})(),i=y=>{const x=y.startsWith("/")?y.slice(1):y;return r?`${r}${x}`:`/${x}`},s=i("z3-built.wasm.base64");_e.debug("[Z3 worker] fetching WASM base64 from",s);const l=await fetch(s);if(!l.ok)throw new Error(`Failed to fetch WASM base64 from ${s}: ${l.status}`);const c=`data:application/wasm;base64,${await l.text()}`,f={...typeof e=="object"?e:{},locateFile:y=>{if(y.endsWith(".wasm"))return _e.debug("[Z3 worker] locateFile",y,"->",`${c.substring(0,50)}...`),c;const x=i(y);return _e.debug("[Z3 worker] locateFile",y,"->",x),x}};globalThis.Module=f;const p=i("z3-built.js"),m=await fetch(p);if(!m.ok)throw new Error(`Failed to fetch z3-built.js from ${p}: ${m.status}`);const w=await m.text();if((0,eval)(w),await new Promise(y=>setTimeout(y,20)),typeof globalThis.initZ3!="function")throw new Error("initZ3 not defined after eval");return}catch(n){throw new Error(`Failed to load Z3 in worker: ${n.message}`)}finally{typeof e=="object"?globalThis.Module=e:delete globalThis.Module}}typeof globalThis.initZ3!="function"&&(_e.debug("initZ3 not found, loading Z3 built assets..."),await new Promise((e,n)=>{const r=document.createElement("script");r.src="/z3-built.js",r.async=!0,r.addEventListener("load",()=>{typeof globalThis.initZ3=="function"?(_e.debug("Z3 built assets loaded successfully"),e()):n(new Error("initZ3 function not found after loading z3-built.js"))}),r.addEventListener("error",i=>{n(new Error(`Failed to load z3-built.js: ${(i==null?void 0:i.message)||i}`))}),document.head.appendChild(r)}))}async function Aw(){return Vh||(Vh=(async()=>{try{_e.debug("Initializing Z3 context..."),await Mw();const{init:t}=await ri(()=>import("./browser-f32ab165.js").then(r=>r.b),[],import.meta.url);if(!t)throw new Error("Z3 init function not found. Z3-solver package may not be properly installed.");_e.debug("Calling Z3 init...");const e=await t();if(!e)throw new Error("Z3 initialization failed. Check browser console for WASM loading errors.");_e.debug("Creating Z3 context...");const n=new e.Context("main");if(!n)throw new Error("Failed to create Z3 context.");return _e.debug("Z3 context initialized successfully"),{z3:e,ctx:n}}catch(t){_e.error("Z3 initialization error:",t);const e=typeof process<"u"&&process.env&&{}.JEST_WORKER_ID;if(typeof document<"u"&&!e){_e.debug("Retrying Z3 initialization with asset loading...");try{typeof globalThis.initZ3!="function"&&(_e.debug("initZ3 not found, loading Z3 built assets..."),await new Promise((s,l)=>{const u=document.createElement("script");u.src="/z3-built.js",u.async=!0,u.addEventListener("load",()=>{typeof globalThis.initZ3=="function"?(_e.debug("Z3 built assets loaded successfully"),s()):l(new Error("initZ3 function not found after loading z3-built.js"))}),u.addEventListener("error",c=>{l(new Error(`Failed to load z3-built.js: ${(c==null?void 0:c.message)||c}`))}),document.head.appendChild(u)}));const{init:n}=await ri(()=>import("./browser-f32ab165.js").then(s=>s.b),[],import.meta.url),r=await n(),i=new r.Context("main");return _e.debug("Z3 context initialized successfully (fallback)"),{z3:r,ctx:i}}catch(n){_e.error("Fallback Z3 initialization also failed:",n)}}if(e||typeof document>"u"){_e.debug("Retrying Z3 initialization for Node.js...");try{const{init:n}=await ri(()=>import("./browser-f32ab165.js").then(s=>s.b),[],import.meta.url),r=await n(),i=new r.Context("main");return _e.debug("Z3 context initialized successfully (Node.js)"),{z3:r,ctx:i}}catch(n){_e.error("Node.js Z3 initialization also failed:",n)}}throw new Error(`initZ3 was not imported correctly. Please consult documentation on how to load Z3 in browser. Details: ${t.message}`)}})()),Vh}function ba(t,e=new Set){return t&&(t.type==="var"&&e.add(t.name),t.type==="pair"&&(ba(t.fst,e),ba(t.snd,e)),t.type==="binop"&&(ba(t.left,e),ba(t.right,e)),t.type==="funcall"&&t.args&&t.args.forEach(n=>ba(n,e))),e}function Yn(t,e,n){var s;const{Int:r,String:i}=t;switch(e.type){case"int":return r.val(e.value);case"string":return i.val(e.value);case"pair":const l=Yn(t,e.fst,n),u=Yn(t,e.snd,n);return l.concat(i.val(",")).concat(u);case"var":return n(e.name);case"funcall":{if(e.name==="length"&&e.args&&e.args.length===1&&((s=e.args[0])==null?void 0:s.type)==="string")return r.val((e.args[0].value||"").length);if(e.name==="concat"&&e.args&&e.args.length===2){const c=Yn(t,e.args[0],n),f=Yn(t,e.args[1],n);return c.concat(f)}if(e.name==="substring"&&e.args&&e.args.length===3){const c=Yn(t,e.args[0],n),f=Yn(t,e.args[1],n),p=Yn(t,e.args[2],n);return c.substr(f,p)}if(e.name==="length"&&e.args&&e.args.length===1)return Yn(t,e.args[0],n).length();throw new Error(`Unknown function '${e.name}'`)}case"binop":{const c=Yn(t,e.left,n),f=Yn(t,e.right,n);switch(e.op){case"+":return c.add(f);case"-":return c.sub(f);case"*":return c.mul(f);case"/":return c.div(f);default:throw new Error(`Unknown operator '${e.op}'`)}}default:throw new Error(`Unknown AST node '${e.type}'`)}}function pr(t,e){function n(r){if(r.type==="int")return r.value|0;if(r.type==="string")return r.value;if(r.type==="list")return(r.elements||[]).map(n);if(r.type==="pair")return{__pair__:!0,fst:n(r.fst),snd:n(r.snd)};if(r.type==="var"){const i=e==null?void 0:e[r.name];if(i===void 0)throw new Error(`Unbound variable '${r.name}'`);return i}if(r.type==="funcall"){if(r.name==="concat"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(typeof i=="string"&&typeof s=="string")return i+s;if(Array.isArray(i)&&Array.isArray(s))return[...i,...s];throw new Error("concat requires two strings or two lists")}if(r.name==="substring"&&r.args&&r.args.length===3){const i=n(r.args[0]),s=n(r.args[1]),l=n(r.args[2]);if(typeof i!="string"||typeof s!="number"||typeof l!="number")throw new Error("substring requires string, int, int");return i.substr(s,l)}if(r.name==="length"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Error("length requires string or list")}if(r.name==="isSubstringOf"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(typeof i!="string"||typeof s!="string")throw new Error("isSubstringOf requires two strings");return s.includes(i)}if(r.name==="head"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!Array.isArray(i)||i.length===0)throw new Error("head requires non-empty list");return i[0]}if(r.name==="tail"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!Array.isArray(i))throw new Error("tail requires list");return i.length===0?[]:i.slice(1)}if(r.name==="append"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(!Array.isArray(i))throw new Error("append requires list");return[...i,s]}if(r.name==="sublist"&&r.args&&r.args.length===3){const i=n(r.args[0]),s=n(r.args[1]),l=n(r.args[2]);if(!Array.isArray(i)||typeof s!="number"||typeof l!="number")throw new Error("sublist requires list, int, int");return i.slice(s,s+l)}if(r.name==="isSublistOf"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(!Array.isArray(i)||!Array.isArray(s))throw new Error("isSublistOf requires two lists");const l=i.length;if(l===0)return!0;for(let u=0;u<=s.length-l;u++){let c=!0;for(let f=0;f<l;f++)if(s[u+f]!==i[f]){c=!1;break}if(c)return!0}return!1}if(r.name==="fst"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!i||typeof i!="object"||i.__pair__!==!0)throw new Error("fst requires pair");return i.fst}if(r.name==="snd"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!i||typeof i!="object"||i.__pair__!==!0)throw new Error("snd requires pair");return i.snd}throw new Error(`Unknown function '${r.name}'`)}if(r.type==="binop"){const i=n(r.left),s=n(r.right);if(typeof i!="number"||typeof s!="number")throw new Error("Arithmetic operands must be numbers");switch(r.op){case"+":return i+s|0;case"-":return i-s|0;case"*":return i*s|0;case"/":if(s===0)throw new Error("Division by zero");return Math.trunc(i/s)|0;default:throw new Error(`Unknown operator '${r.op}'`)}}throw new Error(`Unknown node type '${r.type}'`)}return n(t)}function Iw(t,e){if(typeof t!="string")throw new Error("Predicate must be a string");const n=t.trim(),r=[">=","<=","==","!=",">","<"];let i=0,s=-1,l=null;for(let m=0;m<n.length;m++){const w=n[m];if(w==="("?i++:w===")"&&(i=Math.max(0,i-1)),i!==0)continue;const y=n.slice(m,m+2);if(r.includes(y)){l=y,s=m;break}if(r.includes(w)){l=w,s=m;break}}if(!l||s<0)throw new Error("Predicate must contain a comparison operator");const u=n.slice(0,s).trim(),c=n.slice(s+l.length).trim(),f=e(u),p=e(c);return{type:"cmp",op:l,left:f,right:p}}function Lo(t,e){if(typeof t!="string")throw new Error("Boolean expression must be a string");const n=t.trim();let r=0;const i=()=>{for(;r<n.length&&/\s/.test(n[r]);)r++},s=(k,E)=>(k===0||/[^A-Za-z0-9_]/.test(n[k-1]||""))&&(k+E===n.length||/[^A-Za-z0-9_]/.test(n[k+E]||"")),l=k=>(i(),n.slice(r,r+k.length).toLowerCase()===k&&s(r,k.length)),u=()=>{i();const k=r;if(!/[A-Za-z_]/.test(n[r]||""))throw new Error(`Expected identifier at position ${r}`);for(r++;r<n.length&&/[A-Za-z0-9_]/.test(n[r]);)r++;const E=n.slice(k,r);if(E&&/^[A-Z]/.test(E))throw new Error(`Variable names must start with lowercase letter, got '${E}'`);const N=r;if(i(),n[r]===":"){r++,i();const I=r;for(;r<n.length&&/[A-Za-z]/.test(n[r]);)r++;const M=n.slice(I,r).toLowerCase();return M==="int"||M==="bool"||M==="pair"?{name:E,varType:M}:(r=N,{name:E})}return{name:E}},c=k=>{const E=String(k||"").trim();if(/^true$/i.test(E)||E==="T")return{type:"boolLit",value:!0};if(/^false$/i.test(E)||E==="F")return{type:"boolLit",value:!1};if(/^-?\d+$/.test(E))return{type:"int",value:parseInt(E,10)};if(E.startsWith("(")&&E.endsWith(")")){const L=E.slice(1,-1).trim();let A=0,F=-1;for(let D=0;D<L.length;D++){const U=L[D];if(U==="(")A++;else if(U===")")A=Math.max(0,A-1);else if(U===","&&A===0){F=D;break}}if(F>=0){const D=L.slice(0,F).trim(),U=L.slice(F+1).trim();if(D.length&&U.length)return{type:"pairLit",fst:c(D),snd:c(U)}}}try{if(typeof e=="function")return e(E)}catch{}const N=E.match(/^([A-Za-z_][A-Za-z0-9_]*)(?::([A-Za-z]+))?$/);if(!N)throw new Error(`Unrecognized term '${E}'`);const I=N[1];if(I&&/^[A-Z]/.test(I))throw new Error(`Variable names must start with lowercase letter, got '${I}'`);const M=(N[2]||"").toLowerCase();return M==="bool"?{type:"boolVar",name:I,varType:"bool"}:M==="pair"?{type:"pairVar",name:I,varType:"pair"}:{type:"var",name:I}},f=()=>{if(i(),r>=n.length)throw new Error("Unexpected end");if(n[r]==="T"&&s(r,1))return r+=1,{type:"boolLit",value:!0};if(n[r]==="F"&&s(r,1))return r+=1,{type:"boolLit",value:!1};if(l("true"))return r+=4,{type:"boolLit",value:!0};if(l("false"))return r+=5,{type:"boolLit",value:!1};if(n.slice(r).startsWith("isSubstringOf")){if(r+=13,i(),n[r]!=="(")throw new Error("Expected '('");let A=r+1,F=1;for(r++;r<n.length&&F>0;r++){const j=n[r];j==="("?F++:j===")"&&F--}if(F!==0)throw new Error("Unterminated isSubstringOf arguments");const D=n.slice(A,r-1).trim();let U=0,W="";const G=[];for(let j=0;j<D.length;j++){const $=D[j];if($==="("){U++,W+=$;continue}if($===")"){U=Math.max(0,U-1),W+=$;continue}if($===","&&U===0){G.push(W.trim()),W="";continue}W+=$}if(W.trim().length&&G.push(W.trim()),G.length!==2)throw new Error("isSubstringOf expects two arguments");const z=e(G[0]),B=e(G[1]);return{type:"boolFuncall",name:"isSubstringOf",args:[z,B]}}const k=[">=","<=","==","!=",">","<"];let E=0,N=-1,I=null;for(let A=r;A<n.length;A++){const F=n[A];if(F==="("?E++:F===")"&&(E=Math.max(0,E-1)),E!==0)continue;if(n.slice(A,A+3)==="<->"){A+=2;continue}if(n.slice(A,A+2)==="->"){A+=1;continue}const D=n.slice(A,A+2);if(k.includes(D)){I=D,N=A;break}if(k.includes(F)){I=F,N=A;break}}if(I&&N>=0){const A=n.slice(r,N).trim(),F=N+I.length;let D=n.length;E=0;const U=(j,$)=>(j===0||/[^A-Za-z0-9_]/.test(n[j-1]||""))&&(j+$===n.length||/[^A-Za-z0-9_]/.test(n[j+$]||"")),W=j=>{const $=n.slice(j),X=["&&","||","^","->","<->"],ee=["and","or","xor","implies","iff"];for(const ne of X)if($.startsWith(ne))return!0;for(const ne of ee)if($.toLowerCase().startsWith(ne)&&U(j,ne.length))return!0;return!1};for(let j=F;j<n.length;j++){const $=n[j];if($==="("){E++;continue}if($===")"){if(E===0){D=j;break}E=Math.max(0,E-1);continue}if(E===0&&W(j)){D=j;break}}const G=n.slice(F,D).trim(),z=c(A),B=c(G);return r=D,{type:"cmp",op:I,left:z,right:B}}if(n[r]==="("){r++;const A=T();if(i(),n[r]!==")")throw new Error(`Expected ')' at ${r}`);return r++,A}const{name:M,varType:L}=u();return L?{type:"boolVar",name:M,varType:L}:{type:"boolVar",name:M}},p={not:["not"],and:["and"],xor:["xor"],or:["or"],implies:["implies"],iff:["iff"]},m={not:["!"],and:["&&"],xor:["^"],or:["||"],implies:["->"],iff:["<->"]},w=(k,E)=>{i();for(const N of k)if(n.slice(r,r+N.length)===N)return r+=N.length,!0;for(const N of E)if(n.slice(r,r+N.length).toLowerCase()===N&&s(r,N.length))return r+=N.length,!0;return!1},y=()=>(i(),w(m.not,p.not)?{type:"not",expr:y()}:f()),x=()=>{let k=y();for(;i(),w(m.and,p.and);){const E=y();k={type:"and",left:k,right:E}}return k},b=()=>{let k=x();for(;i(),w(m.xor,p.xor);){const E=x();k={type:"xor",left:k,right:E}}return k},_=()=>{let k=b();for(;i(),w(m.or,p.or);){const E=b();k={type:"or",left:k,right:E}}return k},S=()=>{let k=_();for(;i(),w(m.implies,p.implies);){const E=_();k={type:"implies",left:k,right:E}}return k},T=()=>{let k=S();for(;i(),w(m.iff,p.iff);){const E=S();k={type:"iff",left:k,right:E}}return k},h=T();if(i(),r!==n.length)throw new Error(`Unexpected token '${n[r]}' at position ${r}`);return h}function Co(t,e,n){const r=l=>{if(typeof l=="boolean")return l;if(typeof l=="number")return l!==0;if(l&&typeof l=="object"&&l.__pair__)return!0;throw new Error("Non-bool binding in bool expression")},i=l=>{if(!l)throw new Error("Invalid term");if(l.type==="int"||l.type==="bin"||l.type==="var"){try{return pr(l,e)}catch{}if(l.type==="var"&&typeof(e==null?void 0:e[l.name])<"u")return e[l.name]}return l.type==="boolLit"?!!l.value:l.type==="boolVar"?!!(e!=null&&e[l.name]):l.type==="pairVar"?e==null?void 0:e[l.name]:l.type==="pairLit"?{__pair__:!0,fst:i(l.fst),snd:i(l.snd)}:pr(l,e)},s=l=>{switch(l.type){case"boolLit":return!!l.value;case"boolVar":return r(e==null?void 0:e[l.name]);case"boolFuncall":{if(l.name==="isSubstringOf"&&l.args&&l.args.length===2){const u=pr(l.args[0],e||{}),c=pr(l.args[1],e||{});if(typeof u!="string"||typeof c!="string")throw new Error("isSubstringOf requires two string arguments");return c.includes(u)}throw new Error(`Unknown boolean function '${l.name}'`)}case"not":return!s(l.expr);case"and":return s(l.left)&&s(l.right);case"or":return s(l.left)||s(l.right);case"xor":{const u=s(l.left),c=s(l.right);return u&&!c||!u&&c}case"implies":{const u=s(l.left),c=s(l.right);return!u||c}case"iff":{const u=s(l.left),c=s(l.right);return u===c}case"cmp":{const u=i(l.left),c=i(l.right),f=(p,m)=>p&&typeof p=="object"&&p.__pair__&&m&&typeof m=="object"&&m.__pair__?f(p.fst,m.fst)&&f(p.snd,m.snd):p===m;switch(l.op){case"==":return f(u,c);case"!=":return!f(u,c);case"<":return u<c;case"<=":return u<=c;case">":return u>c;case">=":return u>=c;default:return!1}}default:throw new Error(`Unknown bool AST node '${l.type}'`)}};return s(t)}async function Lw(t,e,n){const{ctx:r}=await Aw(),{Int:i,Bool:s,Solver:l,And:u,Not:c,Or:f}=r,p=typeof t=="string"?Lo(t,n):t,m=new Set,w=new Set,y=h=>{if(h)switch(h.type){case"boolVar":w.add(h.name);break;case"and":case"or":y(h.left),y(h.right);break;case"not":y(h.expr);break;case"cmp":{const k=E=>{E&&(E.type==="var"&&m.add(E.name),E.type==="bin"&&(k(E.left),k(E.right)))};k(h.left),k(h.right);break}}};y(p);const x=new Map(Array.from(m).map(h=>[h,i.const(h)])),b=new Map(Array.from(w).map(h=>[h,s.const(h)])),_=h=>{switch(h.type){case"boolLit":return h.value?s.val(!0):s.val(!1);case"boolVar":return b.get(h.name);case"boolFuncall":{if(h.name==="isSubstringOf"&&h.args&&h.args.length===2)try{const k=pr(h.args[0],e||{}),E=pr(h.args[1],e||{});if(typeof k!="string"||typeof E!="string")throw new Error("isSubstringOf requires two string arguments");return E.includes(k)?s.val(!0):s.val(!1)}catch{try{const E=Yn(r,h.args[1],I=>x.get(I)),N=Yn(r,h.args[0],I=>x.get(I));return E.contains(N)}catch{return s.val(!1)}}throw new Error(`Unknown boolean function '${h.name}'`)}case"not":return c(_(h.expr));case"and":return u(_(h.left),_(h.right));case"or":return f(_(h.left),_(h.right));case"cmp":{const k=N=>N&&(N.type==="int"||N.type==="var"||N.type==="bin"||N.type==="binop");if(k(h.left)&&k(h.right)){const N=L=>{if(L.type==="int")return i.val(L.value);if(L.type==="var")return x.get(L.name);if(L.type==="bin"||L.type==="binop"){const A=N(L.left),F=N(L.right);switch(L.op){case"+":return A.add(F);case"-":return A.sub(F);case"*":return A.mul(F);case"/":return A.div(F);default:throw new Error("Unknown arithmetic operator")}}throw new Error("Unknown arithmetic AST in bool comparison")},I=N(h.left),M=N(h.right);switch(h.op){case"==":return I.eq(M);case"!=":return c(I.eq(M));case"<":return I.lt(M);case"<=":return I.le(M);case">":return I.gt(M);case">=":return I.ge(M);default:throw new Error(`Unsupported predicate operator '${h.op}'`)}}return Co({type:"cmp",op:h.op,left:h.left,right:h.right},e||{})?s.val(!0):s.val(!1)}default:throw new Error(`Unknown bool AST node '${h.type}'`)}},S=new l;try{let h=1e4;try{typeof window<"u"&&window.__Z3_SETTINGS__&&typeof window.__Z3_SETTINGS__.solverTimeoutMs=="number"&&(h=window.__Z3_SETTINGS__.solverTimeoutMs|0)}catch{}S.set("timeout",h)}catch{}if(e&&typeof e=="object"){const h=[];for(const[k,E]of Object.entries(e))x.has(k)&&typeof E=="number"?h.push(x.get(k).eq(i.val(E|0))):b.has(k)&&typeof E=="boolean"&&h.push(b.get(k).eq(E?s.val(!0):s.val(!1)));h.length&&S.add(u(...h))}S.add(_(p));const T=await S.check();return String(T)==="sat"}async function Rw(t,e,n=5){const{solveEquation:r}=await ri(()=>import("./eval-bool-854aef1e.js"),[],import.meta.url);return await r(t,e,n)}function jw(t,e,n=Vt){if(!t||typeof t!="string")return{};const r={},i=t.split(",");for(const s of i){const l=s.indexOf("=");if(l===-1)continue;const u=s.slice(0,l).trim(),c=s.slice(l+1).trim();if(!u)continue;const f=n(c);r[u]=pr(f,e)}return r}function Fw(t){return t&&typeof t=="object"&&(t.__pair__||Object.prototype.hasOwnProperty.call(t,"fst")&&Object.prototype.hasOwnProperty.call(t,"snd"))}function Ya(t){return typeof t=="boolean"?t?"T":"F":typeof t=="string"?`'${t}'`:Array.isArray(t)?`[${t.map(Ya).join(", ")}]`:Fw(t)?`(${Ya(t.fst)}, ${Ya(t.snd)})`:String(t)}function _4(t){return!Array.isArray(t)||t.length===0?"":t.map(Ya).join(", ")}const U2="text-sm sm:text-xs font-semibold text-gray-600 uppercase tracking-wider mb-2";function Ow({isOpen:t,onClose:e}){const n=Cw(),r=n.listTypes(),[i,s]=O.useState("x + 2 * y"),[l,u]=O.useState("x=3, y=4"),[c,f]=O.useState(null),[p,m]=O.useState([]),[w,y]=O.useState(null),x=O.useMemo(()=>r.map(h=>n.getType(h)),[r,n]);if(!t)return null;function b(T){const h=String(T||"").trim();if(!h)return{};try{const E=JSON.parse(h);if(E&&typeof E=="object"&&!Array.isArray(E))return E}catch{}const k={};for(const E of h.split(",")){const N=E.trim();if(!N)continue;const I=N.indexOf("=");if(I===-1)continue;const M=N.slice(0,I).trim(),L=N.slice(I+1).trim(),A=Number.parseInt(L,10);M&&(k[M]=Number.isFinite(A)?A:0)}return k}function _(T){let h=0;for(let k=0;k<T.length;k++){const E=T[k];if(E==="("?h++:E===")"&&(h=Math.max(0,h-1)),h===0&&E==="="){const N=T[k-1]||"",I=T[k+1]||"";if(N!=="="&&I!=="="&&N!=="<"&&N!==">")return k}}return-1}const S=async()=>{y(null),f(null),m([]);try{const T=String(i||"").trim();if(!T)throw new Error("Please enter an expression or an equation.");const h=_(T),k=b(l);if(h>=0){const E=Vt(T.slice(0,h)),N=Vt(T.slice(h+1));if(Object.keys(k).length>0){const M=await Co({type:"cmp",op:"==",left:E,right:N},k,Vt);f(!!M)}else{const{solutions:I}=await Rw(E,N,5);m(I||[])}}else try{const E=Vt(T),N=await pr(E,k);f(N)}catch{const N=Lo(T,Vt),I=Co(N,k,Vt);f(!!I)}}catch(T){y(String(T.message||T))}};return C.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-2 sm:p-4",children:C.jsxs("div",{className:"bg-white rounded-lg sm:rounded shadow-lg w-full h-full sm:h-auto sm:max-h-[90vh] sm:max-w-[1000px] overflow-y-auto p-3 sm:p-4",children:[C.jsxs("div",{className:"flex items-center justify-between mb-3 sticky top-0 bg-white pb-2 border-b -mx-3 sm:-mx-4 px-3 sm:px-4 z-10",children:[C.jsx("h3",{className:"text-base sm:text-lg font-semibold pr-2",children:"ADT Manager"}),C.jsx("button",{className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 active:bg-gray-400 rounded text-sm font-medium flex-shrink-0 transition-colors",onClick:e,children:"Close"})]}),C.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6",children:[C.jsxs("div",{children:[C.jsx("div",{className:U2,children:"Available Data Types"}),x.map(T=>C.jsxs("div",{className:"mt-3 p-3 sm:p-4 border rounded bg-gray-50 space-y-3",children:[C.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[C.jsx("div",{className:"font-semibold text-base sm:text-lg",children:T.name}),T.__readonly&&C.jsx("span",{className:"text-xs sm:text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded flex-shrink-0",children:"Built-in"})]}),C.jsxs("div",{children:[C.jsx("div",{className:"text-sm sm:text-sm font-semibold mb-2 text-gray-700",children:"Operations"}),C.jsxs("div",{className:"space-y-2",children:[(T.operations||[]).map((h,k)=>C.jsx("div",{className:"text-xs sm:text-sm font-mono bg-white p-2 sm:p-3 rounded border",children:C.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 break-words",children:[C.jsx("span",{className:"text-blue-600 font-semibold",children:h.name}),C.jsxs("span",{className:"text-gray-600",children:["(",h.params?h.params.map((E,N)=>`${E.type} ${String.fromCharCode(97+N)}`).join(", "):"no params",")"]}),C.jsx("span",{className:"text-gray-500",children:"  "}),C.jsx("span",{className:"text-green-600 font-semibold",children:h.result})]})},k)),(!T.operations||T.operations.length===0)&&C.jsx("div",{className:"text-sm text-gray-500 italic",children:"(no operations)"})]})]}),C.jsxs("div",{children:[C.jsx("div",{className:"text-sm sm:text-sm font-semibold mb-2 text-gray-700",children:"Axioms"}),C.jsxs("div",{className:"space-y-2",children:[(T.axioms||[]).map((h,k)=>C.jsxs("div",{className:"text-xs sm:text-sm font-mono bg-white p-2 sm:p-3 rounded border break-all",children:[C.jsx("span",{className:"text-purple-600 font-semibold",children:h.name?h.name+": ":""}),C.jsx("span",{className:"text-gray-800 break-words",children:h.equation})]},k)),(!T.axioms||T.axioms.length===0)&&C.jsx("div",{className:"text-sm text-gray-500 italic",children:"(no axioms)"})]})]})]},T.name))]}),C.jsxs("div",{children:[C.jsx("div",{className:U2,children:"Interactive Tools"}),C.jsxs("div",{className:"mt-3 p-3 sm:p-4 border rounded bg-gray-50",children:[C.jsx("div",{className:"text-sm sm:text-sm font-semibold mb-3 text-gray-700",children:"Sandbox"}),C.jsxs("div",{className:"space-y-3",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-xs sm:text-xs text-gray-700 mb-1",children:"Expression or Equation"}),C.jsx("input",{className:"w-full border rounded p-2 sm:p-2 text-sm font-mono",placeholder:"Enter an expression (e.g., x + 2*y) or equation with '=' (e.g., x + y = 7)",value:i,onChange:T=>s(T.target.value),"data-testid":"sandbox-expr"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-xs sm:text-xs text-gray-700 mb-1",children:"Variable Bindings"}),C.jsx("input",{className:"w-full border rounded p-2 sm:p-2 text-sm font-mono",placeholder:'{"x":3, "y":4} or x=3, y=4',value:l,onChange:T=>u(T.target.value),"data-testid":"sandbox-bindings"})]}),C.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[C.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded text-sm font-medium active:bg-blue-700 transition-colors",onClick:S,"data-testid":"sandbox-run",children:"Run"}),c!==null&&C.jsxs("span",{className:"text-sm","data-testid":"sandbox-result",children:["Result: ",C.jsx("span",{className:"font-mono bg-green-100 px-2 py-1 rounded",children:Ya(c)})]})]}),w&&C.jsx("div",{className:"p-2 sm:p-3 text-red-700 bg-red-100 border border-red-200 rounded text-xs sm:text-sm whitespace-pre-wrap break-words",children:w}),p&&p.length>0&&C.jsxs("div",{className:"text-sm","data-testid":"sandbox-solutions",children:[C.jsx("div",{className:"font-semibold mb-2 text-gray-700",children:"Solutions (up to 5):"}),C.jsx("div",{className:"space-y-2",children:p.map((T,h)=>C.jsx("div",{className:"font-mono bg-white p-2 sm:p-3 rounded border break-all text-xs sm:text-sm","data-testid":"sandbox-sol-entry",children:JSON.stringify(T)},h))})]})]})]})]})]})]})})}const Dw=[{filename:"petri-net-PT.pnml",displayName:"Petri Net PT"},{filename:"petri-net-algebraic1.pnml",displayName:"Algebraic Net 1"},{filename:"petri-net-algebraic2.pnml",displayName:"Algebraic Net 2"},{filename:"petri-net-algebraic3.pnml",displayName:"Algebraic Net 3"},{filename:"petri-net-XL.pnml",displayName:"Petri Net XL"}];function zw({isOpen:t,onClose:e,onSelectExample:n}){if(!t)return null;const r=i=>{n(i),e()};return C.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-2 sm:p-4",children:C.jsxs("div",{className:"bg-white rounded-lg sm:rounded shadow-lg w-full h-auto sm:max-w-md overflow-y-auto p-3 sm:p-4",children:[C.jsxs("div",{className:"flex items-center justify-between mb-3 sticky top-0 bg-white pb-2 border-b -mx-3 sm:-mx-4 px-3 sm:px-4 z-10",children:[C.jsx("h3",{className:"text-base sm:text-lg font-semibold pr-2",children:"Examples"}),C.jsx("button",{className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 active:bg-gray-400 rounded text-sm font-medium flex-shrink-0 transition-colors",onClick:e,children:"Close"})]}),C.jsx("div",{className:"space-y-2",children:Dw.map(i=>C.jsxs("button",{className:"w-full text-left px-4 py-3 border rounded hover:bg-gray-50 active:bg-gray-100 transition-colors",onClick:()=>r(i.filename),"data-testid":`example-${i.filename}`,children:[C.jsx("div",{className:"font-medium text-gray-800",children:i.displayName}),C.jsx("div",{className:"text-xs text-gray-500 mt-1",children:i.filename})]},i.filename))})]})})}const Fu="http://example.org/apn",Bw="http://www.pnml.org/version-2009/grammar/pnml",Uw=500,k4={startX:40,startY:40,spacing:80,columns:25,transitionOffsetX:220};function Wh(t){return t?Array.from(t):[]}function Gw(t){const n=new DOMParser().parseFromString(t,"application/xml"),r=n.querySelector("parsererror");if(r)throw console.error("XML parsing error:",r.textContent),new Error("Invalid XML: "+r.textContent);const i=n.documentElement,s=i.namespaceURI||Bw;return{xmlDoc:n,pnmlElement:i,PNML_NS:s}}function Vw(t,e){const n=t.getElementsByTagNameNS(e,"net");if(n&&n.length>0)return n[0];const r=t.getElementsByTagName("net");return r&&r.length>0?r[0]:null}function Ww(t,e){const n=t.getElementsByTagNameNS(e,"page");if(n&&n.length>0)return n[0];const r=t.getElementsByTagName("page");return r&&r.length>0?r[0]:null}function b4(t){const e=(i,s)=>{if(!i)return[];const l=typeof i.getElementsByTagNameNS=="function"?i.getElementsByTagNameNS(t,s):[];if(l&&l.length>0)return Wh(l);const u=typeof i.getElementsByTagNameNS=="function"?i.getElementsByTagNameNS(Fu,s):[];if(u&&u.length>0)return Wh(u);const c=typeof i.getElementsByTagName=="function"?i.getElementsByTagName(s):[];return c&&c.length>0?Wh(c):[]},n=(i,s)=>e(i,s);return{getElements:e,findChildElements:n,getTextContent:(i,s)=>{const l=n(i,s);if(l.length===0)return"";const u=l[0],c=u.getElementsByTagName("text").length?u.getElementsByTagName("text"):u.getElementsByTagNameNS(Fu,"text");if(c&&c.length>0){const f=c[0];if(f&&typeof f.textContent=="string")return f.textContent}return typeof u.textContent=="string"?u.textContent:""}}}function $h(t,e,n){return t?b4(e).getElements(t,n):[]}function $w(t){return t>=Uw}function C4(t,e,n,r,i){const{findChildElements:s}=e,{applyAutoLayout:l,layout:u=k4}=n,{startX:c,startY:f,spacing:p,columns:m,transitionOffsetX:w}=u,y=Hw(t,s);if(y.found||!l)return{x:y.x,y:y.y};const x=r%m,b=Math.floor(r/m),_=c+x*p,S=f+b*p;return i==="transition"?{x:_+w,y:S}:{x:_,y:S}}function Hw(t,e){const n=e(t,"graphics");if(n.length>0){const r=e(n[0],"position");if(r.length>0){const i=parseInt(r[0].getAttribute("x")||"0",10),s=parseInt(r[0].getAttribute("y")||"0",10);return{x:i,y:s,found:!0}}}return{x:0,y:0,found:!1}}function Yw(t,e={}){return{applyAutoLayout:t,layout:{...k4,...e}}}function wg(t){const e=[];let n="",r=0,i=0,s=!1;for(let u=0;u<t.length;u++){const c=t[u];if(s){n+=c,c==="'"&&t[u-1]!=="\\"&&(s=!1);continue}if(c==="'"){s=!0,n+=c;continue}if(c==="("){r++,n+=c;continue}if(c===")"){r=Math.max(0,r-1),n+=c;continue}if(c==="["){i++,n+=c;continue}if(c==="]"){i=Math.max(0,i-1),n+=c;continue}if(c===","&&r===0&&i===0){e.push(n.trim()),n="";continue}n+=c}const l=n.trim();return l.length>0&&e.push(l),e.filter(Boolean)}function Xa(t){const e=String(t||"").trim(),n=e.toLowerCase();if(e==="T"||n==="true")return!0;if(e==="F"||n==="false")return!1;if(/^[+-]?\d+$/.test(e))return parseInt(e,10);if(e.startsWith("'")&&e.endsWith("'")&&e.length>=2)return e.slice(1,-1).replace(/\\(.)/g,(i,s)=>s==="n"?`
`:s==="t"?"	":s==="r"?"\r":s==="\\"?"\\":s==="'"?"'":s);if(e.startsWith("[")&&e.endsWith("]")){const r=e.slice(1,-1).trim();return r.length===0?[]:wg(r).map(s=>Xa(s))}if(e.startsWith("(")&&e.endsWith(")")){const r=e.slice(1,-1).trim();let i=0,s=-1;for(let l=0;l<r.length;l++){const u=r[l];if(u==="(")i++;else if(u===")")i=Math.max(0,i-1);else if(u===","&&i===0){s=l;break}}if(s>=0){const l=r.slice(0,s).trim(),u=r.slice(s+1).trim();return{__pair__:!0,fst:Xa(l),snd:Xa(u)}}}return null}const Xw=t=>`P${t+1}`;function Kw(t,e,n){const{getTextContent:r,getElements:i}=e,s=[];return t.forEach((l,u)=>{try{const c=l.getAttribute("id"),f=r(l,"name")||Xw(u),p=C4(l,e,n,u,"place");let m=0,w;const y=i(l,"valueTokens").filter(b=>b.namespaceURI===Fu&&b.parentElement===l);if(y.length>0){const b=y[0],_=b.getElementsByTagNameNS?b.getElementsByTagNameNS(Fu,"token"):b.getElementsByTagName("token"),S=Array.from(_||[]).map(T=>{let h=r(T,"text");!h&&typeof T.textContent=="string"&&(h=T.textContent);const k=typeof h=="string"?h.trim():"";return k?Xa(k):null}).filter(T=>T!==null);w=S,m=S.length}else{const b=r(l,"initialMarking");if(b){const _=b.trim();if(_.startsWith("[")&&_.endsWith("]"))try{const S=_.slice(1,-1).trim();w=(S.length?wg(S):[]).map(Xa).filter(h=>h!==null),m=Array.isArray(w)?w.length:0}catch(S){console.warn(`Could not parse token list for ${c}:`,S)}else{const S=parseInt(_,10);Number.isFinite(S)&&(m=S)}}}const x=r(l,"type");s.push({id:c,name:f,label:f,x:p.x,y:p.y,tokens:m,valueTokens:w,type:x||void 0})}catch(c){console.error("Error processing place:",c)}}),s}const Qw=t=>`T${t+1}`;function Zw(t,e,n){const{getTextContent:r}=e,i=[];return t.forEach((s,l)=>{try{const u=s.getAttribute("id"),c=r(s,"name")||Qw(l),f=C4(s,e,n,l,"transition"),p=r(s,"guard"),m=r(s,"action");i.push({id:u,name:c,label:c,x:f.x,y:f.y,guard:p||void 0,action:m||void 0})}catch(u){console.error("Error processing transition:",u)}}),i}const qw="north",Jw="south";function e9(t,e,n){const{getTextContent:r,findChildElements:i}=e,s=[],{placeIds:l,transitionIds:u}=n;return t.forEach(c=>{try{const f=c.getAttribute("id"),p=c.getAttribute("source"),m=c.getAttribute("target");if(!p||!m){console.warn(`Skipping arc ${f} due to missing source or target`);return}let w=qw,y=Jw;const x=i(c,"graphics");if(x.length>0){const k=i(x[0],"metadata");if(k.length>0){const E=i(k[0],"sourceDirection");E.length>0&&E[0].textContent&&(w=E[0].textContent);const N=i(k[0],"targetDirection");N.length>0&&N[0].textContent&&(y=N[0].textContent)}}const b=t9(f,p,m,l,u);let _=1;const S=r(c,"inscription");if(S){const k=parseInt(S,10);Number.isFinite(k)?_=k:console.warn(`Could not parse weight for ${f}: '${S}', defaulting to 1`)}const T=r(c,"binding");let h;if(T&&T.includes(","))try{h=wg(T)}catch{h=T.split(",").map(E=>E.trim()).filter(Boolean)}else T&&(h=[T.trim()]);s.push({id:f,source:p,target:m,type:b,weight:_,binding:h?void 0:T||void 0,bindings:h||void 0,sourceDirection:w,targetDirection:y})}catch(f){console.error("Error processing arc:",f)}}),s}function t9(t,e,n,r,i){const s=r.includes(e),l=i.includes(e),u=r.includes(n),c=i.includes(n);return s&&c?"place-to-transition":l&&u?"transition-to-place":e.toLowerCase().includes("place")&&n.toLowerCase().includes("transition")?"place-to-transition":e.toLowerCase().includes("transition")&&n.toLowerCase().includes("place")?"transition-to-place":(console.warn(`Could not determine arc type for ${t}, defaulting to place-to-transition`),"place-to-transition")}function n9(t){const e={places:[],transitions:[],arcs:[]};try{const{xmlDoc:n,PNML_NS:r}=Gw(t),i=Vw(n,r);if(!i)return console.error("No net element found in the PNML file"),e;const s=i.getAttribute("netMode");s&&(e.netMode=s);const l=Ww(i,r);if(!l)return console.error("No page element found in the PNML file"),e;const u=b4(r),c=$h(l,r,"place"),f=$h(l,r,"transition"),p=$h(l,r,"arc"),m=c.length+f.length,w=Yw($w(m));return e.places=Kw(c,u,w),e.transitions=Zw(f,u,w),e.arcs=e9(p,u,{placeIds:e.places.map(y=>y.id),transitionIds:e.transitions.map(y=>y.id)}),e}catch(n){return console.error("Error parsing PNML:",n),e}}const wn="http://example.org/apn";function r9(t){try{const e=document.implementation.createDocument("http://www.pnml.org/version-2009/grammar/pnml","pnml",null),n=e.documentElement;let r=!1;const i=e.createElement("net");i.setAttribute("id","net1"),i.setAttribute("type","http://www.pnml.org/version-2009/grammar/ptnet"),n.appendChild(i),t.netMode&&i.setAttribute("netMode",t.netMode);const s=e.createElement("name"),l=e.createElement("text");l.textContent="Petri Net",s.appendChild(l),i.appendChild(s);const u=e.createElement("page");u.setAttribute("id","page1"),i.appendChild(u);const c=t.places||[];c.forEach(b=>{const _=e.createElement("place");_.setAttribute("id",b.id);const S=e.createElement("name"),T=e.createElement("text");T.textContent=b.label||b.name||`P${b.id}`,S.appendChild(T),_.appendChild(S);const h=e.createElement("graphics"),k=e.createElement("position");if(k.setAttribute("x",b.x||0),k.setAttribute("y",b.y||0),h.appendChild(k),_.appendChild(h),b.type){const N=e.createElementNS(wn,"apn:type"),I=e.createElementNS(wn,"apn:text");I.textContent=String(b.type),N.appendChild(I),_.appendChild(N),r=!0}const E=N=>typeof N=="boolean"?N?"T":"F":typeof N=="string"?`'${N.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}'`:Array.isArray(N)?`[${N.map(E).join(", ")}]`:N&&typeof N=="object"&&N.__pair__?`(${E(N.fst)}, ${E(N.snd)})`:String(N);if(Array.isArray(b.valueTokens)){const N=e.createElementNS(wn,"apn:valueTokens");b.valueTokens.forEach(I=>{const M=e.createElementNS(wn,"apn:token"),L=e.createElementNS(wn,"apn:text");L.textContent=E(I),M.appendChild(L),N.appendChild(M)}),_.appendChild(N),r=!0}else if(b.tokens>0){const N=e.createElement("initialMarking"),I=e.createElement("text");I.textContent=b.tokens,N.appendChild(I),_.appendChild(N)}u.appendChild(_)});const f=t.transitions||[];f.forEach(b=>{const _=e.createElement("transition");_.setAttribute("id",b.id);const S=e.createElement("name"),T=e.createElement("text");T.textContent=b.label||b.name||`T${b.id}`,S.appendChild(T),_.appendChild(S);const h=e.createElement("graphics"),k=e.createElement("position");if(k.setAttribute("x",b.x||0),k.setAttribute("y",b.y||0),h.appendChild(k),_.appendChild(h),b.guard){const E=e.createElementNS(wn,"apn:guard"),N=e.createElementNS(wn,"apn:text");N.textContent=String(b.guard),E.appendChild(N),_.appendChild(E),r=!0}if(b.action){const E=e.createElementNS(wn,"apn:action"),N=e.createElementNS(wn,"apn:text");N.textContent=String(b.action),E.appendChild(N),_.appendChild(E),r=!0}u.appendChild(_)});const p=t.arcs||[],m=new Set(c.map(b=>b.id)),w=new Set(f.map(b=>b.id));return p.filter(b=>{const _=b.source||b.sourceId,S=b.target||b.targetId;if(!_||!S||_==="undefined"||S==="undefined")return console.warn(`Skipping invalid arc ${b.id} during save - missing or undefined source/target`),!1;const T=m.has(_)||w.has(_),h=m.has(S)||w.has(S);return!T||!h?(console.warn(`Skipping invalid arc ${b.id} during save - references non-existent elements`),!1):!0}).forEach(b=>{const _=e.createElement("arc");_.setAttribute("id",b.id);const S=b.source||b.sourceId,T=b.target||b.targetId;_.setAttribute("source",S),_.setAttribute("target",T);const h=e.createElement("graphics"),k=e.createElement("metadata"),E=e.createElement("sourceDirection");E.textContent=b.sourceDirection||"north",k.appendChild(E);const N=e.createElement("targetDirection");if(N.textContent=b.targetDirection||"south",k.appendChild(N),h.appendChild(k),_.appendChild(h),b.weight>1&&!(b.binding||Array.isArray(b.bindings)&&b.bindings.length)){const I=e.createElement("inscription"),M=e.createElement("text");M.textContent=b.weight,I.appendChild(M),_.appendChild(I)}if(Array.isArray(b.bindings)&&b.bindings.length>0){const I=e.createElementNS(wn,"apn:binding"),M=e.createElementNS(wn,"apn:text");M.textContent=b.bindings.join(", "),I.appendChild(M),_.appendChild(I),r=!0}else if(b.binding){const I=e.createElementNS(wn,"apn:binding"),M=e.createElementNS(wn,"apn:text");M.textContent=String(b.binding),I.appendChild(M),_.appendChild(I),r=!0}u.appendChild(_)}),r&&n.setAttribute("xmlns:apn",wn),new XMLSerializer().serializeToString(e)}catch(e){throw console.error("Error generating PNML:",e),e}}async function G2(t){try{return r9(t)}catch(e){throw console.error("Error exporting to PNML:",e),e}}async function V2(t){try{return n9(t)}catch(e){throw console.error("Error importing from PNML:",e),e}}class i9{constructor(){this.listeners=new Map}on(e,n){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(n)}off(e,n){if(!this.listeners.has(e))return;const r=this.listeners.get(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}emit(e,n){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)try{i(n)}catch(s){console.error(`Error in event listener for ${e}:`,s)}}removeAllListeners(e){e?this.listeners.delete(e):this.listeners.clear()}listenerCount(e){return this.listeners.has(e)?this.listeners.get(e).length:0}}const vo={transitionsChanged:"transitionsChanged",transitionFired:"transitionFired"},Ca=new i9;class E4{constructor(){this.isInitialized=!1,this.petriNet=null,this.eventBus=null,this.simulationMode="single"}async initialize(e,n={}){if(!this.validatePetriNet(e))throw new Error("Invalid Petri net structure");this.petriNet=this.normalizeNet(e),this.isInitialized=!0,this.simulationMode=n.simulationMode||"single",await this.initializeSpecific(this.petriNet,n)}async initializeSpecific(e,n){}async update(e){if(!this.isInitialized)throw new Error("Simulator not initialized");if(!this.validatePetriNet(e))throw new Error("Invalid Petri net structure");this.petriNet=this.normalizeNet(e),await this.updateSpecific(this.petriNet)}async updateSpecific(e){}async getEnabledTransitions(){return this.isInitialized?await this.getEnabledTransitionsSpecific():[]}async getEnabledTransitionsSpecific(){return[]}async fireTransition(e,n={}){if(!this.isInitialized)throw new Error("Simulator not initialized");if(!(n.skipEnabledCheck||!1)&&!(await this.getEnabledTransitions()).includes(e))throw new Error(`Transition ${e} is not enabled`);return await this.fireTransitionSpecific(e,n)}async fireTransitionSpecific(e){return this.petriNet}async stepSimulation(){if(!this.isInitialized)throw new Error("Simulator not initialized");return await this.stepSimulationSpecific()}async stepSimulationSpecific(){return this.petriNet}reset(){this.isInitialized=!1,this.petriNet=null,this.simulationMode="single",this.resetSpecific()}resetSpecific(){}setEventBus(e){this.eventBus=e}emitTransitionsChanged(e={}){if(!this.eventBus)return;const n=Array.isArray(e.enabled)?e.enabled:[],r=Array.isArray(e.previouslyEnabled)?e.previouslyEnabled:[],i=typeof e.hasEnabled=="boolean"?e.hasEnabled:n.length>0;this.eventBus.emit(vo.transitionsChanged,{enabled:n,previouslyEnabled:r,hasEnabled:i})}emitTransitionFired(e={}){if(!this.eventBus)return;const{transitionId:n,newPetriNet:r}=e||{};n&&this.eventBus.emit(vo.transitionFired,{transitionId:n,newPetriNet:r})}getType(){throw new Error("getType() must be implemented by subclasses")}validatePetriNet(e){if(!e||typeof e!="object")return!1;const{places:n,transitions:r,arcs:i}=e;return!(!Array.isArray(n)||!Array.isArray(r)||!Array.isArray(i))}normalizeNet(e){const n=JSON.parse(JSON.stringify(e||{places:[],transitions:[],arcs:[]})),r=Array.isArray(n.places)?n.places:[],i=Array.isArray(n.transitions)?n.transitions:[],s=Array.isArray(n.arcs)?n.arcs:[],l=new Set(r.map(c=>String(c.id))),u=new Set(i.map(c=>String(c.id)));for(const c of r){if(c.id=String(c.id),Array.isArray(c.valueTokens)){const f=c.valueTokens.length;(!Number.isFinite(c.tokens)||c.tokens!==f)&&(c.tokens=f)}else Number.isFinite(c.tokens)||(c.tokens=0);!c.label&&c.name&&(c.label=c.name),!c.name&&c.label&&(c.name=c.label)}for(const c of s){c.id!==void 0&&(c.id=String(c.id));const f=c.sourceId||c.source,p=c.targetId||c.target;c.sourceId=String(f),c.targetId=String(p),c.source===void 0&&(c.source=c.sourceId),c.target===void 0&&(c.target=c.targetId);const m=Number(c.weight);c.weight=Number.isFinite(m)&&m>0?m:1,Array.isArray(c.bindings)||(c.binding?c.bindings=[String(c.binding)]:c.bindings=[]),c.sourceType||(c.sourceType=l.has(c.sourceId)?"place":u.has(c.sourceId)?"transition":c.sourceType),c.targetType||(c.targetType=l.has(c.targetId)?"place":u.has(c.targetId)?"transition":c.targetType)}return n.places=r,n.transitions=i,n.arcs=s,n}isReady(){return this.isInitialized&&this.petriNet!==null}getSimulationStats(){if(!this.isInitialized)return{enabledTransitions:[],totalTokens:0,totalPlaces:0,totalTransitions:0};const{places:e,transitions:n}=this.petriNet,r=e.reduce((i,s)=>i+(s.tokens||0),0);return{enabledTransitions:[],totalTokens:r,totalPlaces:e.length,totalTransitions:n.length}}}function s9(t){if(!(t!=null&&t.transitions)||!(t!=null&&t.places)||!(t!=null&&t.arcs))return!1;for(const e of t.transitions)if(T4(e.id,t))return!1;return!0}function T4(t,e){const n=o9(t,e.places,e.arcs);for(const r of n){const i=e.arcs.find(l=>(l.sourceId===r.id||l.source===r.id)&&(l.targetId===t||l.target===t));if(!i)continue;const s=i.weight||1;if((r.tokens||0)<s)return!1}return!0}function o9(t,e,n){const r=[];for(const i of n){const s=i.sourceId||i.source;if((i.targetId||i.target)===t){const u=e.find(c=>c.id===s);u&&r.push(u)}}return r}function a9(t){var l,u,c,f,p;if(!t)return null;const e=((l=t.places)==null?void 0:l.length)||0,n=((u=t.transitions)==null?void 0:u.length)||0,r=((c=t.arcs)==null?void 0:c.length)||0,i=((f=t.places)==null?void 0:f.reduce((m,w)=>m+(w.tokens||0),0))||0,s=((p=t.transitions)==null?void 0:p.filter(m=>T4(m.id,t)))||[];return{placeCount:e,transitionCount:n,arcCount:r,totalTokens:i,enabledTransitionCount:s.length,enabledTransitions:s.map(m=>m.id),isDeadlock:s9(t)}}function N4(t,e){const n=new Map;for(const r of t)r.srcId&&(n.has(r.srcId)||n.set(r.srcId,[]),n.get(r.srcId).push(r));for(const[r,i]of n.entries()){const s=e[r];if(!s)continue;const l=i.filter(c=>c.countFallback).length;if(l>0){const c=Number(s.tokens||0);s.tokens=Math.max(0,c-l)}const u=i.filter(c=>!c.countFallback);if(Array.isArray(s.valueTokens)&&u.length>0){u.sort((c,f)=>f.tokenIndex-c.tokenIndex);for(const c of u)c.tokenIndex>=0&&c.tokenIndex<s.valueTokens.length&&s.valueTokens.splice(c.tokenIndex,1);s.tokens=s.valueTokens.length}}}function l9(t,e,n,r,i){const{evaluateArithmeticWithBindings:s,evaluateBooleanWithBindings:l,evaluatePatternLiteral:u,parseArithmetic:c}=i;for(const f of t){const p=f.targetId,m=r[p];if(!m)continue;const w=e.get(f.id)||[];if(w.length>0){Array.isArray(m.valueTokens)||(m.valueTokens=[]);for(const y of w)try{let x;const{kind:b,ast:_}=y;_&&(_.type==="var"||_.type==="boolVar"||_.type==="pairVar")?x=(n||{})[_.name]:b==="arith"?x=s(_,n):b==="bool"?x=l(_,n,c):b==="pattern"?x=u(_,n||{}):b==="pair"&&_.type==="pairLit"&&(x=u(_,n||{})),Array.isArray(m.valueTokens)||(m.valueTokens=[]),typeof x=="number"?m.valueTokens.push(x|0):typeof x=="boolean"||typeof x=="string"||c9(x)?m.valueTokens.push(x):Array.isArray(x)&&(b==="arith"||b==="pair"||_&&(_.type==="list"||_.type==="listPattern"||_.type==="tuplePattern")?m.valueTokens.push(x):m.valueTokens.push(...x))}catch{}}else if(f.weight&&(f.weight|0)>0){const y=f.weight|0;for(let x=0;x<y;x++){const b=Object.values(n||{});if(Array.isArray(m.valueTokens)){const _=b[0];m.valueTokens.push(typeof _=="boolean"?!!_:Number.isFinite(_)?_|0:1)}else m.tokens=Number(m.tokens||0)+1|0}}else Array.isArray(m.valueTokens)?m.valueTokens.push(1):m.tokens=Number(m.tokens||0)+1|0;Array.isArray(m.valueTokens)&&(m.tokens=m.valueTokens.length)}}function c9(t){return!!(t&&typeof t=="object"&&t.__pair__===!0&&"fst"in t&&"snd"in t)}class u9 extends E4{constructor(){super(),this.maxTokens=1/0}getType(){return"pt"}async initializeSpecific(e,n={}){const r=Number(n.maxTokens);this.maxTokens=Number.isFinite(r)&&r>=0?r:1/0,this.validatePTNet(e),this.initializeTokens(e),_e.debug("P/T Simulator initialized with",e.places.length,"places and",e.transitions.length,"transitions")}async updateSpecific(e){this.initializeTokens(e);const n=await this.getEnabledTransitionsSpecific();this.emitTransitionsChanged({enabled:n})}async getEnabledTransitionsSpecific(){if(!this.petriNet)return[];const{places:e,transitions:n,arcs:r}=this.petriNet,i=[];for(const s of n)this.isTransitionEnabled(s,e,r)&&i.push(s.id);return i}isTransitionEnabled(e,n,r){const i=r.filter(s=>s.target===e.id&&s.source!==e.id);for(const s of i){const l=n.find(f=>f.id===s.source);if(!l)continue;const u=s.weight||1;if((l.tokens||0)<u)return!1}return!0}async fireTransitionSpecific(e,n={}){const{places:r,transitions:i,arcs:s}=this.petriNet,l=n.skipEnabledCheck||!1,u=l?[]:await this.getEnabledTransitionsSpecific();if(!i.find(_=>_.id===e))throw new Error(`Transition ${e} not found`);const f=JSON.parse(JSON.stringify(this.petriNet)),p=f.places,m=s.filter(_=>_.target===e&&_.source!==e),w=s.filter(_=>_.source===e&&_.target!==e),y=[];for(const _ of m){const S=(_.weight||1)|0;for(let T=0;T<S;T++)y.push({srcId:_.source,countFallback:!0})}const x=Object.fromEntries(p.map(_=>[_.id,_]));N4(y,x);const b=w.map(_=>({id:_.id,sourceId:_.source,targetId:_.target,weight:_.weight||1}));for(const _ of b){const S=x[_.targetId];if(!S)continue;Array.isArray(S.valueTokens)&&delete S.valueTokens;const T=(_.weight||1)|0;S.tokens=Number(S.tokens||0)+T|0}for(const _ of p)Array.isArray(_.valueTokens)?(_.tokens=Math.min(this.maxTokens,Array.isArray(_.valueTokens)?_.valueTokens.length:_.tokens||0),delete _.valueTokens):_.tokens=Math.min(this.maxTokens,_.tokens||0);if(this.petriNet=f,!l){this.emitTransitionFired({transitionId:e,newPetriNet:f});const _=await this.getEnabledTransitionsSpecific();this.emitTransitionsChanged({enabled:_,previouslyEnabled:u})}return f}async stepSimulationSpecific(){return this.petriNet}resetSpecific(){this.maxTokens=1/0}validatePTNet(e){const{transitions:n}=e;for(const r of n){if(r.guard&&typeof r.guard=="string"&&(r.guard.includes("+")||r.guard.includes("-")||r.guard.includes("*")||r.guard.includes("/")||r.guard.includes("=")||r.guard.includes("<")||r.guard.includes(">")||r.guard.includes("!=")))throw new Error("P/T simulator cannot handle algebraic expressions. Use algebraic simulator instead.");if(r.action&&typeof r.action=="string"&&(r.action.includes("+")||r.action.includes("-")||r.action.includes("*")||r.action.includes("/")||r.action.includes("=")))throw new Error("P/T simulator cannot handle algebraic expressions. Use algebraic simulator instead.")}}initializeTokens(e){const{places:n}=e;for(const r of n)(r.tokens===void 0||r.tokens===null)&&(r.tokens=0),r.tokens=Math.min(this.maxTokens,Math.max(0,r.tokens))}getSimulationStats(){if(!this.isInitialized)return{enabledTransitions:[],totalTokens:0,totalPlaces:0,totalTransitions:0};const{places:e,transitions:n}=this.petriNet,r=e.reduce((s,l)=>s+(l.tokens||0),0);return{enabledTransitions:this.getEnabledTransitionsSync(),totalTokens:r,totalPlaces:e.length,totalTransitions:n.length}}getEnabledTransitionsSync(){if(!this.petriNet)return[];const{places:e,transitions:n,arcs:r}=this.petriNet,i=[];for(const s of n)this.isTransitionEnabled(s,e,r)&&i.push(s.id);return i}}function Lr(t,e){if(!t)return null;switch(t.type){case"pairLit":return{__pair__:!0,fst:Lr(t.fst,e),snd:Lr(t.snd,e)};case"list":return(t.elements||[]).map(n=>Lr(n,e));case"pairPattern":return{__pair__:!0,fst:Lr(t.fst,e),snd:Lr(t.snd,e)};case"tuplePattern":return(t.elements||t.components||[]).map(n=>Lr(n,e));case"listPattern":return(t.elements||[]).map(n=>Lr(n,e));case"boolLit":return!!t.value;case"int":return t.value|0;case"var":case"boolVar":case"pairVar":return(e||{})[t.name];default:return null}}function d9(t,e,n,r){var i;try{const s=(t.arcs||[]).filter(l=>l.sourceId===n&&(l.targetType==="place"||!l.targetType));for(const l of s){const u=((i=e==null?void 0:e.bindingAstsByArc)==null?void 0:i.get(l.id))||[];for(const c of u){const{ast:f}=c||{};if(f&&(f.type==="var"||f.type==="boolVar"||f.type==="pairVar")){const p=r?r[f.name]:void 0;if(p===void 0)continue;const m=f.varType;if(m==="int"&&typeof p!="number"||m==="bool"&&typeof p!="boolean"||m==="string"&&typeof p!="string"||m==="pair"&&!(p&&typeof p=="object"&&p.__pair__===!0)||m==="list"&&!Array.isArray(p))return!1}}}return!0}catch{return!1}}const f9=["concat","substring","length","head","tail","append","sublist","isSublistOf","isSubstringOf","fst","snd"],h9=new Set(f9);function p9(t,e,n,r){const i=new Map;for(const s of t.transitions||[])if(s.guard&&typeof s.guard=="string")try{const l=n(String(s.guard),e);i.set(s.id,l)}catch{try{const u=r(String(s.guard),e);i.set(s.id,u)}catch{}}return i}function g9(t,e){if(!t)return!1;const n=t.length;for(let r=0;r<n;r+=1){const i=t[r];if(!/[A-Za-z_]/.test(i))continue;let s=r+1;for(;s<n&&/[A-Za-z0-9_]/.test(t[s]);)s+=1;const l=t.slice(r,s);if(e.has(l)){let u=s;for(;u<n&&/\s/.test(t[u]);)u+=1;if(u<n&&t[u]==="(")return!0}r=s-1}return!1}function m9(t,e,n,r,i){const s=new Map;for(const l of t.arcs||[]){const u=l.id,c=Array.isArray(l.bindings)?l.bindings:l.binding?[l.binding]:[],f=[];for(const p of c){const m=String(p),w=m.trim(),y=g9(w,i),x=h=>{if(!h||typeof h!="object")return!0;switch(h.type){case"funcall":return i.has(h.name)?(h.args||[]).every(x):!1;case"pair":return x(h.fst)&&x(h.snd);case"list":return(h.elements||[]).every(x);case"binop":return x(h.left)&&x(h.right);default:return!0}},b=()=>{let h=null;try{h=n(m)}catch{h=null}return!h||!x(h)?!1:(h.type==="var"&&h.varType==="bool"?f.push({kind:"bool",ast:{type:"boolVar",name:h.name,varType:"bool"}}):h.type==="var"&&h.varType==="pair"?f.push({kind:"pair",ast:{type:"pairVar",name:h.name,varType:"pair"}}):f.push({kind:"arith",ast:h}),!0)},_=()=>{try{const h=e(m);return f.push({kind:"pattern",ast:h}),!0}catch{return!1}};let S=!1;if(y?(S=b(),S||(S=_())):(S=_(),S||(S=b())),S)continue;const T=m==="T"?!0:m==="F"?!1:null;if(T!==null){f.push({kind:"bool",ast:{type:"boolLit",value:T}});continue}try{f.push({kind:"bool",ast:r(m,n)});continue}catch{}}f.length&&s.set(u,f)}return s}function W2(t){return!!(t&&typeof t=="object"&&t.__pair__===!0&&"fst"in t&&"snd"in t)}async function $2({transition:t,inputArcs:e,placesById:n,bindingAstsByArc:r,guardAst:i,parseArithmetic:s,evaluateBooleanPredicate:l,matchPattern:u,getTokensForPlace:c,evaluateArithmeticWithBindings:f,evaluateBooleanWithBindings:p,evaluatePatternLiteral:m,maxTokensPerPlace:w=20}){const y=[],x=async(b,_)=>{if(b>=e.length){if(!i)return{env:_,picks:y};try{return p(i,_||{},s)?{env:_,picks:y}:null}catch{try{return await l(i,_||{},s)?{env:_,picks:y}:null}catch{return null}}}const S=e[b],T=S.id,h=S.sourceId||S.source,k=n[h],E=c(k,w),N=r.get(T)||[],I=N.length||(S.weight?Math.max(1,S.weight|0):0);if(I===0)return x(b+1,_);if(E.length<I)return null;const M=new Array(E.length).fill(!1),L=async(A,F)=>{if(A>=I)return x(b+1,F);for(let D=0;D<E.length;D++){if(M[D])continue;M[D]=!0;const U=E[D];let W=!0,G=F;const z=N[A];if(z){const{kind:B,ast:j}=z;if(B==="pattern"){const $=u(j,U);if($===null)W=!1;else{for(const[X,ee]of Object.entries($))if(G&&Object.prototype.hasOwnProperty.call(G,X)&&G[X]!==ee){W=!1;break}W&&(G={...G||{},...$})}}else if(j&&(j.type==="var"||j.type==="boolVar"||j.type==="pairVar"))G&&Object.prototype.hasOwnProperty.call(G,j.name)&&G[j.name]!==U?W=!1:(typeof U=="boolean"&&j.varType&&j.varType!=="bool"&&(W=!1),typeof U=="number"&&j.varType&&j.varType!=="int"&&(W=!1),typeof U=="string"&&j.varType&&j.varType!=="string"&&(W=!1),Array.isArray(U)&&j.varType&&j.varType!=="list"&&(W=!1),W2(U)&&j.varType&&j.varType!=="pair"&&(W=!1),W&&(G={...G||{},[j.name]:U}));else if(B==="arith")try{const $=f(j,F||{});(typeof U!="number"||$!==(U|0))&&(W=!1)}catch{W=!1}else if(B==="bool")try{const $=p(j,F||{},s);(typeof U!="bool"||$!==U)&&(W=!1)}catch{W=!1}else if(B==="pair")try{if(j.type==="pairLit"){const $=m(j,F||{});(!W2(U)||JSON.stringify($)!==JSON.stringify(U))&&(W=!1)}}catch{W=!1}}if(W){y.push({arcId:S.id,srcId:h,tokenIndex:D,value:U,countFallback:!Array.isArray(k==null?void 0:k.valueTokens)});const B=await L(A+1,G);if(B)return B;y.pop()}M[D]=!1}return null};return L(0,_||{})};return x(0,{})}function P4(t){const e=new Set;function n(r){if(r)switch(r.type){case"var":e.add(r.name);break;case"pairPattern":n(r.fst),n(r.snd);break;case"listPattern":Array.isArray(r.elements)&&r.elements.forEach(n);break;case"tuplePattern":r.elements&&r.elements.forEach(n);break}}return n(t),Array.from(e)}function M4(t){const e=new Set;function n(r){if(r)switch(r.type){case"var":case"boolVar":case"pairVar":e.add(r.name);break;case"binop":case"cmp":n(r.left),n(r.right);break;case"unop":n(r.operand);break;case"call":r.args&&r.args.forEach(n);break;case"pairPattern":n(r.fst),n(r.snd);break;case"tuplePattern":r.elements&&r.elements.forEach(n);break;case"pairLit":n(r.fst),n(r.snd);break}}return n(t),Array.from(e)}function y9(t,e,n,r,i){const s=new Set;for(const c of i){const f=e.get(c.id)||[];for(const p of f){const{kind:m,ast:w}=p||{};m==="pattern"&&P4(w).forEach(x=>s.add(x))}}const l=n.get(r);if(l){const c=M4(l);for(const f of c)if(!s.has(f))return!0}const u=(t.arcs||[]).filter(c=>c.sourceId===r&&(c.targetType==="place"||!c.targetType));for(const c of u){const f=e.get(c.id)||[];if(f.length===0)return!0;for(const p of f){const{kind:m,ast:w}=p||{};if(m==="pattern"&&w.type==="var"&&!s.has(w.name))return!0}}return!1}function v9(t){const e=(t.places||[]).map(l=>({id:l.id,label:l.label||"",tokens:Number(Array.isArray(l.valueTokens)?l.valueTokens.length:l.tokens||0),x:Number(l.x||0),y:Number(l.y||0),name:l.name||"",type:"place",valueTokens:Array.isArray(l.valueTokens)?[...l.valueTokens]:void 0})),n=(t.transitions||[]).map(l=>({id:l.id,label:l.label||"",x:Number(l.x||0),y:Number(l.y||0),name:l.name||"",type:"transition",guard:l.guard,action:l.action})),r=new Set(e.map(l=>l.id)),i=new Set(n.map(l=>l.id)),s=(t.arcs||[]).map(l=>{const u=l.sourceId||l.source,c=l.targetId||l.target,f=r.has(u)?"place":i.has(u)?"transition":l.sourceType||"place",p=r.has(c)?"place":i.has(c)?"transition":l.targetType||"transition",m=l.type||`${f}-to-${p}`;return{id:l.id,sourceId:u,targetId:c,source:u,target:c,weight:Number(l.weight||1),sourceType:f,targetType:p,type:m,bindings:Array.isArray(l.bindings)?[...l.bindings]:l.binding?[l.binding]:[]}});return{places:e,transitions:n,arcs:s}}let Fr=[],x9=1;const Ka=new Map;let H2=0,Hh=null;const Cl=typeof Worker<"u",Sg=typeof SharedArrayBuffer<"u",kn={poolSize:0,idleTimeoutMs:3e5,prewarmOnAlgebraicMode:!0,solverTimeoutMs:1e4};function w9(){try{if(typeof globalThis<"u"){const t=globalThis;t.__Z3_SETTINGS__={...t.__Z3_SETTINGS__||{},...kn}}}catch{}}function Bo(t){return Math.max(0,(Number.isFinite(t)?t:0)|0)}function S9(t={}){typeof t.poolSize=="number"&&(kn.poolSize=Bo(t.poolSize)),typeof t.idleTimeoutMs=="number"&&(kn.idleTimeoutMs=Math.max(1e3,t.idleTimeoutMs|0)),typeof t.prewarmOnAlgebraicMode=="boolean"&&(kn.prewarmOnAlgebraicMode=t.prewarmOnAlgebraicMode),typeof t.solverTimeoutMs=="number"&&(kn.solverTimeoutMs=Math.max(0,t.solverTimeoutMs|0)),_9()}function A4(){if(!Cl)throw new Error("Z3 worker pool unavailable in this environment");if(!Sg)throw new Error("SharedArrayBuffer not available. COOP/COEP headers may not be set correctly.");const t=new Worker(new URL(""+new URL("z3.worker-1562d2b4.js",import.meta.url).href,self.location),{type:"module"});return t.onerror=e=>{console.error("Z3 worker error:",e)},t.onmessage=({data:e})=>{const{id:n,ok:r,result:i,error:s}=e||{},l=Ka.get(n);l&&(Ka.delete(n),r?l.resolve(i):l.reject(new Error(s)),I4())},t}function _9(){if(w9(),!Cl)return;const t=Bo(kn.poolSize);for(;Fr.length<t;)Fr.push(A4());for(;Fr.length>t;){const e=Fr.pop();try{e.terminate()}catch{}}}function k9(){if(!Cl)throw new Error("Z3 worker pool unavailable in this environment");if(Bo(kn.poolSize)<=0)throw new Error("Z3 worker pool disabled");Fr.length===0&&Fr.push(A4());const e=Fr[H2%Fr.length];return H2++,e}function I4(){Cl&&(kn.idleTimeoutMs<=0||(Hh&&clearTimeout(Hh),Hh=setTimeout(()=>{const t=Bo(kn.poolSize);for(;Fr.length>t;){const e=Fr.pop();try{e.terminate()}catch{}}},kn.idleTimeoutMs)))}function Uo(t,...e){const n=k9(),r=x9++;return new Promise((i,s)=>{const l=setTimeout(()=>{Ka.delete(r),s(new Error(`Z3 worker operation "${t}" timed out after ${kn.solverTimeoutMs}ms`))},kn.solverTimeoutMs||1e4);Ka.set(r,{resolve:u=>{clearTimeout(l),i(u)},reject:u=>{clearTimeout(l),s(u)}});try{n.postMessage({id:r,op:t,args:e})}catch(u){clearTimeout(l),Ka.delete(r),s(u);return}I4()})}function cp(){return Bo(kn.poolSize)}function up(){return Cl&&Sg&&Bo(kn.poolSize)>0}function b9(){return Sg}const C9=t=>Uo("parseBooleanExpr",t),dp=(t,e,n)=>Uo("evaluateBooleanPredicate",t,e),E9=(t,e,n)=>Uo("evaluateArithmeticWithBindings",t,e),T9=(t,e)=>Uo("evaluateAction",t,e),N9=(t,e)=>Uo("solveEquation",t,e),P9=(t,e,n)=>Uo("solveInequality",t,e,n),Qa=Object.freeze(Object.defineProperty({__proto__:null,evaluateAction:T9,evaluateArithmeticWithBindings:E9,evaluateBooleanPredicate:dp,getConfiguredPoolSize:cp,isSharedArrayBufferAvailable:b9,isWorkerPoolEnabled:up,parseBooleanExpr:C9,setZ3WorkerConfig:S9,solveEquation:N9,solveInequality:P9},Symbol.toStringTag,{value:"Module"})),Yh=async(t,e,n)=>{try{if((typeof up=="function"?up():!1)&&typeof dp=="function")try{return await dp(t,e,n)}catch{}}catch{}return Lw(t,e,n)},Y2=t=>JSON.parse(JSON.stringify(t||{places:[],transitions:[],arcs:[]})),M9=(t,e)=>{const n=new Set,r=l=>{if(l)switch(l.type){case"boolVar":case"pairVar":n.add(l.name);break;case"and":case"or":r(l.left),r(l.right);break;case"not":r(l.expr);break;case"cmp":i(l.left),i(l.right);break}},i=l=>{l&&(l.type==="var"||l.type==="boolVar"||l.type==="pairVar"?n.add(l.name):l.type==="bin"?(i(l.left),i(l.right)):l.type==="pairLit"&&(i(l.fst),i(l.snd)))};r(t);const s=new Set(Object.keys(e||{}));return Array.from(n).filter(l=>!s.has(l))},X2=t=>{try{const e=Array.isArray(t==null?void 0:t.transitions)?t.transitions.slice():[],n=Array.isArray(t==null?void 0:t.arcs)?t.arcs.slice():[];e.sort((s,l)=>String(s.id).localeCompare(String(l.id))),n.sort((s,l)=>String(s.id).localeCompare(String(l.id)));const r=e.map(s=>`${s.id}|g:${String(s.guard||"")}|a:${String(s.action||"")}`).join(";"),i=n.map(s=>`${s.id}|b:${Array.isArray(s.bindings)?s.bindings.join(","):s.binding?String(s.binding):""}`).join(";");return`${r}||${i}`}catch{return String(Math.random())}};class A9 extends E4{constructor(){super(),this.lastEnabledTransitions=[],this.cache={guardAstByTransition:new Map,bindingAstsByArc:new Map},this._cacheSignature=null,this._config={maxTokensPerPlace:1/0},this._enabledCache=new Map}getType(){return"algebraic"}async initializeSpecific(e,n={}){this.lastEnabledTransitions=[],this._enabledCache.clear(),this._cacheSignature=null,this.petriNet=Y2(e),n&&typeof n.maxTokensPerPlace=="number"&&n.maxTokensPerPlace>=0?this._config.maxTokensPerPlace=n.maxTokensPerPlace|0:this._config.maxTokensPerPlace=1/0,await this.buildCaches(),await this.checkTransitionStateChanges()}async buildCaches(){this.cache.guardAstByTransition.clear(),this.cache.bindingAstsByArc.clear(),this.cache.guardAstByTransition=p9(this.petriNet,Vt,Lo,Iw),this.cache.bindingAstsByArc=m9(this.petriNet,x4,Vt,Lo,h9),this._cacheSignature=X2(this.petriNet)}getStatus(){var e,n,r;return{isInitialized:this.isInitialized,hasPyodide:!1,hasSimulator:!0,hasPetriNet:!!this.petriNet,simulationMode:this.simulationMode,petriNetSize:this.petriNet?{places:((e=this.petriNet.places)==null?void 0:e.length)||0,transitions:((n=this.petriNet.transitions)==null?void 0:n.length)||0,arcs:((r=this.petriNet.arcs)==null?void 0:r.length)||0}:null}}async setSimulationMode(e){if(e==="single"||e==="maximal")this.simulationMode=e;else throw new Error("Mode must be 'single' or 'maximal'")}_outputBindingsTypeCompatible(e,n){return d9(this.petriNet,this.cache,e,n)}_invalidateEnabledCache(e){if(!e||e.size===0)return;const n=this.petriNet.arcs||[];for(const r of n){const i=r.sourceId||r.source;if((r.type==="place-to-transition"||r.sourceType==="place")&&e.has(i)){const l=String(r.targetId||r.target);this._enabledCache.delete(l)}}}_clearEnabledCache(){this._enabledCache.clear()}async updateSpecific(e){const r=X2(e)!==this._cacheSignature;this.petriNet=Y2(e),r&&await this.buildCaches(),this._clearEnabledCache(),await this.checkTransitionStateChanges()}async getEnabledTransitionsSpecific(){const e=Array.isArray(this.petriNet.transitions)?this.petriNet.transitions:[];if(e.length===0)return[];const n=[];for(let i=0;i<e.length;i++){const s=String(e[i].id);this._enabledCache.has(s)||n.push(e[i])}if(n.length>0){const i=typeof cp=="function"?Number(cp()||0):0,s=Math.max(1,Math.min(n.length,i>0?i:1));if(s<=1)for(const l of n)try{const u=await this.isTransitionEnabled(l.id);this._enabledCache.set(String(l.id),u)}catch{this._enabledCache.set(String(l.id),!1)}else{const l=new Array(n.length).fill(!1);let u=0;const c=async()=>{for(;;){const p=u++;if(p>=n.length)break;const m=n[p];try{const w=await this.isTransitionEnabled(m.id);l[p]=w}catch{}}},f=Array.from({length:s},()=>c());await Promise.all(f);for(let p=0;p<n.length;p++)this._enabledCache.set(String(n[p].id),l[p])}}const r=[];for(const i of e){const s=String(i.id);this._enabledCache.get(s)===!0&&r.push(s)}return r}async checkForUnboundVariables(e,n){return y9(this.petriNet,this.cache.bindingAstsByArc,this.cache.guardAstByTransition,e,n)}extractVariablesFromPattern(e){return P4(e)}extractVariablesFromExpression(e){return M4(e)}async isTransitionEnabled(e){if(!this.isInitialized)return!1;const n=(this.petriNet.transitions||[]).find(c=>c.id===e);if(!n)return!1;const r=(this.petriNet.arcs||[]).filter(c=>(c.targetId===e||c.target===e)&&(c.sourceType==="place"||!c.sourceType));if(r.length===0)return!0;if(await this.checkForUnboundVariables(e,r))return _e.debug("Transition disabled due to unbound variables:",e),!1;const s=this.cache.guardAstByTransition.get(e),l=Object.fromEntries((this.petriNet.places||[]).map(c=>[c.id,c])),u=await $2({transition:n,inputArcs:r,placesById:l,bindingAstsByArc:this.cache.bindingAstsByArc,guardAst:s,parseArithmetic:Vt,evaluateBooleanPredicate:Yh,matchPattern:D2,getTokensForPlace:z2,evaluateArithmeticWithBindings:pr,evaluateBooleanWithBindings:Co,evaluatePatternLiteral:Lr,maxTokensPerPlace:this._config.maxTokensPerPlace});return u?this._outputBindingsTypeCompatible(e,u.env||{}):!1}async stepSimulationSpecific(){return this.getCurrentState()}async fireTransitionSpecific(e,n={}){const r=n.skipEnabledCheck||!1,i=r?[]:await this.getEnabledTransitionsSpecific(),s=(this.petriNet.transitions||[]).find(x=>x.id===e);if(!s)return this.getCurrentState();const l=(this.petriNet.arcs||[]).filter(x=>(x.targetId===e||x.target===e)&&(x.sourceType==="place"||!x.sourceType)),u=(this.petriNet.arcs||[]).filter(x=>(x.sourceId===e||x.source===e)&&(x.targetType==="place"||!x.targetType)),c=Object.fromEntries((this.petriNet.places||[]).map(x=>[x.id,x])),f=this.cache.guardAstByTransition.get(e),p=await $2({transition:s,inputArcs:l,placesById:c,bindingAstsByArc:this.cache.bindingAstsByArc,guardAst:f,parseArithmetic:Vt,evaluateBooleanPredicate:Yh,matchPattern:D2,getTokensForPlace:z2,evaluateArithmeticWithBindings:pr,evaluateBooleanWithBindings:Co,evaluatePatternLiteral:Lr,maxTokensPerPlace:this._config.maxTokensPerPlace});if(!p)throw new Error(`Transition ${e} is not enabled`);let m=p.env||{};const w=p.picks||[];if(f&&M9(f,m).length>0)try{if(!await Yh(f,m,Vt))throw new Error("Guard unsatisfied under any extension")}catch{}const y=new Set;for(const x of w)y.add(x.srcId);for(const x of u)y.add(x.targetId||x.target);if(N4(w,c),l9(u,this.cache.bindingAstsByArc,m,c,{evaluateArithmeticWithBindings:pr,evaluateBooleanWithBindings:Co,evaluatePatternLiteral:Lr,parseArithmetic:Vt}),s.action&&typeof s.action=="string")try{const x=jw(s.action,m,Vt)}catch{}if(this._invalidateEnabledCache(y),!r){await this.checkTransitionStateChanges();const x=this.getCurrentState();this.emitTransitionFired({transitionId:e,newPetriNet:x});const b=await this.getEnabledTransitionsSpecific();return this.emitTransitionsChanged({enabled:b,previouslyEnabled:i}),x}return this.getCurrentState()}getCurrentState(){return v9(this.petriNet)}async checkTransitionStateChanges(){if(this.isInitialized)try{const e=await this.getEnabledTransitionsSpecific();if(JSON.stringify([...e].sort())!==JSON.stringify([...this.lastEnabledTransitions].sort())){const r=[...this.lastEnabledTransitions];this.lastEnabledTransitions=[...e],this.emitTransitionsChanged({enabled:e,previouslyEnabled:r})}}catch{}}resetSpecific(){this.lastEnabledTransitions=[],this.cache.guardAstByTransition.clear(),this.cache.bindingAstsByArc.clear(),this._cacheSignature=null,this._config.maxTokensPerPlace=1/0,this._clearEnabledCache()}}class I9{static createSimulator(e){switch(e){case"pt":return new u9;case"algebraic":return new A9;default:throw new Error(`Unknown net mode: ${e}`)}}static getAvailableTypes(){return["pt","algebraic"]}static isSupported(e){return this.getAvailableTypes().includes(e)}}const K2=async()=>{try{await new Promise(t=>setTimeout(t,0))}catch{}try{typeof requestAnimationFrame<"u"&&await new Promise(t=>requestAnimationFrame(()=>t()))}catch{}},L9=t=>{const e=new Set;if(!t||!Array.isArray(t.transitions))return e;const n=Array.isArray(t.arcs)?t.arcs:[],r=Array.isArray(t.places)?t.places:[],i=new Set(r.map(s=>String(s.id)));for(const s of t.transitions){const l=String(s.id);let u=!1,c=!1;for(const f of n){const p=String(f.sourceId||f.source),m=String(f.targetId||f.target);if(m===l&&p!==l&&i.has(p)&&(u=!0),p===l&&m!==l&&i.has(m)&&(c=!0),u&&c)break}!u&&!c&&e.add(l)}return e},R9=(t,e,n)=>{const r=new Map;for(const u of t)r.set(u,new Set);for(const u of e||[]){const c=u.targetId||u.target,f=u.sourceId||u.source;(u.type==="place-to-transition"||u.sourceType==="place")&&r.has(c)&&r.get(c).add(f)}const i=t.slice();for(let u=i.length-1;u>0;u--){const c=Math.random()*(u+1)|0,f=i[u];i[u]=i[c],i[c]=f}const s=new Set,l=[];for(const u of i){const c=r.get(u)||new Set;let f=!0;for(const p of c)if(s.has(p)){f=!1;break}if(f){l.push(u);for(const p of c)s.add(p);if(n>0&&l.length>=n)break}}return l},j9=(t=[])=>t.map(e=>{if(typeof e=="string")return e;if(e&&typeof e=="object"){if(e.id)return e.id;if(e.get)return e.get("id")}return String(e)}).filter(Boolean),F9=async({simulator:t,mode:e="single",maxSteps:n=1e5,timeBudgetMs:r=3e4,yieldEvery:i=100,onProgress:s,shouldCancel:l,batchMax:u=0,progressEveryMs:c=0,yieldEveryMs:f=0})=>{const p=typeof performance<"u"&&performance.now?()=>performance.now():()=>Date.now(),m=p();let w=0,y=m,x=m,b=-1;const _=E=>{if(!s)return;const N=E-m,I=c>0?Math.floor(N/c):0;if(I!==b){b=I;try{s({steps:w,elapsedMs:N})}catch{}}},S=L9(t.petriNet||{}),T=async()=>{const E=await t.getEnabledTransitions();return j9(E).filter(I=>!S.has(String(I)))},h=async()=>{if(l&&l())return!1;const E=p(),N=E-m;if(i>0&&w%i===0){const I=p();_(I),await K2();const M=p();return x=M,y=M,c>0&&_(M),!(r>0&&M-m>r||l&&l())}if(c>0&&E-y>=c&&(_(E),y=E),f>0&&E-x>=f){await K2();const I=p();if(x=I,c>0&&I-y>=c&&(_(I),y=I),r>0&&I-m>r||l&&l())return!1}return!(r>0&&N>r||l&&l())};let k=!0;for(;k&&w<n&&!(l&&l());){const E=await T();if(!E||E.length===0)break;if(e==="maximal"){const N=t.petriNet||{},I=u>0?u:Number.POSITIVE_INFINITY;let M=R9(E,N.arcs||[],I);if(!M||M.length===0){const L=E[Math.floor(Math.random()*E.length)];M=L?[L]:[]}if(l&&l()){k=!1;break}await Promise.all(M.map(L=>t.fireTransition(L,{skipEnabledCheck:!0}))),w+=M.length,k=await h()}else{const N=E[Math.floor(Math.random()*E.length)];await t.fireTransition(N),w+=1,k=await h()}}if(s)try{s({steps:w,elapsedMs:p()-m})}catch{}return{petriNet:t.petriNet||null,steps:w}},Q2=(t,e={})=>{_e.debug("determineNetMode called with:",{petriNet:t,options:e});const n=(e==null?void 0:e.netMode)||(t==null?void 0:t.netMode);if(_e.debug("Found netMode from options/petriNet:",n),n){const r=n==="algebraic-int"?"algebraic":n;return _e.debug("Using configured netMode:",r),r}return _e.debug("No configured netMode, detecting from content"),L4(t)},L4=t=>{const e=t||{},n=Array.isArray(e.transitions)?e.transitions:[],r=Array.isArray(e.arcs)?e.arcs:[],i=Array.isArray(e.places)?e.places:[];_e.debug("Net mode detection:",{places:i,transitions:n,arcs:r});for(const s of n){if(typeof s.guard=="string"&&s.guard.trim().length>0)return _e.debug("Found guard, using algebraic mode"),"algebraic";if(typeof s.action=="string"&&s.action.trim().length>0)return _e.debug("Found action, using algebraic mode"),"algebraic"}for(const s of r){const l=Array.isArray(s.bindings)?s.bindings:s.binding?[s.binding]:[];if(_e.debug("Checking arc bindings:",l),l.some(c=>typeof c=="string"&&(/:[ ]*(integer|boolean)/i.test(c)||c==="T"||c==="F"||/[+\-*/()]/.test(c))))return _e.debug("Found algebraic binding, using algebraic mode"),"algebraic"}return i.some(s=>Array.isArray(s.valueTokens)&&s.valueTokens.length>0)?(_e.debug("Found valueTokens, using algebraic mode"),"algebraic"):(_e.debug("Using P/T mode"),"pt")};class O9{constructor(){this.currentSimulator=null,this._ready=!1,this.netMode=null,this.eventBus=null,this.pendingListeners=new Map}async initialize(e,n={}){try{_e.debug("SimulatorCore.initialize called with:",{petriNet:e,options:n});const r=Q2(e,n);return this.currentSimulator=I9.createSimulator(r),this.netMode=r,this.eventBus&&this.currentSimulator.setEventBus(this.eventBus),await this.currentSimulator.initialize(e,n),this._ready=!0,this.setupPendingListeners(),_e.debug(`Simulator initialized with ${r} simulator`),{success:!0,netMode:r,simulatorType:this.currentSimulator.getType()}}catch(r){throw console.error("Failed to initialize simulator:",r),this._ready=!1,this.currentSimulator=null,r}}async update(e){if(!this.currentSimulator)return{success:!0};try{return await this.currentSimulator.update(e),{success:!0}}catch(n){throw console.error("Failed to update simulator:",n),n}}async getEnabledTransitions(){if(!this.currentSimulator)return[];try{return await this.currentSimulator.getEnabledTransitions()}catch(e){return console.error("Failed to get enabled transitions:",e),[]}}async fireTransition(e){if(!this.currentSimulator)throw new Error("Simulator not initialized");try{return await this.currentSimulator.fireTransition(e)}catch(n){throw console.error(`Failed to fire transition ${e}:`,n),n}}async stepSimulation(){if(!this.currentSimulator)throw new Error("Simulator not initialized");try{const e=await this.currentSimulator.getEnabledTransitions();if(!e||e.length===0)return this.currentSimulator.petriNet||null;const n=e[Math.floor(Math.random()*e.length)],r=typeof n=="string"?n:n&&n.id?n.id:String(n);return await this.currentSimulator.fireTransition(r)}catch(e){throw console.error("Failed to step simulation:",e),e}}async runToCompletion({mode:e="single",maxSteps:n=1e5,timeBudgetMs:r=3e4,yieldEvery:i=100,onProgress:s,shouldCancel:l,batchMax:u=0,progressEveryMs:c=0,yieldEveryMs:f=0}={}){if(!this.currentSimulator)throw new Error("Simulator not initialized");const p=this.currentSimulator.eventBus||null;try{this.currentSimulator.setEventBus&&this.currentSimulator.setEventBus(null)}catch{}try{return this.currentSimulator.setSimulationMode&&(this.currentSimulator.simulationMode=e),await F9({simulator:this.currentSimulator,mode:e,maxSteps:n,timeBudgetMs:r,yieldEvery:i,onProgress:s,shouldCancel:l,batchMax:u,progressEveryMs:c,yieldEveryMs:f})}finally{try{this.currentSimulator.setEventBus&&this.currentSimulator.setEventBus(p)}catch{}}}reset(){this.currentSimulator&&this.currentSimulator.reset(),this.currentSimulator=null,this._ready=!1,this.netMode=null,this.pendingListeners.clear()}deactivateSimulation(){this._active=!1}activateSimulation(e=!1){if(!this.currentSimulator)throw new Error("Simulator not initialized");_e.debug(`Simulation activated (continuous: ${e})`)}async isReady(){return this._ready&&this.currentSimulator&&this.currentSimulator.isReady()}getSimulatorStatus(){var e;return{isReady:this._ready,netMode:this.netMode,simulatorType:((e=this.currentSimulator)==null?void 0:e.getType())||"none",simulatorStatus:{simulator:this.currentSimulator}}}getSimulatorType(){var e;return((e=this.currentSimulator)==null?void 0:e.getType())||"none"}getSimulationMode(){var e;return((e=this.currentSimulator)==null?void 0:e.simulationMode)||"single"}setSimulationMode(e){this.currentSimulator&&(this.currentSimulator.simulationMode=e)}setEventBus(e){this.eventBus=e,this.currentSimulator&&this.currentSimulator.setEventBus(e)}__queueListener(e,n){this.pendingListeners.has(e)||this.pendingListeners.set(e,[]),this.pendingListeners.get(e).push(n)}setupPendingListeners(){if(!(!this.currentSimulator||!this.eventBus)){for(const[e,n]of this.pendingListeners)for(const r of n)this.eventBus.on(e,r);this.pendingListeners.clear()}}determineNetMode(e,n){return Q2(e,n)}detectNetModeFromContent(e){return L4(e)}}const Ai=new O9;function D9(){try{return typeof window>"u"||typeof Worker>"u"||typeof process<"u"&&process.env&&{}.JEST_WORKER_ID?null:new Worker(new URL(""+new URL("simulation.worker-04867299.js",import.meta.url).href,self.location),{type:"module"})}catch(t){return console.error("Failed to create simulation worker:",t),null}}var z9="Expected a function",Z2=0/0,B9="[object Symbol]",U9=/^\s+|\s+$/g,G9=/^[-+]0x[0-9a-f]+$/i,V9=/^0b[01]+$/i,W9=/^0o[0-7]+$/i,$9=parseInt,H9=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Y9=typeof self=="object"&&self&&self.Object===Object&&self,X9=H9||Y9||Function("return this")(),K9=Object.prototype,Q9=K9.toString,Z9=Math.max,q9=Math.min,Xh=function(){return X9.Date.now()};function J9(t,e,n){var r,i,s,l,u,c,f=0,p=!1,m=!1,w=!0;if(typeof t!="function")throw new TypeError(z9);e=q2(e)||0,fp(n)&&(p=!!n.leading,m="maxWait"in n,s=m?Z9(q2(n.maxWait)||0,e):s,w="trailing"in n?!!n.trailing:w);function y(N){var I=r,M=i;return r=i=void 0,f=N,l=t.apply(M,I),l}function x(N){return f=N,u=setTimeout(S,e),p?y(N):l}function b(N){var I=N-c,M=N-f,L=e-I;return m?q9(L,s-M):L}function _(N){var I=N-c,M=N-f;return c===void 0||I>=e||I<0||m&&M>=s}function S(){var N=Xh();if(_(N))return T(N);u=setTimeout(S,b(N))}function T(N){return u=void 0,w&&r?y(N):(r=i=void 0,l)}function h(){u!==void 0&&clearTimeout(u),f=0,r=c=i=u=void 0}function k(){return u===void 0?l:T(Xh())}function E(){var N=Xh(),I=_(N);if(r=arguments,i=this,c=N,I){if(u===void 0)return x(c);if(m)return u=setTimeout(S,e),y(c)}return u===void 0&&(u=setTimeout(S,e)),l}return E.cancel=h,E.flush=k,E}function fp(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function e7(t){return!!t&&typeof t=="object"}function t7(t){return typeof t=="symbol"||e7(t)&&Q9.call(t)==B9}function q2(t){if(typeof t=="number")return t;if(t7(t))return Z2;if(fp(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=fp(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(U9,"");var n=V9.test(t);return n||W9.test(t)?$9(t.slice(2),n?2:8):G9.test(t)?Z2:+t}var n7=J9;const r7=xl(n7),i7=({elements:t,netMode:e,simulatorCore:n,setElements:r,updateHistory:i,setEnabledTransitionIds:s,setIsSimulatorReady:l,setSimulationError:u,latestElementsRef:c,forceResetCounter:f})=>{O.useEffect(()=>{c.current=t},[t,c]),O.useEffect(()=>{try{n.setEventBus(Ca)}catch{}},[n]),O.useEffect(()=>{(async()=>{var x,b;if(!(t&&t.places&&t.transitions&&t.arcs&&t.places.length>0&&t.transitions.length>0&&t.arcs.length>0)){try{await((x=n.deactivateSimulation)==null?void 0:x.call(n)),await((b=n.reset)==null?void 0:b.call(n)),s([]),l(!1),u(null)}catch(_){_e.error("Failed to reset simulator:",_)}return}try{_e.debug("Simulator force reset counter:",f),_e.debug("Initializing/updating simulator",{elements:t,netMode:e}),await n.initialize(t,{netMode:e})}catch(_){_e.error("Failed to initialize simulator:",_),s([]),l(!1);return}try{await n.update(c.current)}catch(_){_e.error("Failed to update simulator:",_),s([]),l(!1),u("Failed to update simulator");return}try{if(n.isReady&&await n.isReady()){const _=await n.getEnabledTransitions();s(_||[]),l(_&&_.length>0)}else{const _=a9(c.current),S=(_==null?void 0:_.enabledTransitions)||[];s(S),l(S.length>0)}u(_=>_==="Failed to update simulator"?null:_)}catch(_){_e.error("Failed to compute enabled transitions:",_),s([]),l(!1),u("Failed to update simulator")}})()},[t,e,n,f,s,l,u,c]),O.useEffect(()=>{const w=x=>{s(x.enabled||[]),l(x.hasEnabled);try{typeof window<"u"&&(window.__ENABLED_TRANSITIONS__=Array.isArray(x.enabled)?x.enabled:[])}catch{}},y=x=>{try{typeof window<"u"&&(window.__LAST_FIRED_TRANSITION_ID__=x.transitionId||null)}catch{}x.newPetriNet&&(r(x.newPetriNet),c.current=x.newPetriNet,i&&i(x.newPetriNet,!0))};return Ca.on(vo.transitionsChanged,w),Ca.on(vo.transitionFired,y),()=>{Ca.off(vo.transitionsChanged,w),Ca.off(vo.transitionFired,y)}},[r,i,s,l,c]),O.useEffect(()=>()=>{try{n.deactivateSimulation()}catch{}},[n]);const p=O.useCallback(async()=>{try{if(n.isReady&&await n.isReady()){const w=await n.getEnabledTransitions();s(w||[]);const y=Array.isArray(w)&&w.length>0;return l(y),w||[]}return s([]),l(!1),[]}catch(w){return console.error("Error refreshing enabled transitions:",w),u("Failed to refresh enabled transitions"),[]}},[n,s,l,u]),m=O.useMemo(()=>r7(p,100),[p]);return O.useEffect(()=>()=>{m.cancel()},[m]),{refreshEnabledTransitions:p,debouncedRefresh:m}};class s7{constructor(){this.conflictCache=new Map}areTransitionsInConflict(e,n,r,i){const s=`${e}-${n}`,l=`${n}-${e}`;if(this.conflictCache.has(s))return this.conflictCache.get(s);if(this.conflictCache.has(l))return this.conflictCache.get(l);const u=this._requiredCategories(e,i),c=this._requiredCategories(n,i);let f=!1;for(const[p,m]of u.entries()){const w=c.get(p);if(w&&(m.has("int")&&w.has("int")||m.has("bool")&&w.has("bool"))){f=!0;break}}return this.conflictCache.set(s,f),f}_requiredCategories(e,n){const r=new Map;for(const i of n){const s=i.sourceId||i.source;if(!((i.targetId||i.target)===e&&(i.sourceType==="place"||i.type==="place-to-transition")))continue;const u=Array.isArray(i.bindings)?i.bindings:i.binding?[i.binding]:[];r.has(s)||r.set(s,new Set);const c=r.get(s);for(const f of u){const p=String(f||"");/:[ ]*boolean/i.test(p)||p==="T"||p==="F"?c.add("bool"):c.add("int")}u.length===0&&c.add("int")}return r}findNonConflictingTransitions(e,n,r){if(e.length<=1)return e;this.conflictCache.clear();const i=[];for(let s=e.length;s>=1;s--){const l=this.getCombinations(e,s);for(const u of l)this.isNonConflictingSet(u,n,r)&&i.push(u);if(i.length>0)return i}return e.map(s=>[s])}isNonConflictingSet(e,n,r){for(let i=0;i<e.length;i++)for(let s=i+1;s<e.length;s++)if(this.areTransitionsInConflict(e[i].id,e[s].id,n,r))return!1;return!0}getCombinations(e,n){if(n===0)return[[]];if(n>e.length)return[];const r=[],i=(s,l)=>{if(l.length===n){r.push([...l]);return}for(let u=s;u<e.length;u++)l.push(e[u]),i(u+1,l),l.pop()};return i(0,[]),r}getInputPlaces(e,n,r){const i=[];for(const s of r){const l=s.sourceId||s.source,u=s.targetId||s.target;if(s.sourceType==="place"&&u===e||s.type==="place-to-transition"&&u===e){const f=n.find(p=>p.id===l);f&&i.push(f)}}return i}getOutputPlaces(e,n,r){const i=[];for(const s of r){const l=s.sourceId||s.source,u=s.targetId||s.target;if(s.targetType==="place"&&l===e||s.type==="transition-to-place"&&l===e){const f=n.find(p=>p.id===u);f&&i.push(f)}}return i}clearCache(){this.conflictCache.clear()}getCacheStats(){return{size:this.conflictCache.size,keys:Array.from(this.conflictCache.keys())}}}const o7=1e3,Ou=t=>(t||[]).map(e=>typeof e=="string"?e:e&&typeof e=="object"?e.id??(e.get?e.get("id"):void 0):String(e)).filter(Boolean),R4=t=>(t.current||(t.current=new s7),t.current),a7=({simulatorCore:t,setElements:e,updateHistory:n,clearError:r,refreshEnabledTransitions:i,setSimulationError:s,latestElementsRef:l})=>async u=>{try{if(t.getSimulatorType&&t.getSimulatorType()==="none")throw new Error("Simulator not initialized. Please wait for initialization to complete.");await t.activateSimulation(!1);const c=await t.fireTransition(u);if(!c||typeof c!="object")throw new Error("Invalid Petri net returned from simulator");if(!c.places||!Array.isArray(c.places)||!c.transitions||!Array.isArray(c.transitions)||!c.arcs||!Array.isArray(c.arcs))throw new Error("Incomplete Petri net structure returned from simulator");const f=JSON.parse(JSON.stringify(c));e(f),l.current=f,n&&n(f,!0),r(),await i(),setTimeout(()=>{try{t.activateSimulation()}catch{}},50)}catch(c){console.error(`Error firing transition ${u}:`,c),s(c.message||`Failed to fire transition ${u}.`)}},l7=({simulatorCore:t,handleFireTransition:e,conflictResolverRef:n,latestElementsRef:r,refreshEnabledTransitions:i,setSimulationError:s,stopAllSimulations:l})=>async()=>{var u,c;try{if(t.getSimulatorType&&t.getSimulatorType()==="none")throw new Error("Simulator not initialized. Please wait for initialization to complete.");let f="single";try{f=t.getSimulationMode?t.getSimulationMode():"single"}catch{}if(f==="maximal"){const y=await t.getEnabledTransitions();if(!y||y.length===0)return;const x=R4(n),b=Ou(y).map(k=>({id:k})),_=x.findNonConflictingTransitions(b,((u=r.current)==null?void 0:u.places)||[],((c=r.current)==null?void 0:c.arcs)||[]),S=Array.isArray(_)?_:Array.from(_||[]),T=S.length?S[Math.floor(Math.random()*S.length)]:[],h=Array.isArray(T)?T:T?[T]:[];for(const k of h)await e(k.id);await i();return}const p=await t.getEnabledTransitions();if(!p||p.length===0)return;const m=Ou(p),w=m[Math.floor(Math.random()*m.length)];await e(w)}catch(f){console.error("Error in step simulation:",f),s("Error during simulation step: "+(f.message||"Unknown error")),l()}},c7=t=>new Promise(e=>setTimeout(e,t)),u7=({simulatorCore:t,isContinuousSimulatingRef:e,isRunningRef:n,setIsContinuousSimulating:r,setEnabledTransitionIds:i,stepSimulation:s,refreshEnabledTransitions:l,setSimulationError:u,simulationSettings:c={}})=>async()=>{if(!(e.current||n.current))try{await t.activateSimulation();const f=await t.getEnabledTransitions();if(!f||f.length===0)return;r(!0),e.current=!0;const p=Ou(f);i(p);const m=c.animationDelayMs??o7;for(;e.current;){await s();const w=await l();if(!w||w.length===0)break;await c7(m)}}catch(f){console.error("Error starting continuous simulation:",f),u("Failed to start continuous simulation")}finally{e.current=!1,r(!1);try{t.deactivateSimulation()}catch{}}},d7=(t,e)=>{const n=Number(t);return!Number.isFinite(n)||n<=0?null:Math.max(1,Math.min(e,Math.floor(n)))},f7=()=>{try{const t=window.__Z3_SETTINGS__||{};return{poolSize:Number.isFinite(Number(t.poolSize))?Number(t.poolSize):0,idleTimeoutMs:t.idleTimeoutMs,prewarmOnAlgebraicMode:t.prewarmOnAlgebraicMode,solverTimeoutMs:t.solverTimeoutMs}}catch{return{poolSize:0}}},h7=({simulationSettings:t})=>{let e=!1;try{e=!!window.__PETRI_NET_NON_VISUAL_RUN__}catch{}const n=typeof window<"u"&&window.__PETRI_NET_SETTINGS__?window.__PETRI_NET_SETTINGS__:{};!e&&(t!=null&&t.useNonVisualRun)&&(e=!0);const r=t==null?void 0:t.batchMode,i=r!==void 0?!!r:!!(n!=null&&n.batchMode);i&&(e=!0);const s=!!((t==null?void 0:t.limitIterations)??(n==null?void 0:n.limitIterations)),l=d7((t==null?void 0:t.maxIterations)??(n==null?void 0:n.maxIterations),1e6);return{useNonVisual:e,batchMode:i,limitIterationsFlag:s,maxIterations:l}},p7=({simulatorCore:t,isContinuousSimulatingRef:e,isRunningRef:n,setIsRunning:r,setIsContinuousSimulating:i,refreshEnabledTransitions:s,simulationSettings:l,ensureWorker:u,setElements:c,latestElementsRef:f,updateHistory:p,setSimulationError:m,conflictResolverRef:w,elements:y,handleFireTransition:x,setCompletionStats:b,netMode:_})=>async()=>{if(!(e.current||n.current))try{await t.activateSimulation(!1),r(!0),i(!1),n.current=!0,await s();const{useNonVisual:S,batchMode:T,limitIterationsFlag:h,maxIterations:k}=h7({simulationSettings:l}),E=2e5,N=h?k??E:E;let I=null,M=!1;const L=async G=>{try{if(I||(I=f7()),Number(I.poolSize||0)>=G)return;(await ri(()=>Promise.resolve().then(()=>Qa),void 0,import.meta.url)).setZ3WorkerConfig({...I,poolSize:G}),M=!0}catch{}},A=async()=>{if(M){try{(await ri(()=>Promise.resolve().then(()=>Qa),void 0,import.meta.url)).setZ3WorkerConfig(I||{})}catch{}M=!1}};let F=!1;if(T){if(!(await ri(()=>Promise.resolve().then(()=>Qa),void 0,import.meta.url)).isSharedArrayBufferAvailable()){const B="SharedArrayBuffer not available. This is required for batch mode. Please ensure COOP/COEP headers are set correctly (service worker should handle this). Try refreshing the page.";console.error(B),m(B),n.current=!1,r(!1);return}await L(8);const z=await u();if(z)try{let B="single";try{B=t.getSimulationMode?t.getSimulationMode():"single"}catch{}const j=setTimeout(()=>{z.removeEventListener("message",$),z.removeEventListener("error",X);const ee="Simulation worker timed out after 5 minutes. This may indicate that Z3 workers are not responding. Check browser console for errors.";console.error(ee),m(ee),A(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}},5*60*1e3),$=async ee=>{const{op:ne,payload:Z}=ee.data||{};if(ne==="done"){clearTimeout(j),z.removeEventListener("message",$),z.removeEventListener("error",X),Z&&Z.elements&&typeof Z.elements=="object"&&(c(Z.elements),f.current=Z.elements,p&&p(Z.elements,!0)),await A(),await s(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}Z!=null&&Z.stats&&b({elapsedMs:Z.stats.elapsedMs,transitionsFired:Z.stats.steps?Z.stats.steps.toLocaleString():"0"})}else ne==="error"&&(clearTimeout(j),z.removeEventListener("message",$),z.removeEventListener("error",X),m((Z==null?void 0:Z.message)||"Worker error"),await A(),n.current=!1,r(!1))},X=ee=>{clearTimeout(j),z.removeEventListener("message",$),z.removeEventListener("error",X);const ne=`Worker error: ${ee.message||"Unknown error"}. This may indicate that Z3 workers failed to initialize.`;console.error(ne,ee),m(ne),A(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}};z.addEventListener("message",$),z.addEventListener("error",X),z.postMessage({op:"start",payload:{elements:f.current,simOptions:{netMode:_},run:{mode:B,batchMax:0,maxSteps:N,timeBudgetMs:0,yieldEvery:5e3,progressEveryMs:0,yieldEveryMs:0},z3:typeof window<"u"?window.__Z3_SETTINGS__||{}:{}}}),F=!0}catch(B){console.error("Worker run failed, falling back to in-thread run:",B),m(`Worker initialization failed: ${B.message}. Falling back to in-thread execution.`),await A()}else{const B="Failed to create simulation worker. SharedArrayBuffer may not be available.";console.error(B),m(B),n.current=!1,r(!1);return}}if(F)return;if(S&&typeof t.runToCompletion=="function"){let G="single";try{G=t.getSimulationMode?t.getSimulationMode():"single"}catch{}const z=()=>{try{return!!window.__PETRI_NET_CANCEL_RUN__}catch{return!1}},B=performance.now?performance.now():Date.now();try{const j=await t.runToCompletion({mode:G,maxSteps:N,timeBudgetMs:0,yieldEvery:5e3,progressEveryMs:0,yieldEveryMs:0,onProgress:()=>{},shouldCancel:z,batchMax:0}),$=performance.now?performance.now():Date.now(),X=Math.round($-B);j&&j.petriNet&&typeof j.petriNet=="object"&&(c(j.petriNet),f.current=j.petriNet,p&&p(j.petriNet,!0)),b({elapsedMs:X,transitionsFired:j!=null&&j.steps?j.steps.toLocaleString():"0"})}finally{await A(),await s(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}}return}let D=N;const U=R4(w),W=async()=>{if(!n.current){r(!1);return}if(D<=0){n.current=!1,r(!1);return}try{const G=await t.getEnabledTransitions();if(!G||G.length===0){n.current=!1,r(!1);return}const z=Ou(G).map(ee=>({id:ee})),B=U.findNonConflictingTransitions(z,y.places||[],y.arcs||[]),j=Array.isArray(B)?B:Array.from(B||[]),$=j.length?j[Math.floor(Math.random()*j.length)]:[],X=Array.isArray($)?$:$?[$]:[];for(const ee of X){if(D<=0)break;await x(ee.id),D-=1}if(D<=0){n.current=!1,r(!1);return}setTimeout(W,50)}catch(G){console.error("Error in run simulation:",G),m(G.message||"Error during simulation run"),n.current=!1,r(!1)}};W()}catch(S){console.error("Error starting run simulation:",S),m("Failed to start run simulation")}},g7=(t,e,n,r,i={},s)=>{const[l,u]=O.useState(!1),[c,f]=O.useState(!1),[p,m]=O.useState([]),[w,y]=O.useState(null),[x,b]=O.useState(!1),[_,S]=O.useState(0),[T,h]=O.useState(null),k=O.useRef(!1),E=O.useRef(!1),N=O.useRef(t),I=O.useRef(null),M=O.useRef(null),L=s||Ai,A=O.useCallback(async()=>{if(M.current)return M.current;try{const ee=D9();return M.current=ee,ee}catch(ee){return console.error("Failed to create simulation worker:",ee),null}},[]),{refreshEnabledTransitions:F,debouncedRefresh:D}=i7({elements:t,netMode:r,simulatorCore:L,setElements:e,updateHistory:n,setEnabledTransitionIds:m,setIsSimulatorReady:b,setSimulationError:y,latestElementsRef:N,forceResetCounter:_});O.useEffect(()=>{N.current=t},[t]);const U=O.useCallback(()=>{y(null)},[]),W=O.useCallback(()=>{_e.debug("Forcing simulator reset"),S(ee=>ee+1)},[]),G=O.useCallback(()=>{var ee,ne;u(!1),f(!1),k.current=!1,E.current=!1;try{L.deactivateSimulation()}catch{}U(),m([]);try{(ne=(ee=M.current)==null?void 0:ee.postMessage)==null||ne.call(ee,{op:"cancel"})}catch{}},[U,L]);O.useEffect(()=>{l||c?(L.activateSimulation(),F()):(L.deactivateSimulation(),F())},[l,c,F]),O.useEffect(()=>((c||l)&&D(),()=>D.cancel()),[c,l,D]);const z=O.useMemo(()=>a7({simulatorCore:L,setElements:e,updateHistory:n,clearError:U,refreshEnabledTransitions:F,setSimulationError:y,latestElementsRef:N}),[L,e,n,U,F,y]),B=O.useMemo(()=>l7({simulatorCore:L,handleFireTransition:z,conflictResolverRef:I,latestElementsRef:N,refreshEnabledTransitions:F,setSimulationError:y,stopAllSimulations:G}),[L,z,I,F,y,G]),j=O.useMemo(()=>u7({simulatorCore:L,isContinuousSimulatingRef:k,isRunningRef:E,setIsContinuousSimulating:u,setEnabledTransitionIds:m,stepSimulation:B,refreshEnabledTransitions:F,setSimulationError:y,simulationSettings:i}),[L,k,E,u,m,B,F,y,i]),$=O.useMemo(()=>p7({simulatorCore:L,isContinuousSimulatingRef:k,isRunningRef:E,setIsRunning:f,setIsContinuousSimulating:u,refreshEnabledTransitions:F,simulationSettings:i,ensureWorker:A,setElements:e,latestElementsRef:N,updateHistory:n,setSimulationError:y,conflictResolverRef:I,elements:t,handleFireTransition:z,setCompletionStats:h,netMode:r}),[L,k,E,f,u,F,i==null?void 0:i.limitIterations,i==null?void 0:i.maxIterations,i==null?void 0:i.batchMode,i==null?void 0:i.useNonVisualRun,A,e,N,n,y,I,t,z,h,r]),X=O.useCallback(()=>{h(null)},[]);return{isContinuousSimulating:l,isRunning:c,enabledTransitionIds:p,simulationError:w,isSimulatorReady:x,handleFireTransition:z,stepSimulation:B,startContinuousSimulation:j,startRunSimulation:$,stopAllSimulations:G,clearError:U,forceSimulatorReset:W,completionStats:T,dismissCompletionDialog:X}};function J2(t){if(!t||typeof t!="object")return"pt";const e=Array.isArray(t.places)?t.places:[],n=Array.isArray(t.transitions)?t.transitions:[],r=Array.isArray(t.arcs)?t.arcs:[];return e.some(s=>Array.isArray(s.valueTokens)&&s.valueTokens.length>0||!!s.type)||n.some(s=>!!s.guard||!!s.action)||r.some(s=>Array.isArray(s.bindings)&&s.bindings.length>0||!!s.binding)?"algebraic-int":"pt"}function m7(t){const{elements:e,setElements:n,updateHistory:r,simulationSettings:i,setSimulationSettings:s,resetEditor:l,forceSimulatorReset:u,setIsLoading:c,setError:f,setSuccess:p,setIsAdtOpen:m,saveFileHandle:w,setSaveFileHandle:y,setIsMobileMenuOpen:x}=t||{},b=()=>{m&&m(!0)},_=async(N,I)=>{const M=await N.createWritable();await M.write(new Blob([I],{type:"application/xml"})),await M.close()};return{handleSave:async()=>{try{c==null||c(!0),f==null||f(null),p==null||p(null);const N={...e||{},netMode:(i==null?void 0:i.netMode)||"pt"},I=await G2(N),M="petri-net.pnml";if(typeof window<"u"&&typeof window.showSaveFilePicker=="function")try{if(w)await _(w,I);else{const A=await window.showSaveFilePicker({suggestedName:M,types:[{description:"PNML Files",accept:{"application/xml":[".pnml",".xml"],"text/xml":[".pnml",".xml"]}}],excludeAcceptAllOption:!1});await _(A,I),y==null||y(A)}}catch(A){if(A&&(A.name==="AbortError"||A.name==="SecurityError"))p==null||p("Save cancelled.");else{const F=new Blob([I],{type:"application/xml"}),D=URL.createObjectURL(F),U=document.createElement("a");U.href=D,U.download=M,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(D)}}else{const A=new Blob([I],{type:"application/xml"}),F=URL.createObjectURL(A),D=document.createElement("a");D.href=F,D.download=M,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(F)}p==null||p("Petri net saved."),x==null||x(!1)}catch(N){console.error("Error saving Petri net:",N),f==null||f(`Error saving Petri net: ${N.message}`)}finally{c==null||c(!1)}},handleSaveAs:async()=>{try{c==null||c(!0),f==null||f(null),p==null||p(null);const N={...e||{},netMode:(i==null?void 0:i.netMode)||"pt"},I=await G2(N),M="petri-net.pnml";if(typeof window<"u"&&typeof window.showSaveFilePicker=="function")try{const A=await window.showSaveFilePicker({suggestedName:M,types:[{description:"PNML Files",accept:{"application/xml":[".pnml",".xml"],"text/xml":[".pnml",".xml"]}}],excludeAcceptAllOption:!1});await _(A,I),y==null||y(A)}catch(A){if(A&&(A.name==="AbortError"||A.name==="SecurityError"))p==null||p("Save cancelled.");else{const F=new Blob([I],{type:"application/xml"}),D=URL.createObjectURL(F),U=document.createElement("a");U.href=D,U.download=M,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(D)}}else{const A=new Blob([I],{type:"application/xml"}),F=URL.createObjectURL(A),D=document.createElement("a");D.href=F,D.download=M,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(F)}p==null||p("Petri net saved."),x==null||x(!1)}catch(N){console.error("Error saving Petri net:",N),f==null||f(`Error saving Petri net: ${N.message}`)}finally{c==null||c(!1)}},handleLoad:()=>{const N=document.createElement("input");N.type="file",N.accept=".pnml,.xml";try{N.style.display="none",document.body.appendChild(N)}catch{}N.onchange=async I=>{const M=I.target.files[0];if(M)try{c==null||c(!0),f==null||f(null),p==null||p(null);const L=await new Promise((z,B)=>{const j=new FileReader;j.onload=$=>z($.target.result),j.onerror=B,j.readAsText(M)});if(!L||String(L).trim()==="")throw new Error("The selected file is empty");if(!String(L).includes("<pnml")&&!String(L).includes("<PNML"))throw new Error("The file does not appear to be a valid PNML file");const A=V2(L),F=new Promise((z,B)=>{setTimeout(()=>B(new Error("Operation timed out. The file may be too large or invalid.")),1e4)}),D=await Promise.race([A,F]);if(!D||typeof D!="object")throw new Error("Invalid data structure in the imported file");const U={places:Array.isArray(D.places)?D.places:[],transitions:Array.isArray(D.transitions)?D.transitions:[],arcs:Array.isArray(D.arcs)?D.arcs:[]},W=(U.arcs||[]).filter(z=>{if(z.source==="undefined"||z.target==="undefined"||!z.source||!z.target)return!1;const B=U.places.some($=>$.id===z.source)||U.transitions.some($=>$.id===z.source),j=U.places.some($=>$.id===z.target)||U.transitions.some($=>$.id===z.target);return B&&j});U.arcs=W.map(z=>{if(!z.type||z.type!=="place-to-transition"&&z.type!=="transition-to-place"){const B=U.places.some($=>$.id===z.source),j=U.places.some($=>$.id===z.target);return B&&!j?{...z,type:"place-to-transition"}:!B&&j?{...z,type:"transition-to-place"}:{...z,type:"place-to-transition"}}return z}),u&&u(),n==null||n(U);const G=U.netMode;if(G)s==null||s(z=>({...z||{},netMode:G}));else try{const z=J2(U);s==null||s(B=>({...B||{},netMode:z}))}catch{}r&&r(U),p==null||p(`Petri net loaded successfully with ${U.places.length} places, ${U.transitions.length} transitions, and ${U.arcs.length} arcs.`),x==null||x(!1)}catch(L){console.error("Error loading Petri net:",L),f==null||f(`Error loading Petri net: ${L.message}`)}finally{c==null||c(!1);try{N&&N.parentNode&&N.parentNode.removeChild(N)}catch{}}},N.click()},handleClear:()=>{var N,I;try{(N=Ai.deactivateSimulation)==null||N.call(Ai),(I=Ai.reset)==null||I.call(Ai)}catch{}if(l)l();else{const M={places:[],transitions:[],arcs:[]};n==null||n(M),s==null||s(L=>({...L||{},netMode:"pt"})),r&&r(M)}p==null||p("Canvas cleared successfully."),x==null||x(!1)},handleOpenAdtManager:b,handleLoadExample:async N=>{try{c==null||c(!0),f==null||f(null),p==null||p(null);const I=new URL(`./examples/${N}`,window.location.href).href,M=await fetch(I);if(!M.ok)throw new Error(`Failed to load example file: ${M.statusText}`);const L=await M.text();if(!L||String(L).trim()==="")throw new Error("The example file is empty");if(!String(L).includes("<pnml")&&!String(L).includes("<PNML"))throw new Error("The file does not appear to be a valid PNML file");const A=V2(L),F=new Promise((z,B)=>{setTimeout(()=>B(new Error("Operation timed out. The file may be too large or invalid.")),1e4)}),D=await Promise.race([A,F]);if(!D||typeof D!="object")throw new Error("Invalid data structure in the imported file");const U={places:Array.isArray(D.places)?D.places:[],transitions:Array.isArray(D.transitions)?D.transitions:[],arcs:Array.isArray(D.arcs)?D.arcs:[]},W=(U.arcs||[]).filter(z=>{if(z.source==="undefined"||z.target==="undefined"||!z.source||!z.target)return!1;const B=U.places.some($=>$.id===z.source)||U.transitions.some($=>$.id===z.source),j=U.places.some($=>$.id===z.target)||U.transitions.some($=>$.id===z.target);return B&&j});U.arcs=W.map(z=>{if(!z.type||z.type!=="place-to-transition"&&z.type!=="transition-to-place"){const B=U.places.some($=>$.id===z.source),j=U.places.some($=>$.id===z.target);return B&&!j?{...z,type:"place-to-transition"}:!B&&j?{...z,type:"transition-to-place"}:{...z,type:"place-to-transition"}}return z}),u&&u(),n==null||n(U);const G=U.netMode;if(G)s==null||s(z=>({...z||{},netMode:G}));else try{const z=J2(U);s==null||s(B=>({...B||{},netMode:z}))}catch{}r&&r(U),p==null||p(`Example "${N}" loaded successfully with ${U.places.length} places, ${U.transitions.length} transitions, and ${U.arcs.length} arcs.`),x==null||x(!1)}catch(I){console.error("Error loading example:",I),f==null||f(`Error loading example: ${I.message}`)}finally{c==null||c(!1)}}}}const Ut=[];for(let t=0;t<256;++t)Ut.push((t+256).toString(16).slice(1));function y7(t,e=0){return(Ut[t[e+0]]+Ut[t[e+1]]+Ut[t[e+2]]+Ut[t[e+3]]+"-"+Ut[t[e+4]]+Ut[t[e+5]]+"-"+Ut[t[e+6]]+Ut[t[e+7]]+"-"+Ut[t[e+8]]+Ut[t[e+9]]+"-"+Ut[t[e+10]]+Ut[t[e+11]]+Ut[t[e+12]]+Ut[t[e+13]]+Ut[t[e+14]]+Ut[t[e+15]]).toLowerCase()}let Kh;const v7=new Uint8Array(16);function x7(){if(!Kh){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Kh=crypto.getRandomValues.bind(crypto)}return Kh(v7)}const w7=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ey={randomUUID:w7};function Wi(t,e,n){var i;if(ey.randomUUID&&!e&&!t)return ey.randomUUID();t=t||{};const r=t.random??((i=t.rng)==null?void 0:i.call(t))??x7();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){if(n=n||0,n<0||n+16>e.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let s=0;s<16;++s)e[n+s]=r[s];return e}return y7(r)}function Du(t,e){const n=new Set((e||[]).filter(l=>l.type==="place"||l.type==="transition").map(l=>l.id)),r=(t.places||[]).filter(l=>n.has(l.id)),i=(t.transitions||[]).filter(l=>n.has(l.id)),s=(t.arcs||[]).filter(l=>n.has(l.source)&&n.has(l.target));return{places:r,transitions:i,arcs:s}}function zu(t,e,n){if(!t)return null;const r=new Map,i=n&&typeof n.x=="number"?n.x:(n==null?void 0:n.dx)||0,s=n&&typeof n.y=="number"?n.y:(n==null?void 0:n.dy)||0,l=[],u=(t.places||[]).map(p=>{const m=e();r.set(p.id,m);const w=typeof p.x=="number"&&isFinite(p.x)?p.x:0,y=typeof p.y=="number"&&isFinite(p.y)?p.y:0,x={...p,id:m,x:w+i,y:y+s};return l.push({id:m,type:"place"}),x}),c=(t.transitions||[]).map(p=>{const m=e();r.set(p.id,m);const w=typeof p.x=="number"&&isFinite(p.x)?p.x:0,y=typeof p.y=="number"&&isFinite(p.y)?p.y:0,x={...p,id:m,x:w+i,y:y+s};return l.push({id:m,type:"transition"}),x}),f=(t.arcs||[]).map(p=>({...p,id:e(),source:r.get(p.source),target:r.get(p.target)}));return{newPlaces:u,newTransitions:c,newArcs:f,newSelection:l}}function j4(t,e){const n=new Set(Array.isArray(e)?e.map(i=>typeof i=="string"?i:i.id):[]),r={...t};return r.places=(t.places||[]).filter(i=>!n.has(i.id)),r.transitions=(t.transitions||[]).filter(i=>!n.has(i.id)),r.arcs=(t.arcs||[]).filter(i=>!n.has(i.source)&&!n.has(i.target)),r}function F4(t){const{elements:e,setElements:n,selectedElement:r,selectedElements:i,clearSelection:s,setSelection:l,clipboardRef:u,netMode:c,setClipboard:f,getClipboard:p,onClipboardMismatch:m,handleUndo:w,handleRedo:y,setMode:x,arcStart:b,setArcStart:_,setTempArcEnd:S,setSelectedElement:T,pasteMode:h,setPasteMode:k}=t;O.useEffect(()=>{const E=I=>{const L=navigator.platform.toUpperCase().includes("MAC")?I.metaKey:I.ctrlKey;I.key==="Shift"&&t.isShiftPressedRef&&(t.isShiftPressedRef.current=!0);const A=I.target,F=A==null?void 0:A.tagName,D=F==="INPUT"||F==="TEXTAREA"||(A==null?void 0:A.isContentEditable);if(!D&&(I.key==="Delete"||I.key==="Backspace")){if(i.length===0&&!r)return;I.preventDefault(),n(U=>{const W=[],G=new Set;i.length>0?i.forEach(B=>{(B.type==="place"||B.type==="transition")&&W.push(B.id),B.type==="arc"&&G.add(B.id)}):r&&((r.type==="place"||r.type==="transition")&&W.push(r.id),r.type==="arc"&&G.add(r.id));let z=U;return W.length>0&&(z=j4(z,W)),G.size>0&&(z={...z,arcs:z.arcs.filter(B=>!G.has(B.id))}),z}),s();return}if(!D&&L&&(I.key==="a"||I.key==="A")){I.preventDefault();const U=[...e.places.map(W=>({id:W.id,type:"place"})),...e.transitions.map(W=>({id:W.id,type:"transition"})),...e.arcs.map(W=>({id:W.id,type:"arc"}))];l(U);return}if(!D&&L&&(I.key==="z"||I.key==="Z")&&typeof w=="function"){I.preventDefault(),w();return}if(!D&&L&&(I.key==="y"||I.key==="Y")&&typeof y=="function"){I.preventDefault(),y();return}if(!D&&!L){if((I.key==="p"||I.key==="P")&&typeof x=="function"){I.preventDefault(),x("place");return}if((I.key==="t"||I.key==="T")&&typeof x=="function"){I.preventDefault(),x("transition");return}if((I.key==="a"||I.key==="A")&&typeof x=="function"){I.preventDefault(),x("arc");return}if((I.key==="s"||I.key==="S")&&typeof x=="function"){I.preventDefault(),x("select");return}if(I.key==="Escape"){if(I.preventDefault(),h&&typeof k=="function"){k(!1);return}typeof x=="function"&&x("select"),typeof _=="function"&&b&&_(null),typeof S=="function"&&S(null),typeof T=="function"&&T(null);return}}if(!D&&L&&(I.key==="c"||I.key==="C")){if(i.length===0)return;I.preventDefault();const U=Du(e,i),W=c||"pt";typeof f=="function"?f(U):u&&(u.current={payload:U,netMode:W,source:"local",timestamp:Date.now()});return}if(!D&&L&&(I.key==="v"||I.key==="V")){const U=c||"pt",W=typeof p=="function"?p():u==null?void 0:u.current;if(!W)return;const G=W.payload||W;if(!G)return;const z=W.netMode||U;if(z&&U&&z!==U){typeof m=="function"?m(z,U,W):console.warn(`Blocked paste: shared clipboard contains ${z} net, editor mode is ${U}.`);return}I.preventDefault();const{newPlaces:B,newTransitions:j,newArcs:$,newSelection:X}=zu(G,Wi,{x:40,y:40});n(ee=>({...ee,places:[...ee.places,...B],transitions:[...ee.transitions,...j],arcs:[...ee.arcs,...$]})),l(X);return}},N=I=>{I.key==="Shift"&&t.isShiftPressedRef&&(t.isShiftPressedRef.current=!1)};return document.addEventListener("keydown",E),document.addEventListener("keyup",N),()=>{document.removeEventListener("keydown",E),document.removeEventListener("keyup",N)}},[e,i,r,n,s,l,u,t,w,y,x,b,_,S,T])}function S7(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var O4=S7,_7=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,k7=_7,b7=k7,C7=typeof self=="object"&&self&&self.Object===Object&&self,E7=b7||C7||Function("return this")(),D4=E7,T7=D4,N7=function(){return T7.Date.now()},P7=N7,M7=/\s/;function A7(t){for(var e=t.length;e--&&M7.test(t.charAt(e)););return e}var I7=A7,L7=I7,R7=/^\s+/;function j7(t){return t&&t.slice(0,L7(t)+1).replace(R7,"")}var F7=j7,O7=D4,D7=O7.Symbol,z4=D7,ty=z4,B4=Object.prototype,z7=B4.hasOwnProperty,B7=B4.toString,Ea=ty?ty.toStringTag:void 0;function U7(t){var e=z7.call(t,Ea),n=t[Ea];try{t[Ea]=void 0;var r=!0}catch{}var i=B7.call(t);return r&&(e?t[Ea]=n:delete t[Ea]),i}var G7=U7,V7=Object.prototype,W7=V7.toString;function $7(t){return W7.call(t)}var H7=$7,ny=z4,Y7=G7,X7=H7,K7="[object Null]",Q7="[object Undefined]",ry=ny?ny.toStringTag:void 0;function Z7(t){return t==null?t===void 0?Q7:K7:ry&&ry in Object(t)?Y7(t):X7(t)}var q7=Z7;function J7(t){return t!=null&&typeof t=="object"}var eS=J7,tS=q7,nS=eS,rS="[object Symbol]";function iS(t){return typeof t=="symbol"||nS(t)&&tS(t)==rS}var sS=iS,oS=F7,iy=O4,aS=sS,sy=0/0,lS=/^[-+]0x[0-9a-f]+$/i,cS=/^0b[01]+$/i,uS=/^0o[0-7]+$/i,dS=parseInt;function fS(t){if(typeof t=="number")return t;if(aS(t))return sy;if(iy(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=iy(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=oS(t);var n=cS.test(t);return n||uS.test(t)?dS(t.slice(2),n?2:8):lS.test(t)?sy:+t}var hS=fS,pS=O4,Qh=P7,oy=hS,gS="Expected a function",mS=Math.max,yS=Math.min;function vS(t,e,n){var r,i,s,l,u,c,f=0,p=!1,m=!1,w=!0;if(typeof t!="function")throw new TypeError(gS);e=oy(e)||0,pS(n)&&(p=!!n.leading,m="maxWait"in n,s=m?mS(oy(n.maxWait)||0,e):s,w="trailing"in n?!!n.trailing:w);function y(N){var I=r,M=i;return r=i=void 0,f=N,l=t.apply(M,I),l}function x(N){return f=N,u=setTimeout(S,e),p?y(N):l}function b(N){var I=N-c,M=N-f,L=e-I;return m?yS(L,s-M):L}function _(N){var I=N-c,M=N-f;return c===void 0||I>=e||I<0||m&&M>=s}function S(){var N=Qh();if(_(N))return T(N);u=setTimeout(S,b(N))}function T(N){return u=void 0,w&&r?y(N):(r=i=void 0,l)}function h(){u!==void 0&&clearTimeout(u),f=0,r=c=i=u=void 0}function k(){return u===void 0?l:T(Qh())}function E(){var N=Qh(),I=_(N);if(r=arguments,i=this,c=N,I){if(u===void 0)return x(c);if(m)return clearTimeout(u),u=setTimeout(S,e),y(c)}return u===void 0&&(u=setTimeout(S,e)),l}return E.cancel=h,E.flush=k,E}var xS=vS;const wS=xl(xS);function SS(t,e){return!t||!e||!Zh(t.places,e.places,U4)||!Zh(t.transitions,e.transitions,hp)||!Zh(t.arcs,e.arcs,G4)?!1:(_e.debug("HistoryManager: States are identical"),!0)}function Zh(t=[],e=[],n){if(t.length!==e.length){const i=n===U4?"places":n===hp?"transitions":"arcs";return _e.debug(`HistoryManager: States differ in number of ${i}`),!1}const r=new Map;e.forEach(i=>r.set(i.id,i));for(const i of t){const s=r.get(i.id);if(!s)return _e.debug(`HistoryManager: ${n===G4?"Arc":n===hp?"Transition":"Place"} ${i.id} not found in second state`),!1;if(!n(i,s))return!1}return!0}function U4(t,e){const n=JSON.stringify(t.valueTokens||[])===JSON.stringify(e.valueTokens||[]),r=t.x===e.x&&t.y===e.y&&t.tokens===e.tokens&&t.label===e.label&&t.name===e.name&&n;return r||_e.debug(`HistoryManager: Place ${t.id} differs - x: ${t.x} vs ${e.x}, y: ${t.y} vs ${e.y}, tokens: ${t.tokens} vs ${e.tokens}, label: ${t.label} vs ${e.label}, name: ${t.name} vs ${e.name}`),r}function hp(t,e){const n=t.x===e.x&&t.y===e.y&&t.label===e.label&&t.name===e.name&&(t.guard||"")===(e.guard||"");return n||_e.debug(`HistoryManager: Transition ${t.id} differs - x: ${t.x} vs ${e.x}, y: ${t.y} vs ${e.y}, label: ${t.label} vs ${e.label}, name: ${t.name} vs ${e.name}`),n}function G4(t,e){if(!(t.source===e.source&&t.target===e.target&&t.weight===e.weight))return _e.debug(`HistoryManager: Arc ${t.id} differs - source: ${t.source} vs ${e.source}, target: ${t.target} vs ${e.target}, weight: ${t.weight} vs ${e.weight}`),!1;const r=(t.label||"")===(e.label||"")&&(t.sourceType||"")===(e.sourceType||"")&&(t.targetType||"")===(e.targetType||"")&&JSON.stringify(t.bindings||[])===JSON.stringify(e.bindings||[])&&JSON.stringify(t.anglePoints||[])===JSON.stringify(e.anglePoints||[]);return r||_e.debug(`HistoryManager: Arc ${t.id} differs in secondary properties`),r}function au(t){if(!t||!t.places||!t.transitions||!t.arcs)return{places:[],transitions:[],arcs:[]};const e=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(i=>e(i));const r={};for(const i in n)if(Object.prototype.hasOwnProperty.call(n,i)){const s=n[i];s===null||typeof s!="object"?r[i]=s:Array.isArray(s)?r[i]=[...s]:r[i]={...s}}return r};return{places:t.places.map(e),transitions:t.transitions.map(e),arcs:t.arcs.map(e)}}function qh(t){return!t||!t.places||!t.transitions||!t.arcs?{places:[],transitions:[],arcs:[]}:au(t)}class ay{constructor(e){this.states=[au(e)],this.currentIndex=0,this.maxStates=50}addState(e){const n=au(e),r=this.states[this.currentIndex];return this.currentIndex>=0&&SS(r,n)?(_e.debug("HistoryManager: State unchanged, not adding to history"),{canUndo:this.canUndo(),canRedo:this.canRedo()}):(_e.debug(`HistoryManager: Adding new state to history. Current index: ${this.currentIndex}, States count: ${this.states.length}`),this.currentIndex<this.states.length-1&&(_e.debug(`HistoryManager: Removing ${this.states.length-this.currentIndex-1} future states`),this.states=this.states.slice(0,this.currentIndex+1)),this.states.push(n),this.currentIndex++,this.states.length>this.maxStates&&(this.states.shift(),this.currentIndex--),_e.debug(`HistoryManager: New state added. Current index: ${this.currentIndex}, States count: ${this.states.length}`),{canUndo:this.canUndo(),canRedo:this.canRedo()})}undo(){if(!this.canUndo())return _e.debug("HistoryManager: Cannot undo - no previous states"),null;this.currentIndex--;const e=this.states[this.currentIndex];return _e.debug(`HistoryManager: Undoing to index ${this.currentIndex}, states count: ${this.states.length}`),{state:qh(e),canUndo:this.canUndo(),canRedo:this.canRedo()}}redo(){if(!this.canRedo())return _e.debug("HistoryManager: Cannot redo - no future states"),null;this.currentIndex++;const e=this.states[this.currentIndex];return _e.debug(`HistoryManager: Redoing to index ${this.currentIndex}, states count: ${this.states.length}`),{state:qh(e),canUndo:this.canUndo(),canRedo:this.canRedo()}}canUndo(){return this.currentIndex>0}canRedo(){return this.currentIndex<this.states.length-1}getCurrentState(){return this.states[this.currentIndex]}deepCopyState(e){return au(e)}validateState(e){return qh(e)}}const _S="petri-net-shared-clipboard";function kS({clipboardRef:t,netMode:e,instanceId:n,onIncompatibleClipboard:r}){const i=O.useRef(null),s=O.useRef(e||"pt"),l=O.useRef(r||null);O.useEffect(()=>{s.current=e||"pt"},[e]),O.useEffect(()=>{l.current=r||null},[r]),O.useEffect(()=>{if(typeof window>"u"||typeof window.BroadcastChannel!="function")return;const f=new window.BroadcastChannel(_S);i.current=f;const p=m=>{var b;const w=m==null?void 0:m.data;if(!w||w.type!=="PETRI_NET_CLIPBOARD_UPDATE"||w.instanceId===n)return;const y={payload:w.payload,netMode:w.netMode,source:"remote",instanceId:w.instanceId,timestamp:w.timestamp||Date.now()};t&&(t.current=y);const x=s.current;y.netMode&&x&&y.netMode!==x&&((b=l.current)==null||b.call(l,y.netMode,x,y))};return f.addEventListener("message",p),()=>{f.removeEventListener("message",p),i.current=null,f.close()}},[t,n]);const u=O.useCallback(f=>{if(!f)return;const p={payload:f,netMode:s.current,source:"local",instanceId:n,timestamp:Date.now()};t&&(t.current=p);const m=i.current;if(m&&typeof m.postMessage=="function")try{m.postMessage({type:"PETRI_NET_CLIPBOARD_UPDATE",payload:f,netMode:p.netMode,instanceId:n,timestamp:p.timestamp})}catch(w){console.warn("Failed to broadcast clipboard payload:",w)}},[t,n]),c=O.useCallback(()=>t==null?void 0:t.current,[t]);return{setClipboard:u,getClipboard:c}}const V4=O.createContext(),bS=({children:t})=>{const[r,i]=O.useState({width:800,height:600}),[s,l]=O.useState({width:1e4,height:7500}),[u,c]=O.useState({x:0,y:0}),[f,p]=O.useState(1),[m,w]=O.useState(!0),y=20,x=O.useRef(null),[b,_]=O.useState(null),S=O.useRef(null),[T,h]=O.useState(!1),[k,E]=O.useState({visible:!1,position:null,elementType:null}),N=O.useRef("select"),M={stageDimensions:r,setStageDimensions:i,virtualCanvasDimensions:s,setVirtualCanvasDimensions:l,canvasScroll:u,setCanvasScroll:c,zoomLevel:f,setZoomLevel:p,gridSnappingEnabled:m,toggleGridSnapping:()=>{w(L=>!L)},gridSize:y,MIN_ZOOM:.1,MAX_ZOOM:3,appRef:x,containerRef:b,setContainerRef:_,stageRef:S,isDragging:T,setIsDragging:h,snapIndicator:k,setSnapIndicator:E,prevModeRef:N};return C.jsx(V4.Provider,{value:M,children:t})},Go=()=>{const t=O.useContext(V4);if(t===void 0)throw new Error("useEditorUI must be used within an EditorUIProvider");return t};function ly(t){if(!(t!=null&&t.valueTokens)||t.valueTokens.length===0)return null;const e=pl(t.valueTokens[0]);return t.valueTokens.every(r=>pl(r)===e)?e:null}function El(t,e,n=!0){if(!n)return console.log("[TypeInference] Disabled, returning original state"),t;if(e!=="algebraic-int"||!(t!=null&&t.places)||!(t!=null&&t.arcs)||!(t!=null&&t.transitions))return console.log("[TypeInference] Skipping - netMode:",e,"hasPlaces:",!!(t!=null&&t.places)),t;console.log("[TypeInference] Starting with overwrite=",n);const r={arcs:[],transitions:[]},i=!!n;t.places.forEach(u=>{const c=ly(u);c&&t.arcs.filter(p=>p.source===u.id).forEach(p=>{if(p.bindings&&p.bindings.length>0){const m=[];let w=!1;for(const y of p.bindings){if(!y){m.push(y);continue}const x=new Map,b=y.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(b&&b.forEach(S=>{if(S!=="true"&&S!=="false"&&S!=="and"&&S!=="or"&&S!=="not")if(!y.includes(`${S}:`))x.set(S,c);else{const T=y.match(new RegExp(`${S}:(Int|Bool|Pair|String|List)`,"i"));T&&T[1]&&x.set(S,T[1])}}),c==="List"){const S=Array.isArray(u.valueTokens)?u.valueTokens:[];let T=null;if(S.length>0&&Array.isArray(S[0])&&S[0].length>0){const h=pl(S[0][0]);S.every(E=>Array.isArray(E)&&E.every(N=>pl(N)===h))&&(T=h)}if(T)for(const[h,k]of Array.from(x.entries()))k==="List"&&x.set(h,T);else x.clear()}const _=x.size>0?ou(y,x,null,{overwrite:i}):y;_!==y&&(w=!0),m.push(_)}w&&r.arcs.push({arcId:p.id,newBindings:m})}})});const s=t.arcs.map(u=>{const c=r.arcs.find(f=>f.arcId===u.id);return c?c.newBindings?{...u,bindings:[...c.newBindings]}:{...u,bindings:[c.newBinding]}:u});return t.transitions.forEach(u=>{const c=s.filter(m=>m.target===u.id),f=new Map;if(console.log("[TypeInference] Processing transition:",u.id,"inputArcs:",c.length),c.forEach(m=>{m.bindings&&m.bindings.length>0&&m.bindings.forEach(w=>{if(!w)return;console.log("[TypeInference] Input arc binding:",w);const y=w.match(/\b([a-z][a-zA-Z0-9_]*)\:(Int|Bool|Pair|String|List)\b/gi);y&&y.forEach(b=>{const _=b.match(/\b([a-z][a-zA-Z0-9_]*)\:(Int|Bool|Pair|String|List)\b/i);_&&_[1]&&_[2]&&f.set(_[1],_[2])});const x=w.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(console.log("[TypeInference] All variable matches in binding:",x),x){const b=t.places.find(_=>_.id===m.source);if(b){const _=ly(b);_&&x.forEach(S=>{S!=="true"&&S!=="false"&&S!=="and"&&S!=="or"&&S!=="not"&&(f.has(S)||f.set(S,_))})}}})}),console.log("[TypeInference] Extracted variable types for",u.id,":",JSON.stringify(Array.from(f.entries()))),u.guard&&f.size>0){const m=u.guard.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(m){const w=new Map;if(m.forEach(y=>{if(y!=="true"&&y!=="false"&&y!=="and"&&y!=="or"&&y!=="not"){const x=f.get(y);if(!x)return;i?w.set(y,x):new RegExp(`\\b${y}\\s*:(Int|Bool|Pair|String|List)\\b`,"i").test(u.guard)||w.set(y,x)}}),console.log("[TypeInference] Guard type map for",u.id,":",Array.from(w.entries())),w.size>0){const y=ou(u.guard,w,null,{overwrite:i});console.log("[TypeInference] Guard before:",u.guard),console.log("[TypeInference] Guard after:",y),y!==u.guard&&r.transitions.push({transitionId:u.id,newGuard:y})}}}s.filter(m=>m.source===u.id).forEach(m=>{if(m.bindings&&m.bindings.length>0){const w=[];let y=!1;for(const x of m.bindings){if(!x){w.push(x);continue}const b=new Map,_=x.match(/\b[a-z][a-zA-Z0-9_]*\b/g);_&&_.forEach(T=>{if(T!=="true"&&T!=="false"&&T!=="and"&&T!=="or"&&T!=="not"){const h=f.get(T);if(!h)return;i?b.set(T,h):new RegExp(`\\b${T}\\s*:(Int|Bool|Pair|String|List)\\b`,"i").test(x)||b.set(T,h)}});const S=b.size>0?ou(x,b,null,{overwrite:i}):x;S!==x&&(y=!0),w.push(S)}y&&r.arcs.push({arcId:m.id,newBindings:w})}})}),r.arcs.length===0&&r.transitions.length===0?t:{...t,arcs:t.arcs.map(u=>{const c=r.arcs.find(f=>f.arcId===u.id);return c?c.newBindings?{...u,bindings:[...c.newBindings]}:{...u,bindings:[c.newBinding]}:u}),transitions:t.transitions.map(u=>{const c=r.transitions.find(f=>f.transitionId===u.id);return c?{...u,guard:c.newGuard}:u})}}const _g=O.createContext(),CS=({children:t})=>{const{gridSnappingEnabled:e,gridSize:n,setCanvasScroll:r,setZoomLevel:i}=Go(),[s,l]=O.useState({places:[],transitions:[],arcs:[]}),[u,c]=O.useState(null),[f,p]=O.useState([]),[m,w]=O.useState("select"),[y,x]=O.useState(null),[b,_]=O.useState(null),[S,T]=O.useState(!1),[h,k]=O.useState(!1),[E,N]=O.useState({maxIterations:2e5,limitIterations:!1,netMode:"pt",useNonVisualRun:!1,batchMode:!1,showInferredTypes:!1,animationDelayMs:1e3}),[I,M]=O.useState({poolSize:1,idleTimeoutMs:3e5,prewarmOnAlgebraicMode:!0,solverTimeoutMs:1e4}),[L,A]=O.useState(null),F=O.useRef(new ay({places:[],transitions:[],arcs:[]})),[D,U]=O.useState(!1),[W,G]=O.useState(!1),z=O.useRef(wS(Pe=>{const ie=F.current.addState(Pe);U(ie.canUndo),G(ie.canRedo)},500)),[B,j]=O.useState(!1),$=O.useRef(m),X=O.useRef(null),ee=O.useRef(null),ne=O.useRef(Wi()),Z=O.useRef(!1),te=(E==null?void 0:E.netMode)||"pt",de=O.useRef(!!(E!=null&&E.showInferredTypes)),fe=O.useRef(null),V=O.useCallback((Pe,ie)=>{console.warn(`Shared clipboard net mode mismatch: received ${Pe||"unknown"} while editor is ${ie||te}. Copy/paste is disabled until both editors use the same mode.`)},[te]),{setClipboard:K,getClipboard:se}=kS({clipboardRef:ee,netMode:te,instanceId:ne.current,onIncompatibleClipboard:V}),re=(Pe,ie=!1)=>{if(ie){const ce=F.current.addState(Pe);U(ce.canUndo),G(ce.canRedo)}else z.current(Pe)},{isContinuousSimulating:oe,isRunning:ge,enabledTransitionIds:he,simulationError:be,isSimulatorReady:le,handleFireTransition:ve,stepSimulation:je,startContinuousSimulation:ze,startRunSimulation:Xe,stopAllSimulations:Yt,forceSimulatorReset:st,completionStats:Fn,dismissCompletionDialog:On}=g7(s,l,re,(E==null?void 0:E.netMode)||"pt",E);O.useEffect(()=>(!B&&$.current===m&&re(s),$.current!==m&&S&&T(!1),$.current=m,()=>z.current.cancel()),[s,B,m,S,T]),O.useEffect(()=>{const Pe=!!(E!=null&&E.showInferredTypes),ie=de.current;if(Pe!==ie){if(de.current=Pe,Pe&&te==="algebraic-int"){l(ce=>(fe.current=ce,El(ce,te,!0)));return}!Pe&&fe.current&&(l(fe.current),fe.current=null)}},[E==null?void 0:E.showInferredTypes,te,l]);const ot=()=>{if(!D)return;_e.debug("Undoing to previous state...");const Pe=F.current.undo();Pe&&(_e.debug("Undo result:",Pe.state),l(Pe.state),U(Pe.canUndo),G(Pe.canRedo),st())},wr=()=>{if(!W)return;_e.debug("Redoing to next state...");const Pe=F.current.redo();Pe&&(_e.debug("Redo result:",Pe.state),l(Pe.state),U(Pe.canUndo),G(Pe.canRedo),st())},pi=(Pe,ie)=>e?{x:Math.round(Pe/n)*n,y:Math.round(ie/n)*n}:{x:Pe,y:ie},Br=Pe=>{N(Pe),k(!1)};O.useEffect(()=>{(async()=>{if(!(typeof window>"u"))try{const{setZ3WorkerConfig:ie}=await ri(()=>Promise.resolve().then(()=>Qa),void 0,import.meta.url);ie(I)}catch{}})()},[I]);const Ur=()=>{const Pe={places:[],transitions:[],arcs:[]};l(Pe),c(null),p([]),w("select"),x(null),_(null),N({maxIterations:2e5,limitIterations:!1,netMode:"pt",useNonVisualRun:!1,batchMode:!1,showInferredTypes:!1}),r({x:0,y:0}),i(1),F.current=new ay(Pe),U(!1),G(!1),_e.debug("Editor completely reset")},yt=(Pe,ie)=>Pe?f.some(ce=>ce.id===Pe&&ce.type===ie):!1,dn=()=>{c(null),p([])},Gr=Pe=>{if(p(Array.isArray(Pe)?Pe:[]),Array.isArray(Pe)&&Pe.length>0){const ie=Pe[Pe.length-1],ce=ie.type==="place"?s.places.find(pe=>pe.id===ie.id):ie.type==="transition"?s.transitions.find(pe=>pe.id===ie.id):s.arcs.find(pe=>pe.id===ie.id);ce&&c({...ce,type:ie.type})}else c(null)};return F4({elements:s,setElements:l,selectedElement:u,selectedElements:f,clearSelection:dn,setSelection:Gr,clipboardRef:ee,isShiftPressedRef:Z,netMode:te,setClipboard:K,getClipboard:se,onClipboardMismatch:V}),C.jsx(_g.Provider,{value:{elements:s,setElements:l,selectedElement:u,setSelectedElement:c,mode:m,setMode:w,arcStart:y,setArcStart:x,tempArcEnd:b,setTempArcEnd:_,pasteMode:S,setPasteMode:T,isDragging:B,setIsDragging:j,isContinuousSimulating:oe,isRunning:ge,isSimulatorReady:le,enabledTransitionIds:he,simulationError:be,stepSimulation:je,handleFireTransition:ve,startContinuousSimulation:ze,startRunSimulation:Xe,stopAllSimulations:Yt,completionStats:Fn,dismissCompletionDialog:On,isSettingsDialogOpen:h,setIsSettingsDialogOpen:k,simulationSettings:E,setSimulationSettings:N,netMode:te,historyManagerRef:F,canUndo:D,setCanUndo:U,canRedo:W,setCanRedo:G,handleUndo:ot,handleRedo:wr,updateHistory:re,snapToGrid:pi,handleSaveSettings:Br,z3Settings:I,setZ3Settings:M,resetEditor:Ur,simulatorCore:Ai,forceSimulatorReset:st,selectedElements:f,setSelectedElements:p,isIdSelected:yt,clearSelection:dn,setSelection:Gr,multiDragRef:X,clipboardRef:ee,setClipboard:K,getClipboard:se,onClipboardMismatch:V,instanceId:ne.current,isShiftPressedRef:Z,saveFileHandle:L,setSaveFileHandle:A},children:t})},$t=()=>{const t=O.useContext(_g);if(t===void 0)throw new Error("usePetriNet must be used within a PetriNetProvider");return t},ES=({mode:t,setMode:e,gridSnappingEnabled:n,onToggleGridSnapping:r,canUndo:i,canRedo:s,onUndo:l,onRedo:u,elements:c,setElements:f,updateHistory:p,simulationSettings:m,setSimulationSettings:w,simulationMode:y,setSimulationMode:x,isSimulating:b,startSimulation:_,stopSimulation:S,clearCanvas:T,onOpenSettings:h,resetEditor:k,debugConsoleRef:E})=>{const[N,I]=O.useState(!1),[M,L]=O.useState(null),[A,F]=O.useState(null),[D,U]=O.useState(!1),[W,G]=O.useState(!1),[z,B]=O.useState(!1),{saveFileHandle:j,setSaveFileHandle:$}=(()=>{try{return $t()}catch{return{saveFileHandle:null,setSaveFileHandle:()=>{}}}})(),{handleSave:X,handleSaveAs:ee,handleLoad:ne,handleClear:Z,handleOpenAdtManager:te,handleLoadExample:de}=m7({elements:c,setElements:f,updateHistory:p,simulationSettings:m,setSimulationSettings:w,resetEditor:k,setIsLoading:I,setError:L,setSuccess:F,setIsAdtOpen:U,saveFileHandle:j,setSaveFileHandle:$,setIsMobileMenuOpen:B}),fe=()=>{G(!0),B(!1)},V=le=>{de(le)};O.useEffect(()=>{if(!A)return;const le=setTimeout(()=>F(null),2e3);return()=>clearTimeout(le)},[A]);const K=O.useMemo(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(min-width: 1024px)"):null,[]);O.useEffect(()=>{if(!K)return;const le=ve=>{ve.matches&&B(!1)};return K.addEventListener?K.addEventListener("change",le):K.addListener(le),()=>{K.removeEventListener?K.removeEventListener("change",le):K.removeListener(le)}},[K]);const se=(le="desktop")=>(ve,je="default")=>{if(le==="mobile"){const ze={file:{gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",hover:"linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%)",shadow:"0 4px 15px rgba(102, 126, 234, 0.4)",hoverShadow:"0 6px 20px rgba(102, 126, 234, 0.5)"},settings:{gradient:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",hover:"linear-gradient(135deg, #e879f9 0%, #ef4444 100%)",shadow:"0 4px 15px rgba(245, 87, 108, 0.4)",hoverShadow:"0 6px 20px rgba(245, 87, 108, 0.5)"},adt:{gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",hover:"linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%)",shadow:"0 4px 15px rgba(79, 172, 254, 0.4)",hoverShadow:"0 6px 20px rgba(79, 172, 254, 0.5)"},debug:{gradient:"linear-gradient(135deg, #a855f7 0%, #ec4899 100%)",hover:"linear-gradient(135deg, #9333ea 0%, #db2777 100%)",shadow:"0 4px 15px rgba(168, 85, 247, 0.4)",hoverShadow:"0 6px 20px rgba(168, 85, 247, 0.5)"},default:{gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",hover:"linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%)",shadow:"0 4px 15px rgba(102, 126, 234, 0.3)",hoverShadow:"0 6px 20px rgba(102, 126, 234, 0.4)"}},Xe=ze[je]||ze.default;return{padding:"0.5rem 1rem",borderRadius:"0.5rem",background:ve?Xe.gradient:"white",color:ve?"white":"#374151",border:"none",margin:"0 0 0.5rem 0",minWidth:"100%",width:"100%",fontSize:"0.8125rem",fontWeight:600,cursor:"pointer",transition:"all 0.15s cubic-bezier(0.4, 0, 0.2, 1)",textAlign:"center",height:"36px",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.375rem",boxShadow:ve?`${Xe.shadow}, inset 0 2px 4px rgba(255, 255, 255, 0.2)`:"0 2px 8px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08)",position:"relative",overflow:"hidden","--scheme-gradient":Xe.gradient,"--scheme-hover":Xe.hover,"--scheme-shadow":Xe.shadow,"--scheme-hover-shadow":Xe.hoverShadow}}return{padding:"0.375rem 0.5rem",borderRadius:"0.25rem",backgroundColor:ve?"#4338ca":"white",color:ve?"rgba(255, 255, 255, 0.85)":"rgba(31, 41, 55, 0.7)",border:ve?"1px solid #3730a3":"1px solid #d1d5db",borderBottom:ve?"2px solid #312e81":"2px solid #9ca3af",margin:"0 0.125rem",minWidth:"80px",width:"80px",fontSize:"0.75rem",fontWeight:600,cursor:"pointer",transition:"all 0.15s ease-in-out",textAlign:"center",height:"32px",display:"inline-flex",alignItems:"center",justifyContent:"center",boxShadow:ve?"inset 0 1px 0 rgba(255, 255, 255, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1)":"inset 0 1px 0 rgba(255, 255, 255, 0.7), 0 2px 4px rgba(0, 0, 0, 0.1)",position:"relative",top:"0",transform:ve?"translateY(1px)":"translateY(0)",textShadow:ve?"0 -1px 1px rgba(0, 0, 0, 0.5), 0 1px 0 rgba(255, 255, 255, 0.15)":"0 1px 0 rgba(255, 255, 255, 0.5), 0 -1px 0 rgba(0, 0, 0, 0.2)"}},re=O.useMemo(()=>se("desktop"),[]),oe=O.useMemo(()=>se("mobile"),[]),ge=le=>({padding:"0.5rem",marginTop:"0.5rem",borderRadius:"0.25rem",backgroundColor:le?"#fee2e2":"#d1fae5",color:le?"#b91c1c":"#047857",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem"}),he=()=>C.jsxs("div",{className:"hidden lg:flex items-start",children:[C.jsxs("div",{className:"file-operations p-2",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"File"}),C.jsx(F2,{isLoading:N,onSave:X,onSaveAs:ee,canSaveAs:!0,onLoad:ne,onExamples:fe,onClear:Z,buttonStyle:re})]}),C.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),C.jsxs("div",{className:"editing-tools p-2",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"Editing"}),C.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[C.jsxs("div",{className:"flex items-center mr-4",children:[C.jsx("input",{type:"checkbox",id:"grid-snap-toggle","data-testid":"grid-snap-toggle",checked:n,onChange:r,className:"mr-1"}),C.jsx("label",{htmlFor:"grid-snap-toggle",className:"text-xs text-gray-700",children:"Snap to Grid"})]}),C.jsx(ww,{mode:t,setMode:e,buttonStyle:re})]})]}),C.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),C.jsxs("div",{className:"adt-tools p-2",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"ADT Manager"}),C.jsx("div",{className:"flex justify-between",children:C.jsx("button",{style:re(!1),onClick:te,title:"Open ADT Manager","data-testid":"toolbar-adt-manager",children:"ADT"})})]}),C.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),C.jsxs("div",{className:"history-tools p-2",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"History"}),C.jsx(Sw,{canUndo:i,canRedo:s,onUndo:l,onRedo:u,buttonStyle:re})]}),C.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),C.jsxs("div",{className:"settings-tools p-2 ml-auto",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"Settings"}),C.jsx(O2,{onOpenSettings:h,buttonStyle:re})]})]}),be=()=>{var le,ve;return C.jsxs("div",{className:"flex flex-col space-y-5",children:[C.jsxs("div",{className:"file-operations",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-3 uppercase tracking-wider",children:"File"}),C.jsx(F2,{isLoading:N,onSave:X,onSaveAs:ee,canSaveAs:!0,onLoad:ne,onExamples:fe,onClear:Z,buttonStyle:oe,isMobile:!0})]}),C.jsxs("div",{className:"editing-tools",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-3 uppercase tracking-wider",children:"Editing"}),C.jsxs("div",{className:"flex items-center",children:[C.jsx("input",{type:"checkbox",id:"grid-snap-toggle-mobile","data-testid":"grid-snap-toggle-mobile",checked:n,onChange:r,className:"mr-2"}),C.jsx("label",{htmlFor:"grid-snap-toggle-mobile",className:"text-sm text-gray-700",children:"Snap to Grid"})]})]}),C.jsxs("div",{className:"adt-tools",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-3 uppercase tracking-wider",children:"ADT Manager"}),C.jsxs("button",{className:"menu-button-hover",style:oe(!1,"adt"),onClick:()=>{B(!1),te()},title:"Open ADT Manager","data-testid":"toolbar-adt-manager-mobile",children:[C.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"ADT Manager"]})]}),C.jsxs("div",{className:"settings-tools",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-3 uppercase tracking-wider",children:"Settings"}),C.jsx(O2,{onOpenSettings:()=>{B(!1),h()},buttonStyle:oe,isMobile:!0})]}),C.jsxs("div",{className:"debug-tools",children:[C.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-3 uppercase tracking-wider",children:"Developer"}),C.jsxs("button",{className:"menu-button-hover",style:oe(!1,"debug"),onClick:()=>{E!=null&&E.current&&(E.current.isEnabled()?E.current.disable():E.current.enable()),B(!1)},title:(le=E==null?void 0:E.current)!=null&&le.isEnabled()?"Deactivate Debug Console":"Activate Debug Console","data-testid":"debug-console-mobile",children:[C.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(ve=E==null?void 0:E.current)!=null&&ve.isEnabled()?"Deactivate debug":"Activate debug"]})]})]})};return C.jsxs(C.Fragment,{children:[C.jsx("style",{children:`
        .menu-button-hover {
          transition: all 0.1s ease-out;
          -webkit-tap-highlight-color: transparent;
        }
        .menu-button-hover:active {
          transform: scale(0.88) !important;
          filter: brightness(0.8);
          box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2), 0 1px 2px rgba(0, 0, 0, 0.1) !important;
        }
        @media (hover: hover) and (pointer: fine) {
          .menu-button-hover:hover {
            transform: translateY(-1px) scale(1.01);
            box-shadow: var(--scheme-hover-shadow, 0 6px 20px rgba(0, 0, 0, 0.15)) !important;
          }
        }
      `}),C.jsxs("div",{className:"toolbar-container flex flex-col p-2 bg-gray-50 border-b border-gray-200 shadow-sm",style:{minHeight:"70px"},children:[C.jsx("div",{className:"hidden lg:block",children:he()}),C.jsxs("div",{className:"lg:hidden flex items-center gap-3 px-2 py-1",children:[C.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 rounded-md border border-gray-200 shadow-sm bg-white font-semibold text-gray-700",onClick:()=>B(!0),"aria-label":"Open toolbar menu",children:[C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),C.jsx("span",{children:"Menu"})]}),C.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[C.jsx("button",{type:"button",className:`p-2 rounded-md border border-gray-200 shadow-sm bg-white text-gray-700 transition-all ${i?"hover:bg-gray-50 active:scale-95":"opacity-50 cursor-not-allowed"}`,onClick:l,disabled:!i,title:"Undo","aria-label":"Undo",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})})}),C.jsx("button",{type:"button",className:`p-2 rounded-md border border-gray-200 shadow-sm bg-white text-gray-700 transition-all ${s?"hover:bg-gray-50 active:scale-95":"opacity-50 cursor-not-allowed"}`,onClick:u,disabled:!s,title:"Redo","aria-label":"Redo",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 15l6-6m0 0l-6-6m6 6H9a6 6 0 000 12h3"})})})]})]}),D&&C.jsx(Ow,{isOpen:D,onClose:()=>U(!1)}),C.jsx(zw,{isOpen:W,onClose:()=>G(!1),onSelectExample:V}),M&&C.jsxs("div",{style:ge(!0),children:[M,C.jsx("button",{onClick:()=>L(null),style:{marginLeft:"0.5rem"},children:""})]}),A&&C.jsxs("div",{style:ge(!1),children:[A,C.jsx("button",{onClick:()=>F(null),style:{marginLeft:"0.5rem"},children:""})]}),C.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 pointer-events-none",children:[C.jsx("div",{className:`absolute inset-0 bg-black transition-opacity duration-300 ease-in-out ${z?"opacity-40 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>B(!1)}),C.jsx("div",{className:`fixed w-72 left-0 top-16 bottom-0 z-50 bg-gradient-to-b from-gray-50 to-white backdrop-blur-sm shadow-2xl overflow-y-auto transform transition-transform duration-300 ease-in-out ${z?"translate-x-0":"-translate-x-full"} pointer-events-auto border-r border-gray-200`,onWheel:le=>le.stopPropagation(),children:C.jsxs("div",{className:"p-4",children:[C.jsx("div",{className:"mb-6 border-b border-gray-200 pb-3",children:C.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Menu"})}),be()]})})]})]})]})},TS=({mode:t,tokens:e,valueTokensInput:n,onTokensChange:r,onValueTokensChange:i,onValueTokensBlur:s})=>t==="pt"?C.jsxs("div",{className:"mb-4",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tokens (PT mode)"}),C.jsx("input",{type:"number",min:"0",value:e,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}):t==="algebraic-int"?C.jsxs("div",{className:"mb-4",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Algebraic Tokens"}),C.jsx("input",{type:"text",value:n,onChange:i,onBlur:s,className:"w-full px-3 py-2 border border-gray-300 rounded-md font-mono text-sm",placeholder:"e.g., 2, 3, 'hello', T, F, (1, 2), [1, 2, 3]"})]}):null,NS=({mode:t,weight:e,bindingsInput:n,bindingError:r,onWeightChange:i,onBindingsChange:s,onBindingsBlur:l})=>t==="pt"?C.jsxs("div",{className:"mb-4",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),C.jsx("input",{type:"number",min:"1",value:e,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}):t==="algebraic-int"?C.jsxs("div",{className:"mb-4",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bindings"}),C.jsx("input",{type:"text",value:n,onChange:s,onBlur:l,className:`w-full px-3 py-2 border rounded-md font-mono text-sm ${r?"border-red-500":"border-gray-300"}`,placeholder:"e.g., x, y, (a, b)"}),r&&C.jsx("p",{className:"text-red-600 text-xs mt-1",children:r})]}):null,PS=({guardText:t,guardError:e,onGuardChange:n,onGuardBlur:r})=>C.jsxs("div",{className:"mb-4",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guard"}),C.jsx("input",{type:"text",value:t,onChange:n,onBlur:r,className:`w-full px-3 py-2 border rounded-md font-mono text-sm ${e?"border-red-500":"border-gray-300"}`,placeholder:"e.g., x > 0 and y < 10"}),e&&C.jsx("p",{className:"text-red-600 text-xs mt-1",children:e})]});function MS(){const t=O.useCallback(r=>{const i=[];let s="",l=0,u=0,c=!1;for(let p=0;p<r.length;p++){const m=r[p];if(c){s+=m,m==="'"&&r[p-1]!=="\\"&&(c=!1);continue}if(m==="'"){c=!0,s+=m;continue}if(m==="("){l++,s+=m;continue}if(m===")"){l=Math.max(0,l-1),s+=m;continue}if(m==="["){u++,s+=m;continue}if(m==="]"){u=Math.max(0,u-1),s+=m;continue}if(m===","&&l===0&&u===0){i.push(s.trim()),s="";continue}s+=m}const f=s.trim();return f.length>0&&i.push(f),i},[]),e=O.useCallback(r=>{const i=String(r||"").trim(),s=i.toLowerCase();if(i==="T"||s==="true")return!0;if(i==="F"||s==="false")return!1;if(/^[+-]?\d+$/.test(i))return parseInt(i,10);if(i.startsWith("'")&&i.endsWith("'"))return i.slice(1,-1);if(i.startsWith("[")&&i.endsWith("]")){const l=i.slice(1,-1).trim();return l?t(l).map(e):[]}if(i.startsWith("(")&&i.endsWith(")")){const l=i.slice(1,-1).trim();let u=0,c=-1;for(let f=0;f<l.length;f++){const p=l[f];if(p==="(")u++;else if(p===")")u=Math.max(0,u-1);else if(p===","&&u===0){c=f;break}}if(c>=0)return{__pair__:!0,fst:e(l.slice(0,c)),snd:e(l.slice(c+1))}}return null},[t]);return{parseValueTokensInput:O.useCallback(r=>{const i=String(r||"").trim();return i?t(i).map(e).filter(s=>s!==null):[]},[t,e]),splitTopLevelCommas:t}}function AS(){const t=O.useCallback(n=>{const r=[];let i="",s=0,l=0;for(let u=0;u<n.length;u++){const c=n[u];if(c==="(")s++;else if(c===")")s=Math.max(0,s-1);else if(c==="[")l++;else if(c==="]")l=Math.max(0,l-1);else if(c===","&&s===0&&l===0){r.push(i.trim()),i="";continue}i+=c}return i.trim()&&r.push(i.trim()),r.filter(Boolean)},[]),e=O.useCallback(n=>{const r=t(String(n||""));for(const i of r){try{x4(i);continue}catch{}try{Vt(i);continue}catch{}try{Lo(i,Vt);continue}catch{}return{ok:!1,error:`Invalid binding: ${i}`}}return{ok:!0,bindings:r}},[t]);return{splitTopLevel:t,validateBindings:e}}const IS=({getElementInfo:t,setElements:e,updateHistory:n,setFormValues:r})=>O.useCallback(i=>{const s=i.target.value;r(c=>({...c,label:s}));const{elementId:l,elementType:u}=t();u==="place"?e(c=>({...c,places:c.places.map(f=>f.id===l?{...f,label:s}:f)})):u==="transition"?e(c=>({...c,transitions:c.transitions.map(f=>f.id===l?{...f,label:s}:f)})):u==="arc"&&e(c=>({...c,arcs:c.arcs.map(f=>f.id===l?{...f,label:s}:f)})),n()},[t,e,n,r]),LS=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,parseValueTokensInput:l,showInferredTypes:u})=>{const c=O.useCallback(m=>{let w=parseInt(m.target.value,10);Number.isFinite(w)||(w=0),w<0&&(w=0),e(x=>({...x,tokens:w}));const{elementId:y}=n();r(x=>({...x,places:x.places.map(b=>b.id===y?{...b,tokens:w}:b)})),i()},[n,r,i,e]),f=O.useCallback(()=>{const m=t.valueTokensInput.trim(),{elementId:w}=n();if(!m){r(x=>({...x,places:x.places.map(b=>b.id===w?{...b,valueTokens:[],tokens:0}:b)})),i();return}const y=l(m);r(x=>{const b={...x,places:x.places.map(_=>_.id===w?{..._,valueTokens:y,tokens:y.length}:_)};return El(b,s,u)}),i()},[t.valueTokensInput,n,s,l,r,i,u]),p=O.useCallback(m=>Array.isArray(m.valueTokens)?_4(m.valueTokens):"",[]);return{handleTokensChange:c,handleValueTokensBlur:f,serializeTokensFromElement:p}},RS=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,validateBindings:l,showInferredTypes:u})=>{const c=O.useCallback(m=>{const w=parseInt(m.target.value,10)||1;e(x=>({...x,weight:w}));const{elementId:y}=n();r(x=>({...x,arcs:x.arcs.map(b=>b.id===y?{...b,weight:w}:b)})),i()},[n,r,i,e]),f=O.useCallback(()=>{const m=t.bindingsInput.trim();e(_=>({..._,bindingError:null}));const{elementId:w}=n();if(!m){r(_=>({..._,arcs:_.arcs.map(S=>S.id===w?{...S,bindings:[]}:S)})),i();return}const{ok:y,bindings:x,error:b}=l(m);if(!y){e(_=>({..._,bindingError:b}));return}r(_=>({..._,arcs:_.arcs.map(S=>S.id===w?{...S,bindings:x}:S)})),i(),r(_=>{const S={..._,arcs:_.arcs.map(T=>T.id===w?{...T,bindings:x}:T)};return El(S,s,u)}),i()},[t.bindingsInput,n,s,r,e,i,l,u]),p=O.useCallback((m,w)=>m!=="arc"||!Array.isArray(w.bindings)?"":w.bindings.map(y=>{const x=String(y||"");return/^true$/i.test(x)?"T":/^false$/i.test(x)?"F":w4(x)}).join(", "),[]);return{handleWeightChange:c,handleBindingsBlur:f,serializeBindingsFromElement:p}},jS=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,showInferredTypes:l})=>({handleGuardBlur:O.useCallback(()=>{const c=t.guardText.trim();e(p=>({...p,guardError:null}));const{elementId:f}=n();if(!c){r(p=>({...p,transitions:p.transitions.map(m=>m.id===f?{...m,guard:""}:m)})),i();return}try{Lo(c,Vt),r(p=>({...p,transitions:p.transitions.map(m=>m.id===f?{...m,guard:c}:m)})),i(),r(p=>{const m={...p,transitions:p.transitions.map(w=>w.id===f?{...w,guard:c}:w)};return El(m,s,l)}),i()}catch(p){e(m=>({...m,guardError:`Invalid guard: ${p.message}`}))}},[t.guardText,n,s,r,e,i,l])}),FS=({elements:t,netMode:e,setElements:n,updateHistory:r,showInferredTypes:i})=>{const s=i??!0,l=O.useCallback(c=>{if(!s||!(t!=null&&t.places)||!(t!=null&&t.arcs)||e!=="algebraic-int")return;const f=t.places.find(y=>y.id===c);if(!f||!f.valueTokens||f.valueTokens.length===0)return;const p=pl(f.valueTokens[f.valueTokens.length-1]),w=t.arcs.filter(y=>y.source===c).reduce((y,x)=>{if(!Array.isArray(x.bindings)||x.bindings.length===0)return y;const b=x.bindings[0];if(!b||!s&&b.includes(":"))return y;const _=b.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(!_)return y;const S=new Map;if(_.forEach(h=>{["true","false","and","or","not"].includes(h)||S.set(h,p)}),S.size===0)return y;const T=ou(b,S,null,{overwrite:s});return T!==b&&y.push({arcId:x.id,newBinding:T}),y},[]);w.length!==0&&(n(y=>({...y,arcs:y.arcs.map(x=>{const b=w.find(_=>_.arcId===x.id);return b?{...x,bindings:[b.newBinding]}:x})})),r())},[t,e,n,r,s]),u=O.useCallback(()=>{if(!s)return;const c=El(t,e,s);c!==t&&(n(c),r())},[t,e,n,r,s]);return{inferTypesForPlace:l,performGlobalTypeInference:u}};function OS({selectedElement:t,elements:e,setElements:n,updateHistory:r,netMode:i,showInferredTypes:s=!0}){const[l,u]=O.useState({label:"",tokens:0,weight:1,valueTokensInput:"",bindingsInput:"",bindingError:null,guardText:"",guardError:null}),{parseValueTokensInput:c}=MS(),{validateBindings:f}=AS(),p=O.useCallback(()=>{if(!t)return{elementId:"",elementType:""};const E=t.id||t.element&&t.element.id||"",N=t.type||E.split("-")[0];return{elementId:E,elementType:N}},[t]),{handleTokensChange:m,handleValueTokensBlur:w,serializeTokensFromElement:y}=LS({formValues:l,setFormValues:u,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,parseValueTokensInput:c,showInferredTypes:s}),{handleWeightChange:x,handleBindingsBlur:b,serializeBindingsFromElement:_}=RS({formValues:l,setFormValues:u,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,validateBindings:f,showInferredTypes:s}),{handleGuardBlur:S}=jS({formValues:l,setFormValues:u,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,showInferredTypes:s}),T=IS({getElementInfo:p,setElements:n,updateHistory:r,setFormValues:u}),{inferTypesForPlace:h,performGlobalTypeInference:k}=FS({elements:e,netMode:i,setElements:n,updateHistory:r,showInferredTypes:s});return O.useEffect(()=>{if(!t)return;const{elementType:E}=p(),N=E==="transition"?String(t.guard||"").replace(/\btrue\b/gi,"T").replace(/\bfalse\b/gi,"F"):"";u(I=>({...I,label:t.label||"",tokens:t.tokens||0,weight:t.weight!==void 0?t.weight:1,valueTokensInput:y(t),bindingsInput:_(E,t),guardText:N}))},[t,p,y,_,u]),{formValues:l,setFormValues:u,handleLabelChange:T,handleTokensChange:m,handleWeightChange:x,handleValueTokensBlur:w,handleBindingsBlur:b,handleGuardBlur:S,inferTypesForPlace:h,performGlobalTypeInference:k,getElementInfo:p}}const DS=({selectedElement:t,elements:e,setElements:n,updateHistory:r,simulationSettings:i})=>{const s=O.useContext(_g)||{};s.enabledTransitionIds,s.isSimulatorReady;const l=(i==null?void 0:i.netMode)||"pt",u=!!(i!=null&&i.showInferredTypes),{formValues:c,setFormValues:f,handleLabelChange:p,handleTokensChange:m,handleWeightChange:w,handleValueTokensBlur:y,handleBindingsBlur:x,handleGuardBlur:b,getElementInfo:_}=OS({selectedElement:t,elements:e,setElements:n,updateHistory:r,netMode:l,showInferredTypes:u});if(!t)return null;const{elementType:S}=_();return C.jsxs("div",{className:"properties-panel w-full px-4 py-2 overflow-y-auto mx-0",children:[C.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Properties"}),C.jsxs("div",{className:"mb-4",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),C.jsx("input",{type:"text",value:c.label,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"P1, P2, etc."})]}),t&&S==="place"&&C.jsx(TS,{mode:l,tokens:c.tokens,valueTokensInput:c.valueTokensInput,onTokensChange:m,onValueTokensChange:T=>f(h=>({...h,valueTokensInput:T.target.value})),onValueTokensBlur:y}),t&&S==="arc"&&C.jsx(NS,{mode:l,weight:c.weight,bindingsInput:c.bindingsInput,bindingError:c.bindingError,onWeightChange:w,onBindingsChange:T=>f(h=>({...h,bindingsInput:T.target.value})),onBindingsBlur:x}),t&&S==="transition"&&l==="algebraic-int"&&C.jsx(PS,{guardText:c.guardText,guardError:c.guardError,onGuardChange:T=>f(h=>({...h,guardText:T.target.value})),onGuardBlur:b})]})},zS=({enabledTransitions:t,isLoading:e,isOpen:n,onClose:r,onFire:i})=>n?C.jsxs("div",{"data-testid":"enabled-transitions",className:"enabled-transitions-panel mt-4 p-4 bg-gray-50 border border-gray-200 rounded-md",children:[C.jsxs("div",{className:"flex justify-between items-center mb-3",children:[C.jsx("h3",{className:"text-md font-semibold",children:"Enabled Transitions"}),C.jsx("span",{onClick:r,role:"button",tabIndex:0,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),r&&r())},className:"text-gray-500 hover:text-gray-800 cursor-pointer select-none","aria-label":"Close enabled transitions panel",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e?C.jsx("p",{className:"text-gray-500",children:"Loading..."}):t.length===0?C.jsx("p",{className:"text-gray-500",children:"No enabled transitions"}):C.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto pr-1",children:t.map(s=>C.jsx("button",{type:"button",className:"flex items-center text-left hover:bg-gray-100 rounded px-1 py-0.5",onClick:()=>i&&i(s.id),"data-testid":`enabled-${s.label||s.id}`,title:s.label||s.id,children:C.jsx("span",{className:"font-medium",children:s.label||s.id.substring(11,17)})},s.id))})]}):null,BS=({elements:t,enabledTransitionIds:e})=>{const{handleFireTransition:n,netMode:r}=$t(),[i,s]=O.useState(!1),[l,u]=O.useState(!1);return C.jsxs("div",{className:"pt-4 mt-4 px-4",children:[C.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Petri Net"}),C.jsxs("div",{className:"mb-4 pl-1",children:[C.jsxs("div",{className:"flex justify-between items-center mb-2",children:[C.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Current Markings"}),C.jsxs("button",{"data-testid":"toggle-markings",className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm flex items-center space-x-1 transition-colors",onClick:()=>s(!i),children:[C.jsx("span",{children:i?"Hide":"Show"}),C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})]})]}),i&&C.jsx("div",{"data-testid":"current-marking",className:"markings-panel p-3 bg-gray-50 border border-gray-200 rounded-md",children:(t.places||[]).length===0?C.jsx("p",{className:"text-gray-500 text-sm",children:"No places defined"}):C.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-64 overflow-y-auto pr-1",children:(t.places||[]).filter(c=>r==="algebraic-int"?(Array.isArray(c.valueTokens)?c.valueTokens:[]).length>0:!0).map(c=>{const f=c.label||c.name||c.id.substring(6,12),p=c.tokens||0,m=Array.isArray(c.valueTokens)?c.valueTokens:[],w=r==="algebraic-int"&&Array.isArray(c.valueTokens),y=w?_4(m):"";return C.jsxs("div",{className:"flex items-start text-sm",children:[C.jsx("span",{className:"font-medium text-gray-800 mr-2 truncate",title:f,children:f}),w?C.jsx("div",{className:"flex-1 text-gray-800 bg-purple-50 border border-purple-200 rounded px-2 py-1 whitespace-pre-wrap break-words overflow-visible",title:y,children:y||"[]"}):C.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-purple-100 text-purple-800 border border-purple-200 font-semibold min-w-[2rem] justify-center",children:p})]},c.id)})})})]}),C.jsxs("div",{className:"mb-2 pl-1",children:[C.jsxs("div",{className:"flex justify-between items-center mb-2",children:[C.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Enabled Transitions"}),C.jsxs("button",{"data-testid":"show-enabled-transitions",className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm flex items-center space-x-1 transition-colors",onClick:()=>u(!l),children:[C.jsx("span",{children:l?"Hide":"Show"}),C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})]})]}),l&&C.jsx(zS,{isOpen:!0,enabledTransitions:(e||[]).map(c=>{const f=(t.transitions||[]).find(p=>p.id===c);return{id:c,label:f&&(f.label||f.name)||c}}),isLoading:!1,onClose:()=>u(!1),onFire:c=>n&&n(c)})]})]})};const cy=({stats:t,onDismiss:e})=>{if(!t)return null;const n=r=>{if(r<1e3)return`${r}ms`;const i=Math.floor(r/1e3),s=Math.floor(i/60),l=i%60;return s>0?`${s}m ${l}s`:`${i}s`};return C.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:C.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md mx-4",children:[C.jsxs("div",{className:"flex items-center mb-4",children:[C.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3",children:C.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),C.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Simulation Complete"})]}),C.jsxs("div",{className:"space-y-3 mb-6",children:[C.jsxs("div",{className:"flex justify-between items-center",children:[C.jsx("span",{className:"text-gray-600",children:"Duration:"}),C.jsx("span",{className:"font-medium text-gray-900",children:n(t.elapsedMs)})]}),C.jsxs("div",{className:"flex justify-between items-center",children:[C.jsx("span",{className:"text-gray-600",children:"Transitions Fired:"}),C.jsx("span",{className:"font-medium text-gray-900",children:t.transitionsFired})]})]}),C.jsx("div",{className:"flex justify-end",children:C.jsx("button",{onClick:e,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"OK"})})]})})},uy=({isMobile:t=!1})=>{const{isContinuousSimulating:e,isRunning:n,enabledTransitionIds:r,simulationError:i,isSimulatorReady:s,stepSimulation:l,startContinuousSimulation:u,startRunSimulation:c,stopAllSimulations:f,completionStats:p,dismissCompletionDialog:m}=$t(),[w,y]=O.useState(!1),[x,b]=O.useState(!1),_=e||n,S=s&&r.length>0,T=S?"opacity-100":"opacity-50";O.useEffect(()=>{_&&y(!0)},[_]);const h=()=>{b(!0),setTimeout(()=>{y(!1),b(!1)},200)},k=()=>{b(!1),y(!0)};if(t){const E=i&&C.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-full mb-2 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg text-xs whitespace-nowrap z-50",children:i}),N=({onClick:I,className:M=""})=>C.jsx("button",{onClick:I,className:`flex flex-col items-center justify-center cursor-pointer transition-all hover:opacity-70 py-1 ${M}`,title:"Tap to expand/collapse",children:C.jsxs("div",{className:"flex flex-col gap-0.5",children:[C.jsx("div",{className:"w-6 h-0.5 bg-gray-400 rounded-full"}),C.jsx("div",{className:"w-6 h-0.5 bg-gray-400 rounded-full"}),C.jsx("div",{className:"w-6 h-0.5 bg-gray-400 rounded-full"})]})});return C.jsxs(C.Fragment,{children:[C.jsxs("div",{"data-testid":"simulation-manager-mobile",className:`fixed bottom-4 left-1/2 transform -translate-x-1/2 z-40 transition-all duration-200 ease-out ${T}`,children:[E,!w&&!x&&C.jsx("div",{className:`bg-white/95 backdrop-blur-md rounded-full px-3 py-1.5 shadow-2xl border border-gray-200/50 flex items-center justify-center transition-all duration-200 ease-out ${S?"":"opacity-60"}`,children:C.jsx(N,{onClick:k})}),(w||x)&&_&&C.jsxs("div",{className:`bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-gray-200/50 flex flex-col items-center ${w&&!x?"animate-slide-up":x?"animate-slide-down":""}`,children:[C.jsx("div",{className:"w-full flex justify-center pt-1.5 pb-0.5",children:C.jsx(N,{onClick:h})}),C.jsxs("div",{className:"flex items-center gap-3 px-4 pb-3",children:[n&&C.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[C.jsx("span",{className:"w-2 h-2 bg-gray-500 rounded-full sim-pulse-strong"}),C.jsx("span",{className:"text-xs font-medium",children:"Running"})]}),C.jsx("button",{"data-testid":"sim-stop-mobile",className:"bg-white text-red-500 border-2 border-red-300 rounded-full p-3 hover:bg-red-50 hover:border-red-400 active:scale-90 active:bg-red-100 transition-all duration-100 shadow-lg disabled:opacity-40 disabled:cursor-not-allowed",style:{WebkitTapHighlightColor:"transparent"},onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!0}catch{}f()},disabled:!_,title:"Stop simulation",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:C.jsx("rect",{x:"7",y:"7",width:"10",height:"10"})})})]})]}),(w||x)&&!_&&C.jsxs("div",{className:`bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-gray-200/50 flex flex-col items-center ${w&&!x?"animate-slide-up":x?"animate-slide-down":""} ${S?"":"opacity-60"}`,children:[C.jsx("div",{className:"w-full flex justify-center pt-1.5 pb-0.5",children:C.jsx(N,{onClick:h})}),C.jsxs("div",{className:"flex items-center gap-3 px-4 pb-3",children:[C.jsx("button",{"data-testid":"sim-step-mobile",className:"bg-white text-gray-600 border-2 border-gray-300 rounded-full p-3 hover:bg-gray-50 hover:border-gray-400 active:scale-90 active:bg-gray-200 disabled:opacity-40 disabled:cursor-not-allowed transition-all duration-100 shadow-md",style:{WebkitTapHighlightColor:"transparent"},onClick:l,disabled:!s||r.length===0,title:"Step forward",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})})}),C.jsx("button",{"data-testid":"sim-simulate-mobile",className:"bg-white text-gray-600 border-2 border-gray-300 rounded-full p-3 hover:bg-gray-50 hover:border-gray-400 active:scale-90 active:bg-gray-200 disabled:opacity-40 disabled:cursor-not-allowed transition-all duration-100 shadow-md",style:{WebkitTapHighlightColor:"transparent"},onClick:u,disabled:!s||r.length===0,title:"Simulate with animation",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:C.jsx("path",{fillRule:"evenodd",d:"M10 18V6l8 6-8 6z",clipRule:"evenodd"})})}),C.jsx("button",{"data-testid":"sim-run-mobile",className:"bg-white text-gray-600 border-2 border-gray-300 rounded-full p-3 hover:bg-gray-50 hover:border-gray-400 active:scale-90 active:bg-gray-200 disabled:opacity-40 disabled:cursor-not-allowed transition-all duration-100 shadow-md",style:{WebkitTapHighlightColor:"transparent"},onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!1}catch{}c()},disabled:!s||r.length===0,title:"Run to completion",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 5l7 7-7 7"})})})]})]})]}),C.jsx(cy,{stats:p,onDismiss:m})]})}return C.jsxs("div",{"data-testid":"simulation-manager",className:"simulation-manager w-full px-4 py-2 mx-0",children:[C.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Simulation"}),i&&C.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded mb-4",children:i}),C.jsxs("div",{className:"bg-gray-200 p-3 rounded-lg shadow-lg border border-gray-300",children:[C.jsxs("div",{className:"flex items-center justify-between space-x-3 mb-3",children:[C.jsxs("button",{"data-testid":"sim-step",className:"flex-1 h-12 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:l,disabled:!s||_||r.length===0,title:"Execute one step forward",children:[C.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),C.jsx("span",{className:"text-xs font-bold",children:"Step"})]}),C.jsxs("button",{"data-testid":"sim-simulate",className:"flex-1 h-12 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:u,disabled:!s||_||r.length===0,title:"Simulate with animation",children:[C.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:C.jsx("path",{fillRule:"evenodd",d:"M10 18V6l8 6-8 6z",clipRule:"evenodd"})})}),C.jsx("span",{className:"text-xs font-bold",children:"Simulate"})]}),C.jsxs("button",{"data-testid":"sim-run",className:"flex-1 h-12 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!1}catch{}c()},disabled:!s||_||r.length===0,title:"Run to completion",children:[C.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7"})})}),C.jsx("span",{className:"text-xs font-bold",children:"Run"})]})]}),C.jsx("div",{children:C.jsxs("button",{"data-testid":"sim-stop",className:"w-full h-10 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 flex items-center justify-center space-x-2 transition-all shadow-md",onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!0}catch{}f()},disabled:!_,title:"Stop simulation or run",children:[C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:C.jsx("rect",{x:"7",y:"7",width:"10",height:"10"})}),C.jsx("span",{className:"text-sm font-bold",children:"STOP"})]})}),n&&C.jsx("div",{className:"mt-2 flex items-center justify-center",children:C.jsxs("span",{className:"inline-flex items-center space-x-1 text-green-600",children:[C.jsx("span",{className:"w-4 h-4 bg-green-500 rounded-full sim-pulse-strong"}),C.jsx("span",{className:"font-medium text-sm",children:"Simulation running..."})]})})]}),C.jsx(cy,{stats:p,onDismiss:m})]})},US=({isOpen:t,onClose:e})=>{const{z3Settings:n,setZ3Settings:r}=$t(),[i,s]=O.useState(0),[l,u]=O.useState(3e5),[c,f]=O.useState(!0),[p,m]=O.useState(1e4);O.useEffect(()=>{t&&(s(Number((n==null?void 0:n.poolSize)??0)),u(Number((n==null?void 0:n.idleTimeoutMs)??3e5)),f(!!((n==null?void 0:n.prewarmOnAlgebraicMode)??!0)),m(Number((n==null?void 0:n.solverTimeoutMs)??1e4)))},[t,n]);const w=()=>{const y={poolSize:Math.max(0,Number(i)||0),idleTimeoutMs:Math.max(1e3,Number(l)||3e5),prewarmOnAlgebraicMode:!!c,solverTimeoutMs:Math.max(100,Number(p)||1e4)};try{typeof window<"u"&&ri(()=>Promise.resolve().then(()=>Qa),void 0,import.meta.url).then(x=>x.setZ3WorkerConfig(y)).catch(()=>{})}catch{}try{r(y)}catch{}e==null||e()};return t?C.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:C.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-md mx-4",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h2",{className:"text-xl font-semibold",children:"Z3 Settings"}),C.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:""})]}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Worker Pool"}),C.jsx("div",{className:"space-y-3",children:C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("div",{className:"text-sm",children:"Pool size (0 = on-demand)"}),C.jsx("input",{type:"number",min:0,max:8,value:i,onChange:y=>s(y.target.value),className:"w-24 border rounded px-2 py-1 text-sm"})]})})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lifecycle"}),C.jsxs("div",{className:"space-y-3",children:[C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("div",{className:"text-sm",children:"idleTimeoutMs"}),C.jsx("input",{type:"number",min:1e3,max:36e5,step:1e3,value:l,onChange:y=>u(y.target.value),className:"w-28 border rounded px-2 py-1 text-sm"})]}),C.jsxs("label",{className:"flex items-center text-sm",children:[C.jsx("input",{type:"checkbox",checked:c,onChange:y=>f(y.target.checked),className:"mr-2"}),"Pre-warm when switching to Algebraic mode"]}),C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("div",{className:"text-sm",children:"Solver timeout (ms)"}),C.jsx("input",{type:"number",min:100,max:6e4,step:100,value:p,onChange:y=>m(y.target.value),className:"w-28 border rounded px-2 py-1 text-sm"})]})]})]}),C.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded p-3",children:[C.jsx("h3",{className:"text-sm font-medium text-purple-800 mb-1",children:"Notes"}),C.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[C.jsx("li",{children:" Pool size 0 keeps workers off until a batch run forces 8 workers"}),C.jsx("li",{children:" Idle timeout trims the pool back to the configured size after bursts"}),C.jsx("li",{children:" Pre-warm hides first-use latency when switching to algebraic-int"}),C.jsx("li",{children:" Solver timeout applies to boolean predicate checks (headless runs benefit from a shorter timeout)"})]})]})]}),C.jsxs("div",{className:"mt-6 flex justify-end",children:[C.jsx("button",{onClick:e,className:"px-3 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors mr-2",children:"Cancel"}),C.jsx("button",{onClick:w,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"Save"})]})]})}):null},Ta=2e5,dy=1e3,GS=({isOpen:t,onClose:e})=>{const{simulatorCore:n,simulationSettings:r,handleSaveSettings:i,elements:s,z3Settings:l,setZ3Settings:u}=$t(),[c,f]=O.useState("single"),[p,m]=O.useState(!1),[w,y]=O.useState(Ta),[x,b]=O.useState(!1),[_,S]=O.useState("pt"),[T,h]=O.useState(!1),[k,E]=O.useState(!1),[N,I]=O.useState(!1),[M,L]=O.useState(!1),[A,F]=O.useState(!1),[D,U]=O.useState(dy);O.useEffect(()=>{var z,B,j;if(t){try{if(n){const de=n.getSimulationMode?n.getSimulationMode():"single";f(de)}}catch(de){_e.warn("Could not get current simulation mode:",de)}const $=Number((r==null?void 0:r.maxIterations)??Ta),X=!!(r!=null&&r.limitIterations);b(X);const ee=Number.isFinite($)&&$>0?Math.max(1,Math.min(1e6,Math.floor($))):Ta;y(ee);const ne=(r==null?void 0:r.netMode)||"pt";S(ne);const Z=!!(r!=null&&r.batchMode);L(Z);const te=!!(Z||r!=null&&r.useNonVisualRun);I(te),F(!!(r!=null&&r.showInferredTypes)),U((r==null?void 0:r.animationDelayMs)??dy),Z&&c!=="maximal"&&W("maximal");try{const de=(((z=s==null?void 0:s.places)==null?void 0:z.length)||0)>0||(((B=s==null?void 0:s.transitions)==null?void 0:B.length)||0)>0||(((j=s==null?void 0:s.arcs)==null?void 0:j.length)||0)>0;h(!!de)}catch{h(!1)}}},[t,n,r]);const W=async z=>{if(!n||!n.setSimulationMode){f(z);return}m(!0);try{await n.setSimulationMode(z),f(z),_e.info("Simulation mode changed to:",z)}catch(B){_e.error("Failed to change simulation mode:",B),f(c)}finally{m(!1)}},G=()=>{const z=!!x,B=Math.max(1,Math.min(1e6,Math.floor(Number(w)||Ta)));i({...r,maxIterations:z?B:Ta,limitIterations:z,netMode:_,useNonVisualRun:M?!0:N,batchMode:M,showInferredTypes:A,animationDelayMs:D}),e==null||e()};return t?C.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[C.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-md mx-4 max-h-[90vh] flex flex-col",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h2",{className:"text-xl font-semibold",children:"Simulation Settings"}),C.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold","data-testid":"settings-close",children:""})]}),C.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 pr-2",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limits"}),C.jsx("div",{className:"space-y-3",children:C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsx("div",{className:"text-sm",children:"Max iterations"}),C.jsxs("div",{className:"flex items-center space-x-2",children:[C.jsx("input",{type:"number",min:1,max:1e6,value:w,onChange:z=>y(z.target.value),disabled:!x,className:"w-24 border rounded px-2 py-1 text-sm disabled:bg-gray-100"}),C.jsxs("label",{className:"flex items-center text-sm",children:[C.jsx("input",{type:"checkbox",checked:x,onChange:z=>{const B=z.target.checked;b(B),B&&(!Number.isFinite(Number(w))||Number(w)<=0)&&y(100)},className:"mr-1"}),"Limit iterations"]})]})]})})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Run Options"}),C.jsxs("label",{className:"flex items-center text-sm",children:[C.jsx("input",{type:"checkbox",checked:M?!0:N,onChange:z=>{const B=z.target.checked;I(B)},disabled:M,className:"mr-2"}),C.jsxs("span",{className:"text-sm",children:[C.jsx("strong",{children:"Use non-visual execution for Run"})," - No per-step animations"]})]}),C.jsxs("label",{className:"flex items-center text-sm mt-2",children:[C.jsx("input",{type:"checkbox",checked:M,onChange:z=>{const B=z.target.checked;if(L(B),B){I(!0),W("maximal");try{u(j=>{const $=j?{...j}:l?{...l}:{};return Number($.poolSize||0)>=8?$:{...$,poolSize:8}})}catch{}}},className:"mr-2"}),C.jsxs("span",{className:"text-sm",children:[C.jsx("strong",{children:"Batch mode"})," - Always headless, keeps background worker active"]})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type Annotations"}),C.jsxs("label",{className:"flex items-center text-sm",children:[C.jsx("input",{type:"checkbox",checked:A,onChange:z=>F(z.target.checked),className:"mr-2"}),C.jsxs("span",{className:"text-sm",children:[C.jsx("strong",{children:"Show inferred variable types"}),"  Display automatically inferred types in guards and bindings"]})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Simulation Mode"}),C.jsxs("div",{className:"space-y-2",children:[C.jsxs("label",{className:"flex items-center",children:[C.jsx("input",{type:"radio",name:"simulationMode",value:"single",checked:c==="single",onChange:z=>W(z.target.value),disabled:p,className:"mr-2"}),C.jsxs("span",{className:"text-sm",children:[C.jsx("strong",{children:"Single Transition"})," - Fire one enabled transition at random"]})]}),C.jsxs("label",{className:"flex items-center",children:[C.jsx("input",{type:"radio",name:"simulationMode",value:"maximal",checked:c==="maximal",onChange:z=>W(z.target.value),disabled:p,className:"mr-2"}),C.jsxs("span",{className:"text-sm",children:[C.jsx("strong",{children:"Maximal Concurrent"})," - Fire all non-conflicting enabled transitions simultaneously"]})]})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Net Type"}),C.jsxs("div",{className:"space-y-2",children:[C.jsxs("label",{className:"flex items-center",children:[C.jsx("input",{type:"radio",name:"netMode",value:"pt",checked:_==="pt",onChange:z=>S(z.target.value),disabled:T,className:"mr-2"}),C.jsxs("span",{className:"text-sm",children:[C.jsx("strong",{children:"P/T Net"})," - Classic place/transition nets with counts"]})]}),C.jsxs("label",{className:"flex items-center",children:[C.jsx("input",{type:"radio",name:"netMode",value:"algebraic-int",checked:_==="algebraic-int",onChange:z=>S(z.target.value),disabled:T,className:"mr-2"}),C.jsxs("span",{className:"text-sm",children:[C.jsx("strong",{children:"Algebraic (Integer)"})," - Integer tokens with guard and term labels"]})]}),T&&C.jsx("div",{className:"text-xs text-gray-600",children:"Net type is locked while the canvas has elements. Clear the canvas to switch."})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Animation Speed (Simulation Mode)"}),C.jsxs("div",{className:"space-y-2",children:[C.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[C.jsx("span",{children:"Fast (200ms)"}),C.jsxs("span",{className:"font-medium text-gray-700",children:[D,"ms"]}),C.jsx("span",{children:"Slow (2s)"})]}),C.jsx("input",{type:"range",min:200,max:2e3,step:100,value:D,onChange:z=>U(Number(z.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"})]})]}),p&&C.jsx("div",{className:"text-center text-sm text-gray-600",children:"Updating simulation mode..."})]}),C.jsxs("div",{className:"mt-6 pt-4 flex justify-end border-t border-gray-200",children:[C.jsx("button",{onClick:()=>E(!0),className:"px-3 py-2 bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors mr-auto",children:"Z3 Settings"}),C.jsx("button",{onClick:e,className:"px-3 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors mr-2","data-testid":"settings-cancel",children:"Cancel"}),C.jsx("button",{onClick:G,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors","data-testid":"settings-save",children:"Save"})]})]}),k&&C.jsx(US,{isOpen:k,onClose:()=>E(!1)})]}):null};var W4={exports:{}},cd={},Bu={},Re={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object globalThis]")}t.glob=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.20",isBrowser:n(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var i;return(i=t.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const r=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=r,t.Konva._injectGlobal(t.Konva)})(Re);var mt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=Re;class n{constructor(k=[1,0,0,1,0,0]){this.dirty=!1,this.m=k&&k.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(k){k.m[0]=this.m[0],k.m[1]=this.m[1],k.m[2]=this.m[2],k.m[3]=this.m[3],k.m[4]=this.m[4],k.m[5]=this.m[5]}point(k){const E=this.m;return{x:E[0]*k.x+E[2]*k.y+E[4],y:E[1]*k.x+E[3]*k.y+E[5]}}translate(k,E){return this.m[4]+=this.m[0]*k+this.m[2]*E,this.m[5]+=this.m[1]*k+this.m[3]*E,this}scale(k,E){return this.m[0]*=k,this.m[1]*=k,this.m[2]*=E,this.m[3]*=E,this}rotate(k){const E=Math.cos(k),N=Math.sin(k),I=this.m[0]*E+this.m[2]*N,M=this.m[1]*E+this.m[3]*N,L=this.m[0]*-N+this.m[2]*E,A=this.m[1]*-N+this.m[3]*E;return this.m[0]=I,this.m[1]=M,this.m[2]=L,this.m[3]=A,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(k,E){const N=this.m[0]+this.m[2]*E,I=this.m[1]+this.m[3]*E,M=this.m[2]+this.m[0]*k,L=this.m[3]+this.m[1]*k;return this.m[0]=N,this.m[1]=I,this.m[2]=M,this.m[3]=L,this}multiply(k){const E=this.m[0]*k.m[0]+this.m[2]*k.m[1],N=this.m[1]*k.m[0]+this.m[3]*k.m[1],I=this.m[0]*k.m[2]+this.m[2]*k.m[3],M=this.m[1]*k.m[2]+this.m[3]*k.m[3],L=this.m[0]*k.m[4]+this.m[2]*k.m[5]+this.m[4],A=this.m[1]*k.m[4]+this.m[3]*k.m[5]+this.m[5];return this.m[0]=E,this.m[1]=N,this.m[2]=I,this.m[3]=M,this.m[4]=L,this.m[5]=A,this}invert(){const k=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),E=this.m[3]*k,N=-this.m[1]*k,I=-this.m[2]*k,M=this.m[0]*k,L=k*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),A=k*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=E,this.m[1]=N,this.m[2]=I,this.m[3]=M,this.m[4]=L,this.m[5]=A,this}getMatrix(){return this.m}decompose(){const k=this.m[0],E=this.m[1],N=this.m[2],I=this.m[3],M=this.m[4],L=this.m[5],A=k*I-E*N,F={x:M,y:L,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(k!=0||E!=0){const D=Math.sqrt(k*k+E*E);F.rotation=E>0?Math.acos(k/D):-Math.acos(k/D),F.scaleX=D,F.scaleY=A/D,F.skewX=(k*N+E*I)/A,F.skewY=0}else if(N!=0||I!=0){const D=Math.sqrt(N*N+I*I);F.rotation=Math.PI/2-(I>0?Math.acos(-N/D):-Math.acos(N/D)),F.scaleX=A/D,F.scaleY=D,F.skewX=0,F.skewY=(k*N+E*I)/A}return F.rotation=t.Util._getRotation(F.rotation),F}}t.Transform=n;const r="[object Array]",i="[object Number]",s="[object String]",l="[object Boolean]",u=Math.PI/180,c=180/Math.PI,f="#",p="",m="0",w="Konva warning: ",y="Konva error: ",x="rgb(",b={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},_=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let S=[];const T=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(h){setTimeout(h,60)};t.Util={_isElement(h){return!!(h&&h.nodeType==1)},_isFunction(h){return!!(h&&h.constructor&&h.call&&h.apply)},_isPlainObject(h){return!!h&&h.constructor===Object},_isArray(h){return Object.prototype.toString.call(h)===r},_isNumber(h){return Object.prototype.toString.call(h)===i&&!isNaN(h)&&isFinite(h)},_isString(h){return Object.prototype.toString.call(h)===s},_isBoolean(h){return Object.prototype.toString.call(h)===l},isObject(h){return h instanceof Object},isValidSelector(h){if(typeof h!="string")return!1;const k=h[0];return k==="#"||k==="."||k===k.toUpperCase()},_sign(h){return h===0||h>0?1:-1},requestAnimFrame(h){S.push(h),S.length===1&&T(function(){const k=S;S=[],k.forEach(function(E){E()})})},createCanvasElement(){const h=document.createElement("canvas");try{h.style=h.style||{}}catch{}return h},createImageElement(){return document.createElement("img")},_isInDocument(h){for(;h=h.parentNode;)if(h==document)return!0;return!1},_urlToImage(h,k){const E=t.Util.createImageElement();E.onload=function(){k(E)},E.src=h},_rgbToHex(h,k,E){return((1<<24)+(h<<16)+(k<<8)+E).toString(16).slice(1)},_hexToRgb(h){h=h.replace(f,p);const k=parseInt(h,16);return{r:k>>16&255,g:k>>8&255,b:k&255}},getRandomColor(){let h=(Math.random()*16777215<<0).toString(16);for(;h.length<6;)h=m+h;return f+h},getRGB(h){let k;return h in b?(k=b[h],{r:k[0],g:k[1],b:k[2]}):h[0]===f?this._hexToRgb(h.substring(1)):h.substr(0,4)===x?(k=_.exec(h.replace(/ /g,"")),{r:parseInt(k[1],10),g:parseInt(k[2],10),b:parseInt(k[3],10)}):{r:0,g:0,b:0}},colorToRGBA(h){return h=h||"black",t.Util._namedColorToRBA(h)||t.Util._hex3ColorToRGBA(h)||t.Util._hex4ColorToRGBA(h)||t.Util._hex6ColorToRGBA(h)||t.Util._hex8ColorToRGBA(h)||t.Util._rgbColorToRGBA(h)||t.Util._rgbaColorToRGBA(h)||t.Util._hslColorToRGBA(h)},_namedColorToRBA(h){const k=b[h.toLowerCase()];return k?{r:k[0],g:k[1],b:k[2],a:1}:null},_rgbColorToRGBA(h){if(h.indexOf("rgb(")===0){h=h.match(/rgb\(([^)]+)\)/)[1];const k=h.split(/ *, */).map(Number);return{r:k[0],g:k[1],b:k[2],a:1}}},_rgbaColorToRGBA(h){if(h.indexOf("rgba(")===0){h=h.match(/rgba\(([^)]+)\)/)[1];const k=h.split(/ *, */).map((E,N)=>E.slice(-1)==="%"?N===3?parseInt(E)/100:parseInt(E)/100*255:Number(E));return{r:k[0],g:k[1],b:k[2],a:k[3]}}},_hex8ColorToRGBA(h){if(h[0]==="#"&&h.length===9)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:parseInt(h.slice(7,9),16)/255}},_hex6ColorToRGBA(h){if(h[0]==="#"&&h.length===7)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:1}},_hex4ColorToRGBA(h){if(h[0]==="#"&&h.length===5)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:parseInt(h[4]+h[4],16)/255}},_hex3ColorToRGBA(h){if(h[0]==="#"&&h.length===4)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:1}},_hslColorToRGBA(h){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(h)){const[k,...E]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(h),N=Number(E[0])/360,I=Number(E[1])/100,M=Number(E[2])/100;let L,A,F;if(I===0)return F=M*255,{r:Math.round(F),g:Math.round(F),b:Math.round(F),a:1};M<.5?L=M*(1+I):L=M+I-M*I;const D=2*M-L,U=[0,0,0];for(let W=0;W<3;W++)A=N+1/3*-(W-1),A<0&&A++,A>1&&A--,6*A<1?F=D+(L-D)*6*A:2*A<1?F=L:3*A<2?F=D+(L-D)*(2/3-A)*6:F=D,U[W]=F*255;return{r:Math.round(U[0]),g:Math.round(U[1]),b:Math.round(U[2]),a:1}}},haveIntersection(h,k){return!(k.x>h.x+h.width||k.x+k.width<h.x||k.y>h.y+h.height||k.y+k.height<h.y)},cloneObject(h){const k={};for(const E in h)this._isPlainObject(h[E])?k[E]=this.cloneObject(h[E]):this._isArray(h[E])?k[E]=this.cloneArray(h[E]):k[E]=h[E];return k},cloneArray(h){return h.slice(0)},degToRad(h){return h*u},radToDeg(h){return h*c},_degToRad(h){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(h)},_radToDeg(h){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(h)},_getRotation(h){return e.Konva.angleDeg?t.Util.radToDeg(h):h},_capitalize(h){return h.charAt(0).toUpperCase()+h.slice(1)},throw(h){throw new Error(y+h)},error(h){console.error(y+h)},warn(h){e.Konva.showWarnings&&console.warn(w+h)},each(h,k){for(const E in h)k(E,h[E])},_inRange(h,k,E){return k<=h&&h<E},_getProjectionToSegment(h,k,E,N,I,M){let L,A,F;const D=(h-E)*(h-E)+(k-N)*(k-N);if(D==0)L=h,A=k,F=(I-E)*(I-E)+(M-N)*(M-N);else{const U=((I-h)*(E-h)+(M-k)*(N-k))/D;U<0?(L=h,A=k,F=(h-I)*(h-I)+(k-M)*(k-M)):U>1?(L=E,A=N,F=(E-I)*(E-I)+(N-M)*(N-M)):(L=h+U*(E-h),A=k+U*(N-k),F=(L-I)*(L-I)+(A-M)*(A-M))}return[L,A,F]},_getProjectionToLine(h,k,E){const N=t.Util.cloneObject(h);let I=Number.MAX_VALUE;return k.forEach(function(M,L){if(!E&&L===k.length-1)return;const A=k[(L+1)%k.length],F=t.Util._getProjectionToSegment(M.x,M.y,A.x,A.y,h.x,h.y),D=F[0],U=F[1],W=F[2];W<I&&(N.x=D,N.y=U,I=W)}),N},_prepareArrayForTween(h,k,E){const N=[],I=[];if(h.length>k.length){const L=k;k=h,h=L}for(let L=0;L<h.length;L+=2)N.push({x:h[L],y:h[L+1]});for(let L=0;L<k.length;L+=2)I.push({x:k[L],y:k[L+1]});const M=[];return I.forEach(function(L){const A=t.Util._getProjectionToLine(L,N,E);M.push(A.x),M.push(A.y)}),M},_prepareToStringify(h){let k;h.visitedByCircularReferenceRemoval=!0;for(const E in h)if(h.hasOwnProperty(E)&&h[E]&&typeof h[E]=="object"){if(k=Object.getOwnPropertyDescriptor(h,E),h[E].visitedByCircularReferenceRemoval||t.Util._isElement(h[E]))if(k.configurable)delete h[E];else return null;else if(t.Util._prepareToStringify(h[E])===null)if(k.configurable)delete h[E];else return null}return delete h.visitedByCircularReferenceRemoval,h},_assign(h,k){for(const E in k)h[E]=k[E];return h},_getFirstPointerId(h){return h.touches?h.changedTouches[0].identifier:h.pointerId||999},releaseCanvas(...h){e.Konva.releaseCanvasOnDestroy&&h.forEach(k=>{k.width=0,k.height=0})},drawRoundedRectPath(h,k,E,N){let I=0,M=0,L=0,A=0;typeof N=="number"?I=M=L=A=Math.min(N,k/2,E/2):(I=Math.min(N[0]||0,k/2,E/2),M=Math.min(N[1]||0,k/2,E/2),A=Math.min(N[2]||0,k/2,E/2),L=Math.min(N[3]||0,k/2,E/2)),h.moveTo(I,0),h.lineTo(k-M,0),h.arc(k-M,M,M,Math.PI*3/2,0,!1),h.lineTo(k,E-A),h.arc(k-A,E-A,A,0,Math.PI/2,!1),h.lineTo(L,E),h.arc(L,E-L,L,Math.PI/2,Math.PI,!1),h.lineTo(0,I),h.arc(I,I,I,Math.PI,Math.PI*3/2,!1)}}})(mt);var ut={},Oe={},Ne={};Object.defineProperty(Ne,"__esModule",{value:!0});Ne.RGBComponent=VS;Ne.alphaComponent=WS;Ne.getNumberValidator=$S;Ne.getNumberOrArrayOfNumbersValidator=HS;Ne.getNumberOrAutoValidator=YS;Ne.getStringValidator=XS;Ne.getStringOrGradientValidator=KS;Ne.getFunctionValidator=QS;Ne.getNumberArrayValidator=ZS;Ne.getBooleanValidator=qS;Ne.getComponentValidator=JS;const ui=Re,xt=mt;function di(t){return xt.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||xt.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function VS(t){return t>255?255:t<0?0:Math.round(t)}function WS(t){return t>1?1:t<1e-4?1e-4:t}function $S(){if(ui.Konva.isUnminified)return function(t,e){return xt.Util._isNumber(t)||xt.Util.warn(di(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function HS(t){if(ui.Konva.isUnminified)return function(e,n){let r=xt.Util._isNumber(e),i=xt.Util._isArray(e)&&e.length==t;return!r&&!i&&xt.Util.warn(di(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function YS(){if(ui.Konva.isUnminified)return function(t,e){var n=xt.Util._isNumber(t),r=t==="auto";return n||r||xt.Util.warn(di(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function XS(){if(ui.Konva.isUnminified)return function(t,e){return xt.Util._isString(t)||xt.Util.warn(di(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function KS(){if(ui.Konva.isUnminified)return function(t,e){const n=xt.Util._isString(t),r=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return n||r||xt.Util.warn(di(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function QS(){if(ui.Konva.isUnminified)return function(t,e){return xt.Util._isFunction(t)||xt.Util.warn(di(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function ZS(){if(ui.Konva.isUnminified)return function(t,e){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&t instanceof n||(xt.Util._isArray(t)?t.forEach(function(r){xt.Util._isNumber(r)||xt.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):xt.Util.warn(di(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function qS(){if(ui.Konva.isUnminified)return function(t,e){var n=t===!0||t===!1;return n||xt.Util.warn(di(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function JS(t){if(ui.Konva.isUnminified)return function(e,n){return e==null||xt.Util.isObject(e)||xt.Util.warn(di(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=mt,n=Ne,r="get",i="set";t.Factory={addGetterSetter(s,l,u,c,f){t.Factory.addGetter(s,l,u),t.Factory.addSetter(s,l,c,f),t.Factory.addOverloadedGetterSetter(s,l)},addGetter(s,l,u){var c=r+e.Util._capitalize(l);s.prototype[c]=s.prototype[c]||function(){const f=this.attrs[l];return f===void 0?u:f}},addSetter(s,l,u,c){var f=i+e.Util._capitalize(l);s.prototype[f]||t.Factory.overWriteSetter(s,l,u,c)},overWriteSetter(s,l,u,c){var f=i+e.Util._capitalize(l);s.prototype[f]=function(p){return u&&p!==void 0&&p!==null&&(p=u.call(this,p,l)),this._setAttr(l,p),c&&c.call(this),this}},addComponentsGetterSetter(s,l,u,c,f){const p=u.length,m=e.Util._capitalize,w=r+m(l),y=i+m(l);s.prototype[w]=function(){const b={};for(let _=0;_<p;_++){const S=u[_];b[S]=this.getAttr(l+m(S))}return b};const x=(0,n.getComponentValidator)(u);s.prototype[y]=function(b){const _=this.attrs[l];c&&(b=c.call(this,b,l)),x&&x.call(this,b,l);for(const S in b)b.hasOwnProperty(S)&&this._setAttr(l+m(S),b[S]);return b||u.forEach(S=>{this._setAttr(l+m(S),void 0)}),this._fireChangeEvent(l,_,b),f&&f.call(this),this},t.Factory.addOverloadedGetterSetter(s,l)},addOverloadedGetterSetter(s,l){var u=e.Util._capitalize(l),c=i+u,f=r+u;s.prototype[l]=function(){return arguments.length?(this[c](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(s,l,u,c){e.Util.error("Adding deprecated "+l);const f=r+e.Util._capitalize(l),p=l+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[f]=function(){e.Util.error(p);const m=this.attrs[l];return m===void 0?u:m},t.Factory.addSetter(s,l,c,function(){e.Util.error(p)}),t.Factory.addOverloadedGetterSetter(s,l)},backCompat(s,l){e.Util.each(l,function(u,c){const f=s.prototype[c],p=r+e.Util._capitalize(u),m=i+e.Util._capitalize(u);function w(){f.apply(this,arguments),e.Util.error('"'+u+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}s.prototype[u]=w,s.prototype[p]=w,s.prototype[m]=w})},afterSetFilter(){this._filterUpToDate=!1}}})(Oe);var yr={},ii={};Object.defineProperty(ii,"__esModule",{value:!0});ii.HitContext=ii.SceneContext=ii.Context=void 0;const $4=mt,e_=Re;function t_(t){const e=[],n=t.length,r=$4.Util;for(let i=0;i<n;i++){let s=t[i];r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s)}return e}const fy=",",n_="(",r_=")",i_="([",s_="])",o_=";",a_="()",l_="=",hy=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],c_=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],u_=100;class ud{constructor(e){this.canvas=e,e_.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){let r=this.traceArr,i=r.length,s="",l,u,c,f;for(l=0;l<i;l++)u=r[l],c=u.method,c?(f=u.args,s+=c,e?s+=a_:$4.Util._isArray(f[0])?s+=i_+f.join(fy)+s_:(n&&(f=f.map(p=>typeof p=="number"?Math.floor(p):p)),s+=n_+f.join(fy)+r_)):(s+=u.property,e||(s+=l_+u.val)),s+=o_;return s}clearTrace(){this.traceArr=[]}_trace(e){let n=this.traceArr,r;n.push(e),r=n.length,r>=u_&&n.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){const n=e.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(e){const n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){const n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}setAttr(e,n){this._context[e]=n}arc(e,n,r,i,s,l){this._context.arc(e,n,r,i,s,l)}arcTo(e,n,r,i,s){this._context.arcTo(e,n,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,r,i,s,l){this._context.bezierCurveTo(e,n,r,i,s,l)}clearRect(e,n,r,i){this._context.clearRect(e,n,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,n){const r=arguments;if(r.length===2)return this._context.createImageData(e,n);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,r,i){return this._context.createLinearGradient(e,n,r,i)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,r,i,s,l){return this._context.createRadialGradient(e,n,r,i,s,l)}drawImage(e,n,r,i,s,l,u,c,f){const p=arguments,m=this._context;p.length===3?m.drawImage(e,n,r):p.length===5?m.drawImage(e,n,r,i,s):p.length===9&&m.drawImage(e,n,r,i,s,l,u,c,f)}ellipse(e,n,r,i,s,l,u,c){this._context.ellipse(e,n,r,i,s,l,u,c)}isPointInPath(e,n,r,i){return r?this._context.isPointInPath(r,e,n,i):this._context.isPointInPath(e,n,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,n,r,i){this._context.fillRect(e,n,r,i)}strokeRect(e,n,r,i){this._context.strokeRect(e,n,r,i)}fillText(e,n,r,i){i?this._context.fillText(e,n,r,i):this._context.fillText(e,n,r)}measureText(e){return this._context.measureText(e)}getImageData(e,n,r,i){return this._context.getImageData(e,n,r,i)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,r,i){this._context.rect(e,n,r,i)}roundRect(e,n,r,i,s){this._context.roundRect(e,n,r,i,s)}putImageData(e,n,r){this._context.putImageData(e,n,r)}quadraticCurveTo(e,n,r,i){this._context.quadraticCurveTo(e,n,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,r,i,s,l){this._context.setTransform(e,n,r,i,s,l)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,r,i){this._context.strokeText(e,n,r,i)}transform(e,n,r,i,s,l){this._context.transform(e,n,r,i,s,l)}translate(e,n){this._context.translate(e,n)}_enableTrace(){let e=this,n=hy.length,r=this.setAttr,i,s;const l=function(u){let c=e[u],f;e[u]=function(){return s=t_(Array.prototype.slice.call(arguments,0)),f=c.apply(e,arguments),e._trace({method:u,args:s}),f}};for(i=0;i<n;i++)l(hy[i]);e.setAttr=function(){r.apply(e,arguments);const u=arguments[0];let c=arguments[1];(u==="shadowOffsetX"||u==="shadowOffsetY"||u==="shadowBlur")&&(c=c/this.canvas.getPixelRatio()),e._trace({property:u,val:c})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}ii.Context=ud;c_.forEach(function(t){Object.defineProperty(ud.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class d_ extends ud{constructor(e,{willReadFrequently:n=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(e){const n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){const n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){const n=e.fill(),r=e.getFillPriority();if(n&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const l=e.getFillRadialGradientColorStops();if(l&&r==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):l&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const n=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(n.x,n.y,r.x,r.y);if(i){for(let l=0;l<i.length;l+=2)s.addColorStop(i[l],i[l+1]);this.setAttr("strokeStyle",s)}}_stroke(e){const n=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var n,r,i;const s=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",l=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,u=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},c=e.getAbsoluteScale(),f=this.canvas.getPixelRatio(),p=c.x*f,m=c.y*f;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",l*Math.min(Math.abs(p),Math.abs(m))),this.setAttr("shadowOffsetX",u.x*p),this.setAttr("shadowOffsetY",u.y*m)}}ii.SceneContext=d_;class f_ extends ud{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const n=e.getStrokeScaleEnabled();if(!n){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e);const r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),n||this.restore()}}}ii.HitContext=f_;Object.defineProperty(yr,"__esModule",{value:!0});yr.HitCanvas=yr.SceneCanvas=yr.Canvas=void 0;const Uu=mt,H4=ii,Y4=Re;let Gc;function h_(){if(Gc)return Gc;const t=Uu.Util.createCanvasElement(),e=t.getContext("2d");return Gc=function(){const n=Y4.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/r}(),Uu.Util.releaseCanvas(t),Gc}class kg{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const r=(e||{}).pixelRatio||Y4.Konva.pixelRatio||h_();this.pixelRatio=r,this._canvas=Uu.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const n=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,n){this.setWidth(e||0),this.setHeight(n||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(i){return Uu.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}yr.Canvas=kg;class p_ extends kg{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new H4.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}yr.SceneCanvas=p_;class g_ extends kg{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new H4.HitContext(this),this.setSize(e.width,e.height)}}yr.HitCanvas=g_;var dd={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=Re,n=mt;t.DD={get isDragging(){let r=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return t.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];t.DD._dragElements.forEach((s,l)=>{const{node:u}=s,c=u.getStage();c.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=n.Util._getFirstPointerId(r));const f=c._changedPointerPositions.find(p=>p.id===s.pointerId);if(f){if(s.dragStatus!=="dragging"){const p=u.dragDistance();if(Math.max(Math.abs(f.x-s.startPointerPos.x),Math.abs(f.y-s.startPointerPos.y))<p||(u.startDrag({evt:r}),!u.isDragging()))return}u._setDragPosition(r,s),i.push(u)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];t.DD._dragElements.forEach(s=>{const{node:l}=s,u=l.getStage();if(r&&u.setPointersPositions(r),!u._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const f=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){t.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(dd);Object.defineProperty(ut,"__esModule",{value:!0});ut.Node=void 0;const Be=mt,Tl=Oe,Na=yr,Ti=Re,Hn=dd,kt=Ne,lu="absoluteOpacity",Vc="allEventListeners",Zr="absoluteTransform",py="absoluteScale",gs="canvas",m_="Change",y_="children",v_="konva",pp="listening",gy="mouseenter",my="mouseleave",yy="set",vy="Shape",cu=" ",xy="stage",Ni="transform",x_="Stage",gp="visible",w_=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(cu);let S_=1;class Me{constructor(e){this._id=S_++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Ni||e===Zr)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){let r=this._cache.get(e);return(r===void 0||(e===Ni||e===Zr)&&r.dirty===!0)&&(r=n.call(this),this._cache.set(e,r)),r}_calculate(e,n,r){if(!this._attachedDepsListeners.get(e)){const i=n.map(s=>s+"Change.konva").join(cu);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(gs)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Zr&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(gs)){const{scene:e,filter:n,hit:r}=this._cache.get(gs);Be.Util.releaseCanvas(e,n,r),this._cache.delete(gs)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const n=e||{};let r={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(n.width||r.width),s=Math.ceil(n.height||r.height),l=n.pixelRatio,u=n.x===void 0?Math.floor(r.x):n.x,c=n.y===void 0?Math.floor(r.y):n.y,f=n.offset||0,p=n.drawBorder||!1,m=n.hitCanvasPixelRatio||1;if(!i||!s){Be.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const w=Math.abs(Math.round(r.x)-u)>.5?1:0,y=Math.abs(Math.round(r.y)-c)>.5?1:0;i+=f*2+w,s+=f*2+y,u-=f,c-=f;const x=new Na.SceneCanvas({pixelRatio:l,width:i,height:s}),b=new Na.SceneCanvas({pixelRatio:l,width:0,height:0,willReadFrequently:!0}),_=new Na.HitCanvas({pixelRatio:m,width:i,height:s}),S=x.getContext(),T=_.getContext();return _.isCache=!0,x.isCache=!0,this._cache.delete(gs),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(x.getContext()._context.imageSmoothingEnabled=!1,b.getContext()._context.imageSmoothingEnabled=!1),S.save(),T.save(),S.translate(-u,-c),T.translate(-u,-c),this._isUnderCache=!0,this._clearSelfAndDescendantCache(lu),this._clearSelfAndDescendantCache(py),this.drawScene(x,this),this.drawHit(_,this),this._isUnderCache=!1,S.restore(),T.restore(),p&&(S.save(),S.beginPath(),S.rect(0,0,i,s),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),this._cache.set(gs,{scene:x,filter:b,hit:_,x:u,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(gs)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){const r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,s=1/0,l=-1/0,u=-1/0;const c=this.getAbsoluteTransform(n);return r.forEach(function(f){const p=c.point(f);i===void 0&&(i=l=p.x,s=u=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),l=Math.max(l,p.x),u=Math.max(u,p.y)}),{x:i,y:s,width:l-i,height:u-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);const r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){const n=this._getCanvasCache(),r=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),n=this._getCanvasCache(),r=n.scene,i=n.filter,s=i.getContext(),l,u,c,f;if(e){if(!this._filterUpToDate){const p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(l=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),u=s.getImageData(0,0,i.getWidth(),i.getHeight()),c=0;c<l;c++){if(f=e[c],typeof f!="function"){Be.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,u),s.putImageData(u,0,0)}}catch(m){Be.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,n){if(this._cache&&this._cache.delete(Vc),arguments.length===3)return this._delegate.apply(this,arguments);let r=e.split(cu),i=r.length,s,l,u,c,f;for(s=0;s<i;s++)l=r[s],u=l.split("."),c=u[0],f=u[1]||"",this.eventListeners[c]||(this.eventListeners[c]=[]),this.eventListeners[c].push({name:f,handler:n});return this}off(e,n){let r=(e||"").split(cu),i=r.length,s,l,u,c,f,p;if(this._cache&&this._cache.delete(Vc),!e)for(l in this.eventListeners)this._off(l);for(s=0;s<i;s++)if(u=r[s],c=u.split("."),f=c[0],p=c[1],f)this.eventListeners[f]&&this._off(f,p,n);else for(l in this.eventListeners)this._off(l,p,n);return this}dispatchEvent(e){const n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(r){n.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,r){const i=this;this.on(e,function(s){const l=s.target.findAncestors(n,!0,i);for(let u=0;u<l.length;u++)s=Be.Util.cloneObject(s),s.currentTarget=l[u],r.call(l[u],s)})}remove(){return this.isDragging()&&this.stopDrag(),Hn.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Zr),this._clearSelfAndDescendantCache(lu),this._clearSelfAndDescendantCache(py),this._clearSelfAndDescendantCache(xy),this._clearSelfAndDescendantCache(gp),this._clearSelfAndDescendantCache(pp)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const n="get"+Be.Util._capitalize(e);return Be.Util._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){let e=this.getParent(),n=[];for(;e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let n,r;if(!e)return this;for(n in e)n!==y_&&(r=yy+Be.Util._capitalize(n),Be.Util._isFunction(this[r])?this[r](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache(pp,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(gp,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);const r=this.getLayer();let i=!1;Hn.DD._dragElements.forEach(l=>{l.dragStatus==="dragging"&&(l.node.nodeType==="Stage"||l.node.getLayer()===r)&&(i=!0)});const s=!n&&!Ti.Konva.hitOnDragEnabled&&(i||Ti.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),n=this,r=0,i,s,l,u;function c(p){for(i=[],s=p.length,l=0;l<s;l++)u=p[l],r++,u.nodeType!==vy&&(i=i.concat(u.getChildren().slice())),u._id===n._id&&(l=s);i.length>0&&i[0].getDepth()<=e&&c(i)}const f=this.getStage();return n.nodeType!==x_&&f&&c(f.getChildren()),r}getDepth(){let e=0,n=this.parent;for(;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ni),this._clearSelfAndDescendantCache(Zr)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const n=e.getPointerPosition();if(!n)return null;const r=this.getAbsoluteTransform().copy();return r.invert(),r.point(n)}getAbsolutePosition(e){let n=!1,r=this.parent;for(;r;){if(r.isCached()){n=!0;break}r=r.parent}n&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),s=new Be.Transform,l=this.offset();return s.m=i.slice(),s.translate(l.x,l.y),s.getTranslation()}setAbsolutePosition(e){const{x:n,y:r,...i}=this._clearTransform();this.attrs.x=n,this.attrs.y=r,this._clearCache(Ni);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(Ni),this._clearSelfAndDescendantCache(Zr),this}_setTransform(e){let n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let n=e.x,r=e.y,i=this.x(),s=this.y();return n!==void 0&&(i+=n),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,n){let r=[],i=this.getParent(),s,l;if(!(n&&n._id===this._id)){for(r.unshift(this);i&&(!n||i._id!==n._id);)r.unshift(i),i=i.parent;for(s=r.length,l=0;l<s;l++)e(r[l])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return Be.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Be.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Be.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Be.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return Be.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&Be.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(lu,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),n,r,i,s,l;const u={attrs:{},className:this.getClassName()};for(n in e)r=e[n],l=Be.Util.isObject(r)&&!Be.Util._isPlainObject(r)&&!Be.Util._isArray(r),!l&&(i=typeof this[n]=="function"&&this[n],delete e[n],s=i?i.call(this):null,e[n]=r,s!==r&&(u.attrs[n]=r));return Be.Util._prepareToStringify(u)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,r){const i=[];n&&this._isMatch(e)&&i.push(this);let s=this.parent;for(;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,n,r){return this.findAncestors(e,n,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let n=e.replace(/ /g,"").split(","),r=n.length,i,s;for(i=0;i<r;i++)if(s=n[i],Be.Util.isValidSelector(s)||(Be.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Be.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Be.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(xy,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,n={},r){return n.target=n.target||this,r?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Zr,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let n;if(e)return n=new Be.Transform,this._eachAncestorReverse(function(r){const i=r.transformsEnabled();i==="all"?n.multiply(r.getTransform()):i==="position"&&n.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),n;{n=this._cache.get(Zr)||new Be.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const r=this.transformsEnabled();if(r==="all")n.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,l=this.attrs.offsetX||0,u=this.attrs.offsetY||0;n.translate(i-l,s-u)}return n.dirty=!1,n}}getAbsoluteScale(e){let n=this;for(;n;)n._isUnderCache&&(e=n),n=n.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ni,this._getTransform)}_getTransform(){var e,n;const r=this._cache.get(Ni)||new Be.Transform;r.reset();const i=this.x(),s=this.y(),l=Ti.Konva.getAngle(this.rotation()),u=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,c=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,f=this.attrs.skewX||0,p=this.attrs.skewY||0,m=this.attrs.offsetX||0,w=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),l!==0&&r.rotate(l),(f!==0||p!==0)&&r.skew(f,p),(u!==1||c!==1)&&r.scale(u,c),(m!==0||w!==0)&&r.translate(-1*m,-1*w),r.dirty=!1,r}clone(e){let n=Be.Util.cloneObject(this.attrs),r,i,s,l,u;for(r in e)n[r]=e[r];const c=new this.constructor(n);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,l=0;l<s;l++)u=i[l],u.name.indexOf(v_)<0&&(c.eventListeners[r]||(c.eventListeners[r]=[]),c.eventListeners[r].push(u));return c}_toKonvaCanvas(e){e=e||{};const n=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(n.x),s=e.y!==void 0?e.y:Math.floor(n.y),l=e.pixelRatio||1,u=new Na.SceneCanvas({width:e.width||Math.ceil(n.width)||(r?r.width():0),height:e.height||Math.ceil(n.height)||(r?r.height():0),pixelRatio:l}),c=u.getContext(),f=new Na.SceneCanvas({width:u.width/u.pixelRatio+Math.abs(i),height:u.height/u.pixelRatio+Math.abs(s),pixelRatio:u.pixelRatio});return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||s)&&c.translate(-1*i,-1*s),this.drawScene(u,void 0,f),c.restore(),u}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const n=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(n,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((n,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,Be.Util._urlToImage(this.toDataURL(e),function(s){n(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((n,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{n(s),i==null||i(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Ti.Konva.dragDistance}_off(e,n,r){let i=this.eventListeners[e],s,l,u;for(s=0;s<i.length;s++)if(l=i[s].name,u=i[s].handler,(l!=="konva"||n==="konva")&&(!n||l===n)&&(!r||r===u)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,n,r){this._fire(e+m_,{oldVal:n,newVal:r})}addName(e){if(!this.hasName(e)){const n=this.name(),r=n?n+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const n=(this.name()||"").split(/\s/g),r=n.indexOf(e);return r!==-1&&(n.splice(r,1),this.name(n.join(" "))),this}setAttr(e,n){const r=this[yy+Be.Util._capitalize(e)];return Be.Util._isFunction(r)?r.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(Ti.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,n){const r=this.attrs[e];r===n&&!Be.Util.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,n),this._requestDraw())}_setComponentAttr(e,n,r){let i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,n,r){if(n&&this.nodeType===vy&&(n.target=this),!((e===gy||e===my)&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r))){this._fire(e,n);const s=(e===gy||e===my)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!s&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,n,r):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){var n,r,i;const s=(n=this._cache.get(Vc))!==null&&n!==void 0?n:{};let l=s==null?void 0:s[e];if(l===void 0){l=[];let u=Object.getPrototypeOf(this);for(;u;){const c=(i=(r=u.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];l.push(...c),u=Object.getPrototypeOf(u)}s[e]=l,this._cache.set(Vc,s)}return l}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const r=this._getProtoListeners(e);if(r)for(var i=0;i<r.length;i++)r[i].handler.call(this,n);const s=this.eventListeners[e];if(s)for(var i=0;i<s.length;i++)s[i].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const n=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;const s=r._getPointerById(n)||r._changedPointerPositions[0]||i;Hn.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:n})}startDrag(e,n=!0){Hn.DD._dragElements.has(this._id)||this._createDragElement(e);const r=Hn.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const r=this.getStage()._getPointerById(n.pointerId);if(!r)return;let i={x:r.x-n.offset.x,y:r.y-n.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const l=s.call(this,i,e);l?i=l:Be.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const n=Hn.DD._dragElements.get(this._id);n&&(n.dragStatus="stopped"),Hn.DD._endDragBefore(e),Hn.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Hn.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Ti.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Hn.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=Hn.DD._dragElements.get(this._id),r=n&&n.dragStatus==="dragging",i=n&&n.dragStatus==="ready";r?this.stopDrag():i&&Hn.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const r={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return Be.Util.haveIntersection(r,this.getClientRect())}static create(e,n){return Be.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){let r=Me.prototype.getClassName.call(e),i=e.children,s,l,u;n&&(e.attrs.container=n),Ti.Konva[r]||(Be.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const c=Ti.Konva[r];if(s=new c(e.attrs),i)for(l=i.length,u=0;u<l;u++)s.add(Me._createNode(i[u]));return s}}ut.Node=Me;Me.prototype.nodeType="Node";Me.prototype._attrsAffectingSize=[];Me.prototype.eventListeners={};Me.prototype.on.call(Me.prototype,w_,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Ni),this._clearSelfAndDescendantCache(Zr)});Me.prototype.on.call(Me.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(gp)});Me.prototype.on.call(Me.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(pp)});Me.prototype.on.call(Me.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(lu)});const Ze=Tl.Factory.addGetterSetter;Ze(Me,"zIndex");Ze(Me,"absolutePosition");Ze(Me,"position");Ze(Me,"x",0,(0,kt.getNumberValidator)());Ze(Me,"y",0,(0,kt.getNumberValidator)());Ze(Me,"globalCompositeOperation","source-over",(0,kt.getStringValidator)());Ze(Me,"opacity",1,(0,kt.getNumberValidator)());Ze(Me,"name","",(0,kt.getStringValidator)());Ze(Me,"id","",(0,kt.getStringValidator)());Ze(Me,"rotation",0,(0,kt.getNumberValidator)());Tl.Factory.addComponentsGetterSetter(Me,"scale",["x","y"]);Ze(Me,"scaleX",1,(0,kt.getNumberValidator)());Ze(Me,"scaleY",1,(0,kt.getNumberValidator)());Tl.Factory.addComponentsGetterSetter(Me,"skew",["x","y"]);Ze(Me,"skewX",0,(0,kt.getNumberValidator)());Ze(Me,"skewY",0,(0,kt.getNumberValidator)());Tl.Factory.addComponentsGetterSetter(Me,"offset",["x","y"]);Ze(Me,"offsetX",0,(0,kt.getNumberValidator)());Ze(Me,"offsetY",0,(0,kt.getNumberValidator)());Ze(Me,"dragDistance",void 0,(0,kt.getNumberValidator)());Ze(Me,"width",0,(0,kt.getNumberValidator)());Ze(Me,"height",0,(0,kt.getNumberValidator)());Ze(Me,"listening",!0,(0,kt.getBooleanValidator)());Ze(Me,"preventDefault",!0,(0,kt.getBooleanValidator)());Ze(Me,"filters",void 0,function(t){return this._filterUpToDate=!1,t});Ze(Me,"visible",!0,(0,kt.getBooleanValidator)());Ze(Me,"transformsEnabled","all",(0,kt.getStringValidator)());Ze(Me,"size");Ze(Me,"dragBoundFunc");Ze(Me,"draggable",!1,(0,kt.getBooleanValidator)());Tl.Factory.backCompat(Me,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var As={};Object.defineProperty(As,"__esModule",{value:!0});As.Container=void 0;const Vo=Oe,Jh=ut,fd=Ne;class Is extends Jh.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const n=this.children||[],r=[];return n.forEach(function(i){e(i)&&r.push(i)}),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let r=0;r<e.length;r++)this.add(e[r]);return this}const n=e[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){const r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&n)}),r}_descendants(e){let n=!1;const r=this.getChildren();for(const i of r){if(n=e(i),n)return!0;if(i.hasChildren()&&(n=i._descendants(e),n))return!0}return!1}toObject(){const e=Jh.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){let n=e.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){const n=Jh.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){n.add(r.clone())}),n}getAllIntersections(e){const n=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&n.push(r)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,r){n.index=r}),this._requestDraw()}drawScene(e,n,r){const i=this.getLayer(),s=e||i&&i.getCanvas(),l=s&&s.getContext(),u=this._getCanvasCache(),c=u&&u.scene,f=s&&s.isCache;if(!this.isVisible()&&!f)return this;if(c){l.save();const p=this.getAbsoluteTransform(n).getMatrix();l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(l),l.restore()}else this._drawChildren("drawScene",s,n,r);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;const r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),l=this._getCanvasCache();if(l&&l.hit){s.save();const c=this.getAbsoluteTransform(n).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,n);return this}_drawChildren(e,n,r,i){var s;const l=n&&n.getContext(),u=this.clipWidth(),c=this.clipHeight(),f=this.clipFunc(),p=typeof u=="number"&&typeof c=="number"||f,m=r===this;if(p){l.save();const y=this.getAbsoluteTransform(r);let x=y.getMatrix();l.transform(x[0],x[1],x[2],x[3],x[4],x[5]),l.beginPath();let b;if(f)b=f.call(this,l,this);else{const _=this.clipX(),S=this.clipY();l.rect(_||0,S||0,u,c)}l.clip.apply(l,b),x=y.copy().invert().getMatrix(),l.transform(x[0],x[1],x[2],x[3],x[4],x[5])}const w=!m&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";w&&(l.save(),l._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(y){y[e](n,r,i)}),w&&l.restore(),p&&l.restore()}getClientRect(e={}){var n;const r=e.skipTransform,i=e.relativeTo;let s,l,u,c,f={x:1/0,y:1/0,width:0,height:0};const p=this;(n=this.children)===null||n===void 0||n.forEach(function(y){if(!y.visible())return;const x=y.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});x.width===0&&x.height===0||(s===void 0?(s=x.x,l=x.y,u=x.x+x.width,c=x.y+x.height):(s=Math.min(s,x.x),l=Math.min(l,x.y),u=Math.max(u,x.x+x.width),c=Math.max(c,x.y+x.height)))});const m=this.find("Shape");let w=!1;for(let y=0;y<m.length;y++)if(m[y]._isVisible(this)){w=!0;break}return w&&s!==void 0?f={x:s,y:l,width:u-s,height:c-l}:f={x:0,y:0,width:0,height:0},r?f:this._transformedRect(f,i)}}As.Container=Is;Vo.Factory.addComponentsGetterSetter(Is,"clip",["x","y","width","height"]);Vo.Factory.addGetterSetter(Is,"clipX",void 0,(0,fd.getNumberValidator)());Vo.Factory.addGetterSetter(Is,"clipY",void 0,(0,fd.getNumberValidator)());Vo.Factory.addGetterSetter(Is,"clipWidth",void 0,(0,fd.getNumberValidator)());Vo.Factory.addGetterSetter(Is,"clipHeight",void 0,(0,fd.getNumberValidator)());Vo.Factory.addGetterSetter(Is,"clipFunc");var X4={},Zi={};Object.defineProperty(Zi,"__esModule",{value:!0});Zi.getCapturedShape=k_;Zi.createEvent=bg;Zi.hasPointerCapture=b_;Zi.setPointerCapture=C_;Zi.releaseCapture=Q4;const __=Re,gl=new Map,K4=__.Konva._global.PointerEvent!==void 0;function k_(t){return gl.get(t)}function bg(t){return{evt:t,pointerId:t.pointerId}}function b_(t,e){return gl.get(t)===e}function C_(t,e){Q4(t),e.getStage()&&(gl.set(t,e),K4&&e._fire("gotpointercapture",bg(new PointerEvent("gotpointercapture"))))}function Q4(t,e){const n=gl.get(t);if(!n)return;const r=n.getStage();r&&r.content,gl.delete(t),K4&&n._fire("lostpointercapture",bg(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=mt,n=Oe,r=As,i=Re,s=yr,l=dd,u=Re,c=Zi,f="Stage",p="string",m="px",w="mouseout",y="mouseleave",x="mouseover",b="mouseenter",_="mousemove",S="mousedown",T="mouseup",h="pointermove",k="pointerdown",E="pointerup",N="pointercancel",I="lostpointercapture",M="pointerout",L="pointerleave",A="pointerover",F="pointerenter",D="contextmenu",U="touchstart",W="touchend",G="touchmove",z="touchcancel",B="wheel",j=5,$=[[b,"_pointerenter"],[S,"_pointerdown"],[_,"_pointermove"],[T,"_pointerup"],[y,"_pointerleave"],[U,"_pointerdown"],[G,"_pointermove"],[W,"_pointerup"],[z,"_pointercancel"],[x,"_pointerover"],[B,"_wheel"],[D,"_contextmenu"],[k,"_pointerdown"],[h,"_pointermove"],[E,"_pointerup"],[N,"_pointercancel"],[I,"_lostpointercapture"]],X={mouse:{[M]:w,[L]:y,[A]:x,[F]:b,[h]:_,[k]:S,[E]:T,[N]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[M]:"touchout",[L]:"touchleave",[A]:"touchover",[F]:"touchenter",[h]:G,[k]:U,[E]:W,[N]:z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[M]:M,[L]:L,[A]:A,[F]:F,[h]:h,[k]:k,[E]:E,[N]:N,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ee=fe=>fe.indexOf("pointer")>=0?"pointer":fe.indexOf("touch")>=0?"touch":"mouse",ne=fe=>{const V=ee(fe);if(V==="pointer")return i.Konva.pointerEventsEnabled&&X.pointer;if(V==="touch")return X.touch;if(V==="mouse")return X.mouse};function Z(fe={}){return(fe.clipFunc||fe.clipWidth||fe.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),fe}const te="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class de extends r.Container{constructor(V){super(Z(V)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Z(this.attrs)}),this._checkVisibility()}_validateAdd(V){const K=V.getType()==="Layer",se=V.getType()==="FastLayer";K||se||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const V=this.visible()?"":"none";this.content.style.display=V}setContainer(V){if(typeof V===p){if(V.charAt(0)==="."){const se=V.slice(1);V=document.getElementsByClassName(se)[0]}else{var K;V.charAt(0)!=="#"?K=V:K=V.slice(1),V=document.getElementById(K)}if(!V)throw"Can not find container in document with id "+K}return this._setAttr("container",V),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),V.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const V=this.children,K=V.length;for(let se=0;se<K;se++)V[se].clear();return this}clone(V){return V||(V={}),V.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,V)}destroy(){super.destroy();const V=this.content;V&&e.Util._isInDocument(V)&&this.container().removeChild(V);const K=t.stages.indexOf(this);return K>-1&&t.stages.splice(K,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const V=this._pointerPositions[0]||this._changedPointerPositions[0];return V?{x:V.x,y:V.y}:(e.Util.warn(te),null)}_getPointerById(V){return this._pointerPositions.find(K=>K.id===V)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(V){V=V||{},V.x=V.x||0,V.y=V.y||0,V.width=V.width||this.width(),V.height=V.height||this.height();const K=new s.SceneCanvas({width:V.width,height:V.height,pixelRatio:V.pixelRatio||1}),se=K.getContext()._context,re=this.children;return(V.x||V.y)&&se.translate(-1*V.x,-1*V.y),re.forEach(function(oe){if(!oe.isVisible())return;const ge=oe._toKonvaCanvas(V);se.drawImage(ge._canvas,V.x,V.y,ge.getWidth()/ge.getPixelRatio(),ge.getHeight()/ge.getPixelRatio())}),K}getIntersection(V){if(!V)return null;const K=this.children,se=K.length,re=se-1;for(let oe=re;oe>=0;oe--){const ge=K[oe].getIntersection(V);if(ge)return ge}return null}_resizeDOM(){const V=this.width(),K=this.height();this.content&&(this.content.style.width=V+m,this.content.style.height=K+m),this.bufferCanvas.setSize(V,K),this.bufferHitCanvas.setSize(V,K),this.children.forEach(se=>{se.setSize({width:V,height:K}),se.draw()})}add(V,...K){if(arguments.length>1){for(let re=0;re<arguments.length;re++)this.add(arguments[re]);return this}super.add(V);const se=this.children.length;return se>j&&e.Util.warn("The stage has "+se+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),V.setSize({width:this.width(),height:this.height()}),V.draw(),i.Konva.isBrowser&&this.content.appendChild(V.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(V){return c.hasPointerCapture(V,this)}setPointerCapture(V){c.setPointerCapture(V,this)}releaseCapture(V){c.releaseCapture(V,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&$.forEach(([V,K])=>{this.content.addEventListener(V,se=>{this[K](se)},{passive:!1})})}_pointerenter(V){this.setPointersPositions(V);const K=ne(V.type);K&&this._fire(K.pointerenter,{evt:V,target:this,currentTarget:this})}_pointerover(V){this.setPointersPositions(V);const K=ne(V.type);K&&this._fire(K.pointerover,{evt:V,target:this,currentTarget:this})}_getTargetShape(V){let K=this[V+"targetShape"];return K&&!K.getStage()&&(K=null),K}_pointerleave(V){const K=ne(V.type),se=ee(V.type);if(!K)return;this.setPointersPositions(V);const re=this._getTargetShape(se),oe=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;re&&oe?(re._fireAndBubble(K.pointerout,{evt:V}),re._fireAndBubble(K.pointerleave,{evt:V}),this._fire(K.pointerleave,{evt:V,target:this,currentTarget:this}),this[se+"targetShape"]=null):oe&&(this._fire(K.pointerleave,{evt:V,target:this,currentTarget:this}),this._fire(K.pointerout,{evt:V,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(V){const K=ne(V.type),se=ee(V.type);if(!K)return;this.setPointersPositions(V);let re=!1;this._changedPointerPositions.forEach(oe=>{const ge=this.getIntersection(oe);if(l.DD.justDragged=!1,i.Konva["_"+se+"ListenClick"]=!0,!ge||!ge.isListening()){this[se+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&ge.setPointerCapture(oe.id),this[se+"ClickStartShape"]=ge,ge._fireAndBubble(K.pointerdown,{evt:V,pointerId:oe.id}),re=!0;const he=V.type.indexOf("touch")>=0;ge.preventDefault()&&V.cancelable&&he&&V.preventDefault()}),re||this._fire(K.pointerdown,{evt:V,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(V){const K=ne(V.type),se=ee(V.type);if(!K||(i.Konva.isDragging()&&l.DD.node.preventDefault()&&V.cancelable&&V.preventDefault(),this.setPointersPositions(V),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const oe={};let ge=!1;const he=this._getTargetShape(se);this._changedPointerPositions.forEach(be=>{const le=c.getCapturedShape(be.id)||this.getIntersection(be),ve=be.id,je={evt:V,pointerId:ve},ze=he!==le;if(ze&&he&&(he._fireAndBubble(K.pointerout,{...je},le),he._fireAndBubble(K.pointerleave,{...je},le)),le){if(oe[le._id])return;oe[le._id]=!0}le&&le.isListening()?(ge=!0,ze&&(le._fireAndBubble(K.pointerover,{...je},he),le._fireAndBubble(K.pointerenter,{...je},he),this[se+"targetShape"]=le),le._fireAndBubble(K.pointermove,{...je})):he&&(this._fire(K.pointerover,{evt:V,target:this,currentTarget:this,pointerId:ve}),this[se+"targetShape"]=null)}),ge||this._fire(K.pointermove,{evt:V,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(V){const K=ne(V.type),se=ee(V.type);if(!K)return;this.setPointersPositions(V);const re=this[se+"ClickStartShape"],oe=this[se+"ClickEndShape"],ge={};let he=!1;this._changedPointerPositions.forEach(be=>{const le=c.getCapturedShape(be.id)||this.getIntersection(be);if(le){if(le.releaseCapture(be.id),ge[le._id])return;ge[le._id]=!0}const ve=be.id,je={evt:V,pointerId:ve};let ze=!1;i.Konva["_"+se+"InDblClickWindow"]?(ze=!0,clearTimeout(this[se+"DblTimeout"])):l.DD.justDragged||(i.Konva["_"+se+"InDblClickWindow"]=!0,clearTimeout(this[se+"DblTimeout"])),this[se+"DblTimeout"]=setTimeout(function(){i.Konva["_"+se+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),le&&le.isListening()?(he=!0,this[se+"ClickEndShape"]=le,le._fireAndBubble(K.pointerup,{...je}),i.Konva["_"+se+"ListenClick"]&&re&&re===le&&(le._fireAndBubble(K.pointerclick,{...je}),ze&&oe&&oe===le&&le._fireAndBubble(K.pointerdblclick,{...je}))):(this[se+"ClickEndShape"]=null,i.Konva["_"+se+"ListenClick"]&&this._fire(K.pointerclick,{evt:V,target:this,currentTarget:this,pointerId:ve}),ze&&this._fire(K.pointerdblclick,{evt:V,target:this,currentTarget:this,pointerId:ve}))}),he||this._fire(K.pointerup,{evt:V,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+se+"ListenClick"]=!1,V.cancelable&&se!=="touch"&&se!=="pointer"&&V.preventDefault()}_contextmenu(V){this.setPointersPositions(V);const K=this.getIntersection(this.getPointerPosition());K&&K.isListening()?K._fireAndBubble(D,{evt:V}):this._fire(D,{evt:V,target:this,currentTarget:this})}_wheel(V){this.setPointersPositions(V);const K=this.getIntersection(this.getPointerPosition());K&&K.isListening()?K._fireAndBubble(B,{evt:V}):this._fire(B,{evt:V,target:this,currentTarget:this})}_pointercancel(V){this.setPointersPositions(V);const K=c.getCapturedShape(V.pointerId)||this.getIntersection(this.getPointerPosition());K&&K._fireAndBubble(E,c.createEvent(V)),c.releaseCapture(V.pointerId)}_lostpointercapture(V){c.releaseCapture(V.pointerId)}setPointersPositions(V){const K=this._getContentPosition();let se=null,re=null;V=V||window.event,V.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(V.touches,oe=>{this._pointerPositions.push({id:oe.identifier,x:(oe.clientX-K.left)/K.scaleX,y:(oe.clientY-K.top)/K.scaleY})}),Array.prototype.forEach.call(V.changedTouches||V.touches,oe=>{this._changedPointerPositions.push({id:oe.identifier,x:(oe.clientX-K.left)/K.scaleX,y:(oe.clientY-K.top)/K.scaleY})})):(se=(V.clientX-K.left)/K.scaleX,re=(V.clientY-K.top)/K.scaleY,this.pointerPos={x:se,y:re},this._pointerPositions=[{x:se,y:re,id:e.Util._getFirstPointerId(V)}],this._changedPointerPositions=[{x:se,y:re,id:e.Util._getFirstPointerId(V)}])}_setPointerPosition(V){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(V)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const V=this.content.getBoundingClientRect();return{top:V.top,left:V.left,scaleX:V.width/this.content.clientWidth||1,scaleY:V.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const V=this.container();if(!V)throw"Stage has no container. A container is required.";V.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),V.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(V){V.batchDraw()}),this}}t.Stage=de,de.prototype.nodeType=f,(0,u._registerNode)(de),n.Factory.addGetterSetter(de,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(fe=>{fe.batchDraw()})})})(X4);var Nl={},At={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=Re,n=mt,r=Oe,i=ut,s=Ne,l=Re,u=Zi,c="hasShadow",f="shadowRGBA",p="patternImage",m="linearGradient",w="radialGradient";let y;function x(){return y||(y=n.Util.createCanvasElement().getContext("2d"),y)}t.shapes={};function b(L){const A=this.attrs.fillRule;A?L.fill(A):L.fill()}function _(L){L.stroke()}function S(L){const A=this.attrs.fillRule;A?L.fill(A):L.fill()}function T(L){L.stroke()}function h(){this._clearCache(c)}function k(){this._clearCache(f)}function E(){this._clearCache(p)}function N(){this._clearCache(m)}function I(){this._clearCache(w)}class M extends i.Node{constructor(A){super(A);let F;for(;F=n.Util.getRandomColor(),!(F&&!(F in t.shapes)););this.colorKey=F,t.shapes[F]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const F=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(F&&F.setTransform){const D=new n.Transform;D.translate(this.fillPatternX(),this.fillPatternY()),D.rotate(e.Konva.getAngle(this.fillPatternRotation())),D.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),D.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const U=D.getMatrix(),W=typeof DOMMatrix>"u"?{a:U[0],b:U[1],c:U[2],d:U[3],e:U[4],f:U[5]}:new DOMMatrix(U);F.setTransform(W)}return F}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){const A=this.fillLinearGradientColorStops();if(A){const F=x(),D=this.fillLinearGradientStartPoint(),U=this.fillLinearGradientEndPoint(),W=F.createLinearGradient(D.x,D.y,U.x,U.y);for(let G=0;G<A.length;G+=2)W.addColorStop(A[G],A[G+1]);return W}}_getRadialGradient(){return this._getCache(w,this.__getRadialGradient)}__getRadialGradient(){const A=this.fillRadialGradientColorStops();if(A){const F=x(),D=this.fillRadialGradientStartPoint(),U=this.fillRadialGradientEndPoint(),W=F.createRadialGradient(D.x,D.y,this.fillRadialGradientStartRadius(),U.x,U.y,this.fillRadialGradientEndRadius());for(let G=0;G<A.length;G+=2)W.addColorStop(A[G],A[G+1]);return W}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const A=n.Util.colorToRGBA(this.shadowColor());if(A)return"rgba("+A.r+","+A.g+","+A.b+","+A.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const A=this.hitStrokeWidth();return A==="auto"?this.hasStroke():this.strokeEnabled()&&!!A}intersects(A){const F=this.getStage();if(!F)return!1;const D=F.bufferHitCanvas;return D.getContext().clear(),this.drawHit(D,void 0,!0),D.context.getImageData(Math.round(A.x),Math.round(A.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(A){var F;if(!((F=this.attrs.perfectDrawEnabled)!==null&&F!==void 0?F:!0))return!1;const U=A||this.hasFill(),W=this.hasStroke(),G=this.getAbsoluteOpacity()!==1;if(U&&W&&G)return!0;const z=this.hasShadow(),B=this.shadowForStrokeEnabled();return!!(U&&W&&z&&B)}setStrokeHitEnabled(A){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),A?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const A=this.size();return{x:this._centroid?-A.width/2:0,y:this._centroid?-A.height/2:0,width:A.width,height:A.height}}getClientRect(A={}){let F=!1,D=this.getParent();for(;D;){if(D.isCached()){F=!0;break}D=D.getParent()}const U=A.skipTransform,W=A.relativeTo||F&&this.getStage()||void 0,G=this.getSelfRect(),B=!A.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,j=G.width+B,$=G.height+B,X=!A.skipShadow&&this.hasShadow(),ee=X?this.shadowOffsetX():0,ne=X?this.shadowOffsetY():0,Z=j+Math.abs(ee),te=$+Math.abs(ne),de=X&&this.shadowBlur()||0,fe=Z+de*2,V=te+de*2,K={width:fe,height:V,x:-(B/2+de)+Math.min(ee,0)+G.x,y:-(B/2+de)+Math.min(ne,0)+G.y};return U?K:this._transformedRect(K,W)}drawScene(A,F,D){const U=this.getLayer();let W=A||U.getCanvas(),G=W.getContext(),z=this._getCanvasCache(),B=this.getSceneFunc(),j=this.hasShadow(),$,X;const ee=W.isCache,ne=F===this;if(!this.isVisible()&&!ne)return this;if(z){G.save();const te=this.getAbsoluteTransform(F).getMatrix();return G.transform(te[0],te[1],te[2],te[3],te[4],te[5]),this._drawCachedSceneCanvas(G),G.restore(),this}if(!B)return this;if(G.save(),this._useBufferCanvas()&&!ee){$=this.getStage();const te=D||$.bufferCanvas;X=te.getContext(),X.clear(),X.save(),X._applyLineJoin(this);var Z=this.getAbsoluteTransform(F).getMatrix();X.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]),B.call(this,X,this),X.restore();const de=te.pixelRatio;j&&G._applyShadow(this),G._applyOpacity(this),G._applyGlobalCompositeOperation(this),G.drawImage(te._canvas,0,0,te.width/de,te.height/de)}else{if(G._applyLineJoin(this),!ne){var Z=this.getAbsoluteTransform(F).getMatrix();G.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]),G._applyOpacity(this),G._applyGlobalCompositeOperation(this)}j&&G._applyShadow(this),B.call(this,G,this)}return G.restore(),this}drawHit(A,F,D=!1){if(!this.shouldDrawHit(F,D))return this;const U=this.getLayer(),W=A||U.hitCanvas,G=W&&W.getContext(),z=this.hitFunc()||this.sceneFunc(),B=this._getCanvasCache(),j=B&&B.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),j){G.save();const X=this.getAbsoluteTransform(F).getMatrix();return G.transform(X[0],X[1],X[2],X[3],X[4],X[5]),this._drawCachedHitCanvas(G),G.restore(),this}if(!z)return this;if(G.save(),G._applyLineJoin(this),!(this===F)){const X=this.getAbsoluteTransform(F).getMatrix();G.transform(X[0],X[1],X[2],X[3],X[4],X[5])}return z.call(this,G,this),G.restore(),this}drawHitFromCache(A=0){const F=this._getCanvasCache(),D=this._getCachedSceneCanvas(),U=F.hit,W=U.getContext(),G=U.getWidth(),z=U.getHeight();W.clear(),W.drawImage(D._canvas,0,0,G,z);try{const B=W.getImageData(0,0,G,z),j=B.data,$=j.length,X=n.Util._hexToRgb(this.colorKey);for(let ee=0;ee<$;ee+=4)j[ee+3]>A?(j[ee]=X.r,j[ee+1]=X.g,j[ee+2]=X.b,j[ee+3]=255):j[ee+3]=0;W.putImageData(B,0,0)}catch(B){n.Util.error("Unable to draw hit graph from cached scene canvas. "+B.message)}return this}hasPointerCapture(A){return u.hasPointerCapture(A,this)}setPointerCapture(A){u.setPointerCapture(A,this)}releaseCapture(A){u.releaseCapture(A,this)}}t.Shape=M,M.prototype._fillFunc=b,M.prototype._strokeFunc=_,M.prototype._fillFuncHit=S,M.prototype._strokeFuncHit=T,M.prototype._centroid=!1,M.prototype.nodeType="Shape",(0,l._registerNode)(M),M.prototype.eventListeners={},M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",h),M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",k),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",N),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",I),r.Factory.addGetterSetter(M,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(M,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(M,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(M,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(M,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(M,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(M,"lineJoin"),r.Factory.addGetterSetter(M,"lineCap"),r.Factory.addGetterSetter(M,"sceneFunc"),r.Factory.addGetterSetter(M,"hitFunc"),r.Factory.addGetterSetter(M,"dash"),r.Factory.addGetterSetter(M,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(M,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(M,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillPatternImage"),r.Factory.addGetterSetter(M,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(M,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(M,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(M,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(M,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(M,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(M,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(M,"fillEnabled",!0),r.Factory.addGetterSetter(M,"strokeEnabled",!0),r.Factory.addGetterSetter(M,"shadowEnabled",!0),r.Factory.addGetterSetter(M,"dashEnabled",!0),r.Factory.addGetterSetter(M,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(M,"fillPriority","color"),r.Factory.addComponentsGetterSetter(M,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(M,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(M,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(M,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(M,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(M,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(M,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(M,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(M,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(M,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(M,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(M,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(M,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(M,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(M,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(M,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(M,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(M,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(M,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(M,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(M,"fillPatternRotation",0),r.Factory.addGetterSetter(M,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(M,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(At);Object.defineProperty(Nl,"__esModule",{value:!0});Nl.Layer=void 0;const Qr=mt,e0=As,to=ut,Cg=Oe,wy=yr,E_=Ne,T_=At,N_=Re,P_="#",M_="beforeDraw",A_="draw",Z4=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],I_=Z4.length;let Wo=class extends e0.Container{constructor(e){super(e),this.canvas=new wy.SceneCanvas,this.hitCanvas=new wy.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),e<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[e+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){to.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!to.Node.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(to.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(to.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return to.Node.prototype.remove.call(this),e&&e.parentNode&&Qr.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:n}){return this.canvas.setSize(e,n),this.hitCanvas.setSize(e,n),this._setSmoothEnabled(),this}_validateAdd(e){const n=e.getType();n!=="Group"&&n!=="Shape"&&Qr.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),to.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Qr.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Qr.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Qr.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let n=1,r=!1;for(;;){for(let i=0;i<I_;i++){const s=Z4[i],l=this._getIntersection({x:e.x+s.x*n,y:e.y+s.y*n}),u=l.shape;if(u)return u;if(r=!!l.antialiased,!l.antialiased)break}if(r)n+=1;else return null}}_getIntersection(e){const n=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*n),Math.round(e.y*n),1,1).data,i=r[3];if(i===255){const s=Qr.Util._rgbToHex(r[0],r[1],r[2]),l=T_.shapes[P_+s];return l?{shape:l}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,n){const r=this.getLayer(),i=e||r&&r.getCanvas();return this._fire(M_,{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),e0.Container.prototype.drawScene.call(this,i,n),this._fire(A_,{node:this}),this}drawHit(e,n){const r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),e0.Container.prototype.drawHit.call(this,i,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Qr.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Qr.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Qr.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Nl.Layer=Wo;Wo.prototype.nodeType="Layer";(0,N_._registerNode)(Wo);Cg.Factory.addGetterSetter(Wo,"imageSmoothingEnabled",!0);Cg.Factory.addGetterSetter(Wo,"clearBeforeDraw",!0);Cg.Factory.addGetterSetter(Wo,"hitGraphEnabled",!0,(0,E_.getBooleanValidator)());var hd={};Object.defineProperty(hd,"__esModule",{value:!0});hd.FastLayer=void 0;const L_=mt,R_=Nl,j_=Re;class Eg extends R_.Layer{constructor(e){super(e),this.listening(!1),L_.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}hd.FastLayer=Eg;Eg.prototype.nodeType="FastLayer";(0,j_._registerNode)(Eg);var $o={};Object.defineProperty($o,"__esModule",{value:!0});$o.Group=void 0;const F_=mt,O_=As,D_=Re;let Tg=class extends O_.Container{_validateAdd(e){const n=e.getType();n!=="Group"&&n!=="Shape"&&F_.Util.throw("You may only add groups and shapes to groups.")}};$o.Group=Tg;Tg.prototype.nodeType="Group";(0,D_._registerNode)(Tg);var Ho={};Object.defineProperty(Ho,"__esModule",{value:!0});Ho.Animation=void 0;const t0=Re,Sy=mt,n0=function(){return t0.glob.performance&&t0.glob.performance.now?function(){return t0.glob.performance.now()}:function(){return new Date().getTime()}}();class jr{constructor(e,n){this.id=jr.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n0(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){let n=[];return e&&(n=Array.isArray(e)?e:[e]),this.layers=n,this}getLayers(){return this.layers}addLayer(e){const n=this.layers,r=n.length;for(let i=0;i<r;i++)if(n[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const n=jr.animations,r=n.length;for(let i=0;i<r;i++)if(n[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n0(),jr._addAnimation(this),this}stop(){return jr._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const n=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===n){this.animations.splice(s,1);break}}static _runFrames(){const e={},n=this.animations;for(let r=0;r<n.length;r++){const i=n[r],s=i.layers,l=i.func;i._updateFrameObject(n0());const u=s.length;let c;if(l?c=l.call(i,i.frame)!==!1:c=!0,!!c)for(let f=0;f<u;f++){const p=s[f];p._id!==void 0&&(e[p._id]=p)}}for(const r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=jr;e.animations.length?(e._runFrames(),Sy.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,Sy.Util.requestAnimFrame(this._animationLoop))}}Ho.Animation=jr;jr.animations=[];jr.animIdCounter=0;jr.animRunning=!1;var q4={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=mt,n=Ho,r=ut,i=Re,s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},l=1,u=2,c=3,f=["fill","stroke","shadowColor"];let p=0;class m{constructor(x,b,_,S,T,h,k){this.prop=x,this.propFunc=b,this.begin=S,this._pos=S,this.duration=h,this._change=0,this.prevPos=0,this.yoyo=k,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=_,this._change=T-this.begin,this.pause()}fire(x){const b=this[x];b&&b()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=u,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===u?this.setTime(x):this.state===c&&this.setTime(this.duration-x)}pause(){this.state=l,this.fire("onPause")}getTimer(){return new Date().getTime()}}class w{constructor(x){const b=this,_=x.node,S=_._id,T=x.easing||t.Easings.Linear,h=!!x.yoyo;let k,E;typeof x.duration>"u"?k=.3:x.duration===0?k=.001:k=x.duration,this.node=_,this._id=p++;const N=_.getLayer()||(_ instanceof i.Konva.Stage?_.getLayers():null);N||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){b.tween.onEnterFrame()},N),this.tween=new m(E,function(I){b._tweenFunc(I)},T,0,1,k*1e3,h),this._addListeners(),w.attrs[S]||(w.attrs[S]={}),w.attrs[S][this._id]||(w.attrs[S][this._id]={}),w.tweens[S]||(w.tweens[S]={});for(E in x)s[E]===void 0&&this._addAttr(E,x[E]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,b){const _=this.node,S=_._id;let T,h,k,E,N;const I=w.tweens[S][x];I&&delete w.attrs[S][I][x];let M=_.getAttr(x);if(e.Util._isArray(b))if(T=[],h=Math.max(b.length,M.length),x==="points"&&b.length!==M.length&&(b.length>M.length?(E=M,M=e.Util._prepareArrayForTween(M,b,_.closed())):(k=b,b=e.Util._prepareArrayForTween(b,M,_.closed()))),x.indexOf("fill")===0)for(let L=0;L<h;L++)if(L%2===0)T.push(b[L]-M[L]);else{const A=e.Util.colorToRGBA(M[L]);N=e.Util.colorToRGBA(b[L]),M[L]=A,T.push({r:N.r-A.r,g:N.g-A.g,b:N.b-A.b,a:N.a-A.a})}else for(let L=0;L<h;L++)T.push(b[L]-M[L]);else f.indexOf(x)!==-1?(M=e.Util.colorToRGBA(M),N=e.Util.colorToRGBA(b),T={r:N.r-M.r,g:N.g-M.g,b:N.b-M.b,a:N.a-M.a}):T=b-M;w.attrs[S][this._id][x]={start:M,diff:T,end:b,trueEnd:k,trueStart:E},w.tweens[S][x]=this._id}_tweenFunc(x){const b=this.node,_=w.attrs[b._id][this._id];let S,T,h,k,E,N,I,M;for(S in _){if(T=_[S],h=T.start,k=T.diff,M=T.end,e.Util._isArray(h))if(E=[],I=Math.max(h.length,M.length),S.indexOf("fill")===0)for(N=0;N<I;N++)N%2===0?E.push((h[N]||0)+k[N]*x):E.push("rgba("+Math.round(h[N].r+k[N].r*x)+","+Math.round(h[N].g+k[N].g*x)+","+Math.round(h[N].b+k[N].b*x)+","+(h[N].a+k[N].a*x)+")");else for(N=0;N<I;N++)E.push((h[N]||0)+k[N]*x);else f.indexOf(S)!==-1?E="rgba("+Math.round(h.r+k.r*x)+","+Math.round(h.g+k.g*x)+","+Math.round(h.b+k.b*x)+","+(h.a+k.a*x)+")":E=h+k*x;b.setAttr(S,E)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,b=w.attrs[x._id][this._id];b.points&&b.points.trueEnd&&x.setAttr("points",b.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,b=w.attrs[x._id][this._id];b.points&&b.points.trueStart&&x.points(b.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const x=this.node._id,b=this._id,_=w.tweens[x];this.pause();for(const S in _)delete w.tweens[x][S];delete w.attrs[x][b]}}t.Tween=w,w.attrs={},w.tweens={},r.Node.prototype.to=function(y){const x=y.onFinish;y.node=this,y.onFinish=function(){this.destroy(),x&&x()},new w(y).play()},t.Easings={BackEaseIn(y,x,b,_){return b*(y/=_)*y*((1.70158+1)*y-1.70158)+x},BackEaseOut(y,x,b,_){return b*((y=y/_-1)*y*((1.70158+1)*y+1.70158)+1)+x},BackEaseInOut(y,x,b,_){let S=1.70158;return(y/=_/2)<1?b/2*(y*y*(((S*=1.525)+1)*y-S))+x:b/2*((y-=2)*y*(((S*=1.525)+1)*y+S)+2)+x},ElasticEaseIn(y,x,b,_,S,T){let h=0;return y===0?x:(y/=_)===1?x+b:(T||(T=_*.3),!S||S<Math.abs(b)?(S=b,h=T/4):h=T/(2*Math.PI)*Math.asin(b/S),-(S*Math.pow(2,10*(y-=1))*Math.sin((y*_-h)*(2*Math.PI)/T))+x)},ElasticEaseOut(y,x,b,_,S,T){let h=0;return y===0?x:(y/=_)===1?x+b:(T||(T=_*.3),!S||S<Math.abs(b)?(S=b,h=T/4):h=T/(2*Math.PI)*Math.asin(b/S),S*Math.pow(2,-10*y)*Math.sin((y*_-h)*(2*Math.PI)/T)+b+x)},ElasticEaseInOut(y,x,b,_,S,T){let h=0;return y===0?x:(y/=_/2)===2?x+b:(T||(T=_*(.3*1.5)),!S||S<Math.abs(b)?(S=b,h=T/4):h=T/(2*Math.PI)*Math.asin(b/S),y<1?-.5*(S*Math.pow(2,10*(y-=1))*Math.sin((y*_-h)*(2*Math.PI)/T))+x:S*Math.pow(2,-10*(y-=1))*Math.sin((y*_-h)*(2*Math.PI)/T)*.5+b+x)},BounceEaseOut(y,x,b,_){return(y/=_)<1/2.75?b*(7.5625*y*y)+x:y<2/2.75?b*(7.5625*(y-=1.5/2.75)*y+.75)+x:y<2.5/2.75?b*(7.5625*(y-=2.25/2.75)*y+.9375)+x:b*(7.5625*(y-=2.625/2.75)*y+.984375)+x},BounceEaseIn(y,x,b,_){return b-t.Easings.BounceEaseOut(_-y,0,b,_)+x},BounceEaseInOut(y,x,b,_){return y<_/2?t.Easings.BounceEaseIn(y*2,0,b,_)*.5+x:t.Easings.BounceEaseOut(y*2-_,0,b,_)*.5+b*.5+x},EaseIn(y,x,b,_){return b*(y/=_)*y+x},EaseOut(y,x,b,_){return-b*(y/=_)*(y-2)+x},EaseInOut(y,x,b,_){return(y/=_/2)<1?b/2*y*y+x:-b/2*(--y*(y-2)-1)+x},StrongEaseIn(y,x,b,_){return b*(y/=_)*y*y*y*y+x},StrongEaseOut(y,x,b,_){return b*((y=y/_-1)*y*y*y*y+1)+x},StrongEaseInOut(y,x,b,_){return(y/=_/2)<1?b/2*y*y*y*y*y+x:b/2*((y-=2)*y*y*y*y+2)+x},Linear(y,x,b,_){return b*y/_+x}}})(q4);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=Re,n=mt,r=ut,i=As,s=X4,l=Nl,u=hd,c=$o,f=dd,p=At,m=Ho,w=q4,y=ii,x=yr;t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:l.Layer,FastLayer:u.FastLayer,Group:c.Group,DD:f.DD,Shape:p.Shape,shapes:p.shapes,Animation:m.Animation,Tween:w.Tween,Easings:w.Easings,Context:y.Context,Canvas:x.Canvas}),t.default=t.Konva})(Bu);var pd={};Object.defineProperty(pd,"__esModule",{value:!0});pd.Arc=void 0;const gd=Oe,z_=At,_y=Re,md=Ne,B_=Re;class fi extends z_.Shape{_sceneFunc(e){const n=_y.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,r),e.arc(0,0,this.innerRadius(),n,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),r=this.clockwise(),i=_y.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),l=1,u=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),f=s*(s>0?e:n),p=l*n,m=u*(u>0?e:n),w=c*(c>0?n:e);return{x:f,y:r?-1*w:m,width:p-f,height:w-m}}}pd.Arc=fi;fi.prototype._centroid=!0;fi.prototype.className="Arc";fi.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,B_._registerNode)(fi);gd.Factory.addGetterSetter(fi,"innerRadius",0,(0,md.getNumberValidator)());gd.Factory.addGetterSetter(fi,"outerRadius",0,(0,md.getNumberValidator)());gd.Factory.addGetterSetter(fi,"angle",0,(0,md.getNumberValidator)());gd.Factory.addGetterSetter(fi,"clockwise",!1,(0,md.getBooleanValidator)());var yd={},Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.Line=void 0;const vd=Oe,U_=Re,G_=At,J4=Ne;function mp(t,e,n,r,i,s,l){const u=Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2)),c=Math.sqrt(Math.pow(i-n,2)+Math.pow(s-r,2)),f=l*u/(u+c),p=l*c/(u+c),m=n-f*(i-t),w=r-f*(s-e),y=n+p*(i-t),x=r+p*(s-e);return[m,w,y,x]}function ky(t,e){const n=t.length,r=[];for(let i=2;i<n-2;i+=2){const s=mp(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e);isNaN(s[0])||(r.push(s[0]),r.push(s[1]),r.push(t[i]),r.push(t[i+1]),r.push(s[2]),r.push(s[3]))}return r}let qi=class extends G_.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){let n=this.points(),r=n.length,i=this.tension(),s=this.closed(),l=this.bezier(),u,c,f;if(r){if(e.beginPath(),e.moveTo(n[0],n[1]),i!==0&&r>4){for(u=this.getTensionPoints(),c=u.length,f=s?0:4,s||e.quadraticCurveTo(u[0],u[1],u[2],u[3]);f<c-2;)e.bezierCurveTo(u[f++],u[f++],u[f++],u[f++],u[f++],u[f++]);s||e.quadraticCurveTo(u[c-2],u[c-1],n[r-2],n[r-1])}else if(l)for(f=2;f<r;)e.bezierCurveTo(n[f++],n[f++],n[f++],n[f++],n[f++],n[f++]);else for(f=2;f<r;f+=2)e.lineTo(n[f],n[f+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():ky(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),n=e.length,r=this.tension(),i=mp(e[n-2],e[n-1],e[0],e[1],e[2],e[3],r),s=mp(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],r),l=ky(e,r);return[i[2],i[3]].concat(l).concat([s[0],s[1],e[n-2],e[n-1],s[2],s[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let n=e[0],r=e[0],i=e[1],s=e[1],l,u;for(let c=0;c<e.length/2;c++)l=e[c*2],u=e[c*2+1],n=Math.min(n,l),r=Math.max(r,l),i=Math.min(i,u),s=Math.max(s,u);return{x:n,y:i,width:r-n,height:s-i}}};Pl.Line=qi;qi.prototype.className="Line";qi.prototype._attrsAffectingSize=["points","bezier","tension"];(0,U_._registerNode)(qi);vd.Factory.addGetterSetter(qi,"closed",!1);vd.Factory.addGetterSetter(qi,"bezier",!1);vd.Factory.addGetterSetter(qi,"tension",0,(0,J4.getNumberValidator)());vd.Factory.addGetterSetter(qi,"points",[],(0,J4.getNumberArrayValidator)());var Yo={},e5={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(l,u,c)=>{let f,p;const w=c/2;f=0;for(let y=0;y<20;y++)p=w*t.tValues[20][y]+w,f+=t.cValues[20][y]*r(l,u,p);return w*f};t.getCubicArcLength=e;const n=(l,u,c)=>{c===void 0&&(c=1);const f=l[0]-2*l[1]+l[2],p=u[0]-2*u[1]+u[2],m=2*l[1]-2*l[0],w=2*u[1]-2*u[0],y=4*(f*f+p*p),x=4*(f*m+p*w),b=m*m+w*w;if(y===0)return c*Math.sqrt(Math.pow(l[2]-l[0],2)+Math.pow(u[2]-u[0],2));const _=x/(2*y),S=b/y,T=c+_,h=S-_*_,k=T*T+h>0?Math.sqrt(T*T+h):0,E=_*_+h>0?Math.sqrt(_*_+h):0,N=_+Math.sqrt(_*_+h)!==0?h*Math.log(Math.abs((T+k)/(_+E))):0;return Math.sqrt(y)/2*(T*k-_*E+N)};t.getQuadraticArcLength=n;function r(l,u,c){const f=i(1,c,l),p=i(1,c,u),m=f*f+p*p;return Math.sqrt(m)}const i=(l,u,c)=>{const f=c.length-1;let p,m;if(f===0)return 0;if(l===0){m=0;for(let w=0;w<=f;w++)m+=t.binomialCoefficients[f][w]*Math.pow(1-u,f-w)*Math.pow(u,w)*c[w];return m}else{p=new Array(f);for(let w=0;w<f;w++)p[w]=f*(c[w+1]-c[w]);return i(l-1,u,p)}},s=(l,u,c)=>{let f=1,p=l/u,m=(l-c(p))/u,w=0;for(;f>.001;){const y=c(p+m),x=Math.abs(l-y)/u;if(x<f)f=x,p+=m;else{const b=c(p-m),_=Math.abs(l-b)/u;_<f?(f=_,p-=m):m/=2}if(w++,w>500)break}return p};t.t2length=s})(e5);Object.defineProperty(Yo,"__esModule",{value:!0});Yo.Path=void 0;const V_=Oe,W_=At,$_=Re,no=e5;class Nt extends W_.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Nt.parsePathData(this.data()),this.pathLength=Nt.getPathLength(this.dataArray)}_sceneFunc(e){const n=this.dataArray;e.beginPath();let r=!1;for(let b=0;b<n.length;b++){const _=n[b].command,S=n[b].points;switch(_){case"L":e.lineTo(S[0],S[1]);break;case"M":e.moveTo(S[0],S[1]);break;case"C":e.bezierCurveTo(S[0],S[1],S[2],S[3],S[4],S[5]);break;case"Q":e.quadraticCurveTo(S[0],S[1],S[2],S[3]);break;case"A":var i=S[0],s=S[1],l=S[2],u=S[3],c=S[4],f=S[5],p=S[6],m=S[7],w=l>u?l:u,y=l>u?1:l/u,x=l>u?u/l:1;e.translate(i,s),e.rotate(p),e.scale(y,x),e.arc(0,0,w,c,c+f,1-m),e.scale(1/y,1/x),e.rotate(-p),e.translate(-i,-s);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(c){if(c.command==="A"){const f=c.points[4],p=c.points[5],m=c.points[4]+p;let w=Math.PI/180;if(Math.abs(f-m)<w&&(w=Math.abs(f-m)),p<0)for(let y=f-w;y>m;y-=w){const x=Nt.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],y,0);e.push(x.x,x.y)}else for(let y=f+w;y<m;y+=w){const x=Nt.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],y,0);e.push(x.x,x.y)}}else if(c.command==="C")for(let f=0;f<=1;f+=.01){const p=Nt.getPointOnCubicBezier(f,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);e.push(p.x,p.y)}else e=e.concat(c.points)});let n=e[0],r=e[0],i=e[1],s=e[1],l,u;for(let c=0;c<e.length/2;c++)l=e[c*2],u=e[c*2+1],isNaN(l)||(n=Math.min(n,l),r=Math.max(r,l)),isNaN(u)||(i=Math.min(i,u),s=Math.max(s,u));return{x:n,y:i,width:r-n,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return Nt.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,n,r,i){return Math.sqrt((r-e)*(r-e)+(i-n)*(i-n))}static getPathLength(e){let n=0;for(let r=0;r<e.length;++r)n+=e[r].pathLength;return n}static getPointAtLengthOfDataArray(e,n){let r,i=0,s=n.length;if(!s)return null;for(;i<s&&e>n[i].pathLength;)e-=n[i].pathLength,++i;if(i===s)return r=n[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return r=n[i].points.slice(0,2),{x:r[0],y:r[1]};const l=n[i],u=l.points;switch(l.command){case"L":return Nt.getPointOnLine(e,l.start.x,l.start.y,u[0],u[1]);case"C":return Nt.getPointOnCubicBezier((0,no.t2length)(e,Nt.getPathLength(n),b=>(0,no.getCubicArcLength)([l.start.x,u[0],u[2],u[4]],[l.start.y,u[1],u[3],u[5]],b)),l.start.x,l.start.y,u[0],u[1],u[2],u[3],u[4],u[5]);case"Q":return Nt.getPointOnQuadraticBezier((0,no.t2length)(e,Nt.getPathLength(n),b=>(0,no.getQuadraticArcLength)([l.start.x,u[0],u[2]],[l.start.y,u[1],u[3]],b)),l.start.x,l.start.y,u[0],u[1],u[2],u[3]);case"A":var c=u[0],f=u[1],p=u[2],m=u[3],w=u[4],y=u[5],x=u[6];return w+=y*e/l.pathLength,Nt.getPointOnEllipticalArc(c,f,p,m,w,x)}return null}static getPointOnLine(e,n,r,i,s,l,u){l=l??n,u=u??r;const c=this.getLineLength(n,r,i,s);if(c<1e-10)return{x:n,y:r};if(i===n)return{x:l,y:u+(s>r?e:-e)};const f=(s-r)/(i-n),p=Math.sqrt(e*e/(1+f*f))*(i<n?-1:1),m=f*p;if(Math.abs(u-r-f*(l-n))<1e-10)return{x:l+p,y:u+m};const w=((l-n)*(i-n)+(u-r)*(s-r))/(c*c),y=n+w*(i-n),x=r+w*(s-r),b=this.getLineLength(l,u,y,x),_=Math.sqrt(e*e-b*b),S=Math.sqrt(_*_/(1+f*f))*(i<n?-1:1),T=f*S;return{x:y+S,y:x+T}}static getPointOnCubicBezier(e,n,r,i,s,l,u,c,f){function p(_){return _*_*_}function m(_){return 3*_*_*(1-_)}function w(_){return 3*_*(1-_)*(1-_)}function y(_){return(1-_)*(1-_)*(1-_)}const x=c*p(e)+l*m(e)+i*w(e)+n*y(e),b=f*p(e)+u*m(e)+s*w(e)+r*y(e);return{x,y:b}}static getPointOnQuadraticBezier(e,n,r,i,s,l,u){function c(y){return y*y}function f(y){return 2*y*(1-y)}function p(y){return(1-y)*(1-y)}const m=l*c(e)+i*f(e)+n*p(e),w=u*c(e)+s*f(e)+r*p(e);return{x:m,y:w}}static getPointOnEllipticalArc(e,n,r,i,s,l){const u=Math.cos(l),c=Math.sin(l),f={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(f.x*u-f.y*c),y:n+(f.x*c+f.y*u)}}static parsePathData(e){if(!e)return[];let n=e;const r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(var i=0;i<r.length;i++)n=n.replace(new RegExp(r[i],"g"),"|"+r[i]);const s=n.split("|"),l=[],u=[];let c=0,f=0;const p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let m;for(i=1;i<s.length;i++){let M=s[i],L=M.charAt(0);for(M=M.slice(1),u.length=0;m=p.exec(M);)u.push(m[0]);const A=[];for(let F=0,D=u.length;F<D;F++){if(u[F]==="00"){A.push(0,0);continue}const U=parseFloat(u[F]);isNaN(U)?A.push(0):A.push(U)}for(;A.length>0&&!isNaN(A[0]);){let F="",D=[];const U=c,W=f;var w,y,x,b,_,S,T,h,k,E;switch(L){case"l":c+=A.shift(),f+=A.shift(),F="L",D.push(c,f);break;case"L":c=A.shift(),f=A.shift(),D.push(c,f);break;case"m":var N=A.shift(),I=A.shift();if(c+=N,f+=I,F="M",l.length>2&&l[l.length-1].command==="z"){for(let G=l.length-2;G>=0;G--)if(l[G].command==="M"){c=l[G].points[0]+N,f=l[G].points[1]+I;break}}D.push(c,f),L="l";break;case"M":c=A.shift(),f=A.shift(),F="M",D.push(c,f),L="L";break;case"h":c+=A.shift(),F="L",D.push(c,f);break;case"H":c=A.shift(),F="L",D.push(c,f);break;case"v":f+=A.shift(),F="L",D.push(c,f);break;case"V":f=A.shift(),F="L",D.push(c,f);break;case"C":D.push(A.shift(),A.shift(),A.shift(),A.shift()),c=A.shift(),f=A.shift(),D.push(c,f);break;case"c":D.push(c+A.shift(),f+A.shift(),c+A.shift(),f+A.shift()),c+=A.shift(),f+=A.shift(),F="C",D.push(c,f);break;case"S":y=c,x=f,w=l[l.length-1],w.command==="C"&&(y=c+(c-w.points[2]),x=f+(f-w.points[3])),D.push(y,x,A.shift(),A.shift()),c=A.shift(),f=A.shift(),F="C",D.push(c,f);break;case"s":y=c,x=f,w=l[l.length-1],w.command==="C"&&(y=c+(c-w.points[2]),x=f+(f-w.points[3])),D.push(y,x,c+A.shift(),f+A.shift()),c+=A.shift(),f+=A.shift(),F="C",D.push(c,f);break;case"Q":D.push(A.shift(),A.shift()),c=A.shift(),f=A.shift(),D.push(c,f);break;case"q":D.push(c+A.shift(),f+A.shift()),c+=A.shift(),f+=A.shift(),F="Q",D.push(c,f);break;case"T":y=c,x=f,w=l[l.length-1],w.command==="Q"&&(y=c+(c-w.points[0]),x=f+(f-w.points[1])),c=A.shift(),f=A.shift(),F="Q",D.push(y,x,c,f);break;case"t":y=c,x=f,w=l[l.length-1],w.command==="Q"&&(y=c+(c-w.points[0]),x=f+(f-w.points[1])),c+=A.shift(),f+=A.shift(),F="Q",D.push(y,x,c,f);break;case"A":b=A.shift(),_=A.shift(),S=A.shift(),T=A.shift(),h=A.shift(),k=c,E=f,c=A.shift(),f=A.shift(),F="A",D=this.convertEndpointToCenterParameterization(k,E,c,f,T,h,b,_,S);break;case"a":b=A.shift(),_=A.shift(),S=A.shift(),T=A.shift(),h=A.shift(),k=c,E=f,c+=A.shift(),f+=A.shift(),F="A",D=this.convertEndpointToCenterParameterization(k,E,c,f,T,h,b,_,S);break}l.push({command:F||L,points:D,start:{x:U,y:W},pathLength:this.calcLength(U,W,F||L,D)})}(L==="z"||L==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(e,n,r,i){let s,l,u,c;const f=Nt;switch(r){case"L":return f.getLineLength(e,n,i[0],i[1]);case"C":return(0,no.getCubicArcLength)([e,i[0],i[2],i[4]],[n,i[1],i[3],i[5]],1);case"Q":return(0,no.getQuadraticArcLength)([e,i[0],i[2]],[n,i[1],i[3]],1);case"A":s=0;var p=i[4],m=i[5],w=i[4]+m,y=Math.PI/180;if(Math.abs(p-w)<y&&(y=Math.abs(p-w)),l=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),m<0)for(c=p-y;c>w;c-=y)u=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=f.getLineLength(l.x,l.y,u.x,u.y),l=u;else for(c=p+y;c<w;c+=y)u=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=f.getLineLength(l.x,l.y,u.x,u.y),l=u;return u=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],w,0),s+=f.getLineLength(l.x,l.y,u.x,u.y),s}return 0}static convertEndpointToCenterParameterization(e,n,r,i,s,l,u,c,f){const p=f*(Math.PI/180),m=Math.cos(p)*(e-r)/2+Math.sin(p)*(n-i)/2,w=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(n-i)/2,y=m*m/(u*u)+w*w/(c*c);y>1&&(u*=Math.sqrt(y),c*=Math.sqrt(y));let x=Math.sqrt((u*u*(c*c)-u*u*(w*w)-c*c*(m*m))/(u*u*(w*w)+c*c*(m*m)));s===l&&(x*=-1),isNaN(x)&&(x=0);const b=x*u*w/c,_=x*-c*m/u,S=(e+r)/2+Math.cos(p)*b-Math.sin(p)*_,T=(n+i)/2+Math.sin(p)*b+Math.cos(p)*_,h=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},k=function(A,F){return(A[0]*F[0]+A[1]*F[1])/(h(A)*h(F))},E=function(A,F){return(A[0]*F[1]<A[1]*F[0]?-1:1)*Math.acos(k(A,F))},N=E([1,0],[(m-b)/u,(w-_)/c]),I=[(m-b)/u,(w-_)/c],M=[(-1*m-b)/u,(-1*w-_)/c];let L=E(I,M);return k(I,M)<=-1&&(L=Math.PI),k(I,M)>=1&&(L=0),l===0&&L>0&&(L=L-2*Math.PI),l===1&&L<0&&(L=L+2*Math.PI),[S,T,u,c,N,L,p,l]}}Yo.Path=Nt;Nt.prototype.className="Path";Nt.prototype._attrsAffectingSize=["data"];(0,$_._registerNode)(Nt);V_.Factory.addGetterSetter(Nt,"data");Object.defineProperty(yd,"__esModule",{value:!0});yd.Arrow=void 0;const xd=Oe,H_=Pl,t5=Ne,Y_=Re,by=Yo;let Ls=class extends H_.Line{_sceneFunc(e){super._sceneFunc(e);const n=Math.PI*2,r=this.points();let i=r;const s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());const l=this.pointerLength(),u=r.length;let c,f;if(s){const w=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[u-2],r[u-1]],y=by.Path.calcLength(i[i.length-4],i[i.length-3],"C",w),x=by.Path.getPointOnQuadraticBezier(Math.min(1,1-l/y),w[0],w[1],w[2],w[3],w[4],w[5]);c=r[u-2]-x.x,f=r[u-1]-x.y}else c=r[u-2]-r[u-4],f=r[u-1]-r[u-3];const p=(Math.atan2(f,c)+n)%n,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[u-2],r[u-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-l,m/2),e.lineTo(-l,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(c=(i[0]+i[2])/2-r[0],f=(i[1]+i[3])/2-r[1]):(c=r[2]-r[0],f=r[3]-r[1]),e.rotate((Math.atan2(-f,-c)+n)%n),e.moveTo(0,0),e.lineTo(-l,m/2),e.lineTo(-l,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x,y:e.y-n,width:e.width,height:e.height+n*2}}};yd.Arrow=Ls;Ls.prototype.className="Arrow";(0,Y_._registerNode)(Ls);xd.Factory.addGetterSetter(Ls,"pointerLength",10,(0,t5.getNumberValidator)());xd.Factory.addGetterSetter(Ls,"pointerWidth",10,(0,t5.getNumberValidator)());xd.Factory.addGetterSetter(Ls,"pointerAtBeginning",!1);xd.Factory.addGetterSetter(Ls,"pointerAtEnding",!0);var wd={};Object.defineProperty(wd,"__esModule",{value:!0});wd.Circle=void 0;const X_=Oe,K_=At,Q_=Ne,Z_=Re;let Xo=class extends K_.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};wd.Circle=Xo;Xo.prototype._centroid=!0;Xo.prototype.className="Circle";Xo.prototype._attrsAffectingSize=["radius"];(0,Z_._registerNode)(Xo);X_.Factory.addGetterSetter(Xo,"radius",0,(0,Q_.getNumberValidator)());var Sd={};Object.defineProperty(Sd,"__esModule",{value:!0});Sd.Ellipse=void 0;const Ng=Oe,q_=At,n5=Ne,J_=Re;class Ji extends q_.Shape{_sceneFunc(e){const n=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),n!==r&&e.scale(1,r/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Sd.Ellipse=Ji;Ji.prototype.className="Ellipse";Ji.prototype._centroid=!0;Ji.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,J_._registerNode)(Ji);Ng.Factory.addComponentsGetterSetter(Ji,"radius",["x","y"]);Ng.Factory.addGetterSetter(Ji,"radiusX",0,(0,n5.getNumberValidator)());Ng.Factory.addGetterSetter(Ji,"radiusY",0,(0,n5.getNumberValidator)());var _d={};Object.defineProperty(_d,"__esModule",{value:!0});_d.Image=void 0;const r0=mt,Rs=Oe,ek=At,tk=Re,Ml=Ne;class tr extends ek.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),n=this.hasShadow();return e&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let l;if(s){const u=this.attrs.cropWidth,c=this.attrs.cropHeight;u&&c?l=[s,this.cropX(),this.cropY(),u,c,0,0,n,r]:l=[s,0,0,n,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?r0.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,l))}_hitFunc(e){const n=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?r0.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n;return(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width}getHeight(){var e,n;return(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height}static fromURL(e,n,r=null){const i=r0.Util.createImageElement();i.onload=function(){const s=new tr({image:i});n(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}}_d.Image=tr;tr.prototype.className="Image";(0,tk._registerNode)(tr);Rs.Factory.addGetterSetter(tr,"cornerRadius",0,(0,Ml.getNumberOrArrayOfNumbersValidator)(4));Rs.Factory.addGetterSetter(tr,"image");Rs.Factory.addComponentsGetterSetter(tr,"crop",["x","y","width","height"]);Rs.Factory.addGetterSetter(tr,"cropX",0,(0,Ml.getNumberValidator)());Rs.Factory.addGetterSetter(tr,"cropY",0,(0,Ml.getNumberValidator)());Rs.Factory.addGetterSetter(tr,"cropWidth",0,(0,Ml.getNumberValidator)());Rs.Factory.addGetterSetter(tr,"cropHeight",0,(0,Ml.getNumberValidator)());var Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.Tag=Ro.Label=void 0;const kd=Oe,nk=At,rk=$o,Pg=Ne,r5=Re,i5=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],ik="Change.konva",sk="none",yp="up",vp="right",xp="down",wp="left",ok=i5.length;class Mg extends rk.Group{constructor(e){super(e),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let n=this,r;const i=function(){n._sync()};for(r=0;r<ok;r++)e.on(i5[r]+ik,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),n=this.getTag(),r,i,s,l,u,c,f;if(e&&n){switch(r=e.width(),i=e.height(),s=n.pointerDirection(),l=n.pointerWidth(),f=n.pointerHeight(),u=0,c=0,s){case yp:u=r/2,c=-1*f;break;case vp:u=r+l,c=i/2;break;case xp:u=r/2,c=i+f;break;case wp:u=-1*l,c=i/2;break}n.setAttrs({x:-1*u,y:-1*c,width:r,height:i}),e.setAttrs({x:-1*u,y:-1*c})}}}Ro.Label=Mg;Mg.prototype.className="Label";(0,r5._registerNode)(Mg);class js extends nk.Shape{_sceneFunc(e){const n=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),l=this.pointerHeight(),u=this.cornerRadius();let c=0,f=0,p=0,m=0;typeof u=="number"?c=f=p=m=Math.min(u,n/2,r/2):(c=Math.min(u[0]||0,n/2,r/2),f=Math.min(u[1]||0,n/2,r/2),m=Math.min(u[2]||0,n/2,r/2),p=Math.min(u[3]||0,n/2,r/2)),e.beginPath(),e.moveTo(c,0),i===yp&&(e.lineTo((n-s)/2,0),e.lineTo(n/2,-1*l),e.lineTo((n+s)/2,0)),e.lineTo(n-f,0),e.arc(n-f,f,f,Math.PI*3/2,0,!1),i===vp&&(e.lineTo(n,(r-l)/2),e.lineTo(n+s,r/2),e.lineTo(n,(r+l)/2)),e.lineTo(n,r-m),e.arc(n-m,r-m,m,0,Math.PI/2,!1),i===xp&&(e.lineTo((n+s)/2,r),e.lineTo(n/2,r+l),e.lineTo((n-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===wp&&(e.lineTo(0,(r+l)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-l)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,n=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),l=this.width(),u=this.height();return s===yp?(n-=i,u+=i):s===xp?u+=i:s===wp?(e-=r*1.5,l+=r):s===vp&&(l+=r*1.5),{x:e,y:n,width:l,height:u}}}Ro.Tag=js;js.prototype.className="Tag";(0,r5._registerNode)(js);kd.Factory.addGetterSetter(js,"pointerDirection",sk);kd.Factory.addGetterSetter(js,"pointerWidth",0,(0,Pg.getNumberValidator)());kd.Factory.addGetterSetter(js,"pointerHeight",0,(0,Pg.getNumberValidator)());kd.Factory.addGetterSetter(js,"cornerRadius",0,(0,Pg.getNumberOrArrayOfNumbersValidator)(4));var Al={};Object.defineProperty(Al,"__esModule",{value:!0});Al.Rect=void 0;const ak=Oe,lk=At,ck=Re,uk=mt,dk=Ne;let bd=class extends lk.Shape{_sceneFunc(e){const n=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),n?uk.Util.drawRoundedRectPath(e,r,i,n):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};Al.Rect=bd;bd.prototype.className="Rect";(0,ck._registerNode)(bd);ak.Factory.addGetterSetter(bd,"cornerRadius",0,(0,dk.getNumberOrArrayOfNumbersValidator)(4));var Cd={};Object.defineProperty(Cd,"__esModule",{value:!0});Cd.RegularPolygon=void 0;const s5=Oe,fk=At,o5=Ne,hk=Re;class Fs extends fk.Shape{_sceneFunc(e){const n=this._getPoints();e.beginPath(),e.moveTo(n[0].x,n[0].y);for(let r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,r=[];for(let i=0;i<e;i++)r.push({x:n*Math.sin(i*2*Math.PI/e),y:-1*n*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();let n=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(l=>{n=Math.min(n,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),s=Math.max(s,l.y)}),{x:n,y:i,width:r-n,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Cd.RegularPolygon=Fs;Fs.prototype.className="RegularPolygon";Fs.prototype._centroid=!0;Fs.prototype._attrsAffectingSize=["radius"];(0,hk._registerNode)(Fs);s5.Factory.addGetterSetter(Fs,"radius",0,(0,o5.getNumberValidator)());s5.Factory.addGetterSetter(Fs,"sides",0,(0,o5.getNumberValidator)());var Ed={};Object.defineProperty(Ed,"__esModule",{value:!0});Ed.Ring=void 0;const a5=Oe,pk=At,l5=Ne,gk=Re,Cy=Math.PI*2;class Os extends pk.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,Cy,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),Cy,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Ed.Ring=Os;Os.prototype.className="Ring";Os.prototype._centroid=!0;Os.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,gk._registerNode)(Os);a5.Factory.addGetterSetter(Os,"innerRadius",0,(0,l5.getNumberValidator)());a5.Factory.addGetterSetter(Os,"outerRadius",0,(0,l5.getNumberValidator)());var Td={};Object.defineProperty(Td,"__esModule",{value:!0});Td.Sprite=void 0;const Ds=Oe,mk=At,yk=Ho,c5=Ne,vk=Re;class zr extends mk.Shape{constructor(e){super(e),this._updated=!0,this.anim=new yk.Animation(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const n=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[n],l=this.frameOffsets(),u=s[i+0],c=s[i+1],f=s[i+2],p=s[i+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,f,p),e.closePath(),e.fillStrokeShape(this)),m)if(l){const w=l[n],y=r*2;e.drawImage(m,u,c,f,p,w[y+0],w[y+1],f,p)}else e.drawImage(m,u,c,f,p,0,0,f,p)}_hitFunc(e){const n=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[n],l=this.frameOffsets(),u=s[i+2],c=s[i+3];if(e.beginPath(),l){const f=l[n],p=r*2;e.rect(f[p+0],f[p+1],u,c)}else e.rect(0,0,u,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),n=this.animation(),r=this.animations(),i=r[n],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}Td.Sprite=zr;zr.prototype.className="Sprite";(0,vk._registerNode)(zr);Ds.Factory.addGetterSetter(zr,"animation");Ds.Factory.addGetterSetter(zr,"animations");Ds.Factory.addGetterSetter(zr,"frameOffsets");Ds.Factory.addGetterSetter(zr,"image");Ds.Factory.addGetterSetter(zr,"frameIndex",0,(0,c5.getNumberValidator)());Ds.Factory.addGetterSetter(zr,"frameRate",17,(0,c5.getNumberValidator)());Ds.Factory.backCompat(zr,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Nd={};Object.defineProperty(Nd,"__esModule",{value:!0});Nd.Star=void 0;const Ag=Oe,xk=At,Ig=Ne,wk=Re;class es extends xk.Shape{_sceneFunc(e){const n=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(let s=1;s<i*2;s++){const l=s%2===0?r:n,u=l*Math.sin(s*Math.PI/i),c=-1*l*Math.cos(s*Math.PI/i);e.lineTo(u,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Nd.Star=es;es.prototype.className="Star";es.prototype._centroid=!0;es.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,wk._registerNode)(es);Ag.Factory.addGetterSetter(es,"numPoints",5,(0,Ig.getNumberValidator)());Ag.Factory.addGetterSetter(es,"innerRadius",0,(0,Ig.getNumberValidator)());Ag.Factory.addGetterSetter(es,"outerRadius",0,(0,Ig.getNumberValidator)());var Ko={};Object.defineProperty(Ko,"__esModule",{value:!0});Ko.Text=void 0;Ko.stringToArray=vs;const Sp=mt,sn=Oe,Sk=At,i0=Re,ts=Ne,_k=Re;function vs(t){return[...t].reduce((e,n,r,i)=>{if(/\p{Emoji}/u.test(n)){const s=i[r+1];s&&/\p{Emoji_Modifier}|\u200D/u.test(s)?(e.push(n+s),i[r+1]=""):e.push(n)}else/\p{Regional_Indicator}{2}/u.test(n+(i[r+1]||""))?e.push(n+i[r+1]):r>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(n)?e[e.length-1]+=n:n&&e.push(n);return e},[])}const ro="auto",kk="center",u5="inherit",Pa="justify",bk="Change.konva",Ck="2d",Ey="-",d5="left",Ek="text",Tk="Text",Nk="top",Pk="bottom",Ty="middle",f5="normal",Mk="px ",Wc=" ",Ak="right",Ny="rtl",Ik="word",Lk="char",Py="none",s0="",h5=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Rk=h5.length;function jk(t){return t.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!r&&(e=`"${e}"`),e}).join(", ")}let $c;function o0(){return $c||($c=Sp.Util.createCanvasElement().getContext(Ck),$c)}function Fk(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Ok(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Dk(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let wt=class extends Sk.Shape{constructor(e){super(Dk(e)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<Rk;n++)this.on(h5[n]+bk,this._setTextData);this._setTextData()}_sceneFunc(e){const n=this.textArr,r=n.length;if(!this.text())return;let i=this.padding(),s=this.fontSize(),l=this.lineHeight()*s,u=this.verticalAlign(),c=this.direction(),f=0,p=this.align(),m=this.getWidth(),w=this.letterSpacing(),y=this.fill(),x=this.textDecoration(),b=x.indexOf("underline")!==-1,_=x.indexOf("line-through")!==-1,S;c=c===u5?e.direction:c;let T=l/2,h=Ty;if(i0.Konva._fixTextRendering){const D=this.measureSize("M");h="alphabetic",T=(D.fontBoundingBoxAscent-D.fontBoundingBoxDescent)/2+l/2}var k=0,E=0;for(c===Ny&&e.setAttr("direction",c),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",h),e.setAttr("textAlign",d5),u===Ty?f=(this.getHeight()-r*l-i*2)/2:u===Pk&&(f=this.getHeight()-r*l-i*2),e.translate(i,f+i),S=0;S<r;S++){var k=0,E=0,N=n[S],I=N.text,M=N.width,L=N.lastInParagraph,A,F;if(e.save(),p===Ak?k+=m-M-i*2:p===kk&&(k+=(m-M-i*2)/2),b){e.save(),e.beginPath();const W=i0.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),G=k,z=T+E+W;e.moveTo(G,z),A=I.split(" ").length-1,F=p===Pa&&!L?m-i*2:M,e.lineTo(G+Math.round(F),z),e.lineWidth=s/15;const B=this._getLinearGradient();e.strokeStyle=B||y,e.stroke(),e.restore()}if(_){e.save(),e.beginPath();const W=i0.Konva._fixTextRendering?-Math.round(s/4):0;e.moveTo(k,T+E+W),A=I.split(" ").length-1,F=p===Pa&&!L?m-i*2:M,e.lineTo(k+Math.round(F),T+E+W),e.lineWidth=s/15;const G=this._getLinearGradient();e.strokeStyle=G||y,e.stroke(),e.restore()}if(c!==Ny&&(w!==0||p===Pa)){A=I.split(" ").length-1;const W=vs(I);for(let G=0;G<W.length;G++){const z=W[G];z===" "&&!L&&p===Pa&&(k+=(m-i*2-M)/A),this._partialTextX=k,this._partialTextY=T+E,this._partialText=z,e.fillStrokeShape(this),k+=this.measureSize(z).width+w}}else w!==0&&e.setAttr("letterSpacing",`${w}px`),this._partialTextX=k,this._partialTextY=T+E,this._partialText=I,e.fillStrokeShape(this);e.restore(),r>1&&(T+=l)}}_hitFunc(e){const n=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}setText(e){const n=Sp.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(Ek,n),this}getWidth(){return this.attrs.width===ro||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===ro||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Sp.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n,r,i,s,l,u,c,f,p,m,w;let y=o0(),x=this.fontSize(),b;y.save(),y.font=this._getContextFont(),b=y.measureText(e),y.restore();const _=x/100;return{actualBoundingBoxAscent:(n=b.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*_,actualBoundingBoxDescent:(r=b.actualBoundingBoxDescent)!==null&&r!==void 0?r:0,actualBoundingBoxLeft:(i=b.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*_,actualBoundingBoxRight:(s=b.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*_,alphabeticBaseline:(l=b.alphabeticBaseline)!==null&&l!==void 0?l:0,emHeightAscent:(u=b.emHeightAscent)!==null&&u!==void 0?u:100*_,emHeightDescent:(c=b.emHeightDescent)!==null&&c!==void 0?c:-20*_,fontBoundingBoxAscent:(f=b.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*_,fontBoundingBoxDescent:(p=b.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*_,hangingBaseline:(m=b.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*_,ideographicBaseline:(w=b.ideographicBaseline)!==null&&w!==void 0?w:-21*_,width:b.width,height:x}}_getContextFont(){return this.fontStyle()+Wc+this.fontVariant()+Wc+(this.fontSize()+Mk)+jk(this.fontFamily())}_addTextLine(e){this.align()===Pa&&(e=e.trim());const r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){const n=this.letterSpacing(),r=e.length;return o0().measureText(e).width+n*r}_setTextData(){let e=this.text().split(`
`),n=+this.fontSize(),r=0,i=this.lineHeight()*n,s=this.attrs.width,l=this.attrs.height,u=s!==ro&&s!==void 0,c=l!==ro&&l!==void 0,f=this.padding(),p=s-f*2,m=l-f*2,w=0,y=this.wrap(),x=y!==Py,b=y!==Lk&&x,_=this.ellipsis();this.textArr=[],o0().font=this._getContextFont();const S=_?this._getTextWidth(s0):0;for(let T=0,h=e.length;T<h;++T){let k=e[T],E=this._getTextWidth(k);if(u&&E>p)for(;k.length>0;){let N=0,I=vs(k).length,M="",L=0;for(;N<I;){const A=N+I>>>1,F=vs(k),D=F.slice(0,A+1).join(""),U=this._getTextWidth(D);(_&&c&&w+i>m?U+S:U)<=p?(N=A+1,M=D,L=U):I=A}if(M){if(b){const D=vs(k),U=vs(M),W=D[U.length],G=W===Wc||W===Ey;let z;if(G&&L<=p)z=U.length;else{const B=U.lastIndexOf(Wc),j=U.lastIndexOf(Ey);z=Math.max(B,j)+1}z>0&&(N=z,M=D.slice(0,N).join(""),L=this._getTextWidth(M))}if(M=M.trimRight(),this._addTextLine(M),r=Math.max(r,L),w+=i,this._shouldHandleEllipsis(w)){this._tryToAddEllipsisToLastLine();break}if(k=vs(k).slice(N).join("").trimLeft(),k.length>0&&(E=this._getTextWidth(k),E<=p)){this._addTextLine(k),w+=i,r=Math.max(r,E);break}}else break}else this._addTextLine(k),w+=i,r=Math.max(r,E),this._shouldHandleEllipsis(w)&&T<h-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&w+i>m)break}this.textHeight=n,this.textWidth=r}_shouldHandleEllipsis(e){const n=+this.fontSize(),r=this.lineHeight()*n,i=this.attrs.height,s=i!==ro&&i!==void 0,l=this.padding(),u=i-l*2;return!(this.wrap()!==Py)||s&&e+r>u}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,n=e!==ro&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),l=this.textArr[this.textArr.length-1];!l||!s||(n&&(this._getTextWidth(l.text+s0)<i||(l.text=l.text.slice(0,l.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(l.text+s0))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return e&&n?!0:super._useBufferCanvas()}};Ko.Text=wt;wt.prototype._fillFunc=Fk;wt.prototype._strokeFunc=Ok;wt.prototype.className=Tk;wt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,_k._registerNode)(wt);sn.Factory.overWriteSetter(wt,"width",(0,ts.getNumberOrAutoValidator)());sn.Factory.overWriteSetter(wt,"height",(0,ts.getNumberOrAutoValidator)());sn.Factory.addGetterSetter(wt,"direction",u5);sn.Factory.addGetterSetter(wt,"fontFamily","Arial");sn.Factory.addGetterSetter(wt,"fontSize",12,(0,ts.getNumberValidator)());sn.Factory.addGetterSetter(wt,"fontStyle",f5);sn.Factory.addGetterSetter(wt,"fontVariant",f5);sn.Factory.addGetterSetter(wt,"padding",0,(0,ts.getNumberValidator)());sn.Factory.addGetterSetter(wt,"align",d5);sn.Factory.addGetterSetter(wt,"verticalAlign",Nk);sn.Factory.addGetterSetter(wt,"lineHeight",1,(0,ts.getNumberValidator)());sn.Factory.addGetterSetter(wt,"wrap",Ik);sn.Factory.addGetterSetter(wt,"ellipsis",!1,(0,ts.getBooleanValidator)());sn.Factory.addGetterSetter(wt,"letterSpacing",0,(0,ts.getNumberValidator)());sn.Factory.addGetterSetter(wt,"text","",(0,ts.getStringValidator)());sn.Factory.addGetterSetter(wt,"textDecoration","");var Pd={};Object.defineProperty(Pd,"__esModule",{value:!0});Pd.TextPath=void 0;const a0=mt,xr=Oe,zk=At,Ma=Yo,l0=Ko,p5=Ne,Bk=Re,Uk="",g5="normal";function m5(t){t.fillText(this.partialText,0,0)}function y5(t){t.strokeText(this.partialText,0,0)}class It extends zk.Shape{constructor(e){super(e),this.dummyCanvas=a0.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Ma.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const n=this.pathLength;return e-1>n?null:Ma.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Ma.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const n=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;n==="underline"&&e.beginPath();for(let l=0;l<s.length;l++){e.save();const u=s[l].p0;e.translate(u.x,u.y),e.rotate(s[l].rotation),this.partialText=s[l].text,e.fillStrokeShape(this),n==="underline"&&(l===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}n==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const n=this.glyphInfo;if(n.length>=1){const r=n[0].p0;e.moveTo(r.x,r.y)}for(let r=0;r<n.length;r++){const i=n[r].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return a0.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return l0.Text.prototype.setText.call(this,e)}_getContextFont(){return l0.Text.prototype._getContextFont.call(this)}_getTextSize(e){const r=this.dummyCanvas.getContext("2d");r.save(),r.font=this._getContextFont();const i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:n}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=n,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),l=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let u=0;i==="center"&&(u=Math.max(0,this.pathLength/2-l/2)),i==="right"&&(u=Math.max(0,this.pathLength-l));const c=(0,l0.stringToArray)(this.text());let f=u;for(let p=0;p<c.length;p++){const m=this._getPointAtLength(f);if(!m)return;let w=this._getTextSize(c[p]).width+r;if(c[p]===" "&&i==="justify"){const T=this.text().split(" ").length-1;w+=(this.pathLength-l)/T}const y=this._getPointAtLength(f+w);if(!y)return;const x=Ma.Path.getLineLength(m.x,m.y,y.x,y.y);let b=0;if(s)try{b=s(c[p-1],c[p])*this.fontSize()}catch{b=0}m.x+=b,y.x+=b,this.textWidth+=b;const _=Ma.Path.getPointOnLine(b+x/2,m.x,m.y,y.x,y.y),S=Math.atan2(y.y-m.y,y.x-m.x);this.glyphInfo.push({transposeX:_.x,transposeY:_.y,text:c[p],rotation:S,p0:m,p1:y}),f+=w}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(f){e.push(f.p0.x),e.push(f.p0.y),e.push(f.p1.x),e.push(f.p1.y)});let n=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,l,u;for(let f=0;f<e.length/2;f++)l=e[f*2],u=e[f*2+1],n=Math.min(n,l),r=Math.max(r,l),i=Math.min(i,u),s=Math.max(s,u);const c=this.fontSize();return{x:n-c/2,y:i-c/2,width:r-n+c,height:s-i+c}}destroy(){return a0.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Pd.TextPath=It;It.prototype._fillFunc=m5;It.prototype._strokeFunc=y5;It.prototype._fillFuncHit=m5;It.prototype._strokeFuncHit=y5;It.prototype.className="TextPath";It.prototype._attrsAffectingSize=["text","fontSize","data"];(0,Bk._registerNode)(It);xr.Factory.addGetterSetter(It,"data");xr.Factory.addGetterSetter(It,"fontFamily","Arial");xr.Factory.addGetterSetter(It,"fontSize",12,(0,p5.getNumberValidator)());xr.Factory.addGetterSetter(It,"fontStyle",g5);xr.Factory.addGetterSetter(It,"align","left");xr.Factory.addGetterSetter(It,"letterSpacing",0,(0,p5.getNumberValidator)());xr.Factory.addGetterSetter(It,"textBaseline","middle");xr.Factory.addGetterSetter(It,"fontVariant",g5);xr.Factory.addGetterSetter(It,"text",Uk);xr.Factory.addGetterSetter(It,"textDecoration","");xr.Factory.addGetterSetter(It,"kerningFunc",void 0);var Md={};Object.defineProperty(Md,"__esModule",{value:!0});Md.Transformer=void 0;const Ke=mt,He=Oe,My=ut,Gk=At,Vk=Al,Ay=$o,cr=Re,ns=Ne,Wk=Re,v5="tr-konva",$k=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${v5}`).join(" "),Iy="nodesRect",Hk=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],Yk={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Xk="ontouchstart"in cr.Konva._global;function Kk(t,e,n){if(t==="rotater")return n;e+=Ke.Util.degToRad(Yk[t]||0);const r=(Ke.Util.radToDeg(e)%360+360)%360;return Ke.Util._inRange(r,315+22.5,360)||Ke.Util._inRange(r,0,22.5)?"ns-resize":Ke.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":Ke.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":Ke.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":Ke.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":Ke.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":Ke.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":Ke.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(Ke.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}const Gu=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Ly=1e8;function Qk(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function x5(t,e,n){const r=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),i=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:r,y:i}}function Zk(t,e){const n=Qk(t);return x5(t,e,n)}function qk(t,e,n){let r=e;for(let i=0;i<t.length;i++){const s=cr.Konva.getAngle(t[i]),l=Math.abs(s-e)%(Math.PI*2);Math.min(l,Math.PI*2-l)<n&&(r=s)}return r}let _p=0;class Ue extends Ay.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on($k,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return Ke.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return v5+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const n=e.filter(i=>i.isAncestorOf(this)?(Ke.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=n,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const l=i._attrsAffectingSize.map(u=>u+"Change."+this._getEventNamespace()).join(" ");i.on(l,s)}i.on(Hk.map(l=>l+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let n;e.on(`dragstart.${this._getEventNamespace()}`,r=>{n=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!n)return;const i=e.getAbsolutePosition(),s=i.x-n.x,l=i.y-n.y;this.nodes().forEach(u=>{if(u===e||u.isDragging())return;const c=u.getAbsolutePosition();u.setAbsolutePosition({x:c.x+s,y:c.y+l}),u.startDrag(r)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Iy),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Iy,this.__getNodeRect)}__getNodeShape(e,n=this.rotation(),r){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),l=e.getAbsolutePosition(r),u=i.x*s.x-e.offsetX()*s.x,c=i.y*s.y-e.offsetY()*s.y,f=(cr.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:l.x+u*Math.cos(f)+c*Math.sin(-f),y:l.y+c*Math.cos(f)+u*Math.sin(f),width:i.width*s.x,height:i.height*s.y,rotation:f};return x5(p,-cr.Konva.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-Ly,y:-Ly,width:0,height:0,rotation:0};const n=[];this.nodes().map(f=>{const p=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),m=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],w=f.getAbsoluteTransform();m.forEach(function(y){const x=w.point(y);n.push(x)})});const r=new Ke.Transform;r.rotate(-cr.Konva.getAngle(this.rotation()));let i=1/0,s=1/0,l=-1/0,u=-1/0;n.forEach(function(f){const p=r.point(f);i===void 0&&(i=l=p.x,s=u=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),l=Math.max(l,p.x),u=Math.max(u,p.y)}),r.invert();const c=r.point({x:i,y:s});return{x:c.x,y:c.y,width:l-i,height:u-s,rotation:cr.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Gu.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const n=new Vk.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Xk?10:"auto"}),r=this;n.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),n.on("dragstart",i=>{n.stopDrag(),i.cancelBubble=!0}),n.on("dragend",i=>{i.cancelBubble=!0}),n.on("mouseenter",()=>{const i=cr.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),l=Kk(e,i,s);n.getStage().content&&(n.getStage().content.style.cursor=l),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const e=new Gk.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(n,r){const i=r.getParent(),s=i.padding();n.beginPath(),n.rect(-s,-s,r.width()+s*2,r.height()+s*2),n.moveTo(r.width()/2,-s),i.rotateEnabled()&&i.rotateLineVisible()&&n.lineTo(r.width()/2,-i.rotateAnchorOffset()*Ke.Util._sign(r.height())-s),n.fillStrokeShape(r)},hitFunc:(n,r)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();n.beginPath(),n.rect(-i,-i,r.width()+i*2,r.height()+i*2),n.fillStrokeShape(r)}});this.add(e),this._proxyDrag(e),e.on("dragstart",n=>{n.cancelBubble=!0}),e.on("dragmove",n=>{n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const n=this._getNodeRect(),r=n.width,i=n.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const l=e.target.getAbsolutePosition(),u=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:u.x-l.x,y:u.y-l.y},_p++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){let n,r,i;const s=this.findOne("."+this._movingAnchorName),l=s.getStage();l.setPointersPositions(e);const u=l.getPointerPosition();let c={x:u.x-this._anchorDragOffset.x,y:u.y-this._anchorDragOffset.y};const f=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(f,c,e)),s.setAbsolutePosition(c);const p=s.getAbsolutePosition();if(f.x===p.x&&f.y===p.y)return;if(this._movingAnchorName==="rotater"){const E=this._getNodeRect();n=s.x()-E.width/2,r=-s.y()+E.height/2;let N=Math.atan2(-r,n)+Math.PI/2;E.height<0&&(N-=Math.PI);const M=cr.Konva.getAngle(this.rotation())+N,L=cr.Konva.getAngle(this.rotationSnapTolerance()),F=qk(this.rotationSnaps(),M,L)-E.rotation,D=Zk(E,F);this._fitNodesInto(D,e);return}const m=this.shiftBehavior();let w;m==="inverted"?w=this.keepRatio()&&!e.shiftKey:m==="none"?w=this.keepRatio():w=this.keepRatio()||e.shiftKey;var S=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(w){var y=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(y.x-s.x(),2)+Math.pow(y.y-s.y(),2));var x=this.findOne(".top-left").x()>y.x?-1:1,b=this.findOne(".top-left").y()>y.y?-1:1;n=i*this.cos*x,r=i*this.sin*b,this.findOne(".top-left").x(y.x-n),this.findOne(".top-left").y(y.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(w){var y=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-y.x,2)+Math.pow(y.y-s.y(),2));var x=this.findOne(".top-right").x()<y.x?-1:1,b=this.findOne(".top-right").y()>y.y?-1:1;n=i*this.cos*x,r=i*this.sin*b,this.findOne(".top-right").x(y.x+n),this.findOne(".top-right").y(y.y-r)}var _=s.position();this.findOne(".top-left").y(_.y),this.findOne(".bottom-right").x(_.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(w){var y=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(y.x-s.x(),2)+Math.pow(s.y()-y.y,2));var x=y.x<s.x()?-1:1,b=s.y()<y.y?-1:1;n=i*this.cos*x,r=i*this.sin*b,s.x(y.x-n),s.y(y.y+r)}_=s.position(),this.findOne(".top-left").x(_.x),this.findOne(".bottom-right").y(_.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(w){var y=S?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-y.x,2)+Math.pow(s.y()-y.y,2));var x=this.findOne(".bottom-right").x()<y.x?-1:1,b=this.findOne(".bottom-right").y()<y.y?-1:1;n=i*this.cos*x,r=i*this.sin*b,this.findOne(".bottom-right").x(y.x+n),this.findOne(".bottom-right").y(y.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var S=this.centeredScaling()||e.altKey;if(S){const E=this.findOne(".top-left"),N=this.findOne(".bottom-right"),I=E.x(),M=E.y(),L=this.getWidth()-N.x(),A=this.getHeight()-N.y();N.move({x:-I,y:-M}),E.move({x:L,y:A})}const T=this.findOne(".top-left").getAbsolutePosition();n=T.x,r=T.y;const h=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),k=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:r,width:h,height:k,rotation:cr.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();_p--,this._fire("transformend",{evt:e,target:r}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),r&&this._nodes.forEach(i=>{var s;i._fire("transformend",{evt:e,target:i}),(s=i.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,n){const r=this._getNodeRect(),i=1;if(Ke.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(Ke.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const s=new Ke.Transform;if(s.rotate(cr.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const w=s.point({x:-this.padding()*2,y:0});e.x+=w.x,e.y+=w.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=w.x,this._anchorDragOffset.y-=w.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const w=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=w.x,this._anchorDragOffset.y-=w.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const w=s.point({x:0,y:-this.padding()*2});e.x+=w.x,e.y+=w.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=w.x,this._anchorDragOffset.y-=w.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const w=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=w.x,this._anchorDragOffset.y-=w.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const w=this.boundBoxFunc()(r,e);w?e=w:Ke.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const l=1e7,u=new Ke.Transform;u.translate(r.x,r.y),u.rotate(r.rotation),u.scale(r.width/l,r.height/l);const c=new Ke.Transform,f=e.width/l,p=e.height/l;this.flipEnabled()===!1?(c.translate(e.x,e.y),c.rotate(e.rotation),c.translate(e.width<0?e.width:0,e.height<0?e.height:0),c.scale(Math.abs(f),Math.abs(p))):(c.translate(e.x,e.y),c.rotate(e.rotation),c.scale(f,p));const m=c.multiply(u.invert());this._nodes.forEach(w=>{var y;const x=w.getParent().getAbsoluteTransform(),b=w.getTransform().copy();b.translate(w.offsetX(),w.offsetY());const _=new Ke.Transform;_.multiply(x.copy().invert()).multiply(m).multiply(x).multiply(b);const S=_.decompose();w.setAttrs(S),(y=w.getLayer())===null||y===void 0||y.batchDraw()}),this.rotation(Ke.Util._getRotation(e.rotation)),this._nodes.forEach(w=>{this._fire("transform",{evt:n,target:w}),w._fire("transform",{evt:n,target:w})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,n){this.findOne(e).setAttrs(n)}update(){var e;const n=this._getNodeRect();this.rotation(Ke.Util._getRotation(n.rotation));const r=n.width,i=n.height,s=this.enabledAnchors(),l=this.resizeEnabled(),u=this.padding(),c=this.anchorSize(),f=this.find("._anchor");f.forEach(m=>{m.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+u,offsetY:c/2+u,visible:l&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+u,visible:l&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-u,offsetY:c/2+u,visible:l&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:c/2+u,visible:l&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:c/2-u,visible:l&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:c/2+u,offsetY:c/2-u,visible:l&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:c/2-u,visible:l&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:c/2-u,offsetY:c/2-u,visible:l&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*Ke.Util._sign(i)-u,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&f.forEach(m=>{p(m)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Ay.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return My.Node.prototype.toObject.call(this)}clone(e){return My.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Md.Transformer=Ue;Ue.isTransforming=()=>_p>0;function Jk(t){return t instanceof Array||Ke.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){Gu.indexOf(e)===-1&&Ke.Util.warn("Unknown anchor name: "+e+". Available names are: "+Gu.join(", "))}),t||[]}Ue.prototype.className="Transformer";(0,Wk._registerNode)(Ue);He.Factory.addGetterSetter(Ue,"enabledAnchors",Gu,Jk);He.Factory.addGetterSetter(Ue,"flipEnabled",!0,(0,ns.getBooleanValidator)());He.Factory.addGetterSetter(Ue,"resizeEnabled",!0);He.Factory.addGetterSetter(Ue,"anchorSize",10,(0,ns.getNumberValidator)());He.Factory.addGetterSetter(Ue,"rotateEnabled",!0);He.Factory.addGetterSetter(Ue,"rotateLineVisible",!0);He.Factory.addGetterSetter(Ue,"rotationSnaps",[]);He.Factory.addGetterSetter(Ue,"rotateAnchorOffset",50,(0,ns.getNumberValidator)());He.Factory.addGetterSetter(Ue,"rotateAnchorCursor","crosshair");He.Factory.addGetterSetter(Ue,"rotationSnapTolerance",5,(0,ns.getNumberValidator)());He.Factory.addGetterSetter(Ue,"borderEnabled",!0);He.Factory.addGetterSetter(Ue,"anchorStroke","rgb(0, 161, 255)");He.Factory.addGetterSetter(Ue,"anchorStrokeWidth",1,(0,ns.getNumberValidator)());He.Factory.addGetterSetter(Ue,"anchorFill","white");He.Factory.addGetterSetter(Ue,"anchorCornerRadius",0,(0,ns.getNumberValidator)());He.Factory.addGetterSetter(Ue,"borderStroke","rgb(0, 161, 255)");He.Factory.addGetterSetter(Ue,"borderStrokeWidth",1,(0,ns.getNumberValidator)());He.Factory.addGetterSetter(Ue,"borderDash");He.Factory.addGetterSetter(Ue,"keepRatio",!0);He.Factory.addGetterSetter(Ue,"shiftBehavior","default");He.Factory.addGetterSetter(Ue,"centeredScaling",!1);He.Factory.addGetterSetter(Ue,"ignoreStroke",!1);He.Factory.addGetterSetter(Ue,"padding",0,(0,ns.getNumberValidator)());He.Factory.addGetterSetter(Ue,"nodes");He.Factory.addGetterSetter(Ue,"node");He.Factory.addGetterSetter(Ue,"boundBoxFunc");He.Factory.addGetterSetter(Ue,"anchorDragBoundFunc");He.Factory.addGetterSetter(Ue,"anchorStyleFunc");He.Factory.addGetterSetter(Ue,"shouldOverdrawWholeArea",!1);He.Factory.addGetterSetter(Ue,"useSingleNodeRotation",!0);He.Factory.backCompat(Ue,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Ad={};Object.defineProperty(Ad,"__esModule",{value:!0});Ad.Wedge=void 0;const Id=Oe,eb=At,tb=Re,w5=Ne,nb=Re;class hi extends eb.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,tb.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Ad.Wedge=hi;hi.prototype.className="Wedge";hi.prototype._centroid=!0;hi.prototype._attrsAffectingSize=["radius"];(0,nb._registerNode)(hi);Id.Factory.addGetterSetter(hi,"radius",0,(0,w5.getNumberValidator)());Id.Factory.addGetterSetter(hi,"angle",0,(0,w5.getNumberValidator)());Id.Factory.addGetterSetter(hi,"clockwise",!1);Id.Factory.backCompat(hi,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Ld={};Object.defineProperty(Ld,"__esModule",{value:!0});Ld.Blur=void 0;const Ry=Oe,rb=ut,ib=Ne;function jy(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const sb=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],ob=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function ab(t,e){const n=t.data,r=t.width,i=t.height;let s,l,u,c,f,p,m,w,y,x,b,_,S,T,h,k,E,N,I,M,L,A,F,D;const U=e+e+1,W=r-1,G=i-1,z=e+1,B=z*(z+1)/2,j=new jy,$=sb[e],X=ob[e];let ee=null,ne=j,Z=null,te=null;for(u=1;u<U;u++)ne=ne.next=new jy,u===z&&(ee=ne);for(ne.next=j,m=p=0,l=0;l<i;l++){for(k=E=N=I=w=y=x=b=0,_=z*(M=n[p]),S=z*(L=n[p+1]),T=z*(A=n[p+2]),h=z*(F=n[p+3]),w+=B*M,y+=B*L,x+=B*A,b+=B*F,ne=j,u=0;u<z;u++)ne.r=M,ne.g=L,ne.b=A,ne.a=F,ne=ne.next;for(u=1;u<z;u++)c=p+((W<u?W:u)<<2),w+=(ne.r=M=n[c])*(D=z-u),y+=(ne.g=L=n[c+1])*D,x+=(ne.b=A=n[c+2])*D,b+=(ne.a=F=n[c+3])*D,k+=M,E+=L,N+=A,I+=F,ne=ne.next;for(Z=j,te=ee,s=0;s<r;s++)n[p+3]=F=b*$>>X,F!==0?(F=255/F,n[p]=(w*$>>X)*F,n[p+1]=(y*$>>X)*F,n[p+2]=(x*$>>X)*F):n[p]=n[p+1]=n[p+2]=0,w-=_,y-=S,x-=T,b-=h,_-=Z.r,S-=Z.g,T-=Z.b,h-=Z.a,c=m+((c=s+e+1)<W?c:W)<<2,k+=Z.r=n[c],E+=Z.g=n[c+1],N+=Z.b=n[c+2],I+=Z.a=n[c+3],w+=k,y+=E,x+=N,b+=I,Z=Z.next,_+=M=te.r,S+=L=te.g,T+=A=te.b,h+=F=te.a,k-=M,E-=L,N-=A,I-=F,te=te.next,p+=4;m+=r}for(s=0;s<r;s++){for(E=N=I=k=y=x=b=w=0,p=s<<2,_=z*(M=n[p]),S=z*(L=n[p+1]),T=z*(A=n[p+2]),h=z*(F=n[p+3]),w+=B*M,y+=B*L,x+=B*A,b+=B*F,ne=j,u=0;u<z;u++)ne.r=M,ne.g=L,ne.b=A,ne.a=F,ne=ne.next;for(f=r,u=1;u<=e;u++)p=f+s<<2,w+=(ne.r=M=n[p])*(D=z-u),y+=(ne.g=L=n[p+1])*D,x+=(ne.b=A=n[p+2])*D,b+=(ne.a=F=n[p+3])*D,k+=M,E+=L,N+=A,I+=F,ne=ne.next,u<G&&(f+=r);for(p=s,Z=j,te=ee,l=0;l<i;l++)c=p<<2,n[c+3]=F=b*$>>X,F>0?(F=255/F,n[c]=(w*$>>X)*F,n[c+1]=(y*$>>X)*F,n[c+2]=(x*$>>X)*F):n[c]=n[c+1]=n[c+2]=0,w-=_,y-=S,x-=T,b-=h,_-=Z.r,S-=Z.g,T-=Z.b,h-=Z.a,c=s+((c=l+z)<G?c:G)*r<<2,w+=k+=Z.r=n[c],y+=E+=Z.g=n[c+1],x+=N+=Z.b=n[c+2],b+=I+=Z.a=n[c+3],Z=Z.next,_+=M=te.r,S+=L=te.g,T+=A=te.b,h+=F=te.a,k-=M,E-=L,N-=A,I-=F,te=te.next,p+=r}}const lb=function(e){const n=Math.round(this.blurRadius());n>0&&ab(e,n)};Ld.Blur=lb;Ry.Factory.addGetterSetter(rb.Node,"blurRadius",0,(0,ib.getNumberValidator)(),Ry.Factory.afterSetFilter);var Rd={};Object.defineProperty(Rd,"__esModule",{value:!0});Rd.Brighten=void 0;const Fy=Oe,cb=ut,ub=Ne,db=function(t){const e=this.brightness()*255,n=t.data,r=n.length;for(let i=0;i<r;i+=4)n[i]+=e,n[i+1]+=e,n[i+2]+=e};Rd.Brighten=db;Fy.Factory.addGetterSetter(cb.Node,"brightness",0,(0,ub.getNumberValidator)(),Fy.Factory.afterSetFilter);var jd={};Object.defineProperty(jd,"__esModule",{value:!0});jd.Contrast=void 0;const Oy=Oe,fb=ut,hb=Ne,pb=function(t){const e=Math.pow((this.contrast()+100)/100,2),n=t.data,r=n.length;let i=150,s=150,l=150;for(let u=0;u<r;u+=4)i=n[u],s=n[u+1],l=n[u+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,l/=255,l-=.5,l*=e,l+=.5,l*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,l=l<0?0:l>255?255:l,n[u]=i,n[u+1]=s,n[u+2]=l};jd.Contrast=pb;Oy.Factory.addGetterSetter(fb.Node,"contrast",0,(0,hb.getNumberValidator)(),Oy.Factory.afterSetFilter);var Fd={};Object.defineProperty(Fd,"__esModule",{value:!0});Fd.Emboss=void 0;const Yi=Oe,Od=ut,gb=mt,S5=Ne,mb=function(t){const e=this.embossStrength()*10,n=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=t.data,l=t.width,u=t.height,c=l*4;let f=0,p=0,m=u;switch(r){case"top-left":f=-1,p=-1;break;case"top":f=-1,p=0;break;case"top-right":f=-1,p=1;break;case"right":f=0,p=1;break;case"bottom-right":f=1,p=1;break;case"bottom":f=1,p=0;break;case"bottom-left":f=1,p=-1;break;case"left":f=0,p=-1;break;default:gb.Util.error("Unknown emboss direction: "+r)}do{const w=(m-1)*c;let y=f;m+y<1&&(y=0),m+y>u&&(y=0);const x=(m-1+y)*l*4;let b=l;do{const _=w+(b-1)*4;let S=p;b+S<1&&(S=0),b+S>l&&(S=0);const T=x+(b-1+S)*4,h=s[_]-s[T],k=s[_+1]-s[T+1],E=s[_+2]-s[T+2];let N=h;const I=N>0?N:-N,M=k>0?k:-k,L=E>0?E:-E;if(M>I&&(N=k),L>I&&(N=E),N*=e,i){const A=s[_]+N,F=s[_+1]+N,D=s[_+2]+N;s[_]=A>255?255:A<0?0:A,s[_+1]=F>255?255:F<0?0:F,s[_+2]=D>255?255:D<0?0:D}else{let A=n-N;A<0?A=0:A>255&&(A=255),s[_]=s[_+1]=s[_+2]=A}}while(--b)}while(--m)};Fd.Emboss=mb;Yi.Factory.addGetterSetter(Od.Node,"embossStrength",.5,(0,S5.getNumberValidator)(),Yi.Factory.afterSetFilter);Yi.Factory.addGetterSetter(Od.Node,"embossWhiteLevel",.5,(0,S5.getNumberValidator)(),Yi.Factory.afterSetFilter);Yi.Factory.addGetterSetter(Od.Node,"embossDirection","top-left",void 0,Yi.Factory.afterSetFilter);Yi.Factory.addGetterSetter(Od.Node,"embossBlend",!1,void 0,Yi.Factory.afterSetFilter);var Dd={};Object.defineProperty(Dd,"__esModule",{value:!0});Dd.Enhance=void 0;const Dy=Oe,yb=ut,vb=Ne;function c0(t,e,n,r,i){const s=n-e,l=i-r;if(s===0)return r+l/2;if(l===0)return r;let u=(t-e)/s;return u=l*u+r,u}const xb=function(t){const e=t.data,n=e.length;let r=e[0],i=r,s,l=e[1],u=l,c,f=e[2],p=f,m;const w=this.enhance();if(w===0)return;for(let N=0;N<n;N+=4)s=e[N+0],s<r?r=s:s>i&&(i=s),c=e[N+1],c<l?l=c:c>u&&(u=c),m=e[N+2],m<f?f=m:m>p&&(p=m);i===r&&(i=255,r=0),u===l&&(u=255,l=0),p===f&&(p=255,f=0);let y,x,b,_,S,T,h,k,E;w>0?(x=i+w*(255-i),b=r-w*(r-0),S=u+w*(255-u),T=l-w*(l-0),k=p+w*(255-p),E=f-w*(f-0)):(y=(i+r)*.5,x=i+w*(i-y),b=r+w*(r-y),_=(u+l)*.5,S=u+w*(u-_),T=l+w*(l-_),h=(p+f)*.5,k=p+w*(p-h),E=f+w*(f-h));for(let N=0;N<n;N+=4)e[N+0]=c0(e[N+0],r,i,b,x),e[N+1]=c0(e[N+1],l,u,T,S),e[N+2]=c0(e[N+2],f,p,E,k)};Dd.Enhance=xb;Dy.Factory.addGetterSetter(yb.Node,"enhance",0,(0,vb.getNumberValidator)(),Dy.Factory.afterSetFilter);var zd={};Object.defineProperty(zd,"__esModule",{value:!0});zd.Grayscale=void 0;const wb=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=.34*e[r]+.5*e[r+1]+.16*e[r+2];e[r]=i,e[r+1]=i,e[r+2]=i}};zd.Grayscale=wb;var Bd={};Object.defineProperty(Bd,"__esModule",{value:!0});Bd.HSL=void 0;const jo=Oe,Lg=ut,Rg=Ne;jo.Factory.addGetterSetter(Lg.Node,"hue",0,(0,Rg.getNumberValidator)(),jo.Factory.afterSetFilter);jo.Factory.addGetterSetter(Lg.Node,"saturation",0,(0,Rg.getNumberValidator)(),jo.Factory.afterSetFilter);jo.Factory.addGetterSetter(Lg.Node,"luminance",0,(0,Rg.getNumberValidator)(),jo.Factory.afterSetFilter);const Sb=function(t){const e=t.data,n=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,l=this.luminance()*127,u=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),f=.299*r+.701*u+.167*c,p=.587*r-.587*u+.33*c,m=.114*r-.114*u-.497*c,w=.299*r-.299*u-.328*c,y=.587*r+.413*u+.035*c,x=.114*r-.114*u+.293*c,b=.299*r-.3*u+1.25*c,_=.587*r-.586*u-1.05*c,S=.114*r+.886*u-.2*c;let T,h,k,E;for(let N=0;N<n;N+=4)T=e[N+0],h=e[N+1],k=e[N+2],E=e[N+3],e[N+0]=f*T+p*h+m*k+l,e[N+1]=w*T+y*h+x*k+l,e[N+2]=b*T+_*h+S*k+l,e[N+3]=E};Bd.HSL=Sb;var Ud={};Object.defineProperty(Ud,"__esModule",{value:!0});Ud.HSV=void 0;const Fo=Oe,jg=ut,Fg=Ne,_b=function(t){const e=t.data,n=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,l=r*i*Math.cos(s*Math.PI/180),u=r*i*Math.sin(s*Math.PI/180),c=.299*r+.701*l+.167*u,f=.587*r-.587*l+.33*u,p=.114*r-.114*l-.497*u,m=.299*r-.299*l-.328*u,w=.587*r+.413*l+.035*u,y=.114*r-.114*l+.293*u,x=.299*r-.3*l+1.25*u,b=.587*r-.586*l-1.05*u,_=.114*r+.886*l-.2*u;let S,T,h,k;for(let E=0;E<n;E+=4)S=e[E+0],T=e[E+1],h=e[E+2],k=e[E+3],e[E+0]=c*S+f*T+p*h,e[E+1]=m*S+w*T+y*h,e[E+2]=x*S+b*T+_*h,e[E+3]=k};Ud.HSV=_b;Fo.Factory.addGetterSetter(jg.Node,"hue",0,(0,Fg.getNumberValidator)(),Fo.Factory.afterSetFilter);Fo.Factory.addGetterSetter(jg.Node,"saturation",0,(0,Fg.getNumberValidator)(),Fo.Factory.afterSetFilter);Fo.Factory.addGetterSetter(jg.Node,"value",0,(0,Fg.getNumberValidator)(),Fo.Factory.afterSetFilter);var Gd={};Object.defineProperty(Gd,"__esModule",{value:!0});Gd.Invert=void 0;const kb=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};Gd.Invert=kb;var Vd={};Object.defineProperty(Vd,"__esModule",{value:!0});Vd.Kaleidoscope=void 0;const Vu=Oe,_5=ut,zy=mt,k5=Ne,bb=function(t,e,n){const r=t.data,i=e.data,s=t.width,l=t.height,u=n.polarCenterX||s/2,c=n.polarCenterY||l/2;let f=Math.sqrt(u*u+c*c),p=s-u,m=l-c;const w=Math.sqrt(p*p+m*m);f=w>f?w:f;const y=l,x=s,b=360/x*Math.PI/180;for(let _=0;_<x;_+=1){const S=Math.sin(_*b),T=Math.cos(_*b);for(let h=0;h<y;h+=1){p=Math.floor(u+f*h/y*T),m=Math.floor(c+f*h/y*S);let k=(m*s+p)*4;const E=r[k+0],N=r[k+1],I=r[k+2],M=r[k+3];k=(_+h*s)*4,i[k+0]=E,i[k+1]=N,i[k+2]=I,i[k+3]=M}}},Cb=function(t,e,n){const r=t.data,i=e.data,s=t.width,l=t.height,u=n.polarCenterX||s/2,c=n.polarCenterY||l/2;let f=Math.sqrt(u*u+c*c),p=s-u,m=l-c;const w=Math.sqrt(p*p+m*m);f=w>f?w:f;const y=l,x=s,b=n.polarRotation||0;let _,S;for(p=0;p<s;p+=1)for(m=0;m<l;m+=1){const T=p-u,h=m-c,k=Math.sqrt(T*T+h*h)*y/f;let E=(Math.atan2(h,T)*180/Math.PI+360+b)%360;E=E*x/360,_=Math.floor(E),S=Math.floor(k);let N=(S*s+_)*4;const I=r[N+0],M=r[N+1],L=r[N+2],A=r[N+3];N=(m*s+p)*4,i[N+0]=I,i[N+1]=M,i[N+2]=L,i[N+3]=A}},Eb=function(t){const e=t.width,n=t.height;let r,i,s,l,u,c,f,p,m,w,y=Math.round(this.kaleidoscopePower());const x=Math.round(this.kaleidoscopeAngle()),b=Math.floor(e*(x%360)/360);if(y<1)return;const _=zy.Util.createCanvasElement();_.width=e,_.height=n;const S=_.getContext("2d").getImageData(0,0,e,n);zy.Util.releaseCanvas(_),bb(t,S,{polarCenterX:e/2,polarCenterY:n/2});let T=e/Math.pow(2,y);for(;T<=8;)T=T*2,y-=1;T=Math.ceil(T);let h=T,k=0,E=h,N=1;for(b+T>e&&(k=h,E=0,N=-1),i=0;i<n;i+=1)for(r=k;r!==E;r+=N)s=Math.round(r+b)%e,m=(e*i+s)*4,u=S.data[m+0],c=S.data[m+1],f=S.data[m+2],p=S.data[m+3],w=(e*i+r)*4,S.data[w+0]=u,S.data[w+1]=c,S.data[w+2]=f,S.data[w+3]=p;for(i=0;i<n;i+=1)for(h=Math.floor(T),l=0;l<y;l+=1){for(r=0;r<h+1;r+=1)m=(e*i+r)*4,u=S.data[m+0],c=S.data[m+1],f=S.data[m+2],p=S.data[m+3],w=(e*i+h*2-r-1)*4,S.data[w+0]=u,S.data[w+1]=c,S.data[w+2]=f,S.data[w+3]=p;h*=2}Cb(S,t,{polarRotation:0})};Vd.Kaleidoscope=Eb;Vu.Factory.addGetterSetter(_5.Node,"kaleidoscopePower",2,(0,k5.getNumberValidator)(),Vu.Factory.afterSetFilter);Vu.Factory.addGetterSetter(_5.Node,"kaleidoscopeAngle",0,(0,k5.getNumberValidator)(),Vu.Factory.afterSetFilter);var Wd={};Object.defineProperty(Wd,"__esModule",{value:!0});Wd.Mask=void 0;const By=Oe,Tb=ut,Nb=Ne;function Hc(t,e,n){let r=(n*t.width+e)*4;const i=[];return i.push(t.data[r++],t.data[r++],t.data[r++],t.data[r++]),i}function Aa(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function Pb(t){const e=[0,0,0];for(let n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function Mb(t,e){const n=Hc(t,0,0),r=Hc(t,t.width-1,0),i=Hc(t,0,t.height-1),s=Hc(t,t.width-1,t.height-1),l=e||10;if(Aa(n,r)<l&&Aa(r,s)<l&&Aa(s,i)<l&&Aa(i,n)<l){const u=Pb([r,n,s,i]),c=[];for(let f=0;f<t.width*t.height;f++){const p=Aa(u,[t.data[f*4],t.data[f*4+1],t.data[f*4+2]]);c[f]=p<l?0:255}return c}}function Ab(t,e){for(let n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function Ib(t,e,n){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let u=0;u<n;u++)for(let c=0;c<e;c++){const f=u*e+c;let p=0;for(let m=0;m<i;m++)for(let w=0;w<i;w++){const y=u+m-s,x=c+w-s;if(y>=0&&y<n&&x>=0&&x<e){const b=y*e+x,_=r[m*i+w];p+=t[b]*_}}l[f]=p===255*8?255:0}return l}function Lb(t,e,n){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let u=0;u<n;u++)for(let c=0;c<e;c++){const f=u*e+c;let p=0;for(let m=0;m<i;m++)for(let w=0;w<i;w++){const y=u+m-s,x=c+w-s;if(y>=0&&y<n&&x>=0&&x<e){const b=y*e+x,_=r[m*i+w];p+=t[b]*_}}l[f]=p>=255*4?255:0}return l}function Rb(t,e,n){const r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let u=0;u<n;u++)for(let c=0;c<e;c++){const f=u*e+c;let p=0;for(let m=0;m<i;m++)for(let w=0;w<i;w++){const y=u+m-s,x=c+w-s;if(y>=0&&y<n&&x>=0&&x<e){const b=y*e+x,_=r[m*i+w];p+=t[b]*_}}l[f]=p}return l}const jb=function(t){const e=this.threshold();let n=Mb(t,e);return n&&(n=Ib(n,t.width,t.height),n=Lb(n,t.width,t.height),n=Rb(n,t.width,t.height),Ab(t,n)),t};Wd.Mask=jb;By.Factory.addGetterSetter(Tb.Node,"threshold",0,(0,Nb.getNumberValidator)(),By.Factory.afterSetFilter);var $d={};Object.defineProperty($d,"__esModule",{value:!0});$d.Noise=void 0;const Uy=Oe,Fb=ut,Ob=Ne,Db=function(t){const e=this.noise()*255,n=t.data,r=n.length,i=e/2;for(let s=0;s<r;s+=4)n[s+0]+=i-2*i*Math.random(),n[s+1]+=i-2*i*Math.random(),n[s+2]+=i-2*i*Math.random()};$d.Noise=Db;Uy.Factory.addGetterSetter(Fb.Node,"noise",.2,(0,Ob.getNumberValidator)(),Uy.Factory.afterSetFilter);var Hd={};Object.defineProperty(Hd,"__esModule",{value:!0});Hd.Pixelate=void 0;const Gy=Oe,zb=mt,Bb=ut,Ub=Ne,Gb=function(t){let e=Math.ceil(this.pixelSize()),n=t.width,r=t.height,i,s,l,u,c,f,p,m=Math.ceil(n/e),w=Math.ceil(r/e),y,x,b,_,S,T,h,k=t.data;if(e<=0){zb.Util.error("pixelSize value can not be <= 0");return}for(S=0;S<m;S+=1)for(T=0;T<w;T+=1){for(u=0,c=0,f=0,p=0,y=S*e,x=y+e,b=T*e,_=b+e,h=0,i=y;i<x;i+=1)if(!(i>=n))for(s=b;s<_;s+=1)s>=r||(l=(n*s+i)*4,u+=k[l+0],c+=k[l+1],f+=k[l+2],p+=k[l+3],h+=1);for(u=u/h,c=c/h,f=f/h,p=p/h,i=y;i<x;i+=1)if(!(i>=n))for(s=b;s<_;s+=1)s>=r||(l=(n*s+i)*4,k[l+0]=u,k[l+1]=c,k[l+2]=f,k[l+3]=p)}};Hd.Pixelate=Gb;Gy.Factory.addGetterSetter(Bb.Node,"pixelSize",8,(0,Ub.getNumberValidator)(),Gy.Factory.afterSetFilter);var Yd={};Object.defineProperty(Yd,"__esModule",{value:!0});Yd.Posterize=void 0;const Vy=Oe,Vb=ut,Wb=Ne,$b=function(t){const e=Math.round(this.levels()*254)+1,n=t.data,r=n.length,i=255/e;for(let s=0;s<r;s+=1)n[s]=Math.floor(n[s]/i)*i};Yd.Posterize=$b;Vy.Factory.addGetterSetter(Vb.Node,"levels",.5,(0,Wb.getNumberValidator)(),Vy.Factory.afterSetFilter);var Xd={};Object.defineProperty(Xd,"__esModule",{value:!0});Xd.RGB=void 0;const Wu=Oe,Og=ut,Hb=Ne,Yb=function(t){const e=t.data,n=e.length,r=this.red(),i=this.green(),s=this.blue();for(let l=0;l<n;l+=4){const u=(.34*e[l]+.5*e[l+1]+.16*e[l+2])/255;e[l]=u*r,e[l+1]=u*i,e[l+2]=u*s,e[l+3]=e[l+3]}};Xd.RGB=Yb;Wu.Factory.addGetterSetter(Og.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Wu.Factory.addGetterSetter(Og.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Wu.Factory.addGetterSetter(Og.Node,"blue",0,Hb.RGBComponent,Wu.Factory.afterSetFilter);var Kd={};Object.defineProperty(Kd,"__esModule",{value:!0});Kd.RGBA=void 0;const ml=Oe,Qd=ut,Xb=Ne,Kb=function(t){const e=t.data,n=e.length,r=this.red(),i=this.green(),s=this.blue(),l=this.alpha();for(let u=0;u<n;u+=4){const c=1-l;e[u]=r*l+e[u]*c,e[u+1]=i*l+e[u+1]*c,e[u+2]=s*l+e[u+2]*c}};Kd.RGBA=Kb;ml.Factory.addGetterSetter(Qd.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});ml.Factory.addGetterSetter(Qd.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});ml.Factory.addGetterSetter(Qd.Node,"blue",0,Xb.RGBComponent,ml.Factory.afterSetFilter);ml.Factory.addGetterSetter(Qd.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var Zd={};Object.defineProperty(Zd,"__esModule",{value:!0});Zd.Sepia=void 0;const Qb=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=e[r+0],s=e[r+1],l=e[r+2];e[r+0]=Math.min(255,i*.393+s*.769+l*.189),e[r+1]=Math.min(255,i*.349+s*.686+l*.168),e[r+2]=Math.min(255,i*.272+s*.534+l*.131)}};Zd.Sepia=Qb;var qd={};Object.defineProperty(qd,"__esModule",{value:!0});qd.Solarize=void 0;const Zb=function(t){const e=t.data,n=t.width,r=t.height,i=n*4;let s=r;do{const l=(s-1)*i;let u=n;do{const c=l+(u-1)*4;let f=e[c],p=e[c+1],m=e[c+2];f>127&&(f=255-f),p>127&&(p=255-p),m>127&&(m=255-m),e[c]=f,e[c+1]=p,e[c+2]=m}while(--u)}while(--s)};qd.Solarize=Zb;var Jd={};Object.defineProperty(Jd,"__esModule",{value:!0});Jd.Threshold=void 0;const Wy=Oe,qb=ut,Jb=Ne,eC=function(t){const e=this.threshold()*255,n=t.data,r=n.length;for(let i=0;i<r;i+=1)n[i]=n[i]<e?0:255};Jd.Threshold=eC;Wy.Factory.addGetterSetter(qb.Node,"threshold",.5,(0,Jb.getNumberValidator)(),Wy.Factory.afterSetFilter);Object.defineProperty(cd,"__esModule",{value:!0});cd.Konva=void 0;const $y=Bu,tC=pd,nC=yd,rC=wd,iC=Sd,sC=_d,Hy=Ro,oC=Pl,aC=Yo,lC=Al,cC=Cd,uC=Ed,dC=Td,fC=Nd,hC=Ko,pC=Pd,gC=Md,mC=Ad,yC=Ld,vC=Rd,xC=jd,wC=Fd,SC=Dd,_C=zd,kC=Bd,bC=Ud,CC=Gd,EC=Vd,TC=Wd,NC=$d,PC=Hd,MC=Yd,AC=Xd,IC=Kd,LC=Zd,RC=qd,jC=Jd;cd.Konva=$y.Konva.Util._assign($y.Konva,{Arc:tC.Arc,Arrow:nC.Arrow,Circle:rC.Circle,Ellipse:iC.Ellipse,Image:sC.Image,Label:Hy.Label,Tag:Hy.Tag,Line:oC.Line,Path:aC.Path,Rect:lC.Rect,RegularPolygon:cC.RegularPolygon,Ring:uC.Ring,Sprite:dC.Sprite,Star:fC.Star,Text:hC.Text,TextPath:pC.TextPath,Transformer:gC.Transformer,Wedge:mC.Wedge,Filters:{Blur:yC.Blur,Brighten:vC.Brighten,Contrast:xC.Contrast,Emboss:wC.Emboss,Enhance:SC.Enhance,Grayscale:_C.Grayscale,HSL:kC.HSL,HSV:bC.HSV,Invert:CC.Invert,Kaleidoscope:EC.Kaleidoscope,Mask:TC.Mask,Noise:NC.Noise,Pixelate:PC.Pixelate,Posterize:MC.Posterize,RGB:AC.RGB,RGBA:IC.RGBA,Sepia:LC.Sepia,Solarize:RC.Solarize,Threshold:jC.Threshold}});var FC=W4.exports;Object.defineProperty(FC,"__esModule",{value:!0});const OC=cd;W4.exports=OC.Konva;var kp={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var n=Bu;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return n.Konva}});const r=Bu;t.exports=r.Konva})(kp,kp.exports);var DC=kp.exports;const yl=xl(DC);var b5={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zC=function(e){var n={},r=O,i=Oa,s=Object.assign;function l(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,d=1;d<arguments.length;d++)a+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),f=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),x=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),k=Symbol.for("react.offscreen"),E=Symbol.iterator;function N(o){return o===null||typeof o!="object"?null:(o=E&&o[E]||o["@@iterator"],typeof o=="function"?o:null)}function I(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case p:return"Fragment";case f:return"Portal";case w:return"Profiler";case m:return"StrictMode";case _:return"Suspense";case S:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case x:return(o.displayName||"Context")+".Consumer";case y:return(o._context.displayName||"Context")+".Provider";case b:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case T:return a=o.displayName||null,a!==null?a:I(o.type)||"Memo";case h:a=o._payload,o=o._init;try{return I(o(a))}catch{}}return null}function M(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(a);case 8:return a===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function L(o){var a=o,d=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,a.flags&4098&&(d=a.return),o=a.return;while(o)}return a.tag===3?d:null}function A(o){if(L(o)!==o)throw Error(l(188))}function F(o){var a=o.alternate;if(!a){if(a=L(o),a===null)throw Error(l(188));return a!==o?null:o}for(var d=o,g=a;;){var v=d.return;if(v===null)break;var P=v.alternate;if(P===null){if(g=v.return,g!==null){d=g;continue}break}if(v.child===P.child){for(P=v.child;P;){if(P===d)return A(v),o;if(P===g)return A(v),a;P=P.sibling}throw Error(l(188))}if(d.return!==g.return)d=v,g=P;else{for(var R=!1,H=v.child;H;){if(H===d){R=!0,d=v,g=P;break}if(H===g){R=!0,g=v,d=P;break}H=H.sibling}if(!R){for(H=P.child;H;){if(H===d){R=!0,d=P,g=v;break}if(H===g){R=!0,g=P,d=v;break}H=H.sibling}if(!R)throw Error(l(189))}}if(d.alternate!==g)throw Error(l(190))}if(d.tag!==3)throw Error(l(188));return d.stateNode.current===d?o:a}function D(o){return o=F(o),o!==null?U(o):null}function U(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=U(o);if(a!==null)return a;o=o.sibling}return null}function W(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){if(o.tag!==4){var a=W(o);if(a!==null)return a}o=o.sibling}return null}var G=Array.isArray,z=e.getPublicInstance,B=e.getRootHostContext,j=e.getChildHostContext,$=e.prepareForCommit,X=e.resetAfterCommit,ee=e.createInstance,ne=e.appendInitialChild,Z=e.finalizeInitialChildren,te=e.prepareUpdate,de=e.shouldSetTextContent,fe=e.createTextInstance,V=e.scheduleTimeout,K=e.cancelTimeout,se=e.noTimeout,re=e.isPrimaryRenderer,oe=e.supportsMutation,ge=e.supportsPersistence,he=e.supportsHydration,be=e.getInstanceFromNode,le=e.preparePortalMount,ve=e.getCurrentEventPriority,je=e.detachDeletedInstance,ze=e.supportsMicrotasks,Xe=e.scheduleMicrotask,Yt=e.supportsTestSelectors,st=e.findFiberRoot,Fn=e.getBoundingRect,On=e.getTextContent,ot=e.isHiddenSubtree,wr=e.matchAccessibilityRole,pi=e.setFocusIfFocusable,Br=e.setupIntersectionObserver,Ur=e.appendChild,yt=e.appendChildToContainer,dn=e.commitTextUpdate,Gr=e.commitMount,Pe=e.commitUpdate,ie=e.insertBefore,ce=e.insertInContainerBefore,pe=e.removeChild,Ce=e.removeChildFromContainer,Ee=e.resetTextContent,xe=e.hideInstance,et=e.hideTextInstance,fn=e.unhideInstance,hn=e.unhideTextInstance,gi=e.clearContainer,Sr=e.cloneInstance,is=e.createContainerChildSet,_r=e.appendChildToContainerChildSet,Tn=e.finalizeContainerChildren,Qo=e.replaceContainerChildren,Vg=e.cloneHiddenInstance,Wg=e.cloneHiddenTextInstance,D5=e.canHydrateInstance,z5=e.canHydrateTextInstance,B5=e.canHydrateSuspenseInstance,$g=e.isSuspenseInstancePending,nf=e.isSuspenseInstanceFallback,U5=e.getSuspenseInstanceFallbackErrorDetails,G5=e.registerSuspenseInstanceRetry,Il=e.getNextHydratableSibling,V5=e.getFirstHydratableChild,W5=e.getFirstHydratableChildWithinContainer,$5=e.getFirstHydratableChildWithinSuspenseInstance,H5=e.hydrateInstance,Y5=e.hydrateTextInstance,X5=e.hydrateSuspenseInstance,K5=e.getNextHydratableInstanceAfterSuspenseInstance,Q5=e.commitHydratedContainer,Z5=e.commitHydratedSuspenseInstance,q5=e.clearSuspenseBoundary,J5=e.clearSuspenseBoundaryFromContainer,ex=e.shouldDeleteUnhydratedTailInstances,tx=e.didNotMatchHydratedContainerTextInstance,nx=e.didNotMatchHydratedTextInstance,rf;function Zo(o){if(rf===void 0)try{throw Error()}catch(d){var a=d.stack.trim().match(/\n( *(at )?)/);rf=a&&a[1]||""}return`
`+rf+o}var sf=!1;function of(o,a){if(!o||sf)return"";sf=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ue){var g=ue}Reflect.construct(o,[],a)}else{try{a.call()}catch(ue){g=ue}o.call(a.prototype)}else{try{throw Error()}catch(ue){g=ue}o()}}catch(ue){if(ue&&g&&typeof ue.stack=="string"){for(var v=ue.stack.split(`
`),P=g.stack.split(`
`),R=v.length-1,H=P.length-1;1<=R&&0<=H&&v[R]!==P[H];)H--;for(;1<=R&&0<=H;R--,H--)if(v[R]!==P[H]){if(R!==1||H!==1)do if(R--,H--,0>H||v[R]!==P[H]){var q=`
`+v[R].replace(" at new "," at ");return o.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",o.displayName)),q}while(1<=R&&0<=H);break}}}finally{sf=!1,Error.prepareStackTrace=d}return(o=o?o.displayName||o.name:"")?Zo(o):""}var rx=Object.prototype.hasOwnProperty,af=[],Bs=-1;function mi(o){return{current:o}}function tt(o){0>Bs||(o.current=af[Bs],af[Bs]=null,Bs--)}function qe(o,a){Bs++,af[Bs]=o.current,o.current=a}var yi={},Xt=mi(yi),pn=mi(!1),ss=yi;function Us(o,a){var d=o.type.contextTypes;if(!d)return yi;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===a)return g.__reactInternalMemoizedMaskedChildContext;var v={},P;for(P in d)v[P]=a[P];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=v),v}function gn(o){return o=o.childContextTypes,o!=null}function Ll(){tt(pn),tt(Xt)}function Hg(o,a,d){if(Xt.current!==yi)throw Error(l(168));qe(Xt,a),qe(pn,d)}function Yg(o,a,d){var g=o.stateNode;if(a=a.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var v in g)if(!(v in a))throw Error(l(108,M(o)||"Unknown",v));return s({},d,g)}function Rl(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||yi,ss=Xt.current,qe(Xt,o),qe(pn,pn.current),!0}function Xg(o,a,d){var g=o.stateNode;if(!g)throw Error(l(169));d?(o=Yg(o,a,ss),g.__reactInternalMemoizedMergedChildContext=o,tt(pn),tt(Xt),qe(Xt,o)):tt(pn),qe(pn,d)}var nr=Math.clz32?Math.clz32:ox,ix=Math.log,sx=Math.LN2;function ox(o){return o>>>=0,o===0?32:31-(ix(o)/sx|0)|0}var jl=64,Fl=4194304;function qo(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Ol(o,a){var d=o.pendingLanes;if(d===0)return 0;var g=0,v=o.suspendedLanes,P=o.pingedLanes,R=d&268435455;if(R!==0){var H=R&~v;H!==0?g=qo(H):(P&=R,P!==0&&(g=qo(P)))}else R=d&~v,R!==0?g=qo(R):P!==0&&(g=qo(P));if(g===0)return 0;if(a!==0&&a!==g&&!(a&v)&&(v=g&-g,P=a&-a,v>=P||v===16&&(P&4194240)!==0))return a;if(g&4&&(g|=d&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=g;0<a;)d=31-nr(a),v=1<<d,g|=o[d],a&=~v;return g}function ax(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lx(o,a){for(var d=o.suspendedLanes,g=o.pingedLanes,v=o.expirationTimes,P=o.pendingLanes;0<P;){var R=31-nr(P),H=1<<R,q=v[R];q===-1?(!(H&d)||H&g)&&(v[R]=ax(H,a)):q<=a&&(o.expiredLanes|=H),P&=~H}}function lf(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Kg(){var o=jl;return jl<<=1,!(jl&4194240)&&(jl=64),o}function cf(o){for(var a=[],d=0;31>d;d++)a.push(o);return a}function Jo(o,a,d){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-nr(a),o[a]=d}function cx(o,a){var d=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<d;){var v=31-nr(d),P=1<<v;a[v]=0,g[v]=-1,o[v]=-1,d&=~P}}function uf(o,a){var d=o.entangledLanes|=a;for(o=o.entanglements;d;){var g=31-nr(d),v=1<<g;v&a|o[g]&a&&(o[g]|=a),d&=~v}}var Ve=0;function Qg(o){return o&=-o,1<o?4<o?o&268435455?16:536870912:4:1}var df=i.unstable_scheduleCallback,Zg=i.unstable_cancelCallback,ux=i.unstable_shouldYield,dx=i.unstable_requestPaint,Lt=i.unstable_now,ff=i.unstable_ImmediatePriority,fx=i.unstable_UserBlockingPriority,hf=i.unstable_NormalPriority,hx=i.unstable_IdlePriority,Dl=null,kr=null;function px(o){if(kr&&typeof kr.onCommitFiberRoot=="function")try{kr.onCommitFiberRoot(Dl,o,void 0,(o.current.flags&128)===128)}catch{}}function gx(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var rr=typeof Object.is=="function"?Object.is:gx,Vr=null,zl=!1,pf=!1;function qg(o){Vr===null?Vr=[o]:Vr.push(o)}function mx(o){zl=!0,qg(o)}function br(){if(!pf&&Vr!==null){pf=!0;var o=0,a=Ve;try{var d=Vr;for(Ve=1;o<d.length;o++){var g=d[o];do g=g(!0);while(g!==null)}Vr=null,zl=!1}catch(v){throw Vr!==null&&(Vr=Vr.slice(o+1)),df(ff,br),v}finally{Ve=a,pf=!1}}return null}var Gs=[],Vs=0,Bl=null,Ul=0,Dn=[],zn=0,os=null,Wr=1,$r="";function as(o,a){Gs[Vs++]=Ul,Gs[Vs++]=Bl,Bl=o,Ul=a}function Jg(o,a,d){Dn[zn++]=Wr,Dn[zn++]=$r,Dn[zn++]=os,os=o;var g=Wr;o=$r;var v=32-nr(g)-1;g&=~(1<<v),d+=1;var P=32-nr(a)+v;if(30<P){var R=v-v%5;P=(g&(1<<R)-1).toString(32),g>>=R,v-=R,Wr=1<<32-nr(a)+v|d<<v|g,$r=P+o}else Wr=1<<P|d<<v|g,$r=o}function gf(o){o.return!==null&&(as(o,1),Jg(o,1,0))}function mf(o){for(;o===Bl;)Bl=Gs[--Vs],Gs[Vs]=null,Ul=Gs[--Vs],Gs[Vs]=null;for(;o===os;)os=Dn[--zn],Dn[zn]=null,$r=Dn[--zn],Dn[zn]=null,Wr=Dn[--zn],Dn[zn]=null}var Nn=null,Bn=null,at=!1,ea=!1,ir=null;function e1(o,a){var d=$n(5,null,null,0);d.elementType="DELETED",d.stateNode=a,d.return=o,a=o.deletions,a===null?(o.deletions=[d],o.flags|=16):a.push(d)}function t1(o,a){switch(o.tag){case 5:return a=D5(a,o.type,o.pendingProps),a!==null?(o.stateNode=a,Nn=o,Bn=V5(a),!0):!1;case 6:return a=z5(a,o.pendingProps),a!==null?(o.stateNode=a,Nn=o,Bn=null,!0):!1;case 13:if(a=B5(a),a!==null){var d=os!==null?{id:Wr,overflow:$r}:null;return o.memoizedState={dehydrated:a,treeContext:d,retryLane:1073741824},d=$n(18,null,null,0),d.stateNode=a,d.return=o,o.child=d,Nn=o,Bn=null,!0}return!1;default:return!1}}function yf(o){return(o.mode&1)!==0&&(o.flags&128)===0}function vf(o){if(at){var a=Bn;if(a){var d=a;if(!t1(o,a)){if(yf(o))throw Error(l(418));a=Il(d);var g=Nn;a&&t1(o,a)?e1(g,d):(o.flags=o.flags&-4097|2,at=!1,Nn=o)}}else{if(yf(o))throw Error(l(418));o.flags=o.flags&-4097|2,at=!1,Nn=o}}}function n1(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Nn=o}function Gl(o){if(!he||o!==Nn)return!1;if(!at)return n1(o),at=!0,!1;if(o.tag!==3&&(o.tag!==5||ex(o.type)&&!de(o.type,o.memoizedProps))){var a=Bn;if(a){if(yf(o))throw r1(),Error(l(418));for(;a;)e1(o,a),a=Il(a)}}if(n1(o),o.tag===13){if(!he)throw Error(l(316));if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(l(317));Bn=K5(o)}else Bn=Nn?Il(o.stateNode):null;return!0}function r1(){for(var o=Bn;o;)o=Il(o)}function Ws(){he&&(Bn=Nn=null,ea=at=!1)}function xf(o){ir===null?ir=[o]:ir.push(o)}var yx=u.ReactCurrentBatchConfig;function Vl(o,a){if(rr(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var d=Object.keys(o),g=Object.keys(a);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var v=d[g];if(!rx.call(a,v)||!rr(o[v],a[v]))return!1}return!0}function vx(o){switch(o.tag){case 5:return Zo(o.type);case 16:return Zo("Lazy");case 13:return Zo("Suspense");case 19:return Zo("SuspenseList");case 0:case 2:case 15:return o=of(o.type,!1),o;case 11:return o=of(o.type.render,!1),o;case 1:return o=of(o.type,!0),o;default:return""}}function ta(o,a,d){if(o=d.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(l(309));var g=d.stateNode}if(!g)throw Error(l(147,o));var v=g,P=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===P?a.ref:(a=function(R){var H=v.refs;R===null?delete H[P]:H[P]=R},a._stringRef=P,a)}if(typeof o!="string")throw Error(l(284));if(!d._owner)throw Error(l(290,o))}return o}function Wl(o,a){throw o=Object.prototype.toString.call(a),Error(l(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function i1(o){var a=o._init;return a(o._payload)}function s1(o){function a(Q,Y){if(o){var J=Q.deletions;J===null?(Q.deletions=[Y],Q.flags|=16):J.push(Y)}}function d(Q,Y){if(!o)return null;for(;Y!==null;)a(Q,Y),Y=Y.sibling;return null}function g(Q,Y){for(Q=new Map;Y!==null;)Y.key!==null?Q.set(Y.key,Y):Q.set(Y.index,Y),Y=Y.sibling;return Q}function v(Q,Y){return Q=bi(Q,Y),Q.index=0,Q.sibling=null,Q}function P(Q,Y,J){return Q.index=J,o?(J=Q.alternate,J!==null?(J=J.index,J<Y?(Q.flags|=2,Y):J):(Q.flags|=2,Y)):(Q.flags|=1048576,Y)}function R(Q){return o&&Q.alternate===null&&(Q.flags|=2),Q}function H(Q,Y,J,ye){return Y===null||Y.tag!==6?(Y=ph(J,Q.mode,ye),Y.return=Q,Y):(Y=v(Y,J),Y.return=Q,Y)}function q(Q,Y,J,ye){var Te=J.type;return Te===p?ke(Q,Y,J.props.children,ye,J.key):Y!==null&&(Y.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===h&&i1(Te)===Y.type)?(ye=v(Y,J.props),ye.ref=ta(Q,Y,J),ye.return=Q,ye):(ye=Sc(J.type,J.key,J.props,null,Q.mode,ye),ye.ref=ta(Q,Y,J),ye.return=Q,ye)}function ue(Q,Y,J,ye){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==J.containerInfo||Y.stateNode.implementation!==J.implementation?(Y=gh(J,Q.mode,ye),Y.return=Q,Y):(Y=v(Y,J.children||[]),Y.return=Q,Y)}function ke(Q,Y,J,ye,Te){return Y===null||Y.tag!==7?(Y=ps(J,Q.mode,ye,Te),Y.return=Q,Y):(Y=v(Y,J),Y.return=Q,Y)}function Ae(Q,Y,J){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=ph(""+Y,Q.mode,J),Y.return=Q,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case c:return J=Sc(Y.type,Y.key,Y.props,null,Q.mode,J),J.ref=ta(Q,null,Y),J.return=Q,J;case f:return Y=gh(Y,Q.mode,J),Y.return=Q,Y;case h:var ye=Y._init;return Ae(Q,ye(Y._payload),J)}if(G(Y)||N(Y))return Y=ps(Y,Q.mode,J,null),Y.return=Q,Y;Wl(Q,Y)}return null}function me(Q,Y,J,ye){var Te=Y!==null?Y.key:null;if(typeof J=="string"&&J!==""||typeof J=="number")return Te!==null?null:H(Q,Y,""+J,ye);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case c:return J.key===Te?q(Q,Y,J,ye):null;case f:return J.key===Te?ue(Q,Y,J,ye):null;case h:return Te=J._init,me(Q,Y,Te(J._payload),ye)}if(G(J)||N(J))return Te!==null?null:ke(Q,Y,J,ye,null);Wl(Q,J)}return null}function nt(Q,Y,J,ye,Te){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return Q=Q.get(J)||null,H(Y,Q,""+ye,Te);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case c:return Q=Q.get(ye.key===null?J:ye.key)||null,q(Y,Q,ye,Te);case f:return Q=Q.get(ye.key===null?J:ye.key)||null,ue(Y,Q,ye,Te);case h:var Le=ye._init;return nt(Q,Y,J,Le(ye._payload),Te)}if(G(ye)||N(ye))return Q=Q.get(J)||null,ke(Y,Q,ye,Te,null);Wl(Y,ye)}return null}function Qe(Q,Y,J,ye){for(var Te=null,Le=null,Ie=Y,We=Y=0,Ft=null;Ie!==null&&We<J.length;We++){Ie.index>We?(Ft=Ie,Ie=null):Ft=Ie.sibling;var $e=me(Q,Ie,J[We],ye);if($e===null){Ie===null&&(Ie=Ft);break}o&&Ie&&$e.alternate===null&&a(Q,Ie),Y=P($e,Y,We),Le===null?Te=$e:Le.sibling=$e,Le=$e,Ie=Ft}if(We===J.length)return d(Q,Ie),at&&as(Q,We),Te;if(Ie===null){for(;We<J.length;We++)Ie=Ae(Q,J[We],ye),Ie!==null&&(Y=P(Ie,Y,We),Le===null?Te=Ie:Le.sibling=Ie,Le=Ie);return at&&as(Q,We),Te}for(Ie=g(Q,Ie);We<J.length;We++)Ft=nt(Ie,Q,We,J[We],ye),Ft!==null&&(o&&Ft.alternate!==null&&Ie.delete(Ft.key===null?We:Ft.key),Y=P(Ft,Y,We),Le===null?Te=Ft:Le.sibling=Ft,Le=Ft);return o&&Ie.forEach(function(Ci){return a(Q,Ci)}),at&&as(Q,We),Te}function xn(Q,Y,J,ye){var Te=N(J);if(typeof Te!="function")throw Error(l(150));if(J=Te.call(J),J==null)throw Error(l(151));for(var Le=Te=null,Ie=Y,We=Y=0,Ft=null,$e=J.next();Ie!==null&&!$e.done;We++,$e=J.next()){Ie.index>We?(Ft=Ie,Ie=null):Ft=Ie.sibling;var Ci=me(Q,Ie,$e.value,ye);if(Ci===null){Ie===null&&(Ie=Ft);break}o&&Ie&&Ci.alternate===null&&a(Q,Ie),Y=P(Ci,Y,We),Le===null?Te=Ci:Le.sibling=Ci,Le=Ci,Ie=Ft}if($e.done)return d(Q,Ie),at&&as(Q,We),Te;if(Ie===null){for(;!$e.done;We++,$e=J.next())$e=Ae(Q,$e.value,ye),$e!==null&&(Y=P($e,Y,We),Le===null?Te=$e:Le.sibling=$e,Le=$e);return at&&as(Q,We),Te}for(Ie=g(Q,Ie);!$e.done;We++,$e=J.next())$e=nt(Ie,Q,We,$e.value,ye),$e!==null&&(o&&$e.alternate!==null&&Ie.delete($e.key===null?We:$e.key),Y=P($e,Y,We),Le===null?Te=$e:Le.sibling=$e,Le=$e);return o&&Ie.forEach(function(Xx){return a(Q,Xx)}),at&&as(Q,We),Te}function Kr(Q,Y,J,ye){if(typeof J=="object"&&J!==null&&J.type===p&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case c:e:{for(var Te=J.key,Le=Y;Le!==null;){if(Le.key===Te){if(Te=J.type,Te===p){if(Le.tag===7){d(Q,Le.sibling),Y=v(Le,J.props.children),Y.return=Q,Q=Y;break e}}else if(Le.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===h&&i1(Te)===Le.type){d(Q,Le.sibling),Y=v(Le,J.props),Y.ref=ta(Q,Le,J),Y.return=Q,Q=Y;break e}d(Q,Le);break}else a(Q,Le);Le=Le.sibling}J.type===p?(Y=ps(J.props.children,Q.mode,ye,J.key),Y.return=Q,Q=Y):(ye=Sc(J.type,J.key,J.props,null,Q.mode,ye),ye.ref=ta(Q,Y,J),ye.return=Q,Q=ye)}return R(Q);case f:e:{for(Le=J.key;Y!==null;){if(Y.key===Le)if(Y.tag===4&&Y.stateNode.containerInfo===J.containerInfo&&Y.stateNode.implementation===J.implementation){d(Q,Y.sibling),Y=v(Y,J.children||[]),Y.return=Q,Q=Y;break e}else{d(Q,Y);break}else a(Q,Y);Y=Y.sibling}Y=gh(J,Q.mode,ye),Y.return=Q,Q=Y}return R(Q);case h:return Le=J._init,Kr(Q,Y,Le(J._payload),ye)}if(G(J))return Qe(Q,Y,J,ye);if(N(J))return xn(Q,Y,J,ye);Wl(Q,J)}return typeof J=="string"&&J!==""||typeof J=="number"?(J=""+J,Y!==null&&Y.tag===6?(d(Q,Y.sibling),Y=v(Y,J),Y.return=Q,Q=Y):(d(Q,Y),Y=ph(J,Q.mode,ye),Y.return=Q,Q=Y),R(Q)):d(Q,Y)}return Kr}var $s=s1(!0),o1=s1(!1),$l=mi(null),Hl=null,Hs=null,wf=null;function Sf(){wf=Hs=Hl=null}function a1(o,a,d){re?(qe($l,a._currentValue),a._currentValue=d):(qe($l,a._currentValue2),a._currentValue2=d)}function _f(o){var a=$l.current;tt($l),re?o._currentValue=a:o._currentValue2=a}function kf(o,a,d){for(;o!==null;){var g=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),o===d)break;o=o.return}}function Ys(o,a){Hl=o,wf=Hs=null,o=o.dependencies,o!==null&&o.firstContext!==null&&(o.lanes&a&&(mn=!0),o.firstContext=null)}function Un(o){var a=re?o._currentValue:o._currentValue2;if(wf!==o)if(o={context:o,memoizedValue:a,next:null},Hs===null){if(Hl===null)throw Error(l(308));Hs=o,Hl.dependencies={lanes:0,firstContext:o}}else Hs=Hs.next=o;return a}var ls=null;function bf(o){ls===null?ls=[o]:ls.push(o)}function l1(o,a,d,g){var v=a.interleaved;return v===null?(d.next=d,bf(a)):(d.next=v.next,v.next=d),a.interleaved=d,Cr(o,g)}function Cr(o,a){o.lanes|=a;var d=o.alternate;for(d!==null&&(d.lanes|=a),d=o,o=o.return;o!==null;)o.childLanes|=a,d=o.alternate,d!==null&&(d.childLanes|=a),d=o,o=o.return;return d.tag===3?d.stateNode:null}var vi=!1;function Cf(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function c1(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Hr(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function xi(o,a,d){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,Fe&2){var v=g.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),g.pending=a,Cr(o,d)}return v=g.interleaved,v===null?(a.next=a,bf(g)):(a.next=v.next,v.next=a),g.interleaved=a,Cr(o,d)}function Yl(o,a,d){if(a=a.updateQueue,a!==null&&(a=a.shared,(d&4194240)!==0)){var g=a.lanes;g&=o.pendingLanes,d|=g,a.lanes=d,uf(o,d)}}function u1(o,a){var d=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var v=null,P=null;if(d=d.firstBaseUpdate,d!==null){do{var R={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};P===null?v=P=R:P=P.next=R,d=d.next}while(d!==null);P===null?v=P=a:P=P.next=a}else v=P=a;d={baseState:g.baseState,firstBaseUpdate:v,lastBaseUpdate:P,shared:g.shared,effects:g.effects},o.updateQueue=d;return}o=d.lastBaseUpdate,o===null?d.firstBaseUpdate=a:o.next=a,d.lastBaseUpdate=a}function Xl(o,a,d,g){var v=o.updateQueue;vi=!1;var P=v.firstBaseUpdate,R=v.lastBaseUpdate,H=v.shared.pending;if(H!==null){v.shared.pending=null;var q=H,ue=q.next;q.next=null,R===null?P=ue:R.next=ue,R=q;var ke=o.alternate;ke!==null&&(ke=ke.updateQueue,H=ke.lastBaseUpdate,H!==R&&(H===null?ke.firstBaseUpdate=ue:H.next=ue,ke.lastBaseUpdate=q))}if(P!==null){var Ae=v.baseState;R=0,ke=ue=q=null,H=P;do{var me=H.lane,nt=H.eventTime;if((g&me)===me){ke!==null&&(ke=ke.next={eventTime:nt,lane:0,tag:H.tag,payload:H.payload,callback:H.callback,next:null});e:{var Qe=o,xn=H;switch(me=a,nt=d,xn.tag){case 1:if(Qe=xn.payload,typeof Qe=="function"){Ae=Qe.call(nt,Ae,me);break e}Ae=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=xn.payload,me=typeof Qe=="function"?Qe.call(nt,Ae,me):Qe,me==null)break e;Ae=s({},Ae,me);break e;case 2:vi=!0}}H.callback!==null&&H.lane!==0&&(o.flags|=64,me=v.effects,me===null?v.effects=[H]:me.push(H))}else nt={eventTime:nt,lane:me,tag:H.tag,payload:H.payload,callback:H.callback,next:null},ke===null?(ue=ke=nt,q=Ae):ke=ke.next=nt,R|=me;if(H=H.next,H===null){if(H=v.shared.pending,H===null)break;me=H,H=me.next,me.next=null,v.lastBaseUpdate=me,v.shared.pending=null}}while(1);if(ke===null&&(q=Ae),v.baseState=q,v.firstBaseUpdate=ue,v.lastBaseUpdate=ke,a=v.shared.interleaved,a!==null){v=a;do R|=v.lane,v=v.next;while(v!==a)}else P===null&&(v.shared.lanes=0);us|=R,o.lanes=R,o.memoizedState=Ae}}function d1(o,a,d){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var g=o[a],v=g.callback;if(v!==null){if(g.callback=null,g=d,typeof v!="function")throw Error(l(191,v));v.call(g)}}}var na={},Gn=mi(na),ra=mi(na),Xs=mi(na);function Er(o){if(o===na)throw Error(l(174));return o}function Ef(o,a){qe(Xs,a),qe(ra,o),qe(Gn,na),o=B(a),tt(Gn),qe(Gn,o)}function Ks(){tt(Gn),tt(ra),tt(Xs)}function f1(o){var a=Er(Xs.current),d=Er(Gn.current);a=j(d,o.type,a),d!==a&&(qe(ra,o),qe(Gn,a))}function Tf(o){ra.current===o&&(tt(Gn),tt(ra))}var dt=mi(0);function Kl(o){for(var a=o;a!==null;){if(a.tag===13){var d=a.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||$g(d)||nf(d)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Nf=[];function Pf(){for(var o=0;o<Nf.length;o++){var a=Nf[o];re?a._workInProgressVersionPrimary=null:a._workInProgressVersionSecondary=null}Nf.length=0}var Ql=u.ReactCurrentDispatcher,Mf=u.ReactCurrentBatchConfig,cs=0,ft=null,Et=null,Rt=null,Zl=!1,ia=!1,sa=0,xx=0;function Kt(){throw Error(l(321))}function Af(o,a){if(a===null)return!1;for(var d=0;d<a.length&&d<o.length;d++)if(!rr(o[d],a[d]))return!1;return!0}function If(o,a,d,g,v,P){if(cs=P,ft=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Ql.current=o===null||o.memoizedState===null?kx:bx,o=d(g,v),ia){P=0;do{if(ia=!1,sa=0,25<=P)throw Error(l(301));P+=1,Rt=Et=null,a.updateQueue=null,Ql.current=Cx,o=d(g,v)}while(ia)}if(Ql.current=ec,a=Et!==null&&Et.next!==null,cs=0,Rt=Et=ft=null,Zl=!1,a)throw Error(l(300));return o}function Lf(){var o=sa!==0;return sa=0,o}function Tr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?ft.memoizedState=Rt=o:Rt=Rt.next=o,Rt}function Vn(){if(Et===null){var o=ft.alternate;o=o!==null?o.memoizedState:null}else o=Et.next;var a=Rt===null?ft.memoizedState:Rt.next;if(a!==null)Rt=a,Et=o;else{if(o===null)throw Error(l(310));Et=o,o={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},Rt===null?ft.memoizedState=Rt=o:Rt=Rt.next=o}return Rt}function oa(o,a){return typeof a=="function"?a(o):a}function Rf(o){var a=Vn(),d=a.queue;if(d===null)throw Error(l(311));d.lastRenderedReducer=o;var g=Et,v=g.baseQueue,P=d.pending;if(P!==null){if(v!==null){var R=v.next;v.next=P.next,P.next=R}g.baseQueue=v=P,d.pending=null}if(v!==null){P=v.next,g=g.baseState;var H=R=null,q=null,ue=P;do{var ke=ue.lane;if((cs&ke)===ke)q!==null&&(q=q.next={lane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),g=ue.hasEagerState?ue.eagerState:o(g,ue.action);else{var Ae={lane:ke,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null};q===null?(H=q=Ae,R=g):q=q.next=Ae,ft.lanes|=ke,us|=ke}ue=ue.next}while(ue!==null&&ue!==P);q===null?R=g:q.next=H,rr(g,a.memoizedState)||(mn=!0),a.memoizedState=g,a.baseState=R,a.baseQueue=q,d.lastRenderedState=g}if(o=d.interleaved,o!==null){v=o;do P=v.lane,ft.lanes|=P,us|=P,v=v.next;while(v!==o)}else v===null&&(d.lanes=0);return[a.memoizedState,d.dispatch]}function jf(o){var a=Vn(),d=a.queue;if(d===null)throw Error(l(311));d.lastRenderedReducer=o;var g=d.dispatch,v=d.pending,P=a.memoizedState;if(v!==null){d.pending=null;var R=v=v.next;do P=o(P,R.action),R=R.next;while(R!==v);rr(P,a.memoizedState)||(mn=!0),a.memoizedState=P,a.baseQueue===null&&(a.baseState=P),d.lastRenderedState=P}return[P,g]}function h1(){}function p1(o,a){var d=ft,g=Vn(),v=a(),P=!rr(g.memoizedState,v);if(P&&(g.memoizedState=v,mn=!0),g=g.queue,Ff(y1.bind(null,d,g,o),[o]),g.getSnapshot!==a||P||Rt!==null&&Rt.memoizedState.tag&1){if(d.flags|=2048,aa(9,m1.bind(null,d,g,v,a),void 0,null),jt===null)throw Error(l(349));cs&30||g1(d,a,v)}return v}function g1(o,a,d){o.flags|=16384,o={getSnapshot:a,value:d},a=ft.updateQueue,a===null?(a={lastEffect:null,stores:null},ft.updateQueue=a,a.stores=[o]):(d=a.stores,d===null?a.stores=[o]:d.push(o))}function m1(o,a,d,g){a.value=d,a.getSnapshot=g,v1(a)&&x1(o)}function y1(o,a,d){return d(function(){v1(a)&&x1(o)})}function v1(o){var a=o.getSnapshot;o=o.value;try{var d=a();return!rr(o,d)}catch{return!0}}function x1(o){var a=Cr(o,1);a!==null&&Wn(a,o,1,-1)}function w1(o){var a=Tr();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oa,lastRenderedState:o},a.queue=o,o=o.dispatch=_x.bind(null,ft,o),[a.memoizedState,o]}function aa(o,a,d,g){return o={tag:o,create:a,destroy:d,deps:g,next:null},a=ft.updateQueue,a===null?(a={lastEffect:null,stores:null},ft.updateQueue=a,a.lastEffect=o.next=o):(d=a.lastEffect,d===null?a.lastEffect=o.next=o:(g=d.next,d.next=o,o.next=g,a.lastEffect=o)),o}function S1(){return Vn().memoizedState}function ql(o,a,d,g){var v=Tr();ft.flags|=o,v.memoizedState=aa(1|a,d,void 0,g===void 0?null:g)}function Jl(o,a,d,g){var v=Vn();g=g===void 0?null:g;var P=void 0;if(Et!==null){var R=Et.memoizedState;if(P=R.destroy,g!==null&&Af(g,R.deps)){v.memoizedState=aa(a,d,P,g);return}}ft.flags|=o,v.memoizedState=aa(1|a,d,P,g)}function _1(o,a){return ql(8390656,8,o,a)}function Ff(o,a){return Jl(2048,8,o,a)}function k1(o,a){return Jl(4,2,o,a)}function b1(o,a){return Jl(4,4,o,a)}function C1(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function E1(o,a,d){return d=d!=null?d.concat([o]):null,Jl(4,4,C1.bind(null,a,o),d)}function Of(){}function T1(o,a){var d=Vn();a=a===void 0?null:a;var g=d.memoizedState;return g!==null&&a!==null&&Af(a,g[1])?g[0]:(d.memoizedState=[o,a],o)}function N1(o,a){var d=Vn();a=a===void 0?null:a;var g=d.memoizedState;return g!==null&&a!==null&&Af(a,g[1])?g[0]:(o=o(),d.memoizedState=[o,a],o)}function P1(o,a,d){return cs&21?(rr(d,a)||(d=Kg(),ft.lanes|=d,us|=d,o.baseState=!0),a):(o.baseState&&(o.baseState=!1,mn=!0),o.memoizedState=d)}function wx(o,a){var d=Ve;Ve=d!==0&&4>d?d:4,o(!0);var g=Mf.transition;Mf.transition={};try{o(!1),a()}finally{Ve=d,Mf.transition=g}}function M1(){return Vn().memoizedState}function Sx(o,a,d){var g=_i(o);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},A1(o))I1(a,d);else if(d=l1(o,a,d,g),d!==null){var v=qt();Wn(d,o,g,v),L1(d,a,g)}}function _x(o,a,d){var g=_i(o),v={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(A1(o))I1(a,v);else{var P=o.alternate;if(o.lanes===0&&(P===null||P.lanes===0)&&(P=a.lastRenderedReducer,P!==null))try{var R=a.lastRenderedState,H=P(R,d);if(v.hasEagerState=!0,v.eagerState=H,rr(H,R)){var q=a.interleaved;q===null?(v.next=v,bf(a)):(v.next=q.next,q.next=v),a.interleaved=v;return}}catch{}finally{}d=l1(o,a,v,g),d!==null&&(v=qt(),Wn(d,o,g,v),L1(d,a,g))}}function A1(o){var a=o.alternate;return o===ft||a!==null&&a===ft}function I1(o,a){ia=Zl=!0;var d=o.pending;d===null?a.next=a:(a.next=d.next,d.next=a),o.pending=a}function L1(o,a,d){if(d&4194240){var g=a.lanes;g&=o.pendingLanes,d|=g,a.lanes=d,uf(o,d)}}var ec={readContext:Un,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},kx={readContext:Un,useCallback:function(o,a){return Tr().memoizedState=[o,a===void 0?null:a],o},useContext:Un,useEffect:_1,useImperativeHandle:function(o,a,d){return d=d!=null?d.concat([o]):null,ql(4194308,4,C1.bind(null,a,o),d)},useLayoutEffect:function(o,a){return ql(4194308,4,o,a)},useInsertionEffect:function(o,a){return ql(4,2,o,a)},useMemo:function(o,a){var d=Tr();return a=a===void 0?null:a,o=o(),d.memoizedState=[o,a],o},useReducer:function(o,a,d){var g=Tr();return a=d!==void 0?d(a):a,g.memoizedState=g.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},g.queue=o,o=o.dispatch=Sx.bind(null,ft,o),[g.memoizedState,o]},useRef:function(o){var a=Tr();return o={current:o},a.memoizedState=o},useState:w1,useDebugValue:Of,useDeferredValue:function(o){return Tr().memoizedState=o},useTransition:function(){var o=w1(!1),a=o[0];return o=wx.bind(null,o[1]),Tr().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,d){var g=ft,v=Tr();if(at){if(d===void 0)throw Error(l(407));d=d()}else{if(d=a(),jt===null)throw Error(l(349));cs&30||g1(g,a,d)}v.memoizedState=d;var P={value:d,getSnapshot:a};return v.queue=P,_1(y1.bind(null,g,P,o),[o]),g.flags|=2048,aa(9,m1.bind(null,g,P,d,a),void 0,null),d},useId:function(){var o=Tr(),a=jt.identifierPrefix;if(at){var d=$r,g=Wr;d=(g&~(1<<32-nr(g)-1)).toString(32)+d,a=":"+a+"R"+d,d=sa++,0<d&&(a+="H"+d.toString(32)),a+=":"}else d=xx++,a=":"+a+"r"+d.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},bx={readContext:Un,useCallback:T1,useContext:Un,useEffect:Ff,useImperativeHandle:E1,useInsertionEffect:k1,useLayoutEffect:b1,useMemo:N1,useReducer:Rf,useRef:S1,useState:function(){return Rf(oa)},useDebugValue:Of,useDeferredValue:function(o){var a=Vn();return P1(a,Et.memoizedState,o)},useTransition:function(){var o=Rf(oa)[0],a=Vn().memoizedState;return[o,a]},useMutableSource:h1,useSyncExternalStore:p1,useId:M1,unstable_isNewReconciler:!1},Cx={readContext:Un,useCallback:T1,useContext:Un,useEffect:Ff,useImperativeHandle:E1,useInsertionEffect:k1,useLayoutEffect:b1,useMemo:N1,useReducer:jf,useRef:S1,useState:function(){return jf(oa)},useDebugValue:Of,useDeferredValue:function(o){var a=Vn();return Et===null?a.memoizedState=o:P1(a,Et.memoizedState,o)},useTransition:function(){var o=jf(oa)[0],a=Vn().memoizedState;return[o,a]},useMutableSource:h1,useSyncExternalStore:p1,useId:M1,unstable_isNewReconciler:!1};function sr(o,a){if(o&&o.defaultProps){a=s({},a),o=o.defaultProps;for(var d in o)a[d]===void 0&&(a[d]=o[d]);return a}return a}function Df(o,a,d,g){a=o.memoizedState,d=d(g,a),d=d==null?a:s({},a,d),o.memoizedState=d,o.lanes===0&&(o.updateQueue.baseState=d)}var tc={isMounted:function(o){return(o=o._reactInternals)?L(o)===o:!1},enqueueSetState:function(o,a,d){o=o._reactInternals;var g=qt(),v=_i(o),P=Hr(g,v);P.payload=a,d!=null&&(P.callback=d),a=xi(o,P,v),a!==null&&(Wn(a,o,v,g),Yl(a,o,v))},enqueueReplaceState:function(o,a,d){o=o._reactInternals;var g=qt(),v=_i(o),P=Hr(g,v);P.tag=1,P.payload=a,d!=null&&(P.callback=d),a=xi(o,P,v),a!==null&&(Wn(a,o,v,g),Yl(a,o,v))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var d=qt(),g=_i(o),v=Hr(d,g);v.tag=2,a!=null&&(v.callback=a),a=xi(o,v,g),a!==null&&(Wn(a,o,g,d),Yl(a,o,g))}};function R1(o,a,d,g,v,P,R){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,P,R):a.prototype&&a.prototype.isPureReactComponent?!Vl(d,g)||!Vl(v,P):!0}function j1(o,a,d){var g=!1,v=yi,P=a.contextType;return typeof P=="object"&&P!==null?P=Un(P):(v=gn(a)?ss:Xt.current,g=a.contextTypes,P=(g=g!=null)?Us(o,v):yi),a=new a(d,P),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=tc,o.stateNode=a,a._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=v,o.__reactInternalMemoizedMaskedChildContext=P),a}function F1(o,a,d,g){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(d,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(d,g),a.state!==o&&tc.enqueueReplaceState(a,a.state,null)}function zf(o,a,d,g){var v=o.stateNode;v.props=d,v.state=o.memoizedState,v.refs={},Cf(o);var P=a.contextType;typeof P=="object"&&P!==null?v.context=Un(P):(P=gn(a)?ss:Xt.current,v.context=Us(o,P)),v.state=o.memoizedState,P=a.getDerivedStateFromProps,typeof P=="function"&&(Df(o,a,P,d),v.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(a=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),a!==v.state&&tc.enqueueReplaceState(v,v.state,null),Xl(o,d,v,g),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308)}function Qs(o,a){try{var d="",g=a;do d+=vx(g),g=g.return;while(g);var v=d}catch(P){v=`
Error generating stack: `+P.message+`
`+P.stack}return{value:o,source:a,stack:v,digest:null}}function Bf(o,a,d){return{value:o,source:null,stack:d??null,digest:a??null}}function Uf(o,a){try{console.error(a.value)}catch(d){setTimeout(function(){throw d})}}var Ex=typeof WeakMap=="function"?WeakMap:Map;function O1(o,a,d){d=Hr(-1,d),d.tag=3,d.payload={element:null};var g=a.value;return d.callback=function(){gc||(gc=!0,ah=g),Uf(o,a)},d}function D1(o,a,d){d=Hr(-1,d),d.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var v=a.value;d.payload=function(){return g(v)},d.callback=function(){Uf(o,a)}}var P=o.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(d.callback=function(){Uf(o,a),typeof g!="function"&&(wi===null?wi=new Set([this]):wi.add(this));var R=a.stack;this.componentDidCatch(a.value,{componentStack:R!==null?R:""})}),d}function z1(o,a,d){var g=o.pingCache;if(g===null){g=o.pingCache=new Ex;var v=new Set;g.set(a,v)}else v=g.get(a),v===void 0&&(v=new Set,g.set(a,v));v.has(d)||(v.add(d),o=Bx.bind(null,o,a,d),a.then(o,o))}function B1(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function U1(o,a,d,g,v){return o.mode&1?(o.flags|=65536,o.lanes=v,o):(o===a?o.flags|=65536:(o.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(a=Hr(-1,1),a.tag=2,xi(d,a,1))),d.lanes|=1),o)}var Tx=u.ReactCurrentOwner,mn=!1;function on(o,a,d,g){a.child=o===null?o1(a,null,d,g):$s(a,o.child,d,g)}function G1(o,a,d,g,v){d=d.render;var P=a.ref;return Ys(a,v),g=If(o,a,d,g,P,v),d=Lf(),o!==null&&!mn?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~v,Yr(o,a,v)):(at&&d&&gf(a),a.flags|=1,on(o,a,g,v),a.child)}function V1(o,a,d,g,v){if(o===null){var P=d.type;return typeof P=="function"&&!hh(P)&&P.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(a.tag=15,a.type=P,W1(o,a,P,g,v)):(o=Sc(d.type,null,g,a,a.mode,v),o.ref=a.ref,o.return=a,a.child=o)}if(P=o.child,!(o.lanes&v)){var R=P.memoizedProps;if(d=d.compare,d=d!==null?d:Vl,d(R,g)&&o.ref===a.ref)return Yr(o,a,v)}return a.flags|=1,o=bi(P,g),o.ref=a.ref,o.return=a,a.child=o}function W1(o,a,d,g,v){if(o!==null){var P=o.memoizedProps;if(Vl(P,g)&&o.ref===a.ref)if(mn=!1,a.pendingProps=g=P,(o.lanes&v)!==0)o.flags&131072&&(mn=!0);else return a.lanes=o.lanes,Yr(o,a,v)}return Gf(o,a,d,g,v)}function $1(o,a,d){var g=a.pendingProps,v=g.children,P=o!==null?o.memoizedState:null;if(g.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(qs,Pn),Pn|=d;else{if(!(d&1073741824))return o=P!==null?P.baseLanes|d:d,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,qe(qs,Pn),Pn|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=P!==null?P.baseLanes:d,qe(qs,Pn),Pn|=g}else P!==null?(g=P.baseLanes|d,a.memoizedState=null):g=d,qe(qs,Pn),Pn|=g;return on(o,a,v,d),a.child}function H1(o,a){var d=a.ref;(o===null&&d!==null||o!==null&&o.ref!==d)&&(a.flags|=512,a.flags|=2097152)}function Gf(o,a,d,g,v){var P=gn(d)?ss:Xt.current;return P=Us(a,P),Ys(a,v),d=If(o,a,d,g,P,v),g=Lf(),o!==null&&!mn?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~v,Yr(o,a,v)):(at&&g&&gf(a),a.flags|=1,on(o,a,d,v),a.child)}function Y1(o,a,d,g,v){if(gn(d)){var P=!0;Rl(a)}else P=!1;if(Ys(a,v),a.stateNode===null)rc(o,a),j1(a,d,g),zf(a,d,g,v),g=!0;else if(o===null){var R=a.stateNode,H=a.memoizedProps;R.props=H;var q=R.context,ue=d.contextType;typeof ue=="object"&&ue!==null?ue=Un(ue):(ue=gn(d)?ss:Xt.current,ue=Us(a,ue));var ke=d.getDerivedStateFromProps,Ae=typeof ke=="function"||typeof R.getSnapshotBeforeUpdate=="function";Ae||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(H!==g||q!==ue)&&F1(a,R,g,ue),vi=!1;var me=a.memoizedState;R.state=me,Xl(a,g,R,v),q=a.memoizedState,H!==g||me!==q||pn.current||vi?(typeof ke=="function"&&(Df(a,d,ke,g),q=a.memoizedState),(H=vi||R1(a,d,H,g,me,q,ue))?(Ae||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(a.flags|=4194308)):(typeof R.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=q),R.props=g,R.state=q,R.context=ue,g=H):(typeof R.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{R=a.stateNode,c1(o,a),H=a.memoizedProps,ue=a.type===a.elementType?H:sr(a.type,H),R.props=ue,Ae=a.pendingProps,me=R.context,q=d.contextType,typeof q=="object"&&q!==null?q=Un(q):(q=gn(d)?ss:Xt.current,q=Us(a,q));var nt=d.getDerivedStateFromProps;(ke=typeof nt=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(H!==Ae||me!==q)&&F1(a,R,g,q),vi=!1,me=a.memoizedState,R.state=me,Xl(a,g,R,v);var Qe=a.memoizedState;H!==Ae||me!==Qe||pn.current||vi?(typeof nt=="function"&&(Df(a,d,nt,g),Qe=a.memoizedState),(ue=vi||R1(a,d,ue,g,me,Qe,q)||!1)?(ke||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(g,Qe,q),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(g,Qe,q)),typeof R.componentDidUpdate=="function"&&(a.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof R.componentDidUpdate!="function"||H===o.memoizedProps&&me===o.memoizedState||(a.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||H===o.memoizedProps&&me===o.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=Qe),R.props=g,R.state=Qe,R.context=q,g=ue):(typeof R.componentDidUpdate!="function"||H===o.memoizedProps&&me===o.memoizedState||(a.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||H===o.memoizedProps&&me===o.memoizedState||(a.flags|=1024),g=!1)}return Vf(o,a,d,g,P,v)}function Vf(o,a,d,g,v,P){H1(o,a);var R=(a.flags&128)!==0;if(!g&&!R)return v&&Xg(a,d,!1),Yr(o,a,P);g=a.stateNode,Tx.current=a;var H=R&&typeof d.getDerivedStateFromError!="function"?null:g.render();return a.flags|=1,o!==null&&R?(a.child=$s(a,o.child,null,P),a.child=$s(a,null,H,P)):on(o,a,H,P),a.memoizedState=g.state,v&&Xg(a,d,!0),a.child}function X1(o){var a=o.stateNode;a.pendingContext?Hg(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Hg(o,a.context,!1),Ef(o,a.containerInfo)}function K1(o,a,d,g,v){return Ws(),xf(v),a.flags|=256,on(o,a,d,g),a.child}var Wf={dehydrated:null,treeContext:null,retryLane:0};function $f(o){return{baseLanes:o,cachePool:null,transitions:null}}function Q1(o,a,d){var g=a.pendingProps,v=dt.current,P=!1,R=(a.flags&128)!==0,H;if((H=R)||(H=o!==null&&o.memoizedState===null?!1:(v&2)!==0),H?(P=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(v|=1),qe(dt,v&1),o===null)return vf(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?(a.mode&1?nf(o)?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(R=g.children,o=g.fallback,P?(g=a.mode,P=a.child,R={mode:"hidden",children:R},!(g&1)&&P!==null?(P.childLanes=0,P.pendingProps=R):P=_c(R,g,0,null),o=ps(o,g,d,null),P.return=a,o.return=a,P.sibling=o,a.child=P,a.child.memoizedState=$f(d),a.memoizedState=Wf,o):Hf(a,R));if(v=o.memoizedState,v!==null&&(H=v.dehydrated,H!==null))return Nx(o,a,R,g,H,v,d);if(P){P=g.fallback,R=a.mode,v=o.child,H=v.sibling;var q={mode:"hidden",children:g.children};return!(R&1)&&a.child!==v?(g=a.child,g.childLanes=0,g.pendingProps=q,a.deletions=null):(g=bi(v,q),g.subtreeFlags=v.subtreeFlags&14680064),H!==null?P=bi(H,P):(P=ps(P,R,d,null),P.flags|=2),P.return=a,g.return=a,g.sibling=P,a.child=g,g=P,P=a.child,R=o.child.memoizedState,R=R===null?$f(d):{baseLanes:R.baseLanes|d,cachePool:null,transitions:R.transitions},P.memoizedState=R,P.childLanes=o.childLanes&~d,a.memoizedState=Wf,g}return P=o.child,o=P.sibling,g=bi(P,{mode:"visible",children:g.children}),!(a.mode&1)&&(g.lanes=d),g.return=a,g.sibling=null,o!==null&&(d=a.deletions,d===null?(a.deletions=[o],a.flags|=16):d.push(o)),a.child=g,a.memoizedState=null,g}function Hf(o,a){return a=_c({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function nc(o,a,d,g){return g!==null&&xf(g),$s(a,o.child,null,d),o=Hf(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function Nx(o,a,d,g,v,P,R){if(d)return a.flags&256?(a.flags&=-257,g=Bf(Error(l(422))),nc(o,a,R,g)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(P=g.fallback,v=a.mode,g=_c({mode:"visible",children:g.children},v,0,null),P=ps(P,v,R,null),P.flags|=2,g.return=a,P.return=a,g.sibling=P,a.child=g,a.mode&1&&$s(a,o.child,null,R),a.child.memoizedState=$f(R),a.memoizedState=Wf,P);if(!(a.mode&1))return nc(o,a,R,null);if(nf(v))return g=U5(v).digest,P=Error(l(419)),g=Bf(P,g,void 0),nc(o,a,R,g);if(d=(R&o.childLanes)!==0,mn||d){if(g=jt,g!==null){switch(R&-R){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=v&(g.suspendedLanes|R)?0:v,v!==0&&v!==P.retryLane&&(P.retryLane=v,Cr(o,v),Wn(g,o,v,-1))}return fh(),g=Bf(Error(l(421))),nc(o,a,R,g)}return $g(v)?(a.flags|=128,a.child=o.child,a=Ux.bind(null,o),G5(v,a),null):(o=P.treeContext,he&&(Bn=$5(v),Nn=a,at=!0,ir=null,ea=!1,o!==null&&(Dn[zn++]=Wr,Dn[zn++]=$r,Dn[zn++]=os,Wr=o.id,$r=o.overflow,os=a)),a=Hf(a,g.children),a.flags|=4096,a)}function Z1(o,a,d){o.lanes|=a;var g=o.alternate;g!==null&&(g.lanes|=a),kf(o.return,a,d)}function Yf(o,a,d,g,v){var P=o.memoizedState;P===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:v}:(P.isBackwards=a,P.rendering=null,P.renderingStartTime=0,P.last=g,P.tail=d,P.tailMode=v)}function q1(o,a,d){var g=a.pendingProps,v=g.revealOrder,P=g.tail;if(on(o,a,g.children,d),g=dt.current,g&2)g=g&1|2,a.flags|=128;else{if(o!==null&&o.flags&128)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Z1(o,d,a);else if(o.tag===19)Z1(o,d,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(qe(dt,g),!(a.mode&1))a.memoizedState=null;else switch(v){case"forwards":for(d=a.child,v=null;d!==null;)o=d.alternate,o!==null&&Kl(o)===null&&(v=d),d=d.sibling;d=v,d===null?(v=a.child,a.child=null):(v=d.sibling,d.sibling=null),Yf(a,!1,v,d,P);break;case"backwards":for(d=null,v=a.child,a.child=null;v!==null;){if(o=v.alternate,o!==null&&Kl(o)===null){a.child=v;break}o=v.sibling,v.sibling=d,d=v,v=o}Yf(a,!0,d,null,P);break;case"together":Yf(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function rc(o,a){!(a.mode&1)&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Yr(o,a,d){if(o!==null&&(a.dependencies=o.dependencies),us|=a.lanes,!(d&a.childLanes))return null;if(o!==null&&a.child!==o.child)throw Error(l(153));if(a.child!==null){for(o=a.child,d=bi(o,o.pendingProps),a.child=d,d.return=a;o.sibling!==null;)o=o.sibling,d=d.sibling=bi(o,o.pendingProps),d.return=a;d.sibling=null}return a.child}function Px(o,a,d){switch(a.tag){case 3:X1(a),Ws();break;case 5:f1(a);break;case 1:gn(a.type)&&Rl(a);break;case 4:Ef(a,a.stateNode.containerInfo);break;case 10:a1(a,a.type._context,a.memoizedProps.value);break;case 13:var g=a.memoizedState;if(g!==null)return g.dehydrated!==null?(qe(dt,dt.current&1),a.flags|=128,null):d&a.child.childLanes?Q1(o,a,d):(qe(dt,dt.current&1),o=Yr(o,a,d),o!==null?o.sibling:null);qe(dt,dt.current&1);break;case 19:if(g=(d&a.childLanes)!==0,o.flags&128){if(g)return q1(o,a,d);a.flags|=128}var v=a.memoizedState;if(v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),qe(dt,dt.current),g)break;return null;case 22:case 23:return a.lanes=0,$1(o,a,d)}return Yr(o,a,d)}function Nr(o){o.flags|=4}function J1(o,a){if(o!==null&&o.child===a.child)return!0;if(a.flags&16)return!1;for(o=a.child;o!==null;){if(o.flags&12854||o.subtreeFlags&12854)return!1;o=o.sibling}return!0}var la,ca,ic,sc;if(oe)la=function(o,a){for(var d=a.child;d!==null;){if(d.tag===5||d.tag===6)ne(o,d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===a)break;for(;d.sibling===null;){if(d.return===null||d.return===a)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},ca=function(){},ic=function(o,a,d,g,v){if(o=o.memoizedProps,o!==g){var P=a.stateNode,R=Er(Gn.current);d=te(P,d,o,g,v,R),(a.updateQueue=d)&&Nr(a)}},sc=function(o,a,d,g){d!==g&&Nr(a)};else if(ge){la=function(o,a,d,g){for(var v=a.child;v!==null;){if(v.tag===5){var P=v.stateNode;d&&g&&(P=Vg(P,v.type,v.memoizedProps,v)),ne(o,P)}else if(v.tag===6)P=v.stateNode,d&&g&&(P=Wg(P,v.memoizedProps,v)),ne(o,P);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)P=v.child,P!==null&&(P.return=v),la(o,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===a)break;for(;v.sibling===null;){if(v.return===null||v.return===a)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};var em=function(o,a,d,g){for(var v=a.child;v!==null;){if(v.tag===5){var P=v.stateNode;d&&g&&(P=Vg(P,v.type,v.memoizedProps,v)),_r(o,P)}else if(v.tag===6)P=v.stateNode,d&&g&&(P=Wg(P,v.memoizedProps,v)),_r(o,P);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)P=v.child,P!==null&&(P.return=v),em(o,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===a)break;for(;v.sibling===null;){if(v.return===null||v.return===a)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};ca=function(o,a){var d=a.stateNode;if(!J1(o,a)){o=d.containerInfo;var g=is(o);em(g,a,!1,!1),d.pendingChildren=g,Nr(a),Tn(o,g)}},ic=function(o,a,d,g,v){var P=o.stateNode,R=o.memoizedProps;if((o=J1(o,a))&&R===g)a.stateNode=P;else{var H=a.stateNode,q=Er(Gn.current),ue=null;R!==g&&(ue=te(H,d,R,g,v,q)),o&&ue===null?a.stateNode=P:(P=Sr(P,ue,d,R,g,a,o,H),Z(P,d,g,v,q)&&Nr(a),a.stateNode=P,o?Nr(a):la(P,a,!1,!1))}},sc=function(o,a,d,g){d!==g?(o=Er(Xs.current),d=Er(Gn.current),a.stateNode=fe(g,o,d,a),Nr(a)):a.stateNode=o.stateNode}}else ca=function(){},ic=function(){},sc=function(){};function ua(o,a){if(!at)switch(o.tailMode){case"hidden":a=o.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?o.tail=null:d.sibling=null;break;case"collapsed":d=o.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Qt(o){var a=o.alternate!==null&&o.alternate.child===o.child,d=0,g=0;if(a)for(var v=o.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags&14680064,g|=v.flags&14680064,v.return=o,v=v.sibling;else for(v=o.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags,g|=v.flags,v.return=o,v=v.sibling;return o.subtreeFlags|=g,o.childLanes=d,a}function Mx(o,a,d){var g=a.pendingProps;switch(mf(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(a),null;case 1:return gn(a.type)&&Ll(),Qt(a),null;case 3:return d=a.stateNode,Ks(),tt(pn),tt(Xt),Pf(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(o===null||o.child===null)&&(Gl(a)?Nr(a):o===null||o.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,ir!==null&&(uh(ir),ir=null))),ca(o,a),Qt(a),null;case 5:Tf(a),d=Er(Xs.current);var v=a.type;if(o!==null&&a.stateNode!=null)ic(o,a,v,g,d),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!g){if(a.stateNode===null)throw Error(l(166));return Qt(a),null}if(o=Er(Gn.current),Gl(a)){if(!he)throw Error(l(175));o=H5(a.stateNode,a.type,a.memoizedProps,d,o,a,!ea),a.updateQueue=o,o!==null&&Nr(a)}else{var P=ee(v,g,d,o,a);la(P,a,!1,!1),a.stateNode=P,Z(P,v,g,d,o)&&Nr(a)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Qt(a),null;case 6:if(o&&a.stateNode!=null)sc(o,a,o.memoizedProps,g);else{if(typeof g!="string"&&a.stateNode===null)throw Error(l(166));if(o=Er(Xs.current),d=Er(Gn.current),Gl(a)){if(!he)throw Error(l(176));if(o=a.stateNode,d=a.memoizedProps,(g=Y5(o,d,a,!ea))&&(v=Nn,v!==null))switch(v.tag){case 3:tx(v.stateNode.containerInfo,o,d,(v.mode&1)!==0);break;case 5:nx(v.type,v.memoizedProps,v.stateNode,o,d,(v.mode&1)!==0)}g&&Nr(a)}else a.stateNode=fe(g,o,d,a)}return Qt(a),null;case 13:if(tt(dt),g=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(at&&Bn!==null&&a.mode&1&&!(a.flags&128))r1(),Ws(),a.flags|=98560,v=!1;else if(v=Gl(a),g!==null&&g.dehydrated!==null){if(o===null){if(!v)throw Error(l(318));if(!he)throw Error(l(344));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(l(317));X5(v,a)}else Ws(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Qt(a),v=!1}else ir!==null&&(uh(ir),ir=null),v=!0;if(!v)return a.flags&65536?a:null}return a.flags&128?(a.lanes=d,a):(d=g!==null,d!==(o!==null&&o.memoizedState!==null)&&d&&(a.child.flags|=8192,a.mode&1&&(o===null||dt.current&1?Tt===0&&(Tt=3):fh())),a.updateQueue!==null&&(a.flags|=4),Qt(a),null);case 4:return Ks(),ca(o,a),o===null&&le(a.stateNode.containerInfo),Qt(a),null;case 10:return _f(a.type._context),Qt(a),null;case 17:return gn(a.type)&&Ll(),Qt(a),null;case 19:if(tt(dt),v=a.memoizedState,v===null)return Qt(a),null;if(g=(a.flags&128)!==0,P=v.rendering,P===null)if(g)ua(v,!1);else{if(Tt!==0||o!==null&&o.flags&128)for(o=a.child;o!==null;){if(P=Kl(o),P!==null){for(a.flags|=128,ua(v,!1),o=P.updateQueue,o!==null&&(a.updateQueue=o,a.flags|=4),a.subtreeFlags=0,o=d,d=a.child;d!==null;)g=d,v=o,g.flags&=14680066,P=g.alternate,P===null?(g.childLanes=0,g.lanes=v,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=P.childLanes,g.lanes=P.lanes,g.child=P.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=P.memoizedProps,g.memoizedState=P.memoizedState,g.updateQueue=P.updateQueue,g.type=P.type,v=P.dependencies,g.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext}),d=d.sibling;return qe(dt,dt.current&1|2),a.child}o=o.sibling}v.tail!==null&&Lt()>oh&&(a.flags|=128,g=!0,ua(v,!1),a.lanes=4194304)}else{if(!g)if(o=Kl(P),o!==null){if(a.flags|=128,g=!0,o=o.updateQueue,o!==null&&(a.updateQueue=o,a.flags|=4),ua(v,!0),v.tail===null&&v.tailMode==="hidden"&&!P.alternate&&!at)return Qt(a),null}else 2*Lt()-v.renderingStartTime>oh&&d!==1073741824&&(a.flags|=128,g=!0,ua(v,!1),a.lanes=4194304);v.isBackwards?(P.sibling=a.child,a.child=P):(o=v.last,o!==null?o.sibling=P:a.child=P,v.last=P)}return v.tail!==null?(a=v.tail,v.rendering=a,v.tail=a.sibling,v.renderingStartTime=Lt(),a.sibling=null,o=dt.current,qe(dt,g?o&1|2:o&1),a):(Qt(a),null);case 22:case 23:return dh(),d=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==d&&(a.flags|=8192),d&&a.mode&1?Pn&1073741824&&(Qt(a),oe&&a.subtreeFlags&6&&(a.flags|=8192)):Qt(a),null;case 24:return null;case 25:return null}throw Error(l(156,a.tag))}function Ax(o,a){switch(mf(a),a.tag){case 1:return gn(a.type)&&Ll(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return Ks(),tt(pn),tt(Xt),Pf(),o=a.flags,o&65536&&!(o&128)?(a.flags=o&-65537|128,a):null;case 5:return Tf(a),null;case 13:if(tt(dt),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(l(340));Ws()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return tt(dt),null;case 4:return Ks(),null;case 10:return _f(a.type._context),null;case 22:case 23:return dh(),null;case 24:return null;default:return null}}var oc=!1,Zt=!1,Ix=typeof WeakSet=="function"?WeakSet:Set,we=null;function Zs(o,a){var d=o.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){lt(o,a,g)}else d.current=null}function Xf(o,a,d){try{d()}catch(g){lt(o,a,g)}}var tm=!1;function Lx(o,a){for($(o.containerInfo),we=a;we!==null;)if(o=we,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,we=a;else for(;we!==null;){o=we;try{var d=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(d!==null){var g=d.memoizedProps,v=d.memoizedState,P=o.stateNode,R=P.getSnapshotBeforeUpdate(o.elementType===o.type?g:sr(o.type,g),v);P.__reactInternalSnapshotBeforeUpdate=R}break;case 3:oe&&gi(o.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch(H){lt(o,o.return,H)}if(a=o.sibling,a!==null){a.return=o.return,we=a;break}we=o.return}return d=tm,tm=!1,d}function da(o,a,d){var g=a.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&o)===o){var P=v.destroy;v.destroy=void 0,P!==void 0&&Xf(a,d,P)}v=v.next}while(v!==g)}}function ac(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var d=a=a.next;do{if((d.tag&o)===o){var g=d.create;d.destroy=g()}d=d.next}while(d!==a)}}function Kf(o){var a=o.ref;if(a!==null){var d=o.stateNode;switch(o.tag){case 5:o=z(d);break;default:o=d}typeof a=="function"?a(o):a.current=o}}function nm(o){var a=o.alternate;a!==null&&(o.alternate=null,nm(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&je(a)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function rm(o){return o.tag===5||o.tag===3||o.tag===4}function im(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||rm(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Qf(o,a,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?ce(d,o,a):yt(d,o);else if(g!==4&&(o=o.child,o!==null))for(Qf(o,a,d),o=o.sibling;o!==null;)Qf(o,a,d),o=o.sibling}function Zf(o,a,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?ie(d,o,a):Ur(d,o);else if(g!==4&&(o=o.child,o!==null))for(Zf(o,a,d),o=o.sibling;o!==null;)Zf(o,a,d),o=o.sibling}var zt=null,or=!1;function Pr(o,a,d){for(d=d.child;d!==null;)qf(o,a,d),d=d.sibling}function qf(o,a,d){if(kr&&typeof kr.onCommitFiberUnmount=="function")try{kr.onCommitFiberUnmount(Dl,d)}catch{}switch(d.tag){case 5:Zt||Zs(d,a);case 6:if(oe){var g=zt,v=or;zt=null,Pr(o,a,d),zt=g,or=v,zt!==null&&(or?Ce(zt,d.stateNode):pe(zt,d.stateNode))}else Pr(o,a,d);break;case 18:oe&&zt!==null&&(or?J5(zt,d.stateNode):q5(zt,d.stateNode));break;case 4:oe?(g=zt,v=or,zt=d.stateNode.containerInfo,or=!0,Pr(o,a,d),zt=g,or=v):(ge&&(g=d.stateNode.containerInfo,v=is(g),Qo(g,v)),Pr(o,a,d));break;case 0:case 11:case 14:case 15:if(!Zt&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){v=g=g.next;do{var P=v,R=P.destroy;P=P.tag,R!==void 0&&(P&2||P&4)&&Xf(d,a,R),v=v.next}while(v!==g)}Pr(o,a,d);break;case 1:if(!Zt&&(Zs(d,a),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(H){lt(d,a,H)}Pr(o,a,d);break;case 21:Pr(o,a,d);break;case 22:d.mode&1?(Zt=(g=Zt)||d.memoizedState!==null,Pr(o,a,d),Zt=g):Pr(o,a,d);break;default:Pr(o,a,d)}}function sm(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var d=o.stateNode;d===null&&(d=o.stateNode=new Ix),a.forEach(function(g){var v=Gx.bind(null,o,g);d.has(g)||(d.add(g),g.then(v,v))})}}function ar(o,a){var d=a.deletions;if(d!==null)for(var g=0;g<d.length;g++){var v=d[g];try{var P=o,R=a;if(oe){var H=R;e:for(;H!==null;){switch(H.tag){case 5:zt=H.stateNode,or=!1;break e;case 3:zt=H.stateNode.containerInfo,or=!0;break e;case 4:zt=H.stateNode.containerInfo,or=!0;break e}H=H.return}if(zt===null)throw Error(l(160));qf(P,R,v),zt=null,or=!1}else qf(P,R,v);var q=v.alternate;q!==null&&(q.return=null),v.return=null}catch(ue){lt(v,a,ue)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)om(a,o),a=a.sibling}function om(o,a){var d=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(ar(a,o),Mr(o),g&4){try{da(3,o,o.return),ac(3,o)}catch(me){lt(o,o.return,me)}try{da(5,o,o.return)}catch(me){lt(o,o.return,me)}}break;case 1:ar(a,o),Mr(o),g&512&&d!==null&&Zs(d,d.return);break;case 5:if(ar(a,o),Mr(o),g&512&&d!==null&&Zs(d,d.return),oe){if(o.flags&32){var v=o.stateNode;try{Ee(v)}catch(me){lt(o,o.return,me)}}if(g&4&&(v=o.stateNode,v!=null)){var P=o.memoizedProps;if(d=d!==null?d.memoizedProps:P,g=o.type,a=o.updateQueue,o.updateQueue=null,a!==null)try{Pe(v,a,g,d,P,o)}catch(me){lt(o,o.return,me)}}}break;case 6:if(ar(a,o),Mr(o),g&4&&oe){if(o.stateNode===null)throw Error(l(162));v=o.stateNode,P=o.memoizedProps,d=d!==null?d.memoizedProps:P;try{dn(v,d,P)}catch(me){lt(o,o.return,me)}}break;case 3:if(ar(a,o),Mr(o),g&4){if(oe&&he&&d!==null&&d.memoizedState.isDehydrated)try{Q5(a.containerInfo)}catch(me){lt(o,o.return,me)}if(ge){v=a.containerInfo,P=a.pendingChildren;try{Qo(v,P)}catch(me){lt(o,o.return,me)}}}break;case 4:if(ar(a,o),Mr(o),g&4&&ge){P=o.stateNode,v=P.containerInfo,P=P.pendingChildren;try{Qo(v,P)}catch(me){lt(o,o.return,me)}}break;case 13:ar(a,o),Mr(o),v=o.child,v.flags&8192&&(P=v.memoizedState!==null,v.stateNode.isHidden=P,!P||v.alternate!==null&&v.alternate.memoizedState!==null||(sh=Lt())),g&4&&sm(o);break;case 22:var R=d!==null&&d.memoizedState!==null;if(o.mode&1?(Zt=(d=Zt)||R,ar(a,o),Zt=d):ar(a,o),Mr(o),g&8192){if(d=o.memoizedState!==null,(o.stateNode.isHidden=d)&&!R&&o.mode&1)for(we=o,g=o.child;g!==null;){for(a=we=g;we!==null;){R=we;var H=R.child;switch(R.tag){case 0:case 11:case 14:case 15:da(4,R,R.return);break;case 1:Zs(R,R.return);var q=R.stateNode;if(typeof q.componentWillUnmount=="function"){var ue=R,ke=R.return;try{var Ae=ue;q.props=Ae.memoizedProps,q.state=Ae.memoizedState,q.componentWillUnmount()}catch(me){lt(ue,ke,me)}}break;case 5:Zs(R,R.return);break;case 22:if(R.memoizedState!==null){cm(a);continue}}H!==null?(H.return=R,we=H):cm(a)}g=g.sibling}if(oe){e:if(g=null,oe)for(a=o;;){if(a.tag===5){if(g===null){g=a;try{v=a.stateNode,d?xe(v):fn(a.stateNode,a.memoizedProps)}catch(me){lt(o,o.return,me)}}}else if(a.tag===6){if(g===null)try{P=a.stateNode,d?et(P):hn(P,a.memoizedProps)}catch(me){lt(o,o.return,me)}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===o)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;g===a&&(g=null),a=a.return}g===a&&(g=null),a.sibling.return=a.return,a=a.sibling}}}break;case 19:ar(a,o),Mr(o),g&4&&sm(o);break;case 21:break;default:ar(a,o),Mr(o)}}function Mr(o){var a=o.flags;if(a&2){try{if(oe){e:{for(var d=o.return;d!==null;){if(rm(d)){var g=d;break e}d=d.return}throw Error(l(160))}switch(g.tag){case 5:var v=g.stateNode;g.flags&32&&(Ee(v),g.flags&=-33);var P=im(o);Zf(o,P,v);break;case 3:case 4:var R=g.stateNode.containerInfo,H=im(o);Qf(o,H,R);break;default:throw Error(l(161))}}}catch(q){lt(o,o.return,q)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function Rx(o,a,d){we=o,am(o)}function am(o,a,d){for(var g=(o.mode&1)!==0;we!==null;){var v=we,P=v.child;if(v.tag===22&&g){var R=v.memoizedState!==null||oc;if(!R){var H=v.alternate,q=H!==null&&H.memoizedState!==null||Zt;H=oc;var ue=Zt;if(oc=R,(Zt=q)&&!ue)for(we=v;we!==null;)R=we,q=R.child,R.tag===22&&R.memoizedState!==null?um(v):q!==null?(q.return=R,we=q):um(v);for(;P!==null;)we=P,am(P),P=P.sibling;we=v,oc=H,Zt=ue}lm(o)}else v.subtreeFlags&8772&&P!==null?(P.return=v,we=P):lm(o)}}function lm(o){for(;we!==null;){var a=we;if(a.flags&8772){var d=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:Zt||ac(5,a);break;case 1:var g=a.stateNode;if(a.flags&4&&!Zt)if(d===null)g.componentDidMount();else{var v=a.elementType===a.type?d.memoizedProps:sr(a.type,d.memoizedProps);g.componentDidUpdate(v,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var P=a.updateQueue;P!==null&&d1(a,P,g);break;case 3:var R=a.updateQueue;if(R!==null){if(d=null,a.child!==null)switch(a.child.tag){case 5:d=z(a.child.stateNode);break;case 1:d=a.child.stateNode}d1(a,R,d)}break;case 5:var H=a.stateNode;d===null&&a.flags&4&&Gr(H,a.type,a.memoizedProps,a);break;case 6:break;case 4:break;case 12:break;case 13:if(he&&a.memoizedState===null){var q=a.alternate;if(q!==null){var ue=q.memoizedState;if(ue!==null){var ke=ue.dehydrated;ke!==null&&Z5(ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(l(163))}Zt||a.flags&512&&Kf(a)}catch(Ae){lt(a,a.return,Ae)}}if(a===o){we=null;break}if(d=a.sibling,d!==null){d.return=a.return,we=d;break}we=a.return}}function cm(o){for(;we!==null;){var a=we;if(a===o){we=null;break}var d=a.sibling;if(d!==null){d.return=a.return,we=d;break}we=a.return}}function um(o){for(;we!==null;){var a=we;try{switch(a.tag){case 0:case 11:case 15:var d=a.return;try{ac(4,a)}catch(q){lt(a,d,q)}break;case 1:var g=a.stateNode;if(typeof g.componentDidMount=="function"){var v=a.return;try{g.componentDidMount()}catch(q){lt(a,v,q)}}var P=a.return;try{Kf(a)}catch(q){lt(a,P,q)}break;case 5:var R=a.return;try{Kf(a)}catch(q){lt(a,R,q)}}}catch(q){lt(a,a.return,q)}if(a===o){we=null;break}var H=a.sibling;if(H!==null){H.return=a.return,we=H;break}we=a.return}}var lc=0,cc=1,uc=2,dc=3,fc=4;if(typeof Symbol=="function"&&Symbol.for){var fa=Symbol.for;lc=fa("selector.component"),cc=fa("selector.has_pseudo_class"),uc=fa("selector.role"),dc=fa("selector.test_id"),fc=fa("selector.text")}function Jf(o){var a=be(o);if(a!=null){if(typeof a.memoizedProps["data-testname"]!="string")throw Error(l(364));return a}if(o=st(o),o===null)throw Error(l(362));return o.stateNode.current}function eh(o,a){switch(a.$$typeof){case lc:if(o.type===a.value)return!0;break;case cc:e:{a=a.value,o=[o,0];for(var d=0;d<o.length;){var g=o[d++],v=o[d++],P=a[v];if(g.tag!==5||!ot(g)){for(;P!=null&&eh(g,P);)v++,P=a[v];if(v===a.length){a=!0;break e}else for(g=g.child;g!==null;)o.push(g,v),g=g.sibling}}a=!1}return a;case uc:if(o.tag===5&&wr(o.stateNode,a.value))return!0;break;case fc:if((o.tag===5||o.tag===6)&&(o=On(o),o!==null&&0<=o.indexOf(a.value)))return!0;break;case dc:if(o.tag===5&&(o=o.memoizedProps["data-testname"],typeof o=="string"&&o.toLowerCase()===a.value.toLowerCase()))return!0;break;default:throw Error(l(365))}return!1}function th(o){switch(o.$$typeof){case lc:return"<"+(I(o.value)||"Unknown")+">";case cc:return":has("+(th(o)||"")+")";case uc:return'[role="'+o.value+'"]';case fc:return'"'+o.value+'"';case dc:return'[data-testname="'+o.value+'"]';default:throw Error(l(365))}}function dm(o,a){var d=[];o=[o,0];for(var g=0;g<o.length;){var v=o[g++],P=o[g++],R=a[P];if(v.tag!==5||!ot(v)){for(;R!=null&&eh(v,R);)P++,R=a[P];if(P===a.length)d.push(v);else for(v=v.child;v!==null;)o.push(v,P),v=v.sibling}}return d}function nh(o,a){if(!Yt)throw Error(l(363));o=Jf(o),o=dm(o,a),a=[],o=Array.from(o);for(var d=0;d<o.length;){var g=o[d++];if(g.tag===5)ot(g)||a.push(g.stateNode);else for(g=g.child;g!==null;)o.push(g),g=g.sibling}return a}var jx=Math.ceil,hc=u.ReactCurrentDispatcher,rh=u.ReactCurrentOwner,St=u.ReactCurrentBatchConfig,Fe=0,jt=null,bt=null,Bt=0,Pn=0,qs=mi(0),Tt=0,ha=null,us=0,pc=0,ih=0,pa=null,yn=null,sh=0,oh=1/0,Xr=null;function Js(){oh=Lt()+500}var gc=!1,ah=null,wi=null,mc=!1,Si=null,yc=0,ga=0,lh=null,vc=-1,xc=0;function qt(){return Fe&6?Lt():vc!==-1?vc:vc=Lt()}function _i(o){return o.mode&1?Fe&2&&Bt!==0?Bt&-Bt:yx.transition!==null?(xc===0&&(xc=Kg()),xc):(o=Ve,o!==0?o:ve()):1}function Wn(o,a,d,g){if(50<ga)throw ga=0,lh=null,Error(l(185));Jo(o,d,g),(!(Fe&2)||o!==jt)&&(o===jt&&(!(Fe&2)&&(pc|=d),Tt===4&&ki(o,Bt)),vn(o,g),d===1&&Fe===0&&!(a.mode&1)&&(Js(),zl&&br()))}function vn(o,a){var d=o.callbackNode;lx(o,a);var g=Ol(o,o===jt?Bt:0);if(g===0)d!==null&&Zg(d),o.callbackNode=null,o.callbackPriority=0;else if(a=g&-g,o.callbackPriority!==a){if(d!=null&&Zg(d),a===1)o.tag===0?mx(hm.bind(null,o)):qg(hm.bind(null,o)),ze?Xe(function(){!(Fe&6)&&br()}):df(ff,br),d=null;else{switch(Qg(g)){case 1:d=ff;break;case 4:d=fx;break;case 16:d=hf;break;case 536870912:d=hx;break;default:d=hf}d=_m(d,fm.bind(null,o))}o.callbackPriority=a,o.callbackNode=d}}function fm(o,a){if(vc=-1,xc=0,Fe&6)throw Error(l(327));var d=o.callbackNode;if(hs()&&o.callbackNode!==d)return null;var g=Ol(o,o===jt?Bt:0);if(g===0)return null;if(g&30||g&o.expiredLanes||a)a=wc(o,g);else{a=g;var v=Fe;Fe|=2;var P=mm();(jt!==o||Bt!==a)&&(Xr=null,Js(),ds(o,a));do try{Dx();break}catch(H){gm(o,H)}while(1);Sf(),hc.current=P,Fe=v,bt!==null?a=0:(jt=null,Bt=0,a=Tt)}if(a!==0){if(a===2&&(v=lf(o),v!==0&&(g=v,a=ch(o,v))),a===1)throw d=ha,ds(o,0),ki(o,g),vn(o,Lt()),d;if(a===6)ki(o,g);else{if(v=o.current.alternate,!(g&30)&&!Fx(v)&&(a=wc(o,g),a===2&&(P=lf(o),P!==0&&(g=P,a=ch(o,P))),a===1))throw d=ha,ds(o,0),ki(o,g),vn(o,Lt()),d;switch(o.finishedWork=v,o.finishedLanes=g,a){case 0:case 1:throw Error(l(345));case 2:fs(o,yn,Xr);break;case 3:if(ki(o,g),(g&130023424)===g&&(a=sh+500-Lt(),10<a)){if(Ol(o,0)!==0)break;if(v=o.suspendedLanes,(v&g)!==g){qt(),o.pingedLanes|=o.suspendedLanes&v;break}o.timeoutHandle=V(fs.bind(null,o,yn,Xr),a);break}fs(o,yn,Xr);break;case 4:if(ki(o,g),(g&4194240)===g)break;for(a=o.eventTimes,v=-1;0<g;){var R=31-nr(g);P=1<<R,R=a[R],R>v&&(v=R),g&=~P}if(g=v,g=Lt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*jx(g/1960))-g,10<g){o.timeoutHandle=V(fs.bind(null,o,yn,Xr),g);break}fs(o,yn,Xr);break;case 5:fs(o,yn,Xr);break;default:throw Error(l(329))}}}return vn(o,Lt()),o.callbackNode===d?fm.bind(null,o):null}function ch(o,a){var d=pa;return o.current.memoizedState.isDehydrated&&(ds(o,a).flags|=256),o=wc(o,a),o!==2&&(a=yn,yn=d,a!==null&&uh(a)),o}function uh(o){yn===null?yn=o:yn.push.apply(yn,o)}function Fx(o){for(var a=o;;){if(a.flags&16384){var d=a.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var v=d[g],P=v.getSnapshot;v=v.value;try{if(!rr(P(),v))return!1}catch{return!1}}}if(d=a.child,a.subtreeFlags&16384&&d!==null)d.return=a,a=d;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ki(o,a){for(a&=~ih,a&=~pc,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var d=31-nr(a),g=1<<d;o[d]=-1,a&=~g}}function hm(o){if(Fe&6)throw Error(l(327));hs();var a=Ol(o,0);if(!(a&1))return vn(o,Lt()),null;var d=wc(o,a);if(o.tag!==0&&d===2){var g=lf(o);g!==0&&(a=g,d=ch(o,g))}if(d===1)throw d=ha,ds(o,0),ki(o,a),vn(o,Lt()),d;if(d===6)throw Error(l(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,fs(o,yn,Xr),vn(o,Lt()),null}function pm(o){Si!==null&&Si.tag===0&&!(Fe&6)&&hs();var a=Fe;Fe|=1;var d=St.transition,g=Ve;try{if(St.transition=null,Ve=1,o)return o()}finally{Ve=g,St.transition=d,Fe=a,!(Fe&6)&&br()}}function dh(){Pn=qs.current,tt(qs)}function ds(o,a){o.finishedWork=null,o.finishedLanes=0;var d=o.timeoutHandle;if(d!==se&&(o.timeoutHandle=se,K(d)),bt!==null)for(d=bt.return;d!==null;){var g=d;switch(mf(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Ll();break;case 3:Ks(),tt(pn),tt(Xt),Pf();break;case 5:Tf(g);break;case 4:Ks();break;case 13:tt(dt);break;case 19:tt(dt);break;case 10:_f(g.type._context);break;case 22:case 23:dh()}d=d.return}if(jt=o,bt=o=bi(o.current,null),Bt=Pn=a,Tt=0,ha=null,ih=pc=us=0,yn=pa=null,ls!==null){for(a=0;a<ls.length;a++)if(d=ls[a],g=d.interleaved,g!==null){d.interleaved=null;var v=g.next,P=d.pending;if(P!==null){var R=P.next;P.next=v,g.next=R}d.pending=g}ls=null}return o}function gm(o,a){do{var d=bt;try{if(Sf(),Ql.current=ec,Zl){for(var g=ft.memoizedState;g!==null;){var v=g.queue;v!==null&&(v.pending=null),g=g.next}Zl=!1}if(cs=0,Rt=Et=ft=null,ia=!1,sa=0,rh.current=null,d===null||d.return===null){Tt=1,ha=a,bt=null;break}e:{var P=o,R=d.return,H=d,q=a;if(a=Bt,H.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var ue=q,ke=H,Ae=ke.tag;if(!(ke.mode&1)&&(Ae===0||Ae===11||Ae===15)){var me=ke.alternate;me?(ke.updateQueue=me.updateQueue,ke.memoizedState=me.memoizedState,ke.lanes=me.lanes):(ke.updateQueue=null,ke.memoizedState=null)}var nt=B1(R);if(nt!==null){nt.flags&=-257,U1(nt,R,H,P,a),nt.mode&1&&z1(P,ue,a),a=nt,q=ue;var Qe=a.updateQueue;if(Qe===null){var xn=new Set;xn.add(q),a.updateQueue=xn}else Qe.add(q);break e}else{if(!(a&1)){z1(P,ue,a),fh();break e}q=Error(l(426))}}else if(at&&H.mode&1){var Kr=B1(R);if(Kr!==null){!(Kr.flags&65536)&&(Kr.flags|=256),U1(Kr,R,H,P,a),xf(Qs(q,H));break e}}P=q=Qs(q,H),Tt!==4&&(Tt=2),pa===null?pa=[P]:pa.push(P),P=R;do{switch(P.tag){case 3:P.flags|=65536,a&=-a,P.lanes|=a;var Q=O1(P,q,a);u1(P,Q);break e;case 1:H=q;var Y=P.type,J=P.stateNode;if(!(P.flags&128)&&(typeof Y.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(wi===null||!wi.has(J)))){P.flags|=65536,a&=-a,P.lanes|=a;var ye=D1(P,H,a);u1(P,ye);break e}}P=P.return}while(P!==null)}vm(d)}catch(Te){a=Te,bt===d&&d!==null&&(bt=d=d.return);continue}break}while(1)}function mm(){var o=hc.current;return hc.current=ec,o===null?ec:o}function fh(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),jt===null||!(us&268435455)&&!(pc&268435455)||ki(jt,Bt)}function wc(o,a){var d=Fe;Fe|=2;var g=mm();(jt!==o||Bt!==a)&&(Xr=null,ds(o,a));do try{Ox();break}catch(v){gm(o,v)}while(1);if(Sf(),Fe=d,hc.current=g,bt!==null)throw Error(l(261));return jt=null,Bt=0,Tt}function Ox(){for(;bt!==null;)ym(bt)}function Dx(){for(;bt!==null&&!ux();)ym(bt)}function ym(o){var a=Sm(o.alternate,o,Pn);o.memoizedProps=o.pendingProps,a===null?vm(o):bt=a,rh.current=null}function vm(o){var a=o;do{var d=a.alternate;if(o=a.return,a.flags&32768){if(d=Ax(d,a),d!==null){d.flags&=32767,bt=d;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Tt=6,bt=null;return}}else if(d=Mx(d,a,Pn),d!==null){bt=d;return}if(a=a.sibling,a!==null){bt=a;return}bt=a=o}while(a!==null);Tt===0&&(Tt=5)}function fs(o,a,d){var g=Ve,v=St.transition;try{St.transition=null,Ve=1,zx(o,a,d,g)}finally{St.transition=v,Ve=g}return null}function zx(o,a,d,g){do hs();while(Si!==null);if(Fe&6)throw Error(l(327));d=o.finishedWork;var v=o.finishedLanes;if(d===null)return null;if(o.finishedWork=null,o.finishedLanes=0,d===o.current)throw Error(l(177));o.callbackNode=null,o.callbackPriority=0;var P=d.lanes|d.childLanes;if(cx(o,P),o===jt&&(bt=jt=null,Bt=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||mc||(mc=!0,_m(hf,function(){return hs(),null})),P=(d.flags&15990)!==0,d.subtreeFlags&15990||P){P=St.transition,St.transition=null;var R=Ve;Ve=1;var H=Fe;Fe|=4,rh.current=null,Lx(o,d),om(d,o),X(o.containerInfo),o.current=d,Rx(d),dx(),Fe=H,Ve=R,St.transition=P}else o.current=d;if(mc&&(mc=!1,Si=o,yc=v),P=o.pendingLanes,P===0&&(wi=null),px(d.stateNode),vn(o,Lt()),a!==null)for(g=o.onRecoverableError,d=0;d<a.length;d++)v=a[d],g(v.value,{componentStack:v.stack,digest:v.digest});if(gc)throw gc=!1,o=ah,ah=null,o;return yc&1&&o.tag!==0&&hs(),P=o.pendingLanes,P&1?o===lh?ga++:(ga=0,lh=o):ga=0,br(),null}function hs(){if(Si!==null){var o=Qg(yc),a=St.transition,d=Ve;try{if(St.transition=null,Ve=16>o?16:o,Si===null)var g=!1;else{if(o=Si,Si=null,yc=0,Fe&6)throw Error(l(331));var v=Fe;for(Fe|=4,we=o.current;we!==null;){var P=we,R=P.child;if(we.flags&16){var H=P.deletions;if(H!==null){for(var q=0;q<H.length;q++){var ue=H[q];for(we=ue;we!==null;){var ke=we;switch(ke.tag){case 0:case 11:case 15:da(8,ke,P)}var Ae=ke.child;if(Ae!==null)Ae.return=ke,we=Ae;else for(;we!==null;){ke=we;var me=ke.sibling,nt=ke.return;if(nm(ke),ke===ue){we=null;break}if(me!==null){me.return=nt,we=me;break}we=nt}}}var Qe=P.alternate;if(Qe!==null){var xn=Qe.child;if(xn!==null){Qe.child=null;do{var Kr=xn.sibling;xn.sibling=null,xn=Kr}while(xn!==null)}}we=P}}if(P.subtreeFlags&2064&&R!==null)R.return=P,we=R;else e:for(;we!==null;){if(P=we,P.flags&2048)switch(P.tag){case 0:case 11:case 15:da(9,P,P.return)}var Q=P.sibling;if(Q!==null){Q.return=P.return,we=Q;break e}we=P.return}}var Y=o.current;for(we=Y;we!==null;){R=we;var J=R.child;if(R.subtreeFlags&2064&&J!==null)J.return=R,we=J;else e:for(R=Y;we!==null;){if(H=we,H.flags&2048)try{switch(H.tag){case 0:case 11:case 15:ac(9,H)}}catch(Te){lt(H,H.return,Te)}if(H===R){we=null;break e}var ye=H.sibling;if(ye!==null){ye.return=H.return,we=ye;break e}we=H.return}}if(Fe=v,br(),kr&&typeof kr.onPostCommitFiberRoot=="function")try{kr.onPostCommitFiberRoot(Dl,o)}catch{}g=!0}return g}finally{Ve=d,St.transition=a}}return!1}function xm(o,a,d){a=Qs(d,a),a=O1(o,a,1),o=xi(o,a,1),a=qt(),o!==null&&(Jo(o,1,a),vn(o,a))}function lt(o,a,d){if(o.tag===3)xm(o,o,d);else for(;a!==null;){if(a.tag===3){xm(a,o,d);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(wi===null||!wi.has(g))){o=Qs(d,o),o=D1(a,o,1),a=xi(a,o,1),o=qt(),a!==null&&(Jo(a,1,o),vn(a,o));break}}a=a.return}}function Bx(o,a,d){var g=o.pingCache;g!==null&&g.delete(a),a=qt(),o.pingedLanes|=o.suspendedLanes&d,jt===o&&(Bt&d)===d&&(Tt===4||Tt===3&&(Bt&130023424)===Bt&&500>Lt()-sh?ds(o,0):ih|=d),vn(o,a)}function wm(o,a){a===0&&(o.mode&1?(a=Fl,Fl<<=1,!(Fl&130023424)&&(Fl=4194304)):a=1);var d=qt();o=Cr(o,a),o!==null&&(Jo(o,a,d),vn(o,d))}function Ux(o){var a=o.memoizedState,d=0;a!==null&&(d=a.retryLane),wm(o,d)}function Gx(o,a){var d=0;switch(o.tag){case 13:var g=o.stateNode,v=o.memoizedState;v!==null&&(d=v.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(l(314))}g!==null&&g.delete(a),wm(o,d)}var Sm;Sm=function(o,a,d){if(o!==null)if(o.memoizedProps!==a.pendingProps||pn.current)mn=!0;else{if(!(o.lanes&d)&&!(a.flags&128))return mn=!1,Px(o,a,d);mn=!!(o.flags&131072)}else mn=!1,at&&a.flags&1048576&&Jg(a,Ul,a.index);switch(a.lanes=0,a.tag){case 2:var g=a.type;rc(o,a),o=a.pendingProps;var v=Us(a,Xt.current);Ys(a,d),v=If(null,a,g,o,v,d);var P=Lf();return a.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,gn(g)?(P=!0,Rl(a)):P=!1,a.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Cf(a),v.updater=tc,a.stateNode=v,v._reactInternals=a,zf(a,g,o,d),a=Vf(null,a,g,!0,P,d)):(a.tag=0,at&&P&&gf(a),on(null,a,v,d),a=a.child),a;case 16:g=a.elementType;e:{switch(rc(o,a),o=a.pendingProps,v=g._init,g=v(g._payload),a.type=g,v=a.tag=Wx(g),o=sr(g,o),v){case 0:a=Gf(null,a,g,o,d);break e;case 1:a=Y1(null,a,g,o,d);break e;case 11:a=G1(null,a,g,o,d);break e;case 14:a=V1(null,a,g,sr(g.type,o),d);break e}throw Error(l(306,g,""))}return a;case 0:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:sr(g,v),Gf(o,a,g,v,d);case 1:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:sr(g,v),Y1(o,a,g,v,d);case 3:e:{if(X1(a),o===null)throw Error(l(387));g=a.pendingProps,P=a.memoizedState,v=P.element,c1(o,a),Xl(a,g,null,d);var R=a.memoizedState;if(g=R.element,he&&P.isDehydrated)if(P={element:g,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},a.updateQueue.baseState=P,a.memoizedState=P,a.flags&256){v=Qs(Error(l(423)),a),a=K1(o,a,g,d,v);break e}else if(g!==v){v=Qs(Error(l(424)),a),a=K1(o,a,g,d,v);break e}else for(he&&(Bn=W5(a.stateNode.containerInfo),Nn=a,at=!0,ir=null,ea=!1),d=o1(a,null,g,d),a.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Ws(),g===v){a=Yr(o,a,d);break e}on(o,a,g,d)}a=a.child}return a;case 5:return f1(a),o===null&&vf(a),g=a.type,v=a.pendingProps,P=o!==null?o.memoizedProps:null,R=v.children,de(g,v)?R=null:P!==null&&de(g,P)&&(a.flags|=32),H1(o,a),on(o,a,R,d),a.child;case 6:return o===null&&vf(a),null;case 13:return Q1(o,a,d);case 4:return Ef(a,a.stateNode.containerInfo),g=a.pendingProps,o===null?a.child=$s(a,null,g,d):on(o,a,g,d),a.child;case 11:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:sr(g,v),G1(o,a,g,v,d);case 7:return on(o,a,a.pendingProps,d),a.child;case 8:return on(o,a,a.pendingProps.children,d),a.child;case 12:return on(o,a,a.pendingProps.children,d),a.child;case 10:e:{if(g=a.type._context,v=a.pendingProps,P=a.memoizedProps,R=v.value,a1(a,g,R),P!==null)if(rr(P.value,R)){if(P.children===v.children&&!pn.current){a=Yr(o,a,d);break e}}else for(P=a.child,P!==null&&(P.return=a);P!==null;){var H=P.dependencies;if(H!==null){R=P.child;for(var q=H.firstContext;q!==null;){if(q.context===g){if(P.tag===1){q=Hr(-1,d&-d),q.tag=2;var ue=P.updateQueue;if(ue!==null){ue=ue.shared;var ke=ue.pending;ke===null?q.next=q:(q.next=ke.next,ke.next=q),ue.pending=q}}P.lanes|=d,q=P.alternate,q!==null&&(q.lanes|=d),kf(P.return,d,a),H.lanes|=d;break}q=q.next}}else if(P.tag===10)R=P.type===a.type?null:P.child;else if(P.tag===18){if(R=P.return,R===null)throw Error(l(341));R.lanes|=d,H=R.alternate,H!==null&&(H.lanes|=d),kf(R,d,a),R=P.sibling}else R=P.child;if(R!==null)R.return=P;else for(R=P;R!==null;){if(R===a){R=null;break}if(P=R.sibling,P!==null){P.return=R.return,R=P;break}R=R.return}P=R}on(o,a,v.children,d),a=a.child}return a;case 9:return v=a.type,g=a.pendingProps.children,Ys(a,d),v=Un(v),g=g(v),a.flags|=1,on(o,a,g,d),a.child;case 14:return g=a.type,v=sr(g,a.pendingProps),v=sr(g.type,v),V1(o,a,g,v,d);case 15:return W1(o,a,a.type,a.pendingProps,d);case 17:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:sr(g,v),rc(o,a),a.tag=1,gn(g)?(o=!0,Rl(a)):o=!1,Ys(a,d),j1(a,g,v),zf(a,g,v,d),Vf(null,a,g,!0,o,d);case 19:return q1(o,a,d);case 22:return $1(o,a,d)}throw Error(l(156,a.tag))};function _m(o,a){return df(o,a)}function Vx(o,a,d,g){this.tag=o,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(o,a,d,g){return new Vx(o,a,d,g)}function hh(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Wx(o){if(typeof o=="function")return hh(o)?1:0;if(o!=null){if(o=o.$$typeof,o===b)return 11;if(o===T)return 14}return 2}function bi(o,a){var d=o.alternate;return d===null?(d=$n(o.tag,a,o.key,o.mode),d.elementType=o.elementType,d.type=o.type,d.stateNode=o.stateNode,d.alternate=o,o.alternate=d):(d.pendingProps=a,d.type=o.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=o.flags&14680064,d.childLanes=o.childLanes,d.lanes=o.lanes,d.child=o.child,d.memoizedProps=o.memoizedProps,d.memoizedState=o.memoizedState,d.updateQueue=o.updateQueue,a=o.dependencies,d.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},d.sibling=o.sibling,d.index=o.index,d.ref=o.ref,d}function Sc(o,a,d,g,v,P){var R=2;if(g=o,typeof o=="function")hh(o)&&(R=1);else if(typeof o=="string")R=5;else e:switch(o){case p:return ps(d.children,v,P,a);case m:R=8,v|=8;break;case w:return o=$n(12,d,a,v|2),o.elementType=w,o.lanes=P,o;case _:return o=$n(13,d,a,v),o.elementType=_,o.lanes=P,o;case S:return o=$n(19,d,a,v),o.elementType=S,o.lanes=P,o;case k:return _c(d,v,P,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case y:R=10;break e;case x:R=9;break e;case b:R=11;break e;case T:R=14;break e;case h:R=16,g=null;break e}throw Error(l(130,o==null?o:typeof o,""))}return a=$n(R,d,a,v),a.elementType=o,a.type=g,a.lanes=P,a}function ps(o,a,d,g){return o=$n(7,o,g,a),o.lanes=d,o}function _c(o,a,d,g){return o=$n(22,o,g,a),o.elementType=k,o.lanes=d,o.stateNode={isHidden:!1},o}function ph(o,a,d){return o=$n(6,o,null,a),o.lanes=d,o}function gh(o,a,d){return a=$n(4,o.children!==null?o.children:[],o.key,a),a.lanes=d,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function $x(o,a,d,g,v){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=se,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cf(0),this.expirationTimes=cf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cf(0),this.identifierPrefix=g,this.onRecoverableError=v,he&&(this.mutableSourceEagerHydrationData=null)}function km(o,a,d,g,v,P,R,H,q){return o=new $x(o,a,d,H,q),a===1?(a=1,P===!0&&(a|=8)):a=0,P=$n(3,null,null,a),o.current=P,P.stateNode=o,P.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cf(P),o}function bm(o){if(!o)return yi;o=o._reactInternals;e:{if(L(o)!==o||o.tag!==1)throw Error(l(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(gn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(l(171))}if(o.tag===1){var d=o.type;if(gn(d))return Yg(o,d,a)}return a}function Cm(o){var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(l(188)):(o=Object.keys(o).join(","),Error(l(268,o)));return o=D(a),o===null?null:o.stateNode}function Em(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var d=o.retryLane;o.retryLane=d!==0&&d<a?d:a}}function kc(o,a){Em(o,a),(o=o.alternate)&&Em(o,a)}function Hx(o){return o=D(o),o===null?null:o.stateNode}function Yx(){return null}return n.attemptContinuousHydration=function(o){if(o.tag===13){var a=Cr(o,134217728);if(a!==null){var d=qt();Wn(a,o,134217728,d)}kc(o,134217728)}},n.attemptDiscreteHydration=function(o){if(o.tag===13){var a=Cr(o,1);if(a!==null){var d=qt();Wn(a,o,1,d)}kc(o,1)}},n.attemptHydrationAtCurrentPriority=function(o){if(o.tag===13){var a=_i(o),d=Cr(o,a);if(d!==null){var g=qt();Wn(d,o,a,g)}kc(o,a)}},n.attemptSynchronousHydration=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var d=qo(a.pendingLanes);d!==0&&(uf(a,d|1),vn(a,Lt()),!(Fe&6)&&(Js(),br()))}break;case 13:pm(function(){var g=Cr(o,1);if(g!==null){var v=qt();Wn(g,o,1,v)}}),kc(o,1)}},n.batchedUpdates=function(o,a){var d=Fe;Fe|=1;try{return o(a)}finally{Fe=d,Fe===0&&(Js(),zl&&br())}},n.createComponentSelector=function(o){return{$$typeof:lc,value:o}},n.createContainer=function(o,a,d,g,v,P,R){return km(o,a,!1,null,d,g,v,P,R)},n.createHasPseudoClassSelector=function(o){return{$$typeof:cc,value:o}},n.createHydrationContainer=function(o,a,d,g,v,P,R,H,q){return o=km(d,g,!0,o,v,P,R,H,q),o.context=bm(null),d=o.current,g=qt(),v=_i(d),P=Hr(g,v),P.callback=a??null,xi(d,P,v),o.current.lanes=v,Jo(o,v,g),vn(o,g),o},n.createPortal=function(o,a,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:g==null?null:""+g,children:o,containerInfo:a,implementation:d}},n.createRoleSelector=function(o){return{$$typeof:uc,value:o}},n.createTestNameSelector=function(o){return{$$typeof:dc,value:o}},n.createTextSelector=function(o){return{$$typeof:fc,value:o}},n.deferredUpdates=function(o){var a=Ve,d=St.transition;try{return St.transition=null,Ve=16,o()}finally{Ve=a,St.transition=d}},n.discreteUpdates=function(o,a,d,g,v){var P=Ve,R=St.transition;try{return St.transition=null,Ve=1,o(a,d,g,v)}finally{Ve=P,St.transition=R,Fe===0&&Js()}},n.findAllNodes=nh,n.findBoundingRects=function(o,a){if(!Yt)throw Error(l(363));a=nh(o,a),o=[];for(var d=0;d<a.length;d++)o.push(Fn(a[d]));for(a=o.length-1;0<a;a--){d=o[a];for(var g=d.x,v=g+d.width,P=d.y,R=P+d.height,H=a-1;0<=H;H--)if(a!==H){var q=o[H],ue=q.x,ke=ue+q.width,Ae=q.y,me=Ae+q.height;if(g>=ue&&P>=Ae&&v<=ke&&R<=me){o.splice(a,1);break}else if(g!==ue||d.width!==q.width||me<P||Ae>R){if(!(P!==Ae||d.height!==q.height||ke<g||ue>v)){ue>g&&(q.width+=ue-g,q.x=g),ke<v&&(q.width=v-ue),o.splice(a,1);break}}else{Ae>P&&(q.height+=Ae-P,q.y=P),me<R&&(q.height=R-Ae),o.splice(a,1);break}}}return o},n.findHostInstance=Cm,n.findHostInstanceWithNoPortals=function(o){return o=F(o),o=o!==null?W(o):null,o===null?null:o.stateNode},n.findHostInstanceWithWarning=function(o){return Cm(o)},n.flushControlled=function(o){var a=Fe;Fe|=1;var d=St.transition,g=Ve;try{St.transition=null,Ve=1,o()}finally{Ve=g,St.transition=d,Fe=a,Fe===0&&(Js(),br())}},n.flushPassiveEffects=hs,n.flushSync=pm,n.focusWithin=function(o,a){if(!Yt)throw Error(l(363));for(o=Jf(o),a=dm(o,a),a=Array.from(a),o=0;o<a.length;){var d=a[o++];if(!ot(d)){if(d.tag===5&&pi(d.stateNode))return!0;for(d=d.child;d!==null;)a.push(d),d=d.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Ve},n.getFindAllNodesFailureDescription=function(o,a){if(!Yt)throw Error(l(363));var d=0,g=[];o=[Jf(o),0];for(var v=0;v<o.length;){var P=o[v++],R=o[v++],H=a[R];if((P.tag!==5||!ot(P))&&(eh(P,H)&&(g.push(th(H)),R++,R>d&&(d=R)),R<a.length))for(P=P.child;P!==null;)o.push(P,R),P=P.sibling}if(d<a.length){for(o=[];d<a.length;d++)o.push(th(a[d]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+o.join(" > ")}return null},n.getPublicRootInstance=function(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return z(o.child.stateNode);default:return o.child.stateNode}},n.injectIntoDevTools=function(o){if(o={bundleType:o.bundleType,version:o.version,rendererPackageName:o.rendererPackageName,rendererConfig:o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:Hx,findFiberByHostInstance:o.findFiberByHostInstance||Yx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")o=!1;else{var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled||!a.supportsFiber)o=!0;else{try{Dl=a.inject(o),kr=a}catch{}o=!!a.checkDCE}}return o},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(o,a,d,g){if(!Yt)throw Error(l(363));o=nh(o,a);var v=Br(o,d,g).disconnect;return{disconnect:function(){v()}}},n.registerMutableSourceForHydration=function(o,a){var d=a._getVersion;d=d(a._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[a,d]:o.mutableSourceEagerHydrationData.push(a,d)},n.runWithPriority=function(o,a){var d=Ve;try{return Ve=o,a()}finally{Ve=d}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(o,a,d,g){var v=a.current,P=qt(),R=_i(v);return d=bm(d),a.context===null?a.context=d:a.pendingContext=d,a=Hr(P,R),a.payload={element:o},g=g===void 0?null:g,g!==null&&(a.callback=g),o=xi(v,a,R),o!==null&&(Wn(o,v,R,P),Yl(o,v,R)),R},n};b5.exports=zC;var BC=b5.exports;const UC=xl(BC);var C5={exports:{}},zs={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */zs.ConcurrentRoot=1;zs.ContinuousEventPriority=4;zs.DefaultEventPriority=16;zs.DiscreteEventPriority=1;zs.IdleEventPriority=536870912;zs.LegacyRoot=0;C5.exports=zs;var E5=C5.exports;const Yy={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let Xy=!1,Ky=!1;const Dg=".react-konva-event",GC=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,VC=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,WC={};function ef(t,e,n=WC){if(!Xy&&"zIndex"in e&&(console.warn(VC),Xy=!0),!Ky&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(GC),Ky=!0)}for(var s in n)if(!Yy[s]){var l=s.slice(0,2)==="on",u=n[s]!==e[s];if(l&&u){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t.off(c,n[s])}var f=!e.hasOwnProperty(s);f&&t.setAttr(s,void 0)}var p=e._useStrictMode,m={},w=!1;const y={};for(var s in e)if(!Yy[s]){var l=s.slice(0,2)==="on",x=n[s]!==e[s];if(l&&x){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[s]&&(y[c]=e[s])}!l&&(e[s]!==n[s]||p&&e[s]!==t.getAttr(s))&&(w=!0,m[s]=e[s])}w&&(t.setAttrs(m),rs(t));for(var c in y)t.on(c+Dg,y[c])}function rs(t){if(!Re.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const T5={},$C={};yl.Node.prototype._applyProps=ef;function HC(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),rs(t)}function YC(t,e,n){let r=yl[t];r||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=yl.Group);const i={},s={};for(var l in e){var u=l.slice(0,2)==="on";u?s[l]=e[l]:i[l]=e[l]}const c=new r(i);return ef(c,s),c}function XC(t,e,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function KC(t,e,n){return!1}function QC(t){return t}function ZC(){return null}function qC(){return null}function JC(t,e,n,r){return $C}function eE(){}function tE(t){}function nE(t,e){return!1}function rE(){return T5}function iE(){return T5}const sE=setTimeout,oE=clearTimeout,aE=-1;function lE(t,e){return!1}const cE=!1,uE=!0,dE=!0;function fE(t,e){e.parent===t?e.moveToTop():t.add(e),rs(t)}function hE(t,e){e.parent===t?e.moveToTop():t.add(e),rs(t)}function N5(t,e,n){e._remove(),t.add(e),e.setZIndex(n.getZIndex()),rs(t)}function pE(t,e,n){N5(t,e,n)}function gE(t,e){e.destroy(),e.off(Dg),rs(t)}function mE(t,e){e.destroy(),e.off(Dg),rs(t)}function yE(t,e,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function vE(t,e,n){}function xE(t,e,n,r,i){ef(t,i,r)}function wE(t){t.hide(),rs(t)}function SE(t){}function _E(t,e){(e.visible==null||e.visible)&&t.show()}function kE(t,e){}function bE(t){}function CE(){}const EE=()=>E5.DefaultEventPriority,TE=Object.freeze(Object.defineProperty({__proto__:null,appendChild:fE,appendChildToContainer:hE,appendInitialChild:HC,cancelTimeout:oE,clearContainer:bE,commitMount:vE,commitTextUpdate:yE,commitUpdate:xE,createInstance:YC,createTextInstance:XC,detachDeletedInstance:CE,finalizeInitialChildren:KC,getChildHostContext:iE,getCurrentEventPriority:EE,getPublicInstance:QC,getRootHostContext:rE,hideInstance:wE,hideTextInstance:SE,idlePriority:Oa.unstable_IdlePriority,insertBefore:N5,insertInContainerBefore:pE,isPrimaryRenderer:cE,noTimeout:aE,now:Oa.unstable_now,prepareForCommit:ZC,preparePortalMount:qC,prepareUpdate:JC,removeChild:gE,removeChildFromContainer:mE,resetAfterCommit:eE,resetTextContent:tE,run:Oa.unstable_runWithPriority,scheduleTimeout:sE,shouldDeprioritizeSubtree:nE,shouldSetTextContent:lE,supportsMutation:dE,unhideInstance:_E,unhideTextInstance:kE,warnsIfNotActing:uE},Symbol.toStringTag,{value:"Module"}));var NE=Object.defineProperty,PE=Object.defineProperties,ME=Object.getOwnPropertyDescriptors,Qy=Object.getOwnPropertySymbols,AE=Object.prototype.hasOwnProperty,IE=Object.prototype.propertyIsEnumerable,Zy=(t,e,n)=>e in t?NE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qy=(t,e)=>{for(var n in e||(e={}))AE.call(e,n)&&Zy(t,n,e[n]);if(Qy)for(var n of Qy(e))IE.call(e,n)&&Zy(t,n,e[n]);return t},LE=(t,e)=>PE(t,ME(e)),Jy,ev;typeof window<"u"&&((Jy=window.document)!=null&&Jy.createElement||((ev=window.navigator)==null?void 0:ev.product)==="ReactNative")?O.useLayoutEffect:O.useEffect;function P5(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=e?t.return:t.child;for(;r;){const i=P5(r,e,n);if(i)return i;r=e?null:r.sibling}}function M5(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const tv=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=tv;return}return tv.apply(this,arguments)};const zg=M5(O.createContext(null));class A5 extends O.Component{render(){return O.createElement(zg.Provider,{value:this._reactInternals},this.props.children)}}function RE(){const t=O.useContext(zg);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=O.useId();return O.useMemo(()=>{for(const r of[t,t==null?void 0:t.alternate]){if(!r)continue;const i=P5(r,!1,s=>{let l=s.memoizedState;for(;l;){if(l.memoizedState===e)return!0;l=l.next}});if(i)return i}},[t,e])}function jE(){const t=RE(),[e]=O.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){const i=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;i&&i!==zg&&!e.has(i)&&e.set(i,O.useContext(M5(i)))}n=n.return}return e}function FE(){const t=jE();return O.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>O.createElement(e,null,O.createElement(n.Provider,LE(qy({},r),{value:t.get(n)}))),e=>O.createElement(A5,qy({},e))),[t])}function OE(t){const e=tn.useRef({});return tn.useLayoutEffect(()=>{e.current=t}),tn.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const DE=t=>{const e=tn.useRef(),n=tn.useRef(),r=tn.useRef(),i=OE(t),s=FE(),l=u=>{const{forwardedRef:c}=t;c&&(typeof c=="function"?c(u):c.current=u)};return tn.useLayoutEffect(()=>(n.current=new yl.Stage({width:t.width,height:t.height,container:e.current}),l(n.current),r.current=Fa.createContainer(n.current,E5.LegacyRoot,!1,null),Fa.updateContainer(tn.createElement(s,{},t.children),r.current),()=>{yl.isBrowser&&(l(null),Fa.updateContainer(null,r.current,null),n.current.destroy())}),[]),tn.useLayoutEffect(()=>{l(n.current),ef(n.current,t,i),Fa.updateContainer(tn.createElement(s,{},t.children),r.current,null)}),tn.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},$u="Layer",tf="Group",Hu="Rect",vl="Circle",bp="Line",Qn="Text",zE="Arrow",Fa=UC(TE);Fa.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:tn.version,rendererPackageName:"react-konva"});const BE=tn.forwardRef((t,e)=>tn.createElement(A5,{},tn.createElement(DE,{...t,forwardedRef:e}))),I5=()=>{const{elements:t,setElements:e,arcStart:n,setArcStart:r,setTempArcEnd:i,setSelectedElement:s,snapToGrid:l,gridSnappingEnabled:u}=$t(),c=O.useCallback((w,y)=>{if(w.id===y.id)return;if(w.type===y.type){console.warn("Invalid arc: Cannot connect elements of the same type."),r(null),i(null),s(null);return}const x={id:Wi(),source:w.id,target:y.id,weight:1,anglePoints:[],sourceType:w.type,targetType:y.type};e(b=>({...b,arcs:[...b.arcs,x]})),r(null),i(null),s(null)},[e,r,i,s]),f=O.useCallback((w,y)=>{e(x=>{const b=x.arcs.map(_=>{if(_.id===w){const S=u?l(y.x,y.y):y,T=_.anglePoints?[..._.anglePoints]:[];return T.push(S),{..._,anglePoints:T}}return _});return{...x,arcs:b}})},[e,u,l]),p=O.useCallback((w,y,x)=>{e(b=>{const _=b.arcs.map(S=>{if(S.id===w&&S.anglePoints&&S.anglePoints[y]){const T=u?l(x.x,x.y):x,h=[...S.anglePoints];return h[y]=T,{...S,anglePoints:h}}return S});return{...b,arcs:_}})},[e,u,l]),m=O.useCallback((w,y)=>{e(x=>{const b=x.arcs.map(_=>{if(_.id===w&&_.anglePoints&&_.anglePoints[y]){const S=[..._.anglePoints];return S.splice(y,1),{..._,anglePoints:S}}return _});return{...x,arcs:b}})},[e]);return{handleCompleteArc:c,handleAddAnglePoint:f,handleDragAnglePoint:p,handleDeleteAnglePoint:m}};function nv(t,e){if(!t||!e)return!1;const n=Math.min(e.x,e.x+e.w),r=Math.min(e.y,e.y+e.h),i=Math.max(e.x,e.x+e.w),s=Math.max(e.y,e.y+e.h);return t.x>=n&&t.x<=i&&t.y>=r&&t.y<=s}function rv(t,e){if(!t||!e)return[];const n=[];return(t.places||[]).forEach(r=>{nv({x:r.x,y:r.y},e)&&n.push({id:r.id,type:"place"})}),(t.transitions||[]).forEach(r=>{nv({x:r.x,y:r.y},e)&&n.push({id:r.id,type:"transition"})}),n}function UE(t,e){return t.some(r=>r.id===e.id&&r.type===e.type)?t.filter(r=>!(r.id===e.id&&r.type===e.type)):[...t,e]}function L5(t,e,n,r={}){if(!e||!e.startPositions)return t;const{dx:i,dy:s}=n||{dx:0,dy:0},{gridSnappingEnabled:l=!1,snapToGrid:u=(x,b)=>({x,y:b})}=r,c=e.startPositions;if(c.size===0)return t;const f=new Map((t.places||[]).map(x=>[x.id,x])),p=new Map((t.transitions||[]).map(x=>[x.id,x])),m=new Map,w=new Map;for(const[x,b]of c){const _=l?u(b.x+i,b.y+s):{x:b.x+i,y:b.y+s};if(b.type==="place"){const S=f.get(x);S&&m.set(x,{...S,x:_.x,y:_.y})}else if(b.type==="transition"){const S=p.get(x);S&&w.set(x,{...S,x:_.x,y:_.y})}}const y={...t};return m.size>0&&(y.places=(t.places||[]).map(x=>m.get(x.id)||x)),w.size>0&&(y.transitions=(t.transitions||[]).map(x=>w.get(x.id)||x)),e.startArcPoints&&e.startArcPoints.size>0&&(y.arcs=(t.arcs||[]).map(x=>{const b=e.startArcPoints.get(x.id);if(!b)return x;const _=b.map(S=>({x:S.x+i,y:S.y+s}));return{...x,anglePoints:_}})),y}const Bg=()=>{var A,F;const{gridSnappingEnabled:t}=Go(),{elements:e,setElements:n,selectedElement:r,setSelectedElement:i,selectedElements:s,setSelectedElements:l,isIdSelected:u,setSelection:c,mode:f,arcStart:p,setArcStart:m,tempArcEnd:w,setTempArcEnd:y,snapToGrid:x,isShiftPressedRef:b,pasteMode:_,setPasteMode:S}=$t(),{handleCompleteArc:T}=I5(),h=O.useCallback(()=>{if(!r)return;const{type:D,id:U}=r;let W=JSON.parse(JSON.stringify(e));D==="place"?(W.places=W.places.filter(G=>G.id!==U),W.arcs=W.arcs.filter(G=>G.source!==U&&G.target!==U)):D==="transition"?(W.transitions=W.transitions.filter(G=>G.id!==U),W.arcs=W.arcs.filter(G=>G.source!==U&&G.target!==U)):D==="arc"&&(W.arcs=W.arcs.filter(G=>G.id!==U)),n(W),i(null)},[r,e,n,i]),k=O.useCallback(()=>{n({places:[],transitions:[],arcs:[]}),i(null),m(null),y(null)},[n,i,m,y]),E=O.useCallback(D=>{var W,G;if(!D)return;let U=t?x(D.x,D.y):D;if(f==="place"){const z=((W=e==null?void 0:e.places)==null?void 0:W.length)||0,B={id:Wi(),x:U.x,y:U.y,label:`P${z+1}`,tokens:0};n(j=>({...j,places:[...(j==null?void 0:j.places)||[],B]}))}else if(f==="transition"){const z=((G=e==null?void 0:e.transitions)==null?void 0:G.length)||0,B={id:Wi(),x:U.x,y:U.y,label:`T${z+1}`};n(j=>({...j,transitions:[...(j==null?void 0:j.transitions)||[],B]}))}},[f,(A=e==null?void 0:e.places)==null?void 0:A.length,(F=e==null?void 0:e.transitions)==null?void 0:F.length,n,x,t]),N=O.useCallback((D,U,W)=>{var j,$;let G=null,z=null,B=null;typeof W<"u"?(G=D,z=U,B=W):(z=D,B=U),_&&typeof S=="function"&&S(!1),f==="select"||f==="arc_angle"?(!!(G&&((j=G.evt)!=null&&j.shiftKey||($=G.evt)!=null&&$.getModifierState&&G.evt.getModifierState("Shift")))||!!(b&&b.current)?(l(ee=>UE(ee,{id:z.id,type:B})),i({...z,type:B})):c([{id:z.id,type:B}]),m(null),y(null)):f==="arc"&&(p?T(p.element,{...z,type:B}):(i({...z,type:B}),m({element:{id:z.id,type:B},point:{x:z.x,y:z.y}}),y({sourcePoint:{x:z.x,y:z.y},x:z.x,y:z.y,potentialTarget:null})))},[f,p,i,l,u,c,m,y,T]),I=O.useCallback((D,U,W)=>{const G=t?x(W.x,W.y):W;n(z=>{const B={...z};return U==="place"?B.places=z.places.map(j=>j.id===D.id?{...j,x:G.x,y:G.y}:j):U==="transition"&&(B.transitions=z.transitions.map(j=>j.id===D.id?{...j,x:G.x,y:G.y}:j)),B})},[n,t,x]),M=O.useCallback(D=>Du(e,D),[e]),L=O.useCallback((D,U={x:40,y:40})=>{if(!D)return null;const{newPlaces:W,newTransitions:G,newArcs:z,newSelection:B}=zu(D,Wi,U);return n(j=>({...j,places:[...j.places,...W],transitions:[...j.transitions,...G],arcs:[...j.arcs,...z]})),B},[n]);return{handleDeleteElement:h,clearAllElements:k,handleCreateElement:E,handleElementClick:N,handleElementDragEnd:I,collectClipboard:M,pasteClipboard:L}},GE=30,VE=4,WE=4,Ug=4,hr=2,$E=12,Cp=10,HE=10,Gg=.48,u0=.25,YE={},R5=new WeakMap;function Yc(t,e,n){return R5.set(t,{baseRadius:e,visuals:n}),n}function XE(t,e,n=2){const r=t.x+t.width,i=t.y+t.height,s=e.x+e.width,l=e.y+e.height;return!(r+n<=e.x||s+n<=t.x||i+n<=e.y||l+n<=t.y)}function KE(t){if(t<=0)return[];const e=[[t]];if(t>=4){const n=Math.min(6,t-1);for(let r=n;r>=Math.ceil(t/2);r-=1){const i=t-r;i>=1&&e.push([r,i])}}if(t>=7){const n=Math.min(6,t-3),r=Math.max(2,Math.ceil((t-n)/2)),i=t-n-r;i>0&&e.push([n,r,i])}return e}function QE(t,e,n){const r=[...e].sort((l,u)=>n[u].width-n[l].width),i=[];let s=0;for(let l=0;l<t.length;l+=1){const u=t[l],c=r.slice(s,s+u);if(c.length<u)return null;i.push(c),s+=u}return i}function ZE(t,e,n,r,i){const s=t.length;if(s===0)return[];const l=new Array(s),u=t[0],c=Math.max(...u.map(_=>e[_].diagonal),r);let f=n-c-hr;if(f<=0)return null;const p=i?i+r+hr:r+hr;if(s===1)return l[0]=Math.max(f,p),l;const m=t[s-1],w=Math.max(...m.map(_=>e[_].diagonal),r),y=Math.max(p,w+hr),x=f-y,b=Math.max(r+hr,x/s);l[0]=f;for(let _=1;_<s;_+=1){const T=l[_-1]-b,h=t[_],k=Math.max(...h.map(N=>e[N].diagonal),r),E=Math.max(k+hr,p);if(l[_]=Math.max(T,E),l[_]<=0)return null}return l[s-1]<y&&(l[s-1]=y),l}function uu(t,e,n){if(!t||t.length===0)return e;let r=0;t.forEach(s=>{const l=s.x+s.width/2,u=s.y+s.height/2,c=Math.hypot(s.width/2,s.height/2),f=Math.hypot(l,u)+c+Ug;f>r&&(r=f)});const i=Math.ceil(r);return i>n&&n>=e?n:Math.max(e,i)}function du(t){return typeof t=="boolean"?t?"T":"F":typeof t=="string"?`'${t}'`:Array.isArray(t)?`[${t.map(du).join(", ")}]`:t&&typeof t=="object"&&t.__pair__?`(${du(t.fst)}, ${du(t.snd)})`:String(t)}function j5(t,e){return t.length?Math.max(e,t.length*e*Gg):e}function qE(t,e,n){const r=t.length;if(r===0)return null;const i=e-Ug;if(i<=0)return null;const s=i*2,l=[];for(let c=1;c<=r;c+=1){const f=Math.ceil(r/c);c===1&&r>4||f===1&&r>4||l.push({cols:c,rows:f})}l.sort((c,f)=>{const p=Math.abs(c.cols-c.rows)-Math.abs(f.cols-f.rows);return p!==0?p:c.cols-f.cols});const u=Math.max(...t.map(c=>c.length||1),1);for(const c of l){const f=c.cols,p=c.rows,m=s-hr*(f-1),w=s-hr*(p-1);if(m<=0||w<=0)continue;const y=m/f,x=w/p,b=x*.8,_=y/(u*Gg||1),S=Math.min($E,b,_);if(S<Cp)continue;const T=[];let h=!0;const k=y+hr,E=x+hr,N=k*(f-1),I=E*(p-1),M=-N/2,L=-I/2;if(t.forEach((A,F)=>{if(!h)return;const D=Math.floor(F/f),U=F%f,W=r-D*f,G=D===p-1?Math.min(W,f):f,B=M+(f-G)*k/2+U*k,j=L+D*E,X=j5(A,S)/2,ee=S/2,ne=Math.hypot(X,ee);if(Math.hypot(B,j)+ne>i){h=!1;return}T.push({key:`token-${F}`,text:A,fontSize:S,x:B-y/2,y:j-S/2,width:y,height:S})}),h)return{radius:uu(T,n,e),layout:T}}return null}function JE(t,e,n){const r=t.length;if(r===0)return{layout:[],radius:n};const i=e-Ug;if(i<=0)return null;const s=Math.max(...t.map(f=>f.length||1),1),l=Math.max(Cp,Math.min(12,i*2/(s*Gg))),u=t.map((f,p)=>p),c=f=>{const p=u.map(S=>{const T=j5(t[S],f);return{width:T,halfWidth:T/2,halfHeight:f/2,diagonal:Math.hypot(T/2,f/2)}});if(r===1){const S=p[0];if(S.diagonal>i)return null;const T=S.width*(1+u0),h=[{key:"token-0",text:t[0],fontSize:f,x:-T/2,y:-S.halfHeight,width:T,height:f}];return{layout:h,radius:uu(h,n,e)}}let m=null,w=0;if(r%2===1&&r>1){const T=[...u].sort((M,L)=>p[L].width-p[M].width)[0],h=p[T].diagonal,k=u.filter(M=>M!==T),E=k.length?Math.max(...k.map(M=>p[M].diagonal)):0,N=h+f*.5;i-E-2>=N&&(m=T,w=h)}const y=new Array(r);if(m!==null){const S=p[m];if(S.diagonal>i)return null;const T=S.width*(1+u0);y[m]={key:`token-${m}`,text:t[m],fontSize:f,x:-T/2,y:-S.halfHeight,width:T,height:f}}const x=u.filter(S=>S!==m);if(x.length===0){const S=y.filter(Boolean);return{layout:S,radius:uu(S,n,e)}}const b=y.slice(),_=KE(x.length);for(const S of _){const T=QE(S,x,p);if(!T)continue;const h=ZE(T,p,i,f,w);if(!h)continue;const k=b.slice();let E=!0;if(T.forEach((M,L)=>{const A=h[L],F=M.length;if(!F)return;const D=L%2===1?Math.PI/F:0;M.forEach((U,W)=>{if(!E)return;const G=p[U],z=G.width*(1+u0),B=z/2,j=-Math.PI/2+2*Math.PI*W/F+D,$=Math.cos(j)*A,X=Math.sin(j)*A;if(Math.hypot($,X)+G.diagonal>i+hr){E=!1;return}k[U]={key:`token-${U}`,text:t[U],fontSize:f,x:$-B,y:X-G.halfHeight,width:z,height:f}})}),!E)continue;const N=k.filter(Boolean);if(N.length!==r)continue;let I=!1;for(let M=0;M<N.length;M+=1){for(let L=M+1;L<N.length;L+=1)if(XE(N[M],N[L])){I=!0;break}if(I)break}if(!I){const M=uu(N,n,e);return{layout:N,radius:M}}}return null};for(let f=l;f>=Cp;f-=.5){const p=c(f);if(p&&p.layout&&p.layout.length===r)return p}return null}function F5(t,e=GE){var u;const n=Array.isArray(t)?t:YE,r=R5.get(n);if(r&&r.baseRadius===e)return r.visuals;const i=Array.isArray(t)?t:[];if(i.length===0)return Yc(n,e,{radius:e,tokens:[],indicator:null});const s=i.map(du),l=e*VE;for(let c=e;c<=l;c+=WE){if(s.length<=HE){const p=JE(s,c,e);if(p&&((u=p.layout)==null?void 0:u.length)===s.length){const m=Math.max(e,Math.min(p.radius,c));return Yc(n,e,{radius:m,tokens:p.layout,indicator:null})}}const f=qE(s,c,e);if(f){const p=Math.max(e,Math.min(f.radius,c));return Yc(n,e,{radius:p,tokens:f.layout,indicator:null})}}return Yc(n,e,{radius:e,tokens:[],indicator:s.length})}const eT=typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0),tT=t=>t>500?100:50,nT=({id:t,x:e,y:n,label:r,tokens:i,valueTokens:s,isSelected:l,onSelect:u,onChange:c})=>{const{setIsDragging:f,snapToGrid:p,netMode:m,elements:w,selectedElements:y,setElements:x,multiDragRef:b,isIdSelected:_,mode:S,arcStart:T}=$t(),{gridSnappingEnabled:h,setSnapIndicator:k}=Go(),E=30,N=O.useRef(0),I=m==="algebraic-int"||Array.isArray(s),M=O.useMemo(()=>I?F5(s||[],E):{radius:E,tokens:[],indicator:null},[I,s]),L=I?M.radius:E,A=O.useCallback(G=>{const z=new Map;w.places.forEach(j=>{G.has(j.id)&&z.set(j.id,{type:"place",x:j.x,y:j.y})}),w.transitions.forEach(j=>{G.has(j.id)&&z.set(j.id,{type:"transition",x:j.x,y:j.y})});const B=new Map;return w.arcs.forEach(j=>{if(G.has(j.source)&&G.has(j.target)){const $=Array.isArray(j.anglePoints)?j.anglePoints.map(X=>({x:X.x,y:X.y})):[];B.set(j.id,$)}}),{startPositions:z,startArcPoints:B}},[w]),F=()=>{b.current!==null&&(b.current=null),f(!0);const G=_(t,"place");let z;G?z=new Set(y.filter(j=>j.type==="place"||j.type==="transition").map(j=>j.id)):(z=new Set([t]),typeof u=="function"&&u(t));const B=A(z);b.current={baseId:t,lastDelta:{dx:0,dy:0},...B}},D=G=>{var fe,V;let z={x:G.target.x(),y:G.target.y()};if(h){const K=p(z.x,z.y);k({visible:!0,position:K,elementType:"place"}),G.target.position({x:K.x,y:K.y}),z=K}const B=b.current;if(!B||!B.startPositions||B.baseId!==t)return;const j=B.startPositions.get(t);if(!j)return;const $=z.x-j.x,X=z.y-j.y,ee=B.lastDelta||{dx:0,dy:0};if(ee.dx===$&&ee.dy===X)return;if(eT){B.lastDelta={dx:$,dy:X};return}const ne=(((fe=w.places)==null?void 0:fe.length)||0)+(((V=w.transitions)==null?void 0:V.length)||0),Z=tT(ne),te=performance.now();if(te-N.current<Z)return;N.current=te,B.lastDelta={dx:$,dy:X};const de={dx:$,dy:X};x(K=>!B||!B.startPositions?K:L5(K,B,de,{gridSnappingEnabled:h,snapToGrid:p}))},U=G=>{const z={x:G.target.x(),y:G.target.y()};b.current=null,f(!1),k({visible:!1,position:null,elementType:null}),c(z)},W=()=>I?M.tokens.length>0?C.jsx(C.Fragment,{children:M.tokens.map(G=>C.jsx(Qn,{text:G.text,fontSize:G.fontSize,fill:"black",x:G.x,y:G.y,width:G.width,align:"center",wrap:"none",listening:!1},G.key))}):M.indicator?C.jsx(Qn,{text:`(${M.indicator})`,fontSize:12,fill:"black",x:-L,y:-7,width:L*2,align:"center",wrap:"none",listening:!1}):null:i===0?m==="algebraic-int"||Array.isArray(s)?null:C.jsx(Qn,{text:"0",fontSize:14,fill:"black",x:-L,y:-7,width:L*2,align:"center",listening:!1}):i<=5?C.jsxs(C.Fragment,{children:[Array.from({length:i}).map((G,z)=>{const B=2*Math.PI*z/i,j=4,$=L/2,X=Math.cos(B)*$,ee=Math.sin(B)*$;return C.jsx(vl,{x:X,y:ee,radius:j,fill:"black",listening:!1},z)}),C.jsx(Qn,{text:i.toString(),fontSize:14,fill:"black",x:-L,y:-7,width:L*2,align:"center",listening:!1})]}):C.jsx(Qn,{text:i.toString(),fontSize:16,fill:"black",x:-L,y:-8,width:L*2,align:"center",listening:!1});return C.jsxs(tf,{x:e,y:n,draggable:S!=="arc"||!T,onDragStart:F,onDragMove:D,onDragEnd:U,onClick:()=>u(t),onTap:G=>{G.evt&&G.evt._handledByTouchEnd||u(t)},onTouchEnd:G=>{S==="arc"&&T&&T.element.id!==t&&(u(t),G.evt&&(G.evt._handledByTouchEnd=!0))},id:t,name:"element",elementType:"place",children:[C.jsx(vl,{radius:L,fill:"white",stroke:l?"blue":"black",strokeWidth:2}),C.jsx(Qn,{text:r,fontSize:12,fill:"black",x:-L,y:L+5,width:L*2,align:"center",listening:!1}),W()]})},rT=typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0),iT=t=>t>500?100:50,d0=11,sT=.48,iv=160,oT=6,aT=({id:t,x:e,y:n,label:r,guard:i,isSelected:s,isEnabled:l,onSelect:u,onChange:c})=>{const{gridSnappingEnabled:m,setSnapIndicator:w}=Go(),{setIsDragging:y,snapToGrid:x,simulationSettings:b,netMode:_,elements:S,selectedElements:T,setElements:h,multiDragRef:k,isIdSelected:E,setSelection:N,mode:I,arcStart:M}=$t(),L=O.useRef(0),A=O.useCallback(B=>{const j=new Map;S.places.forEach(X=>{B.has(X.id)&&j.set(X.id,{type:"place",x:X.x,y:X.y})}),S.transitions.forEach(X=>{B.has(X.id)&&j.set(X.id,{type:"transition",x:X.x,y:X.y})});const $=new Map;return S.arcs.forEach(X=>{if(B.has(X.source)&&B.has(X.target)){const ee=Array.isArray(X.anglePoints)?X.anglePoints.map(ne=>({x:ne.x,y:ne.y})):[];$.set(X.id,ee)}}),{startPositions:j,startArcPoints:$}},[S]),F=()=>{k.current!==null&&(k.current=null),y(!0);const B=E(t,"transition");let j;B?j=new Set(T.filter(X=>X.type==="place"||X.type==="transition").map(X=>X.id)):(j=new Set([t]),typeof u=="function"&&u(t));const $=A(j);k.current={baseId:t,lastDelta:{dx:0,dy:0},...$}},D=B=>{var K,se;let j={x:B.target.x(),y:B.target.y()};if(m){const re=x(j.x,j.y);w({visible:!0,position:re,elementType:"transition"}),B.target.position({x:re.x,y:re.y}),j=re}const $=k.current;if(!$||!$.startPositions||$.baseId!==t)return;const X=$.startPositions.get(t);if(!X)return;const ee=j.x-X.x,ne=j.y-X.y,Z=$.lastDelta||{dx:0,dy:0};if(Z.dx===ee&&Z.dy===ne)return;if(rT){$.lastDelta={dx:ee,dy:ne};return}const te=(((K=S.places)==null?void 0:K.length)||0)+(((se=S.transitions)==null?void 0:se.length)||0),de=iT(te),fe=performance.now();if(fe-L.current<de)return;L.current=fe,$.lastDelta={dx:ee,dy:ne};const V={dx:ee,dy:ne};h(re=>!$||!$.startPositions?re:L5(re,$,V,{gridSnappingEnabled:m,snapToGrid:x}))},U=B=>{const j={x:B.target.x(),y:B.target.y()};k.current=null,y(!1),w({visible:!1,position:null,elementType:null}),c(j)},W=_==="algebraic-int"?String(i||""):"";let G=40,z="none";if(W){const B=W.length*d0*sT+oT*2;B<=iv?G=Math.max(40,B):(G=iv,z="char")}return C.jsxs(tf,{x:e,y:n,onClick:B=>u(t,B),onTap:B=>{B.evt&&B.evt._handledByTouchEnd||u(t,B)},onTouchEnd:B=>{I==="arc"&&M&&M.element.id!==t&&(u(t,B),B.evt&&(B.evt._handledByTouchEnd=!0))},draggable:I!=="arc"||!M,onDragStart:F,onDragMove:D,onDragEnd:U,id:t,name:"element",elementType:"transition",children:[C.jsx(Hu,{x:-40/2,y:-50/2,width:40,height:50,fill:l?"rgba(255, 255, 0, 0.8)":"gray",stroke:s?"blue":l?"rgba(255, 180, 0, 1)":"black",strokeWidth:s||l?3:2}),C.jsx(Qn,{text:r,fontSize:14,fill:"black",x:-40/2,y:50/2+5,width:40,align:"center",listening:!1}),_==="algebraic-int"&&W&&C.jsx(Qn,{text:W,fontSize:d0,fill:"#333",x:-G/2,y:-50/2-14,width:G,align:"center",wrap:z,listening:!1,ellipsis:z!=="none"}),_==="algebraic-int"&&!W&&C.jsx(Qn,{text:"",fontSize:d0,fill:"gray",x:-40/2,y:-50/2-14,width:40,align:"center",listening:!1})]})},lT=({elements:t,selectedElement:e,handleElementClick:n,handleElementDragEnd:r,enabledTransitionIds:i})=>{var l,u;const{isIdSelected:s}=$t();return C.jsxs($u,{children:[(l=t==null?void 0:t.places)==null?void 0:l.map(c=>C.jsx(nT,{...c,isSelected:s(c.id,"place"),onSelect:f=>n(c,"place"),onChange:f=>r(c,"place",f)},c.id)),(u=t==null?void 0:t.transitions)==null?void 0:u.map(c=>C.jsx(aT,{...c,isSelected:s(c.id,"transition"),onSelect:f=>n(c,"transition"),onChange:f=>r(c,"transition",f),isEnabled:Array.isArray(i)?i.includes(c.id):!1},c.id))]})};function cT(t){return t!=null&&t.sourceType?t.sourceType:(t==null?void 0:t.type)==="place-to-transition"?"place":(t==null?void 0:t.type)==="transition-to-place"?"transition":"place"}function uT(t){return t!=null&&t.targetType?t.targetType:(t==null?void 0:t.type)==="place-to-transition"?"transition":(t==null?void 0:t.type)==="transition-to-place"?"place":"transition"}const dT=.52,f0=(t="",e=12,{padding:n=4,maxWidth:r=1/0}={})=>{if(!t.length)return{width:0,wrap:"none"};const i=t.length*e*dT+n*2;return i<=r?{width:i,wrap:"none"}:{width:r,wrap:"char"}},h0=(t,e)=>t.width||e*2,io=t=>Number.isFinite(t),fT=()=>{var T;const{elements:t,selectedElement:e,selectedElements:n,mode:r,tempArcEnd:i,getVirtualPointerPosition:s,gridSnappingEnabled:l,snapToGrid:u,simulationSettings:c}=$t(),f=(c==null?void 0:c.netMode)||"pt",{handleElementClick:p}=Bg(),{handleAddAnglePoint:m,handleDragAnglePoint:w,handleDeleteAnglePoint:y}=I5(),x=O.useMemo(()=>{const h=new Map;return(t.places||[]).forEach(k=>h.set(k.id,k)),(t.transitions||[]).forEach(k=>h.set(k.id,k)),h},[t.places,t.transitions]),b=h=>!h||typeof h!="string"?null:x.get(h)||null,_=h=>{if(!h)return 30;if(f==="algebraic-int"||Array.isArray(h.valueTokens)){const k=F5(h.valueTokens,30);if(k&&typeof k.radius=="number"&&Number.isFinite(k.radius))return k.radius}return 30},S=(h,k,E=[])=>{if(!h||!k||typeof h.x!="number"||typeof h.y!="number"||typeof k.x!="number"||typeof k.y!="number")return[0,0,100,100];const N={x:h.x,y:h.y},I={x:k.x,y:k.y},M=[{...h},...E,{...k}],L=40,A=50,F={...M[0]},D={...M[M.length-1]},U=M[1]||D,W=M[M.length-2]||F;let G=U.x-F.x,z=U.y-F.y,B=Math.atan2(z,G);if(h.type==="place"){const te=_(h);F.x+=te*Math.cos(B),F.y+=te*Math.sin(B)}else{const te=L/2,de=A/2,fe=Math.abs(Math.cos(B)),V=Math.abs(Math.sin(B)),K=Math.tan(B);if(te*V<=de*fe)F.x+=Math.sign(G)*te,F.y+=Math.sign(G)*te*K;else{const se=Math.abs(K)<1e-6?1e-6*Math.sign(K||1):K;F.x+=Math.sign(z)*de/se,F.y+=Math.sign(z)*de}}let j=D.x-W.x,$=D.y-W.y,X=Math.atan2($,j);if(k.type==="place"){const te=_(k);D.x-=te*Math.cos(X),D.y-=te*Math.sin(X)}else{const te=L/2,de=A/2,fe=Math.abs(Math.cos(X)),V=Math.abs(Math.sin(X)),K=Math.tan(X);if(te*V<=de*fe)D.x-=Math.sign(j)*te,D.y-=Math.sign(j)*te*K;else{const se=Math.abs(K)<1e-6?1e-6*Math.sign(K||1):K;D.x-=Math.sign($)*de/se,D.y-=Math.sign($)*de}}const ee=[F.x,F.y];if(E.forEach(te=>ee.push(te.x,te.y)),ee.push(D.x,D.y),ee.every(te=>Number.isFinite(te)))return ee;const Z=[N.x,N.y];return E.forEach(te=>Z.push(te.x,te.y)),Z.push(I.x,I.y),Z};return[C.jsxs($u,{children:[(T=t==null?void 0:t.arcs)==null?void 0:T.map(h=>{try{if(!h||!h.source||!h.target)return null;const k=b(h.source),E=b(h.target);if(!k||!E)return null;const N=S({...k,type:cT(h)},{...E,type:uT(h)},Array.isArray(h.anglePoints)?h.anglePoints:[]);if(!N||N.length<4||!N.every(yt=>Number.isFinite(yt)))return null;const I=(N[0]+N[N.length-2])/2,M=(N[1]+N[N.length-1])/2;if(!Number.isFinite(I)||!Number.isFinite(M))return null;const L=8,A=14,F=(n==null?void 0:n.some(yt=>yt.id===h.id&&yt.type==="arc"))||(n==null?void 0:n.some(yt=>yt.id===k.id))&&(n==null?void 0:n.some(yt=>yt.id===E.id)),D=12,U=12,W=12,G=h.label?`${h.label}`:"",z=h.weight>1?`${h.weight}`:"",B=f==="algebraic-int"&&Array.isArray(h.bindings)&&h.bindings.length>0?h.bindings.map(w4).join(", "):"",j=f0(G,D,{padding:6,maxWidth:220}),$=f0(z,U,{padding:4,maxWidth:80}),X=f0(B,W,{padding:6,maxWidth:240}),ee=N[0],ne=N[1],Z=N[N.length-2],te=N[N.length-1],de=Z-ee,fe=te-ne,V=Math.hypot(de,fe);let K=0,se=-1;V>.001&&(K=-fe/V,se=de/V);const re=6,oe=9,ge=8,he=.66,be=Math.abs(K),le=Math.abs(se),ve=(yt,dn,Gr=4)=>yt/2*be+dn/2*le+Gr,je=h0($,U),ze=h0(j,D),Xe=h0(X,W),Yt=Math.max(re,ve(je,U)),st=Math.max(oe,ve(ze,D)),Fn=Math.max(st+ge,ve(Xe,W,6)*he),On=I-K*Yt,ot=M-se*Yt,wr=I+K*st,pi=M+se*st,Br=I+K*Fn,Ur=M+se*Fn;return!io(On)||!io(ot)||!io(wr)||!io(pi)||!io(Br)||!io(Ur)?null:C.jsxs(tf,{children:[C.jsx(zE,{points:N,stroke:(e==null?void 0:e.id)===h.id||F?"blue":"black",strokeWidth:2,fill:"black",pointerLength:10,pointerWidth:10,hitStrokeWidth:12,onClick:yt=>p(yt,h,"arc"),onTap:yt=>p(yt,h,"arc"),onDblClick:yt=>{if(r==="arc_angle"){const dn=s();dn&&m(h.id,dn)}}}),h.weight>1&&C.jsx(Qn,{x:On,y:ot,text:z,fontSize:U,width:je,offsetX:je/2,offsetY:U/2,align:"center",listening:!1}),h.label&&C.jsx(Qn,{x:wr,y:pi,text:G,fontSize:D,fill:"gray",width:ze,offsetX:ze/2,offsetY:D/2,align:"center",wrap:j.wrap,ellipsis:j.wrap!=="none",listening:!1}),B&&C.jsx(Qn,{x:Br,y:Ur,text:B,fontSize:W,fill:"#333",width:Xe,offsetX:Xe/2,offsetY:W/2,align:"center",wrap:X.wrap,ellipsis:X.wrap!=="none",listening:!1})]},h.id)}catch(k){return console.warn("[ArcManager] Error rendering arc:",h==null?void 0:h.id,k),null}}),i&&i.sourcePoint&&C.jsx(bp,{points:[i.sourcePoint.x,i.sourcePoint.y,i.x,i.y],stroke:"grey",strokeWidth:2,dash:[5,5],listening:!1})]},"arcs-layer"),C.jsx($u,{children:(e==null?void 0:e.type)==="arc"&&r==="arc_angle"&&e.anglePoints.map((h,k)=>C.jsx(vl,{x:h.x,y:h.y,radius:6,fill:"red",stroke:"black",strokeWidth:1,draggable:!0,onDragEnd:E=>{const N={x:E.target.x(),y:E.target.y()},I=l?u(N.x,N.y):N;w(e.id,k,I)},onClick:E=>{E.evt.button===2&&(E.evt.preventDefault(),y(e.id,k))},onContextMenu:E=>{E.evt.preventDefault(),y(e.id,k)}},`angle-${e.id}-${k}`))},"handles-layer")]},hT=({width:t,height:e,gridSize:n})=>{const r=[],i=[],s=Math.ceil(e/n),l=Math.ceil(t/n);for(let u=0;u<=s;u++){const c=u*n;r.push(C.jsx(bp,{points:[0,c,t,c],stroke:"#ddd",strokeWidth:u%5===0?.5:.2,perfectDrawEnabled:!1,listening:!1},`h-${u}`))}for(let u=0;u<=l;u++){const c=u*n;i.push(C.jsx(bp,{points:[c,0,c,e],stroke:"#ddd",strokeWidth:u%5===0?.5:.2,perfectDrawEnabled:!1,listening:!1},`v-${u}`))}return C.jsxs(tf,{listening:!1,perfectDrawEnabled:!1,children:[r,i]})},sv=({orientation:t,contentSize:e,viewportSize:n,scrollPosition:r,onScroll:i})=>{const s=O.useRef(null),l=O.useRef(null),[u,c]=O.useState(!1),f=O.useRef(0),p=O.useRef(0),m=t==="horizontal",w=O.useCallback(M=>{M.preventDefault(),M.stopPropagation(),c(!0),f.current=r,p.current=m?M.clientX:M.clientY},[m,r]),y=O.useCallback(M=>{if(s.current&&l.current&&!l.current.contains(M.target)){const{left:L,top:A,width:F,height:D}=s.current.getBoundingClientRect(),U=m?F:D,W=Math.max(20,U*(n/e)),G=Math.max(0,e-n),z=Math.max(0,U-W);let j=((m?M.clientX-L:M.clientY-A)-W/2)/z*G;j=Math.max(0,Math.min(j,G)),i(j)}},[e,n,m,i]);if(O.useEffect(()=>{const M=A=>{if(!u||!s.current)return;const D=(m?A.clientX:A.clientY)-p.current,U=m?s.current.clientWidth:s.current.clientHeight,W=Math.max(20,U*(n/e)),G=Math.max(0,e-n),z=Math.max(0,U-W);if(z<=0)return;const B=G/z,j=f.current+D*B;i(Math.max(0,Math.min(j,G)))},L=()=>{u&&c(!1)};return u&&(document.addEventListener("mousemove",M),document.addEventListener("mouseup",L),document.body.style.cursor=m?"ew-resize":"ns-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",L),document.body.style.cursor="default",document.body.style.userSelect="auto"}},[u,m,i,e,n]),e<=n)return null;const x=s.current?m?s.current.clientWidth:s.current.clientHeight:0,b=x>0?x*(n/e):0,_=Math.max(20,Math.min(b,x)),S=Math.max(0,e-n),T=Math.max(0,x-_),h=Math.max(0,Math.min(r,S)),k=S>0?Math.min(h/S*T,T):0,E={position:"absolute",zIndex:50,padding:0,margin:0,...m?{left:"0px",right:"0px",bottom:"0px",height:"10px"}:{top:"0px",bottom:"0px",right:"0px",width:"10px"}},N={position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},I={position:"absolute",backgroundColor:"rgba(0,0,0,0.45)",borderRadius:"6px",cursor:"pointer",willChange:"transform",...m?{left:`${Math.round(k)}px`,top:"0px",width:`${Math.round(_)}px`,height:"100%"}:{top:`${Math.round(k)}px`,left:"0px",height:`${Math.round(_)}px`,width:"100%"}};return C.jsx("div",{style:E,children:C.jsx("div",{ref:s,style:N,onMouseDown:y,children:C.jsx("div",{ref:l,style:I,onMouseDown:w})})})},pT=({position:t,visible:e,elementType:n})=>!e||!t?null:n==="place"?C.jsx(vl,{x:t.x,y:t.y,radius:5,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}):n==="transition"?C.jsx(Hu,{x:t.x-5,y:t.y-5,width:10,height:10,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}):C.jsx(vl,{x:t.x,y:t.y,radius:5,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}),gT=({handleZoom:t,ZOOM_STEP:e,isSingleFingerPanningActive:n,isSelectionActiveRef:r,activateSingleFingerPan:i})=>{const{stageDimensions:s,setStageDimensions:l,virtualCanvasDimensions:u,canvasScroll:c,setCanvasScroll:f,zoomLevel:p,setContainerRef:m,stageRef:w,gridSize:y,gridSnappingEnabled:x,snapIndicator:b,setSnapIndicator:_}=Go(),{mode:S,setMode:T,arcStart:h,setArcStart:k,tempArcEnd:E,setTempArcEnd:N,selectedElement:I,setSelectedElement:M,elements:L,setElements:A,enabledTransitionIds:F,snapToGrid:D,selectedElements:U,setSelection:W,isDragging:G,pasteMode:z,setPasteMode:B,getClipboard:j,netMode:$,onClipboardMismatch:X}=$t(),{handleCreateElement:ee,handleElementClick:ne,handleElementDragEnd:Z}=Bg(),te=O.useRef(null),de=O.useRef({isSelecting:!1,start:null}),[fe,V]=O.useState(null),[K,se]=O.useState(!1),re=O.useRef(!1),oe=O.useRef([]),ge=O.useRef(null),he=O.useRef(null),be=3,le=O.useRef({active:!1,touchId:null,startX:0,startY:0,startVirtualX:0,startVirtualY:0,maxMovement:0,startTime:0,selectionTimerId:null,gestureStartTimerId:null,gestureDecided:!1,gestureType:null,isQuickTap:!1}),ve=500,je=0,ze=10,Xe=10,Yt=0,st=O.useCallback(()=>{const ie=le.current;ie.selectionTimerId&&clearTimeout(ie.selectionTimerId),ie.gestureStartTimerId&&clearTimeout(ie.gestureStartTimerId),le.current={active:!1,touchId:null,startX:0,startY:0,startVirtualX:0,startVirtualY:0,maxMovement:0,startTime:0,selectionTimerId:null,gestureStartTimerId:null,gestureDecided:!1,gestureType:null,isQuickTap:!1},r&&(r.current=!1)},[r]),Fn=O.useCallback((ie,ce,pe)=>{st();const Ce=le.current;Ce.active=!0,Ce.touchId=ie.identifier,Ce.startX=ie.clientX,Ce.startY=ie.clientY,Ce.startVirtualX=ce.x,Ce.startVirtualY=ce.y,Ce.maxMovement=0,Ce.startTime=Date.now(),Ce.gestureDecided=!1,Ce.gestureType=null,Ce.isQuickTap=!0,console.log("[TouchGesture] Started:",{touchId:ie.identifier,startX:ie.clientX,startY:ie.clientY,isSelectMode:pe}),Ce.gestureStartTimerId=setTimeout(()=>{const Ee=le.current;if(!(!Ee.active||Ee.gestureDecided)){if(Ee.maxMovement>Xe){Ee.isQuickTap=!1;return}pe&&(Ee.isQuickTap=!1,Ee.selectionTimerId=setTimeout(()=>{const xe=le.current;if(console.log("[TouchGesture] Timer fired:",{active:xe.active,gestureDecided:xe.gestureDecided,maxMovement:xe.maxMovement}),xe.gestureDecided||!xe.active){console.log("[TouchGesture] Selection cancelled - gesture already decided or inactive");return}if(xe.maxMovement>ze){console.log("[TouchGesture] Selection cancelled - moved too much:",xe.maxMovement);return}if(console.log("[TouchGesture] Selection ACTIVATED!"),xe.gestureDecided=!0,xe.gestureType="selection",xe.selectionTimerId=null,r&&(r.current=!0),de.current={isSelecting:!0,start:{x:xe.startVirtualX,y:xe.startVirtualY}},V({x:xe.startVirtualX,y:xe.startVirtualY,w:0,h:0}),navigator.vibrate)try{navigator.vibrate([10,50,10])}catch{}},ve-Yt))}},Yt)},[st,r,V]),On=O.useCallback(ie=>{const ce=le.current;if(!ce.active||ce.gestureDecided||ce.isQuickTap&&ce.maxMovement<=Xe)return;ce.maxMovement>Xe&&(ce.isQuickTap=!1),Date.now()-ce.startTime>=je&&ce.maxMovement>ze&&(ce.gestureDecided=!0,ce.gestureType="pan",ce.selectionTimerId&&(clearTimeout(ce.selectionTimerId),ce.selectionTimerId=null),ce.gestureStartTimerId&&(clearTimeout(ce.gestureStartTimerId),ce.gestureStartTimerId=null),i&&i())},[i]);O.useEffect(()=>{if(typeof window>"u")return;const ie=window.matchMedia("(pointer: coarse)"),ce=pe=>se(pe.matches);return ce(ie),ie.addEventListener?ie.addEventListener("change",ce):ie.addListener(ce),()=>{ie.removeEventListener?ie.removeEventListener("change",ce):ie.removeListener(ce)}},[]),O.useEffect(()=>()=>{st()},[st]),O.useEffect(()=>{G||st()},[G,st]),O.useEffect(()=>{const ie=te.current;if(!ie)return;m(ie);const ce=new ResizeObserver(pe=>{for(let Ce of pe){const{width:Ee,height:xe}=Ce.contentRect;Ee>0&&xe>0&&l({width:Ee,height:xe})}});return ce.observe(ie),()=>{ce.disconnect()}},[l,m]);const ot=()=>{const ie=w.current;if(!ie)return null;const ce=ie.getPointerPosition();if(!ce)return null;const pe=ie.getAbsoluteTransform().copy();pe.invert();const{x:Ce,y:Ee}=pe.point(ce);return{x:Ce,y:Ee}},wr=ie=>{if(ie.target.name()!=="background"||re.current)return;if(z){const pe=ot();if(pe){const Ce=$||"pt",Ee=typeof j=="function"?j():null;if(!Ee){B(!1);return}const xe=Ee.payload||Ee;if(!xe){B(!1);return}const et=Ee.netMode||Ce;if(et&&Ce&&et!==Ce){typeof X=="function"?X(et,Ce,Ee):console.warn(`Blocked paste: shared clipboard contains ${et} net, editor mode is ${Ce}.`),B(!1);return}let fn=40,hn=40;xe.places&&xe.places.length>0?(fn=pe.x-xe.places[0].x,hn=pe.y-xe.places[0].y):xe.transitions&&xe.transitions.length>0&&(fn=pe.x-xe.transitions[0].x,hn=pe.y-xe.transitions[0].y);const{newPlaces:gi,newTransitions:Sr,newArcs:is,newSelection:_r}=zu(xe,Wi,{x:fn,y:hn});A(Tn=>({...Tn,places:[...Tn.places,...gi],transitions:[...Tn.transitions,...Sr],arcs:[...Tn.arcs,...is]})),W(_r),B(!1)}return}if(S==="select"){W([]),M(null);return}const ce=ot();ce&&ee(ce)},pi=ie=>{if(ie.target.name()!=="background"||re.current)return;if(z){const pe=ot();if(pe){const Ce=$||"pt",Ee=typeof j=="function"?j():null;if(!Ee){B(!1);return}const xe=Ee.payload||Ee;if(!xe){B(!1);return}const et=Ee.netMode||Ce;if(et&&Ce&&et!==Ce){typeof X=="function"?X(et,Ce,Ee):console.warn(`Blocked paste: shared clipboard contains ${et} net, editor mode is ${Ce}.`),B(!1);return}let fn=40,hn=40;xe.places&&xe.places.length>0?(fn=pe.x-xe.places[0].x,hn=pe.y-xe.places[0].y):xe.transitions&&xe.transitions.length>0&&(fn=pe.x-xe.transitions[0].x,hn=pe.y-xe.transitions[0].y);const{newPlaces:gi,newTransitions:Sr,newArcs:is,newSelection:_r}=zu(xe,Wi,{x:fn,y:hn});A(Tn=>({...Tn,places:[...Tn.places,...gi],transitions:[...Tn.transitions,...Sr],arcs:[...Tn.arcs,...is]})),W(_r),B(!1)}return}if(S==="select"){W([]),M(null);return}const ce=ot();ce&&ee(ce)},Br=ie=>{const ce=ot();if(ce){if(S==="arc"&&h){let pe=null;const Ce=w.current;if(Ce){const Ee=Ce.getPointerPosition(),xe=Ce.getIntersection(Ee);xe&&(xe.attrs.elementType==="place"||xe.attrs.elementType==="transition")&&xe.attrs.id!==h.element.id&&(pe={id:xe.attrs.id,type:xe.attrs.elementType})}N({sourcePoint:h.point,x:ce.x,y:ce.y,potentialTarget:pe})}if(r!=null&&r.current,S==="select"&&de.current.isSelecting&&de.current.start){const pe=de.current.start;V({x:pe.x,y:pe.y,w:ce.x-pe.x,h:ce.y-pe.y})}if(x&&(S==="place"||S==="transition")){const pe=D(ce.x,ce.y);_({visible:!0,position:pe,elementType:S})}else b.visible&&_({visible:!1,position:null,elementType:null})}},Ur=O.useCallback(()=>{const ie=oe.current;if(ie.length<2)return{vx:0,vy:0};const[ce,pe]=ie.slice(-2),Ce=pe.time-ce.time;if(Ce<=0)return{vx:0,vy:0};const Ee=(pe.deltaX-ce.deltaX)/Ce,xe=(pe.deltaY-ce.deltaY)/Ce;return{vx:Ee,vy:xe}},[]),yt=O.useCallback((ie,ce)=>{ge.current&&cancelAnimationFrame(ge.current),he.current&&clearTimeout(he.current);const pe=.95,Ce=.01,Ee=16;let xe=ie/p,et=ce/p,fn=performance.now();const hn=gi=>{const Sr=gi-fn;if(fn=gi,xe*=Math.pow(pe,Sr/Ee),et*=Math.pow(pe,Sr/Ee),Math.hypot(xe,et)<Ce){ge.current=null;return}f(_r=>{if(!u||!s)return _r;const Tn=Math.max(0,u.width-s.width/p),Qo=Math.max(0,u.height-s.height/p);return{x:Math.max(0,Math.min(Tn,_r.x+xe*Sr)),y:Math.max(0,Math.min(Qo,_r.y+et*Sr))}}),ge.current=requestAnimationFrame(hn)};ge.current=requestAnimationFrame(hn)},[p,f,u,s]),dn=O.useCallback(()=>{ge.current&&(cancelAnimationFrame(ge.current),ge.current=null),he.current&&(clearTimeout(he.current),he.current=null),oe.current=[]},[]),Gr=O.useCallback(ie=>{if(ie.preventDefault(),ie.stopPropagation(),ie.ctrlKey||ie.metaKey){dn();const ce=ie.deltaY>0?-e:e;t(ce,{clientX:ie.clientX,clientY:ie.clientY})}else{const ce=ie.deltaX/p,pe=ie.deltaY/p,Ce=performance.now();oe.current.push({deltaX:ie.deltaX,deltaY:ie.deltaY,time:Ce}),oe.current.length>be&&oe.current.shift(),he.current&&clearTimeout(he.current),ge.current&&(cancelAnimationFrame(ge.current),ge.current=null),f(Ee=>{if(!u||!s)return Ee;const xe=Math.max(0,u.width-s.width/p),et=Math.max(0,u.height-s.height/p);return{x:Math.max(0,Math.min(xe,Ee.x+ce)),y:Math.max(0,Math.min(et,Ee.y+pe))}}),he.current=setTimeout(()=>{const Ee=Ur();Math.hypot(Ee.vx,Ee.vy)>.1&&yt(Ee.vx,Ee.vy),he.current=null},150)}},[e,t,f,p,u,s,Ur,yt,dn]);O.useEffect(()=>{const ie=te.current;if(!ie)return;const ce=pe=>{ie.contains(pe.target)&&Gr(pe)};return document.addEventListener("wheel",ce,{passive:!1}),()=>{document.removeEventListener("wheel",ce),dn()}},[Gr,dn]);const Pe=O.useCallback((ie,ce)=>{f(pe=>{const Ce=Math.max(0,u.width-s.width/p),Ee=Math.max(0,u.height-s.height/p),xe=(fn,hn)=>Math.max(0,Math.min(fn,hn)),et={...pe};return ie==="x"&&(et.x=xe(ce,Ce)),ie==="y"&&(et.y=xe(ce,Ee)),et})},[f,u,s,p]);return C.jsxs("div",{ref:te,className:"canvas-container",style:{width:"100%",height:"100%",position:"relative",backgroundColor:"#f0f0f0",overflow:"hidden",touchAction:K?"none":"auto"},children:[C.jsxs(BE,{ref:w,width:s.width,height:s.height,listening:!0,onClick:wr,onTap:pi,onMouseMove:Br,onTouchMove:ie=>{const ce=ie.evt&&ie.evt.touches||ie.touches;if(K){const pe=le.current;if(pe.active&&!pe.gestureDecided&&ce&&ce.length===1){const Ce=ce[0],Ee=Ce.clientX-pe.startX,xe=Ce.clientY-pe.startY,et=Math.hypot(Ee,xe);pe.maxMovement=Math.max(pe.maxMovement,et),pe.maxMovement>Xe&&(pe.isQuickTap=!1),console.log("[TouchGesture] Move:",{distance:et,maxMovement:pe.maxMovement,gestureDecided:pe.gestureDecided,isQuickTap:pe.isQuickTap}),On()}}Br()},onMouseDown:ie=>{if(S!=="select"||ie.target&&ie.target.name&&ie.target.name()!=="background")return;const ce=ot();ce&&(de.current={isSelecting:!0,start:ce},V({x:ce.x,y:ce.y,w:0,h:0}))},onTouchStart:ie=>{const ce=ie.target&&ie.target.name&&ie.target.name()==="background",pe=ie.evt&&ie.evt.touches||ie.touches;if(pe&&pe.length===1){const Ce=pe[0],Ee=ot();if(!Ee)return;ce?Fn(Ce,Ee,S==="select"):st()}else st()},onMouseUp:()=>{if(S!=="select"||!de.current.isSelecting||!fe)return;const ie=rv(L,fe);W(ie),de.current={isSelecting:!1,start:null},V(null),re.current=!0,setTimeout(()=>{re.current=!1},100)},onTouchEnd:ie=>{console.log("[TouchGesture] TouchEnd");const ce=le.current,pe=ce.isQuickTap&&ce.maxMovement<=Xe;if(pe&&st(),S==="select"&&!pe&&de.current.isSelecting&&fe){const Ce=rv(L,fe);W(Ce),de.current={isSelecting:!1,start:null},V(null),re.current=!0,setTimeout(()=>{re.current=!1},100)}pe||st(),S==="arc"&&h&&setTimeout(()=>{if(S==="arc"&&h){const Ce=w.current;if(Ce){const Ee=Ce.getPointerPosition();if(Ee){const xe=Ce.getIntersection(Ee);(!xe||xe.attrs.elementType!=="place"&&xe.attrs.elementType!=="transition")&&(k(null),N(null))}else k(null),N(null)}else k(null),N(null)}},20)},scaleX:p,scaleY:p,x:-c.x*p,y:-c.y*p,children:[C.jsxs($u,{children:[C.jsx(Hu,{x:0,y:0,width:u.width,height:u.height,fill:"#FFFFFF",name:"background",onClick:()=>{S==="arc"&&h&&(k(null),N(null)),M(null)},onTap:()=>{S==="arc"&&h&&(k(null),N(null)),M(null)},onTouchEnd:()=>{S==="arc"&&h&&(k(null),N(null)),M(null)}}),fe&&C.jsx(Hu,{x:Math.min(fe.x,fe.x+fe.w),y:Math.min(fe.y,fe.y+fe.h),width:Math.abs(fe.w),height:Math.abs(fe.h),stroke:"#3399FF",strokeWidth:1,dash:[4,4],fill:"rgba(51,153,255,0.15)",listening:!1}),C.jsx(hT,{width:u.width,height:u.height,gridSize:y}),C.jsx(pT,{position:b.position,visible:b.visible,elementType:b.elementType})]}),C.jsx(lT,{elements:L,selectedElement:I,handleElementClick:ne,handleElementDragEnd:Z,enabledTransitionIds:F}),C.jsx(fT,{})]}),!K&&s.width>0&&u.width>s.width/p&&C.jsx(sv,{orientation:"horizontal",contentSize:u.width,viewportSize:s.width/p,scrollPosition:c.x,onScroll:ie=>Pe("x",ie)}),!K&&s.height>0&&u.height>s.height/p&&C.jsx(sv,{orientation:"vertical",contentSize:u.height,viewportSize:s.height/p,scrollPosition:c.y,onScroll:ie=>{_e.debug("Vertical scroll callback:",{newScroll:ie,currentScroll:c.y,maxScroll:Math.max(0,u.height-s.height/p)}),Pe("y",ie)}})]})},mT=()=>{const{mode:t,setMode:e}=$t(),[n,r]=O.useState(!1);if(O.useEffect(()=>{if(typeof window>"u")return;const s=window.matchMedia("(pointer: coarse)"),l=u=>r(u.matches);return l(s),s.addEventListener?s.addEventListener("change",l):s.addListener(l),()=>{s.removeEventListener?s.removeEventListener("change",l):s.removeListener(l)}},[]),!n)return null;const i=s=>({width:"44px",height:"44px",borderRadius:"50%",backgroundColor:s?"#4338ca":"white",color:s?"white":"#374151",border:s?"2px solid #312e81":"1px solid #d1d5db",boxShadow:"0 2px 4px -1px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.06)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",marginBottom:"8px",cursor:"pointer",position:"relative"});return C.jsxs("div",{className:"fixed bottom-32 left-6 z-50 flex flex-col items-center",children:[C.jsx("button",{style:i(t==="arc"),onClick:()=>e("arc"),title:"Arc Tool","data-testid":"toolbar-arc",className:"active:scale-95",children:C.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:C.jsx("path",{d:"M3 21l18-18M3 21l7-1M3 21l1-7"})})}),C.jsx("button",{style:i(t==="transition"),onClick:()=>e("transition"),title:"Transition Tool","data-testid":"toolbar-transition",className:"active:scale-95",children:C.jsx("div",{style:{width:"11px",height:"26px",backgroundColor:"currentColor"}})}),C.jsx("button",{style:i(t==="place"),onClick:()=>e("place"),title:"Place Tool","data-testid":"toolbar-place",className:"active:scale-95",children:C.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",border:"2px solid currentColor",backgroundColor:"transparent"}})}),C.jsx("button",{style:i(t==="select"),onClick:()=>e("select"),title:"Select Tool","data-testid":"toolbar-select",className:"active:scale-95",children:C.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:C.jsx("path",{d:"M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"})})})]})},yT=()=>{const{selectedElements:t,elements:e,setElements:n,setSelection:r,clearSelection:i,netMode:s,setClipboard:l,getClipboard:u,onClipboardMismatch:c,pasteMode:f,setPasteMode:p}=$t(),[m,w]=O.useState(!1);if(O.useEffect(()=>{if(typeof window>"u")return;const E=window.matchMedia("(pointer: coarse)"),N=I=>w(I.matches);return N(E),E.addEventListener?E.addEventListener("change",N):E.addListener(N),()=>{E.removeEventListener?E.removeEventListener("change",N):E.removeListener(N)}},[]),!m)return null;const y=(E=!1,N=!1)=>({width:"48px",height:"48px",borderRadius:"50%",backgroundColor:E?"#4338ca":N?"#dc2626":"white",color:E||N?"white":"#374151",border:E?"2px solid #312e81":N?"2px solid #991b1b":"2px solid #d1d5db",boxShadow:"0 4px 8px -2px rgba(0, 0, 0, 0.15), 0 2px 4px -1px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.1s ease-out, box-shadow 0.1s ease-out, background-color 0.1s ease-out",marginBottom:"10px",cursor:"pointer",position:"relative",WebkitTapHighlightColor:"transparent"}),x=t.length>0,b=u(),_=!!b&&!!b.payload,S=()=>{if(!x)return;const E=Du(e,t);typeof l=="function"&&l(E)},T=()=>{if(!x)return;const E=Du(e,t);typeof l=="function"&&l(E),n(N=>{const I=[],M=new Set;t.forEach(A=>{(A.type==="place"||A.type==="transition")&&I.push(A.id),A.type==="arc"&&M.add(A.id)});let L=N;return I.length>0&&(L=j4(L,I)),M.size>0&&(L={...L,arcs:L.arcs.filter(A=>!M.has(A.id))}),L}),i()},h=()=>{if(!_)return;const E=s||"pt",N=b.netMode||E;if(N&&E&&N!==E){typeof c=="function"?c(N,E,b):console.warn(`Blocked paste: shared clipboard contains ${N} net, editor mode is ${E}.`);return}p(!0)},k="touch-action-button";return C.jsxs(C.Fragment,{children:[C.jsx("style",{children:`
        .touch-action-button {
          -webkit-tap-highlight-color: transparent;
        }
        .touch-action-button:active {
          transform: scale(0.85) !important;
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
          filter: brightness(0.85);
        }
      `}),f&&C.jsx("div",{className:"fixed left-0 right-0 z-50 flex justify-center",style:{top:"72px"},children:C.jsxs("div",{style:{padding:"0.5rem 1rem",borderRadius:"0.25rem",backgroundColor:"#dbeafe",color:"#1d4ed8",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",maxWidth:"90%"},children:[C.jsx("span",{children:"Tap on canvas to paste"}),C.jsx("button",{onClick:()=>p(!1),style:{marginLeft:"1rem",fontWeight:"600"},children:""})]})}),C.jsxs("div",{className:"fixed top-24 left-4 z-50 flex flex-col items-center",children:[_&&C.jsx("button",{style:y(f),onClick:h,title:f?"Tap canvas to paste":"Paste","data-testid":"floating-action-paste",className:k,children:C.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),C.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]})}),x&&C.jsxs(C.Fragment,{children:[C.jsx("button",{style:y(!1),onClick:S,title:"Copy","data-testid":"floating-action-copy",className:k,children:C.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),C.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2-2v1"})]})}),C.jsx("button",{style:y(!1,!0),onClick:T,title:"Cut (replaces delete)","data-testid":"floating-action-cut",className:k,children:C.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[C.jsx("circle",{cx:"6",cy:"6",r:"3"}),C.jsx("circle",{cx:"6",cy:"18",r:"3"}),C.jsx("line",{x1:"20",y1:"4",x2:"8.12",y2:"15.88"}),C.jsx("line",{x1:"14.47",y1:"14.48",x2:"20",y2:"20"}),C.jsx("line",{x1:"8.12",y1:"8.12",x2:"12",y2:"12"})]})})]})]})]})},O5=O.forwardRef((t,e)=>{const[n,r]=O.useState(!1),[i,s]=O.useState([]),[l,u]=O.useState(!1),[c,f]=O.useState(!1),p=O.useRef(null),m=O.useRef({});O.useImperativeHandle(e,()=>({enable:()=>u(!0),disable:()=>u(!1),toggle:()=>u(_=>!_),isEnabled:()=>l,open:()=>{u(!0),r(!0)},close:()=>r(!1)}),[l]);const w=()=>{var _;(_=p.current)==null||_.scrollIntoView({behavior:"smooth"})};O.useEffect(()=>{if(!l)return;m.current={log:console.log,error:console.error,warn:console.warn,info:console.info};const _=(S,T)=>{const h=new Date().toLocaleTimeString(),k=T.map(E=>{if(typeof E=="object")try{return JSON.stringify(E,null,2)}catch{return String(E)}return String(E)}).join(" ");s(E=>[...E,{level:S,message:k,timestamp:h,id:Date.now()+Math.random()}])};return console.log=(...S)=>{m.current.log(...S),_("log",S)},console.error=(...S)=>{m.current.error(...S),_("error",S)},console.warn=(...S)=>{m.current.warn(...S),_("warn",S)},console.info=(...S)=>{m.current.info(...S),_("info",S)},()=>{console.log=m.current.log,console.error=m.current.error,console.warn=m.current.warn,console.info=m.current.info}},[l]),O.useEffect(()=>{n&&w()},[i,n]);const y=()=>{s([])},x=async()=>{if(i.length===0)return;const _=i.map(h=>`[${h.timestamp}] ${h.level.toUpperCase()}: ${h.message}`).join(`
`),T=`Debug Console Logs
Generated: ${new Date().toLocaleString()}
Total Messages: ${i.length}

`+_;try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(T),f(!0),setTimeout(()=>f(!1),2e3);else{const h=document.createElement("textarea");h.value=T,h.style.position="fixed",h.style.opacity="0",document.body.appendChild(h),h.select(),document.execCommand("copy"),document.body.removeChild(h),f(!0),setTimeout(()=>f(!1),2e3)}}catch(h){console.error("Failed to copy to clipboard:",h),alert("Failed to copy to clipboard. Please try selecting the text manually.")}},b=_=>{switch(_){case"error":return"text-red-600 bg-red-50 border-red-200";case"warn":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"info":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-700 bg-gray-50 border-gray-200"}};return l?C.jsxs(C.Fragment,{children:[C.jsxs("button",{onClick:()=>r(!n),className:"fixed bottom-4 right-4 z-[100] bg-purple-600 text-white px-4 py-3 rounded-full shadow-lg text-sm font-medium active:bg-purple-700 flex items-center gap-2",title:n?"Hide Console":"Show Console",children:[" ",n?"Hide":"Show"]}),n&&C.jsxs("div",{className:"fixed bottom-20 right-4 z-[99] w-[calc(100vw-2rem)] sm:w-96 max-w-md h-64 sm:h-80 bg-white border-2 border-purple-300 rounded-lg shadow-2xl flex flex-col",children:[C.jsxs("div",{className:"flex items-center justify-between p-2 bg-purple-600 text-white rounded-t-lg",children:[C.jsx("h3",{className:"text-sm font-semibold",children:"Debug Console"}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("button",{onClick:x,disabled:i.length===0,className:`px-2 py-1 rounded text-xs active:opacity-80 transition-all ${c?"bg-green-600 hover:bg-green-700":i.length===0?"bg-gray-500 opacity-50 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,title:"Copy All Logs to Clipboard",children:c?" Copied!":" Copy"}),C.jsx("button",{onClick:y,className:"px-2 py-1 bg-purple-700 hover:bg-purple-800 rounded text-xs active:bg-purple-900",title:"Clear Logs",children:"Clear"}),C.jsx("button",{onClick:()=>u(!1),className:"px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs active:bg-red-800",title:"Disable Console",children:""})]})]}),C.jsxs("div",{className:"flex-1 overflow-y-auto p-2 bg-gray-900 text-green-400 font-mono text-xs",children:[i.length===0?C.jsx("div",{className:"text-gray-500 italic",children:"No logs yet..."}):i.map(_=>C.jsx("div",{className:`mb-1 p-1 rounded border-l-2 ${b(_.level)}`,children:C.jsxs("div",{className:"flex items-start gap-2",children:[C.jsx("span",{className:"text-gray-500 text-[10px] flex-shrink-0",children:_.timestamp}),C.jsxs("span",{className:"text-[10px] font-semibold uppercase flex-shrink-0",children:[_.level,":"]}),C.jsx("span",{className:"flex-1 break-words whitespace-pre-wrap",children:_.message})]})},_.id)),C.jsx("div",{ref:p})]}),C.jsxs("div",{className:"p-2 bg-gray-100 border-t text-xs text-gray-600",children:[i.length," message",i.length!==1?"s":""]})]})]}):null});O5.displayName="DebugConsole";const p0=()=>({active:!1,touchId:null,startX:0,startY:0,lastX:0,lastY:0});function vT({MIN_ZOOM:t,MAX_ZOOM:e,zoomLevel:n,setZoomLevel:r,virtualCanvasDimensions:i,canvasScroll:s,setCanvasScroll:l,setContainerRef:u,isDragging:c=!1,isSelectionActiveRef:f=null}){const[p,m]=O.useState(null),w=O.useRef(null),y=O.useCallback(Z=>{w.current=Z,m(Z),u&&u(Z)},[u]),x=O.useRef(!1),b=O.useRef({active:!1}),_=O.useRef({active:!1,startX:0,startY:0,lastX:0,lastY:0}),[S,T]=O.useState(!1),h=O.useRef(p0()),k=O.useRef(n),E=O.useRef(!1),N=O.useRef(0),I=100,M=O.useRef(null),L=O.useRef([]),A=12;O.useEffect(()=>{k.current=n},[n]),O.useEffect(()=>{E.current=c,c||(N.current=performance.now())},[c]);const F=O.useCallback(Z=>Math.max(t,Math.min(e,Z)),[t,e]),D=O.useCallback((Z,te,de)=>{if(!w.current||!i)return;const fe=w.current,V=fe.clientWidth||1,K=fe.clientHeight||1,se=fe.getBoundingClientRect(),re=de?Math.min(Math.max(de.clientX-se.left,0),V):V/2,oe=de?Math.min(Math.max(de.clientY-se.top,0),K):K/2,ge=(s.x+re)/Z,he=(s.y+oe)/Z,be=Math.max(0,i.width-V/te),le=Math.max(0,i.height-K/te),ve=Math.max(0,Math.min(be,ge*te-re)),je=Math.max(0,Math.min(le,he*te-oe));l({x:ve,y:je})},[s,l,i]),U=O.useCallback((Z,te,de)=>{if(!w.current||!i||!Number.isFinite(de)||de<=0){console.log("[Inertia] applyPanDelta blocked:",{hasContainer:!!w.current,hasVirtualDims:!!i,zoomValue:de});return}const fe=w.current,V=fe.clientWidth||1,K=fe.clientHeight||1,se=Math.max(0,i.width-V/de),re=Math.max(0,i.height-K/de);l(oe=>{const ge=Math.max(0,Math.min(se,oe.x-Z/de)),he=Math.max(0,Math.min(re,oe.y-te/de));return ge===oe.x&&he===oe.y?oe:{x:ge,y:he}})},[l,i]),W=O.useCallback(()=>{const Z=L.current;if(Z.length<2)return{vx:0,vy:0};const te=Z[Z.length-1],de=Z[0],fe=te.time-de.time;if(fe<=10||fe>300){if(Z.length>=2){const se=Z.slice(-2),re=se[1].time-se[0].time;if(re>0&&re<=100)return{vx:(se[1].x-se[0].x)/re,vy:(se[1].y-se[0].y)/re}}return{vx:0,vy:0}}const V=(te.x-de.x)/fe,K=(te.y-de.y)/fe;return{vx:V,vy:K}},[]),G=O.useCallback((Z,te)=>{M.current&&cancelAnimationFrame(M.current),console.log("[Inertia] Animation starting with velocity:",{vx:Z.toFixed(4),vy:te.toFixed(4)});const de=.965,fe=.005,V=16;let K=Z,se=te,re=null,oe=0;const ge=he=>{if(console.log("[Inertia] animate() called, lastTime:",re,"currentTime:",he==null?void 0:he.toFixed(0)),re===null){re=he,console.log("[Inertia] First frame - initializing timing"),M.current=requestAnimationFrame(ge);return}oe++;const be=he-re;if(re=he,be<=0||be>100){M.current=requestAnimationFrame(ge);return}oe<=3&&console.log("[Inertia] Frame",oe,":",{deltaTime:be.toFixed(1),vx:K.toFixed(4),vy:se.toFixed(4)}),K*=Math.pow(de,be/V),se*=Math.pow(de,be/V);const le=Math.hypot(K,se);if(le<fe){console.log("[Inertia] Animation stopped after",oe,"frames, final speed:",le.toFixed(4)),M.current=null;return}const ve=K*be,je=se*be;oe<=3&&console.log("[Inertia] Applying delta:",{deltaX:ve.toFixed(2),deltaY:je.toFixed(2),zoom:k.current}),U(ve,je,k.current),M.current=requestAnimationFrame(ge)};M.current=requestAnimationFrame(ge),console.log("[Inertia] Animation frame requested")},[U]),z=O.useCallback(()=>{M.current&&(console.log("[Inertia] Stopping animation (RAF ID:",M.current,")"),cancelAnimationFrame(M.current),M.current=null)},[]),B=O.useCallback((Z,te)=>{r(de=>{const fe=F(Z(de));return fe!==de&&D(de,fe,te),fe})},[D,F,r]),j=O.useCallback((Z,te)=>{typeof Z!="number"||Number.isNaN(Z)||Z===0||B(de=>de+Z,te)},[B]),$=O.useCallback((Z,te)=>{typeof Z!="number"||Number.isNaN(Z)||B(()=>Z,te)},[B]),X=O.useCallback(Z=>{if(x.current){x.current=!1;return}l&&l({x:Z.target.scrollLeft,y:Z.target.scrollTop})},[l]);O.useEffect(()=>{w.current&&(x.current=!0,w.current.scrollLeft!==s.x&&(w.current.scrollLeft=s.x),w.current.scrollTop!==s.y&&(w.current.scrollTop=s.y))},[s,w]),O.useEffect(()=>{const Z=p;if(!Z)return;const te=re=>{const[oe,ge]=re;return Math.hypot(oe.clientX-ge.clientX,oe.clientY-ge.clientY)},de=re=>{const[oe,ge]=re;return{clientX:(oe.clientX+ge.clientX)/2,clientY:(oe.clientY+ge.clientY)/2}},fe=()=>{h.current=p0(),T(!1)},V=re=>{console.log("[Inertia] handleTouchStart called:",{touchCount:re.touches.length}),z();const oe=performance.now(),ge=L.current[L.current.length-1],he=ge?oe-ge.time:1/0;if(he>500&&(L.current=[],console.log("[Inertia] Cleared stale velocity history (gap:",he.toFixed(0),"ms)")),re.touches.length===2){fe();const be=de(re.touches),le=te(re.touches);b.current={active:!1,startDistance:le,startZoom:k.current,lastCenter:be},_.current={active:!1,startX:be.clientX,startY:be.clientY,lastX:be.clientX,lastY:be.clientY};return}if(re.touches.length===1){_.current={active:!1,startX:0,startY:0,lastX:0,lastY:0},b.current={active:!1};const le=performance.now()-N.current<I,ve=re.touches[0],je=h.current.touchId===null||h.current.touchId!==ve.identifier;je&&!E.current&&!le?(h.current={active:!1,touchId:ve.identifier,startX:ve.clientX,startY:ve.clientY,lastX:ve.clientX,lastY:ve.clientY},console.log("[Inertia] TouchStart tracked (new):",{touchId:ve.identifier})):je?(h.current={active:!1,touchId:ve.identifier,startX:ve.clientX,startY:ve.clientY,lastX:ve.clientX,lastY:ve.clientY},console.log("[Inertia] TouchStart (blocked but tracking):",{touchId:ve.identifier,isDragging:E.current,isInCooldown:le})):(h.current.lastX=ve.clientX,h.current.lastY=ve.clientY,console.log("[Inertia] TouchStart (continuing):",{touchId:ve.identifier}));return}fe(),b.current={active:!1},_.current={active:!1,startX:0,startY:0,lastX:0,lastY:0}},K=re=>{if(console.log("[Inertia] handleTouchMove called:",{touchCount:re.touches.length}),re.touches.length===2){fe();const oe=de(re.touches),ge=te(re.touches),he=b.current,be=he.startDistance>0?ge/he.startDistance:1;if(Math.abs(be-1)>.05){he.active||(b.current={...he,active:!0}),re.preventDefault(),re.stopPropagation();const je=F(he.startZoom*be);$(je,oe),b.current={...he,active:!0,startDistance:he.startDistance,startZoom:he.startZoom,lastCenter:oe}}else{const ze={..._.current},Xe=oe.clientX-ze.lastX,Yt=oe.clientY-ze.lastY,st=oe.clientX-ze.startX,Fn=oe.clientY-ze.startY,On=Math.hypot(st,Fn),ot=5;if(!ze.active&&On>ot&&(ze.active=!0,z()),ze.active){re.preventDefault(),re.stopPropagation(),U(Xe,Yt,k.current);const wr=performance.now();L.current.push({x:oe.clientX,y:oe.clientY,time:wr}),L.current.length>A&&L.current.shift()}_.current={...ze,lastX:oe.clientX,lastY:oe.clientY}}return}if(re.touches.length===1){const oe=(f==null?void 0:f.current)||!1,he=performance.now()-N.current<I,be=re.touches[0],le=h.current;if(le.touchId===null&&(le.touchId=be.identifier,le.lastX=be.clientX,le.lastY=be.clientY),be.identifier===le.touchId||le.touchId===null){const ve=performance.now();L.current.push({x:be.clientX,y:be.clientY,time:ve}),L.current.length>A&&L.current.shift(),console.log("[Inertia] Velocity tracked:",{touchId:be.identifier,panTouchId:le.touchId,historyLength:L.current.length,x:be.clientX,y:be.clientY})}else console.log("[Inertia] Touch ID mismatch:",{touchId:be.identifier,panTouchId:le.touchId});if(E.current||he||oe||be.identifier!==le.touchId&&le.touchId!==null)return;if(le.active){const ve=be.clientX-le.lastX,je=be.clientY-le.lastY;re.preventDefault(),re.stopPropagation(),U(ve,je,k.current)}le.lastX=be.clientX,le.lastY=be.clientY;return}fe(),b.current={active:!1},_.current={active:!1,startX:0,startY:0,lastX:0,lastY:0}},se=re=>{var le,ve;if(console.log("[Inertia] handleTouchEnd called:",{remainingTouches:((le=re.touches)==null?void 0:le.length)||0,changedTouches:((ve=re.changedTouches)==null?void 0:ve.length)||0,velocityHistoryLength:L.current.length}),re.touches&&re.touches.length>0){console.log("[Inertia] Touch end but other touches still active, skipping");return}const oe=_.current.active||h.current.active,ge=[...L.current];let he={vx:0,vy:0};if(ge.length>=2){const je=L.current;L.current=ge,he=W(),L.current=je;const ze=Math.hypot(he.vx,he.vy),Xe=.01;console.log("[Inertia] Touch end:",{historyLength:ge.length,velocity:{vx:he.vx.toFixed(4),vy:he.vy.toFixed(4)},speed:ze.toFixed(4),panWasActive:oe,willStart:ze>Xe}),ze>Xe?(console.log("[Inertia] Starting animation"),G(he.vx,he.vy)):console.log("[Inertia] Speed too low:",ze,"<",Xe)}else console.log("[Inertia] No velocity history:",ge.length);fe(),b.current={active:!1},_.current={active:!1,startX:0,startY:0,lastX:0,lastY:0},setTimeout(()=>{M.current||(L.current=[])},100)};return Z.addEventListener("touchstart",V,{passive:!1}),Z.addEventListener("touchmove",K,{passive:!1}),Z.addEventListener("touchend",se,{passive:!1}),Z.addEventListener("touchcancel",se,{passive:!1}),()=>{Z.removeEventListener("touchstart",V),Z.removeEventListener("touchmove",K),Z.removeEventListener("touchend",se),Z.removeEventListener("touchcancel",se)}},[U,F,$,c,f,p,W,G,z]),O.useEffect(()=>()=>{M.current&&(cancelAnimationFrame(M.current),M.current=null)},[]);const ee=O.useRef(c);O.useEffect(()=>{const Z=ee.current;ee.current=c,Z!==c&&(c&&(z(),h.current=p0(),T(!1),b.current={active:!1},_.current={active:!1,startX:0,startY:0,lastX:0,lastY:0}),E.current=c,c||(N.current=performance.now()))},[c,z]);const ne=O.useCallback(()=>{const Z=h.current;Z.touchId!==null&&!Z.active&&(console.log("[Inertia] activateSingleFingerPan called - activating pan"),Z.active=!0,T(!0),z())},[z]);return{localCanvasContainerDivRef:y,handleZoom:j,handleNativeCanvasScroll:X,isSingleFingerPanningActive:S,activateSingleFingerPan:ne}}function xT({elements:t,selectedElements:e,mode:n,clipboardRef:r,simulationSettings:i,simulatorCore:s}){try{if(t&&(window.__PETRI_NET_STATE__={places:t.places,transitions:t.transitions,arcs:t.arcs,selectedElements:e||[]}),typeof n<"u"&&(window.__PETRI_NET_MODE__=n),r&&(window.__PETRI_NET_CLIPBOARD__=r),i){const u=!!(i!=null&&i.batchMode),c=!!(i!=null&&i.limitIterations),f=Number(i==null?void 0:i.maxIterations),p=Number.isFinite(f)&&f>0?Math.floor(f):2e5,m=!!(i!=null&&i.useNonVisualRun||u);window.__PETRI_NET_NON_VISUAL_RUN__=m,window.__PETRI_NET_SETTINGS__={...window.__PETRI_NET_SETTINGS__||{},batchMode:u,limitIterations:c,maxIterations:p}}s&&!window.__PETRI_NET_SIM_CORE__&&(window.__PETRI_NET_SIM_CORE__=s)}catch{}}const wT=()=>{const{stageDimensions:e,virtualCanvasDimensions:n,canvasScroll:r,setCanvasScroll:i,zoomLevel:s,setZoomLevel:l,gridSnappingEnabled:u,toggleGridSnapping:c,MIN_ZOOM:f,MAX_ZOOM:p,appRef:m,containerRef:w,setContainerRef:y,stageRef:x}=Go(),{elements:b,setElements:_,selectedElement:S,setSelectedElement:T,selectedElements:h,mode:k,setMode:E,arcStart:N,setArcStart:I,tempArcEnd:M,setTempArcEnd:L,clearSelection:A,setSelection:F,isSettingsDialogOpen:D,setIsSettingsDialogOpen:U,simulationSettings:W,setSimulationSettings:G,historyManagerRef:z,canUndo:B,canRedo:j,handleUndo:$,handleRedo:X,updateHistory:ee,snapToGrid:ne,resetEditor:Z,simulatorCore:te,enabledTransitionIds:de,clipboardRef:fe,setClipboard:V,getClipboard:K,isShiftPressedRef:se}=$t(),[re,oe]=O.useState(!1);O.useEffect(()=>{typeof SharedArrayBuffer>"u"?console.warn(" SharedArrayBuffer is not available. This is required for Z3 workers in batch mode. The COOP/COEP service worker should enable this. If this warning persists, the service worker may not be active. Try refreshing the page or checking browser console for service worker errors."):console.log(" SharedArrayBuffer is available - Z3 workers should work correctly")},[]);const{isDragging:ge}=$t(),he=O.useRef(!1),be=O.useRef(null),{localCanvasContainerDivRef:le,handleZoom:ve,handleNativeCanvasScroll:je,isSingleFingerPanningActive:ze,activateSingleFingerPan:Xe}=vT({MIN_ZOOM:f,MAX_ZOOM:p,zoomLevel:s,setZoomLevel:l,virtualCanvasDimensions:n,canvasScroll:r,setCanvasScroll:i,setContainerRef:y,isDragging:ge,isSelectionActiveRef:he}),{handleDeleteElement:Yt,clearAllElements:st}=Bg();O.useEffect(()=>{xT({elements:b,selectedElements:h,mode:k,clipboardRef:fe,simulationSettings:W,simulatorCore:te})},[b.places,b.transitions,b.arcs,h,k,W==null?void 0:W.useNonVisualRun,W==null?void 0:W.batchMode,W==null?void 0:W.limitIterations,W==null?void 0:W.maxIterations,fe,te]);const{pasteMode:Fn,setPasteMode:On}=$t();return F4({elements:b,setElements:_,selectedElement:S,selectedElements:h,clearSelection:A,setSelection:F,clipboardRef:fe,netMode:(W==null?void 0:W.netMode)||"pt",setClipboard:V,getClipboard:K,onClipboardMismatch:void 0,handleUndo:$,handleRedo:X,setMode:E,arcStart:N,setArcStart:I,setTempArcEnd:L,setSelectedElement:T,isShiftPressedRef:se,pasteMode:Fn,setPasteMode:On}),C.jsxs("div",{ref:m,className:"app-container h-screen max-h-screen overflow-hidden",tabIndex:-1,children:[C.jsx("button",{className:"fixed top-2.5 right-2 z-50 p-2 bg-white rounded-md shadow-md lg:hidden",onClick:()=>oe(!re),children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),C.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 bg-white",onWheel:ot=>ot.stopPropagation(),children:C.jsx(ES,{mode:k,setMode:E,onNew:st,onUndo:$,canUndo:B,onRedo:X,canRedo:j,gridSnappingEnabled:u,onToggleGridSnapping:c,onOpenSettings:()=>U(!0),elements:b,setElements:_,updateHistory:ee,simulationSettings:W,setSimulationSettings:G,resetEditor:Z,debugConsoleRef:be})}),C.jsx("div",{className:`lg:hidden fixed inset-0 z-20 bg-black transition-opacity duration-300 ease-in-out ${re?"opacity-40 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>oe(!1)}),C.jsxs("div",{className:`fixed w-80 right-0 top-16 bottom-0 z-30 bg-gray-100/90 backdrop-blur-sm shadow-lg pt-4 flex flex-col overflow-hidden transform transition-transform duration-300 ease-in-out ${re?"translate-x-0":"translate-x-full"} lg:translate-x-0`,onWheel:ot=>ot.stopPropagation(),children:[C.jsx("div",{className:"overflow-y-auto pr-2",children:C.jsx(DS,{selectedElement:S,elements:b,setElements:_,updateHistory:ee,simulationSettings:W})}),C.jsx("div",{className:"flex-1 overflow-y-auto pr-2 border-t-2 border-gray-200",children:C.jsx(BS,{elements:b,enabledTransitionIds:de})}),C.jsx("div",{className:"hidden lg:block border-t-2 border-gray-200 mt-auto sticky bottom-0 bg-gray-100",children:C.jsx(uy,{})})]}),C.jsxs("div",{className:"fixed top-20 left-0 bottom-0 right-0 lg:right-80 transition-all duration-300",children:[C.jsx("div",{className:"absolute inset-0 overflow-hidden stage-container bg-gray-200 dark:bg-gray-700","data-testid":"canvas-container",ref:le,onScroll:je,children:C.jsx(gT,{handleZoom:ve,ZOOM_STEP:.1,isSingleFingerPanningActive:ze,isSelectionActiveRef:he,activateSingleFingerPan:Xe})}),C.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-40",children:C.jsx(uy,{isMobile:!0})}),C.jsxs("div",{className:"hidden lg:flex fixed top-24 right-[336px] z-10 flex-col space-y-2 pointer-events-auto",children:[C.jsx("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none",onClick:()=>ve(.1),title:"Zoom In",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),C.jsx("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none",onClick:()=>ve(-.1),title:"Zoom Out",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 12H6"})})}),C.jsxs("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none text-xs font-mono",onClick:()=>{l(1),i({x:0,y:0})},title:"Reset Zoom",children:[Math.round(s*100),"%"]})]}),C.jsx(mT,{}),C.jsx(yT,{}),C.jsx(O5,{ref:be})]}),C.jsx(GS,{isOpen:D,onClose:()=>U(!1)})]})},ST=()=>C.jsx(bw,{children:C.jsx(bS,{children:C.jsx(CS,{children:C.jsx(wT,{})})})});g0.createRoot(document.getElementById("root")).render(C.jsx(tn.StrictMode,{children:C.jsx(ST,{})}));export{Lo as a,Yn as b,ba as c,Co as d,pr as e,Lw as f,Aw as g,kT as h,_T as i,xl as j,Iw as p};
//# sourceMappingURL=index-273fdbf4.js.map
