(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var yb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function ul(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function vb(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var q2={exports:{}},jc={},J2={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cl=Symbol.for("react.element"),W6=Symbol.for("react.portal"),$6=Symbol.for("react.fragment"),H6=Symbol.for("react.strict_mode"),Y6=Symbol.for("react.profiler"),X6=Symbol.for("react.provider"),K6=Symbol.for("react.context"),Q6=Symbol.for("react.forward_ref"),Z6=Symbol.for("react.suspense"),q6=Symbol.for("react.memo"),J6=Symbol.for("react.lazy"),Sm=Symbol.iterator;function ex(t){return t===null||typeof t!="object"?null:(t=Sm&&t[Sm]||t["@@iterator"],typeof t=="function"?t:null)}var ev={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tv=Object.assign,nv={};function bo(t,e,n){this.props=t,this.context=e,this.refs=nv,this.updater=n||ev}bo.prototype.isReactComponent={};bo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};bo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function rv(){}rv.prototype=bo.prototype;function vp(t,e,n){this.props=t,this.context=e,this.refs=nv,this.updater=n||ev}var xp=vp.prototype=new rv;xp.constructor=vp;tv(xp,bo.prototype);xp.isPureReactComponent=!0;var km=Array.isArray,iv=Object.prototype.hasOwnProperty,wp={current:null},sv={key:!0,ref:!0,__self:!0,__source:!0};function ov(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)iv.call(e,r)&&!sv.hasOwnProperty(r)&&(i[r]=e[r]);var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){for(var u=Array(c),f=0;f<c;f++)u[f]=arguments[f+2];i.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)i[r]===void 0&&(i[r]=c[r]);return{$$typeof:cl,type:t,key:s,ref:l,props:i,_owner:wp.current}}function tx(t,e){return{$$typeof:cl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function _p(t){return typeof t=="object"&&t!==null&&t.$$typeof===cl}function nx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Cm=/\/+/g;function lh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nx(""+t.key):e.toString(36)}function zu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case cl:case W6:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+lh(l,0):r,km(i)?(n="",t!=null&&(n=t.replace(Cm,"$&/")+"/"),zu(i,e,n,"",function(f){return f})):i!=null&&(_p(i)&&(i=tx(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Cm,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",km(t))for(var c=0;c<t.length;c++){s=t[c];var u=r+lh(s,c);l+=zu(s,e,n,u,i)}else if(u=ex(t),typeof u=="function")for(t=u.call(t),c=0;!(s=t.next()).done;)s=s.value,u=r+lh(s,c++),l+=zu(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function gu(t,e,n){if(t==null)return t;var r=[],i=0;return zu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function rx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var on={current:null},Bu={transition:null},ix={ReactCurrentDispatcher:on,ReactCurrentBatchConfig:Bu,ReactCurrentOwner:wp};function av(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:gu,forEach:function(t,e,n){gu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return gu(t,function(){e++}),e},toArray:function(t){return gu(t,function(e){return e})||[]},only:function(t){if(!_p(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=bo;Le.Fragment=$6;Le.Profiler=Y6;Le.PureComponent=vp;Le.StrictMode=H6;Le.Suspense=Z6;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ix;Le.act=av;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=tv({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=wp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)iv.call(e,u)&&!sv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var f=0;f<u;f++)c[f]=arguments[f+2];r.children=c}return{$$typeof:cl,type:t.type,key:i,ref:s,props:r,_owner:l}};Le.createContext=function(t){return t={$$typeof:K6,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:X6,_context:t},t.Consumer=t};Le.createElement=ov;Le.createFactory=function(t){var e=ov.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:Q6,render:t}};Le.isValidElement=_p;Le.lazy=function(t){return{$$typeof:J6,_payload:{_status:-1,_result:t},_init:rx}};Le.memo=function(t,e){return{$$typeof:q6,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Bu.transition;Bu.transition={};try{t()}finally{Bu.transition=e}};Le.unstable_act=av;Le.useCallback=function(t,e){return on.current.useCallback(t,e)};Le.useContext=function(t){return on.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return on.current.useDeferredValue(t)};Le.useEffect=function(t,e){return on.current.useEffect(t,e)};Le.useId=function(){return on.current.useId()};Le.useImperativeHandle=function(t,e,n){return on.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return on.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return on.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return on.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return on.current.useReducer(t,e,n)};Le.useRef=function(t){return on.current.useRef(t)};Le.useState=function(t){return on.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return on.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return on.current.useTransition()};Le.version="18.3.1";J2.exports=Le;var z=J2.exports;const Zt=ul(z);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sx=z,ox=Symbol.for("react.element"),ax=Symbol.for("react.fragment"),lx=Object.prototype.hasOwnProperty,ux=sx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cx={key:!0,ref:!0,__self:!0,__source:!0};function lv(t,e,n){var r,i={},s=null,l=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)lx.call(e,r)&&!cx.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:ox,type:t,key:s,ref:l,props:i,_owner:ux.current}}jc.Fragment=ax;jc.jsx=lv;jc.jsxs=lv;q2.exports=jc;var P=q2.exports,a0={},uv={exports:{}},Nn={},cv={exports:{}},dv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,X){var H=D.length;D.push(X);e:for(;0<H;){var re=H-1>>>1,K=D[re];if(0<i(K,X))D[re]=X,D[H]=K,H=re;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var X=D[0],H=D.pop();if(H!==X){D[0]=H;e:for(var re=0,K=D.length,ne=K>>>1;re<ne;){var te=2*(re+1)-1,he=D[te],de=te+1,B=D[de];if(0>i(he,H))de<K&&0>i(B,he)?(D[re]=B,D[de]=H,re=de):(D[re]=he,D[te]=H,re=te);else if(de<K&&0>i(B,H))D[re]=B,D[de]=H,re=de;else break e}}return X}function i(D,X){var H=D.sortIndex-X.sortIndex;return H!==0?H:D.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],f=[],p=1,m=null,w=3,y=!1,x=!1,C=!1,S=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function h(D){for(var X=n(f);X!==null;){if(X.callback===null)r(f);else if(X.startTime<=D)r(f),X.sortIndex=X.expirationTime,e(u,X);else break;X=n(f)}}function k(D){if(C=!1,h(D),!x)if(n(u)!==null)x=!0,V(T);else{var X=n(f);X!==null&&$(k,X.startTime-D)}}function T(D,X){x=!1,C&&(C=!1,_(M),M=-1),y=!0;var H=w;try{for(h(X),m=n(u);m!==null&&(!(m.expirationTime>X)||D&&!R());){var re=m.callback;if(typeof re=="function"){m.callback=null,w=m.priorityLevel;var K=re(m.expirationTime<=X);X=t.unstable_now(),typeof K=="function"?m.callback=K:m===n(u)&&r(u),h(X)}else r(u);m=n(u)}if(m!==null)var ne=!0;else{var te=n(f);te!==null&&$(k,te.startTime-X),ne=!1}return ne}finally{m=null,w=H,y=!1}}var N=!1,I=null,M=-1,L=5,A=-1;function R(){return!(t.unstable_now()-A<L)}function j(){if(I!==null){var D=t.unstable_now();A=D;var X=!0;try{X=I(!0,D)}finally{X?G():(N=!1,I=null)}}else N=!1}var G;if(typeof E=="function")G=function(){E(j)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,O=U.port2;U.port1.onmessage=j,G=function(){O.postMessage(null)}}else G=function(){S(j,0)};function V(D){I=D,N||(N=!0,G())}function $(D,X){M=S(function(){D(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){x||y||(x=!0,V(T))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(D){switch(w){case 1:case 2:case 3:var X=3;break;default:X=w}var H=w;w=X;try{return D()}finally{w=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,X){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var H=w;w=D;try{return X()}finally{w=H}},t.unstable_scheduleCallback=function(D,X,H){var re=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?re+H:re):H=re,D){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=H+K,D={id:p++,callback:X,priorityLevel:D,startTime:H,expirationTime:K,sortIndex:-1},H>re?(D.sortIndex=H,e(f,D),n(u)===null&&D===n(f)&&(C?(_(M),M=-1):C=!0,$(k,H-re))):(D.sortIndex=K,e(u,D),x||y||(x=!0,V(T))),D},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(D){var X=w;return function(){var H=w;w=X;try{return D.apply(this,arguments)}finally{w=H}}}})(dv);cv.exports=dv;var ba=cv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dx=z,bn=ba;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fv=new Set,Ua={};function ms(t,e){mo(t,e),mo(t+"Capture",e)}function mo(t,e){for(Ua[t]=e,t=0;t<e.length;t++)fv.add(e[t])}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l0=Object.prototype.hasOwnProperty,fx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tm={},Em={};function hx(t){return l0.call(Em,t)?!0:l0.call(Tm,t)?!1:fx.test(t)?Em[t]=!0:(Tm[t]=!0,!1)}function px(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gx(t,e,n,r){if(e===null||typeof e>"u"||px(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function an(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var Ut={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ut[t]=new an(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ut[e]=new an(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ut[t]=new an(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ut[t]=new an(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ut[t]=new an(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ut[t]=new an(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ut[t]=new an(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ut[t]=new an(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ut[t]=new an(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sp=/[\-:]([a-z])/g;function kp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sp,kp);Ut[e]=new an(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sp,kp);Ut[e]=new an(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sp,kp);Ut[e]=new an(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ut[t]=new an(t,1,!1,t.toLowerCase(),null,!1,!1)});Ut.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ut[t]=new an(t,1,!1,t.toLowerCase(),null,!0,!0)});function Cp(t,e,n,r){var i=Ut.hasOwnProperty(e)?Ut[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gx(e,n,i,r)&&(n=null),r||i===null?hx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Jr=dx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mu=Symbol.for("react.element"),Xs=Symbol.for("react.portal"),Ks=Symbol.for("react.fragment"),Tp=Symbol.for("react.strict_mode"),u0=Symbol.for("react.profiler"),hv=Symbol.for("react.provider"),pv=Symbol.for("react.context"),Ep=Symbol.for("react.forward_ref"),c0=Symbol.for("react.suspense"),d0=Symbol.for("react.suspense_list"),bp=Symbol.for("react.memo"),yi=Symbol.for("react.lazy"),gv=Symbol.for("react.offscreen"),bm=Symbol.iterator;function oa(t){return t===null||typeof t!="object"?null:(t=bm&&t[bm]||t["@@iterator"],typeof t=="function"?t:null)}var ct=Object.assign,uh;function Sa(t){if(uh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);uh=e&&e[1]||""}return`
`+uh+t}var ch=!1;function dh(t,e){if(!t||ch)return"";ch=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var r=f}Reflect.construct(t,[],e)}else{try{e.call()}catch(f){r=f}t.call(e.prototype)}else{try{throw Error()}catch(f){r=f}t()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,c=s.length-1;1<=l&&0<=c&&i[l]!==s[c];)c--;for(;1<=l&&0<=c;l--,c--)if(i[l]!==s[c]){if(l!==1||c!==1)do if(l--,c--,0>c||i[l]!==s[c]){var u=`
`+i[l].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=l&&0<=c);break}}}finally{ch=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Sa(t):""}function mx(t){switch(t.tag){case 5:return Sa(t.type);case 16:return Sa("Lazy");case 13:return Sa("Suspense");case 19:return Sa("SuspenseList");case 0:case 2:case 15:return t=dh(t.type,!1),t;case 11:return t=dh(t.type.render,!1),t;case 1:return t=dh(t.type,!0),t;default:return""}}function f0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ks:return"Fragment";case Xs:return"Portal";case u0:return"Profiler";case Tp:return"StrictMode";case c0:return"Suspense";case d0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pv:return(t.displayName||"Context")+".Consumer";case hv:return(t._context.displayName||"Context")+".Provider";case Ep:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case bp:return e=t.displayName||null,e!==null?e:f0(t.type)||"Memo";case yi:e=t._payload,t=t._init;try{return f0(t(e))}catch{}}return null}function yx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return f0(e);case 8:return e===Tp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ii(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mv(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function vx(t){var e=mv(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yu(t){t._valueTracker||(t._valueTracker=vx(t))}function yv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=mv(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function rc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function h0(t,e){var n=e.checked;return ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Nm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ii(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vv(t,e){e=e.checked,e!=null&&Cp(t,"checked",e,!1)}function p0(t,e){vv(t,e);var n=Ii(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?g0(t,e.type,n):e.hasOwnProperty("defaultValue")&&g0(t,e.type,Ii(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Pm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function g0(t,e,n){(e!=="number"||rc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ka=Array.isArray;function ao(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ii(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function m0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Mm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(ka(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ii(n)}}function xv(t,e){var n=Ii(e.value),r=Ii(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Am(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function wv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function y0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?wv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vu,_v=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(vu=vu||document.createElement("div"),vu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ga(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Na={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xx=["Webkit","ms","Moz","O"];Object.keys(Na).forEach(function(t){xx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Na[e]=Na[t]})});function Sv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Na.hasOwnProperty(t)&&Na[t]?(""+e).trim():e+"px"}function kv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Sv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var wx=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function v0(t,e){if(e){if(wx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function x0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var w0=null;function Np(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var _0=null,lo=null,uo=null;function Im(t){if(t=hl(t)){if(typeof _0!="function")throw Error(se(280));var e=t.stateNode;e&&(e=Uc(e),_0(t.stateNode,t.type,e))}}function Cv(t){lo?uo?uo.push(t):uo=[t]:lo=t}function Tv(){if(lo){var t=lo,e=uo;if(uo=lo=null,Im(t),e)for(t=0;t<e.length;t++)Im(e[t])}}function Ev(t,e){return t(e)}function bv(){}var fh=!1;function Nv(t,e,n){if(fh)return t(e,n);fh=!0;try{return Ev(t,e,n)}finally{fh=!1,(lo!==null||uo!==null)&&(bv(),Tv())}}function Va(t,e){var n=t.stateNode;if(n===null)return null;var r=Uc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var S0=!1;if(Kr)try{var aa={};Object.defineProperty(aa,"passive",{get:function(){S0=!0}}),window.addEventListener("test",aa,aa),window.removeEventListener("test",aa,aa)}catch{S0=!1}function _x(t,e,n,r,i,s,l,c,u){var f=Array.prototype.slice.call(arguments,3);try{e.apply(n,f)}catch(p){this.onError(p)}}var Pa=!1,ic=null,sc=!1,k0=null,Sx={onError:function(t){Pa=!0,ic=t}};function kx(t,e,n,r,i,s,l,c,u){Pa=!1,ic=null,_x.apply(Sx,arguments)}function Cx(t,e,n,r,i,s,l,c,u){if(kx.apply(this,arguments),Pa){if(Pa){var f=ic;Pa=!1,ic=null}else throw Error(se(198));sc||(sc=!0,k0=f)}}function ys(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Pv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Rm(t){if(ys(t)!==t)throw Error(se(188))}function Tx(t){var e=t.alternate;if(!e){if(e=ys(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Rm(i),t;if(s===r)return Rm(i),e;s=s.sibling}throw Error(se(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,c=i.child;c;){if(c===n){l=!0,n=i,r=s;break}if(c===r){l=!0,r=i,n=s;break}c=c.sibling}if(!l){for(c=s.child;c;){if(c===n){l=!0,n=s,r=i;break}if(c===r){l=!0,r=s,n=i;break}c=c.sibling}if(!l)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function Mv(t){return t=Tx(t),t!==null?Av(t):null}function Av(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Av(t);if(e!==null)return e;t=t.sibling}return null}var Iv=bn.unstable_scheduleCallback,Lm=bn.unstable_cancelCallback,Ex=bn.unstable_shouldYield,bx=bn.unstable_requestPaint,yt=bn.unstable_now,Nx=bn.unstable_getCurrentPriorityLevel,Pp=bn.unstable_ImmediatePriority,Rv=bn.unstable_UserBlockingPriority,oc=bn.unstable_NormalPriority,Px=bn.unstable_LowPriority,Lv=bn.unstable_IdlePriority,Oc=null,Nr=null;function Mx(t){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Oc,t,void 0,(t.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:Rx,Ax=Math.log,Ix=Math.LN2;function Rx(t){return t>>>=0,t===0?32:31-(Ax(t)/Ix|0)|0}var xu=64,wu=4194304;function Ca(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ac(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var c=l&~i;c!==0?r=Ca(c):(s&=l,s!==0&&(r=Ca(s)))}else l=n&~i,l!==0?r=Ca(l):s!==0&&(r=Ca(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ur(e),i=1<<n,r|=t[n],e&=~i;return r}function Lx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-ur(s),c=1<<l,u=i[l];u===-1?(!(c&n)||c&r)&&(i[l]=Lx(c,e)):u<=e&&(t.expiredLanes|=c),s&=~c}}function C0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Fv(){var t=xu;return xu<<=1,!(xu&4194240)&&(xu=64),t}function hh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function dl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ur(e),t[e]=n}function jx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ur(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Mp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ur(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var We=0;function jv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ov,Ap,Dv,zv,Bv,T0=!1,_u=[],Ci=null,Ti=null,Ei=null,Wa=new Map,$a=new Map,wi=[],Ox="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fm(t,e){switch(t){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":Ei=null;break;case"pointerover":case"pointerout":Wa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$a.delete(e.pointerId)}}function la(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=hl(e),e!==null&&Ap(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Dx(t,e,n,r,i){switch(e){case"focusin":return Ci=la(Ci,t,e,n,r,i),!0;case"dragenter":return Ti=la(Ti,t,e,n,r,i),!0;case"mouseover":return Ei=la(Ei,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Wa.set(s,la(Wa.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,$a.set(s,la($a.get(s)||null,t,e,n,r,i)),!0}return!1}function Uv(t){var e=os(t.target);if(e!==null){var n=ys(e);if(n!==null){if(e=n.tag,e===13){if(e=Pv(n),e!==null){t.blockedOn=e,Bv(t.priority,function(){Dv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Uu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=E0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);w0=r,n.target.dispatchEvent(r),w0=null}else return e=hl(n),e!==null&&Ap(e),t.blockedOn=n,!1;e.shift()}return!0}function jm(t,e,n){Uu(t)&&n.delete(e)}function zx(){T0=!1,Ci!==null&&Uu(Ci)&&(Ci=null),Ti!==null&&Uu(Ti)&&(Ti=null),Ei!==null&&Uu(Ei)&&(Ei=null),Wa.forEach(jm),$a.forEach(jm)}function ua(t,e){t.blockedOn===e&&(t.blockedOn=null,T0||(T0=!0,bn.unstable_scheduleCallback(bn.unstable_NormalPriority,zx)))}function Ha(t){function e(i){return ua(i,t)}if(0<_u.length){ua(_u[0],t);for(var n=1;n<_u.length;n++){var r=_u[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ci!==null&&ua(Ci,t),Ti!==null&&ua(Ti,t),Ei!==null&&ua(Ei,t),Wa.forEach(e),$a.forEach(e),n=0;n<wi.length;n++)r=wi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wi.length&&(n=wi[0],n.blockedOn===null);)Uv(n),n.blockedOn===null&&wi.shift()}var co=Jr.ReactCurrentBatchConfig,lc=!0;function Bx(t,e,n,r){var i=We,s=co.transition;co.transition=null;try{We=1,Ip(t,e,n,r)}finally{We=i,co.transition=s}}function Ux(t,e,n,r){var i=We,s=co.transition;co.transition=null;try{We=4,Ip(t,e,n,r)}finally{We=i,co.transition=s}}function Ip(t,e,n,r){if(lc){var i=E0(t,e,n,r);if(i===null)kh(t,e,r,uc,n),Fm(t,r);else if(Dx(i,t,e,n,r))r.stopPropagation();else if(Fm(t,r),e&4&&-1<Ox.indexOf(t)){for(;i!==null;){var s=hl(i);if(s!==null&&Ov(s),s=E0(t,e,n,r),s===null&&kh(t,e,r,uc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else kh(t,e,r,null,n)}}var uc=null;function E0(t,e,n,r){if(uc=null,t=Np(r),t=os(t),t!==null)if(e=ys(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Pv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return uc=t,null}function Gv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Nx()){case Pp:return 1;case Rv:return 4;case oc:case Px:return 16;case Lv:return 536870912;default:return 16}default:return 16}}var Si=null,Rp=null,Gu=null;function Vv(){if(Gu)return Gu;var t,e=Rp,n=e.length,r,i="value"in Si?Si.value:Si.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return Gu=i.slice(t,1<r?1-r:void 0)}function Vu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Su(){return!0}function Om(){return!1}function Pn(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(s):s[c]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Su:Om,this.isPropagationStopped=Om,this}return ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Su)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Su)},persist:function(){},isPersistent:Su}),e}var No={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lp=Pn(No),fl=ct({},No,{view:0,detail:0}),Gx=Pn(fl),ph,gh,ca,Dc=ct({},fl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ca&&(ca&&t.type==="mousemove"?(ph=t.screenX-ca.screenX,gh=t.screenY-ca.screenY):gh=ph=0,ca=t),ph)},movementY:function(t){return"movementY"in t?t.movementY:gh}}),Dm=Pn(Dc),Vx=ct({},Dc,{dataTransfer:0}),Wx=Pn(Vx),$x=ct({},fl,{relatedTarget:0}),mh=Pn($x),Hx=ct({},No,{animationName:0,elapsedTime:0,pseudoElement:0}),Yx=Pn(Hx),Xx=ct({},No,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Kx=Pn(Xx),Qx=ct({},No,{data:0}),zm=Pn(Qx),Zx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function e8(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Jx[t])?!!e[t]:!1}function Fp(){return e8}var t8=ct({},fl,{key:function(t){if(t.key){var e=Zx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Vu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?qx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fp,charCode:function(t){return t.type==="keypress"?Vu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Vu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),n8=Pn(t8),r8=ct({},Dc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bm=Pn(r8),i8=ct({},fl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fp}),s8=Pn(i8),o8=ct({},No,{propertyName:0,elapsedTime:0,pseudoElement:0}),a8=Pn(o8),l8=ct({},Dc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),u8=Pn(l8),c8=[9,13,27,32],jp=Kr&&"CompositionEvent"in window,Ma=null;Kr&&"documentMode"in document&&(Ma=document.documentMode);var d8=Kr&&"TextEvent"in window&&!Ma,Wv=Kr&&(!jp||Ma&&8<Ma&&11>=Ma),Um=String.fromCharCode(32),Gm=!1;function $v(t,e){switch(t){case"keyup":return c8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qs=!1;function f8(t,e){switch(t){case"compositionend":return Hv(e);case"keypress":return e.which!==32?null:(Gm=!0,Um);case"textInput":return t=e.data,t===Um&&Gm?null:t;default:return null}}function h8(t,e){if(Qs)return t==="compositionend"||!jp&&$v(t,e)?(t=Vv(),Gu=Rp=Si=null,Qs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Wv&&e.locale!=="ko"?null:e.data;default:return null}}var p8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!p8[t.type]:e==="textarea"}function Yv(t,e,n,r){Cv(r),e=cc(e,"onChange"),0<e.length&&(n=new Lp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Aa=null,Ya=null;function g8(t){i3(t,0)}function zc(t){var e=Js(t);if(yv(e))return t}function m8(t,e){if(t==="change")return e}var Xv=!1;if(Kr){var yh;if(Kr){var vh="oninput"in document;if(!vh){var Wm=document.createElement("div");Wm.setAttribute("oninput","return;"),vh=typeof Wm.oninput=="function"}yh=vh}else yh=!1;Xv=yh&&(!document.documentMode||9<document.documentMode)}function $m(){Aa&&(Aa.detachEvent("onpropertychange",Kv),Ya=Aa=null)}function Kv(t){if(t.propertyName==="value"&&zc(Ya)){var e=[];Yv(e,Ya,t,Np(t)),Nv(g8,e)}}function y8(t,e,n){t==="focusin"?($m(),Aa=e,Ya=n,Aa.attachEvent("onpropertychange",Kv)):t==="focusout"&&$m()}function v8(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return zc(Ya)}function x8(t,e){if(t==="click")return zc(e)}function w8(t,e){if(t==="input"||t==="change")return zc(e)}function _8(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fr=typeof Object.is=="function"?Object.is:_8;function Xa(t,e){if(fr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!l0.call(e,i)||!fr(t[i],e[i]))return!1}return!0}function Hm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ym(t,e){var n=Hm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hm(n)}}function Qv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Qv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Zv(){for(var t=window,e=rc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=rc(t.document)}return e}function Op(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function S8(t){var e=Zv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Qv(n.ownerDocument.documentElement,n)){if(r!==null&&Op(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Ym(n,s);var l=Ym(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var k8=Kr&&"documentMode"in document&&11>=document.documentMode,Zs=null,b0=null,Ia=null,N0=!1;function Xm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;N0||Zs==null||Zs!==rc(r)||(r=Zs,"selectionStart"in r&&Op(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ia&&Xa(Ia,r)||(Ia=r,r=cc(b0,"onSelect"),0<r.length&&(e=new Lp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Zs)))}function ku(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var qs={animationend:ku("Animation","AnimationEnd"),animationiteration:ku("Animation","AnimationIteration"),animationstart:ku("Animation","AnimationStart"),transitionend:ku("Transition","TransitionEnd")},xh={},qv={};Kr&&(qv=document.createElement("div").style,"AnimationEvent"in window||(delete qs.animationend.animation,delete qs.animationiteration.animation,delete qs.animationstart.animation),"TransitionEvent"in window||delete qs.transitionend.transition);function Bc(t){if(xh[t])return xh[t];if(!qs[t])return t;var e=qs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in qv)return xh[t]=e[n];return t}var Jv=Bc("animationend"),e3=Bc("animationiteration"),t3=Bc("animationstart"),n3=Bc("transitionend"),r3=new Map,Km="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fi(t,e){r3.set(t,e),ms(e,[t])}for(var wh=0;wh<Km.length;wh++){var _h=Km[wh],C8=_h.toLowerCase(),T8=_h[0].toUpperCase()+_h.slice(1);Fi(C8,"on"+T8)}Fi(Jv,"onAnimationEnd");Fi(e3,"onAnimationIteration");Fi(t3,"onAnimationStart");Fi("dblclick","onDoubleClick");Fi("focusin","onFocus");Fi("focusout","onBlur");Fi(n3,"onTransitionEnd");mo("onMouseEnter",["mouseout","mouseover"]);mo("onMouseLeave",["mouseout","mouseover"]);mo("onPointerEnter",["pointerout","pointerover"]);mo("onPointerLeave",["pointerout","pointerover"]);ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ta="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),E8=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ta));function Qm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Cx(r,e,void 0,t),t.currentTarget=null}function i3(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var c=r[l],u=c.instance,f=c.currentTarget;if(c=c.listener,u!==s&&i.isPropagationStopped())break e;Qm(i,c,f),s=u}else for(l=0;l<r.length;l++){if(c=r[l],u=c.instance,f=c.currentTarget,c=c.listener,u!==s&&i.isPropagationStopped())break e;Qm(i,c,f),s=u}}}if(sc)throw t=k0,sc=!1,k0=null,t}function Je(t,e){var n=e[R0];n===void 0&&(n=e[R0]=new Set);var r=t+"__bubble";n.has(r)||(s3(e,t,2,!1),n.add(r))}function Sh(t,e,n){var r=0;e&&(r|=4),s3(n,t,r,e)}var Cu="_reactListening"+Math.random().toString(36).slice(2);function Ka(t){if(!t[Cu]){t[Cu]=!0,fv.forEach(function(n){n!=="selectionchange"&&(E8.has(n)||Sh(n,!1,t),Sh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Cu]||(e[Cu]=!0,Sh("selectionchange",!1,e))}}function s3(t,e,n,r){switch(Gv(e)){case 1:var i=Bx;break;case 4:i=Ux;break;default:i=Ip}n=i.bind(null,e,n,t),i=void 0,!S0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function kh(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;l=l.return}for(;c!==null;){if(l=os(c),l===null)return;if(u=l.tag,u===5||u===6){r=s=l;continue e}c=c.parentNode}}r=r.return}Nv(function(){var f=s,p=Np(n),m=[];e:{var w=r3.get(t);if(w!==void 0){var y=Lp,x=t;switch(t){case"keypress":if(Vu(n)===0)break e;case"keydown":case"keyup":y=n8;break;case"focusin":x="focus",y=mh;break;case"focusout":x="blur",y=mh;break;case"beforeblur":case"afterblur":y=mh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Dm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=Wx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=s8;break;case Jv:case e3:case t3:y=Yx;break;case n3:y=a8;break;case"scroll":y=Gx;break;case"wheel":y=u8;break;case"copy":case"cut":case"paste":y=Kx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Bm}var C=(e&4)!==0,S=!C&&t==="scroll",_=C?w!==null?w+"Capture":null:w;C=[];for(var E=f,h;E!==null;){h=E;var k=h.stateNode;if(h.tag===5&&k!==null&&(h=k,_!==null&&(k=Va(E,_),k!=null&&C.push(Qa(E,k,h)))),S)break;E=E.return}0<C.length&&(w=new y(w,x,null,n,p),m.push({event:w,listeners:C}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",w&&n!==w0&&(x=n.relatedTarget||n.fromElement)&&(os(x)||x[Qr]))break e;if((y||w)&&(w=p.window===p?p:(w=p.ownerDocument)?w.defaultView||w.parentWindow:window,y?(x=n.relatedTarget||n.toElement,y=f,x=x?os(x):null,x!==null&&(S=ys(x),x!==S||x.tag!==5&&x.tag!==6)&&(x=null)):(y=null,x=f),y!==x)){if(C=Dm,k="onMouseLeave",_="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(C=Bm,k="onPointerLeave",_="onPointerEnter",E="pointer"),S=y==null?w:Js(y),h=x==null?w:Js(x),w=new C(k,E+"leave",y,n,p),w.target=S,w.relatedTarget=h,k=null,os(p)===f&&(C=new C(_,E+"enter",x,n,p),C.target=h,C.relatedTarget=S,k=C),S=k,y&&x)t:{for(C=y,_=x,E=0,h=C;h;h=Vs(h))E++;for(h=0,k=_;k;k=Vs(k))h++;for(;0<E-h;)C=Vs(C),E--;for(;0<h-E;)_=Vs(_),h--;for(;E--;){if(C===_||_!==null&&C===_.alternate)break t;C=Vs(C),_=Vs(_)}C=null}else C=null;y!==null&&Zm(m,w,y,C,!1),x!==null&&S!==null&&Zm(m,S,x,C,!0)}}e:{if(w=f?Js(f):window,y=w.nodeName&&w.nodeName.toLowerCase(),y==="select"||y==="input"&&w.type==="file")var T=m8;else if(Vm(w))if(Xv)T=w8;else{T=v8;var N=y8}else(y=w.nodeName)&&y.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(T=x8);if(T&&(T=T(t,f))){Yv(m,T,n,p);break e}N&&N(t,w,f),t==="focusout"&&(N=w._wrapperState)&&N.controlled&&w.type==="number"&&g0(w,"number",w.value)}switch(N=f?Js(f):window,t){case"focusin":(Vm(N)||N.contentEditable==="true")&&(Zs=N,b0=f,Ia=null);break;case"focusout":Ia=b0=Zs=null;break;case"mousedown":N0=!0;break;case"contextmenu":case"mouseup":case"dragend":N0=!1,Xm(m,n,p);break;case"selectionchange":if(k8)break;case"keydown":case"keyup":Xm(m,n,p)}var I;if(jp)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Qs?$v(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(Wv&&n.locale!=="ko"&&(Qs||M!=="onCompositionStart"?M==="onCompositionEnd"&&Qs&&(I=Vv()):(Si=p,Rp="value"in Si?Si.value:Si.textContent,Qs=!0)),N=cc(f,M),0<N.length&&(M=new zm(M,t,null,n,p),m.push({event:M,listeners:N}),I?M.data=I:(I=Hv(n),I!==null&&(M.data=I)))),(I=d8?f8(t,n):h8(t,n))&&(f=cc(f,"onBeforeInput"),0<f.length&&(p=new zm("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:f}),p.data=I))}i3(m,e)})}function Qa(t,e,n){return{instance:t,listener:e,currentTarget:n}}function cc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Va(t,n),s!=null&&r.unshift(Qa(t,s,i)),s=Va(t,e),s!=null&&r.push(Qa(t,s,i))),t=t.return}return r}function Vs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Zm(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var c=n,u=c.alternate,f=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&f!==null&&(c=f,i?(u=Va(n,s),u!=null&&l.unshift(Qa(n,u,c))):i||(u=Va(n,s),u!=null&&l.push(Qa(n,u,c)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var b8=/\r\n?/g,N8=/\u0000|\uFFFD/g;function qm(t){return(typeof t=="string"?t:""+t).replace(b8,`
`).replace(N8,"")}function Tu(t,e,n){if(e=qm(e),qm(t)!==e&&n)throw Error(se(425))}function dc(){}var P0=null,M0=null;function A0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var I0=typeof setTimeout=="function"?setTimeout:void 0,P8=typeof clearTimeout=="function"?clearTimeout:void 0,Jm=typeof Promise=="function"?Promise:void 0,M8=typeof queueMicrotask=="function"?queueMicrotask:typeof Jm<"u"?function(t){return Jm.resolve(null).then(t).catch(A8)}:I0;function A8(t){setTimeout(function(){throw t})}function Ch(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ha(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ha(e)}function bi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ey(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Po=Math.random().toString(36).slice(2),Tr="__reactFiber$"+Po,Za="__reactProps$"+Po,Qr="__reactContainer$"+Po,R0="__reactEvents$"+Po,I8="__reactListeners$"+Po,R8="__reactHandles$"+Po;function os(t){var e=t[Tr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qr]||n[Tr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ey(t);t!==null;){if(n=t[Tr])return n;t=ey(t)}return e}t=n,n=t.parentNode}return null}function hl(t){return t=t[Tr]||t[Qr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Js(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function Uc(t){return t[Za]||null}var L0=[],eo=-1;function ji(t){return{current:t}}function et(t){0>eo||(t.current=L0[eo],L0[eo]=null,eo--)}function Ke(t,e){eo++,L0[eo]=t.current,t.current=e}var Ri={},Jt=ji(Ri),xn=ji(!1),ds=Ri;function yo(t,e){var n=t.type.contextTypes;if(!n)return Ri;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function wn(t){return t=t.childContextTypes,t!=null}function fc(){et(xn),et(Jt)}function ty(t,e,n){if(Jt.current!==Ri)throw Error(se(168));Ke(Jt,e),Ke(xn,n)}function o3(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(se(108,yx(t)||"Unknown",i));return ct({},n,r)}function hc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ri,ds=Jt.current,Ke(Jt,t),Ke(xn,xn.current),!0}function ny(t,e,n){var r=t.stateNode;if(!r)throw Error(se(169));n?(t=o3(t,e,ds),r.__reactInternalMemoizedMergedChildContext=t,et(xn),et(Jt),Ke(Jt,t)):et(xn),Ke(xn,n)}var Vr=null,Gc=!1,Th=!1;function a3(t){Vr===null?Vr=[t]:Vr.push(t)}function L8(t){Gc=!0,a3(t)}function Oi(){if(!Th&&Vr!==null){Th=!0;var t=0,e=We;try{var n=Vr;for(We=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Vr=null,Gc=!1}catch(i){throw Vr!==null&&(Vr=Vr.slice(t+1)),Iv(Pp,Oi),i}finally{We=e,Th=!1}}return null}var to=[],no=0,pc=null,gc=0,Bn=[],Un=0,fs=null,Wr=1,$r="";function rs(t,e){to[no++]=gc,to[no++]=pc,pc=t,gc=e}function l3(t,e,n){Bn[Un++]=Wr,Bn[Un++]=$r,Bn[Un++]=fs,fs=t;var r=Wr;t=$r;var i=32-ur(r)-1;r&=~(1<<i),n+=1;var s=32-ur(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Wr=1<<32-ur(e)+i|n<<i|r,$r=s+t}else Wr=1<<s|n<<i|r,$r=t}function Dp(t){t.return!==null&&(rs(t,1),l3(t,1,0))}function zp(t){for(;t===pc;)pc=to[--no],to[no]=null,gc=to[--no],to[no]=null;for(;t===fs;)fs=Bn[--Un],Bn[Un]=null,$r=Bn[--Un],Bn[Un]=null,Wr=Bn[--Un],Bn[Un]=null}var En=null,Tn=null,it=!1,or=null;function u3(t,e){var n=Vn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ry(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,En=t,Tn=bi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,En=t,Tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=fs!==null?{id:Wr,overflow:$r}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,En=t,Tn=null,!0):!1;default:return!1}}function F0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function j0(t){if(it){var e=Tn;if(e){var n=e;if(!ry(t,e)){if(F0(t))throw Error(se(418));e=bi(n.nextSibling);var r=En;e&&ry(t,e)?u3(r,n):(t.flags=t.flags&-4097|2,it=!1,En=t)}}else{if(F0(t))throw Error(se(418));t.flags=t.flags&-4097|2,it=!1,En=t}}}function iy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;En=t}function Eu(t){if(t!==En)return!1;if(!it)return iy(t),it=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!A0(t.type,t.memoizedProps)),e&&(e=Tn)){if(F0(t))throw c3(),Error(se(418));for(;e;)u3(t,e),e=bi(e.nextSibling)}if(iy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Tn=bi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Tn=null}}else Tn=En?bi(t.stateNode.nextSibling):null;return!0}function c3(){for(var t=Tn;t;)t=bi(t.nextSibling)}function vo(){Tn=En=null,it=!1}function Bp(t){or===null?or=[t]:or.push(t)}var F8=Jr.ReactCurrentBatchConfig;function da(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var c=i.refs;l===null?delete c[s]:c[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function bu(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sy(t){var e=t._init;return e(t._payload)}function d3(t){function e(_,E){if(t){var h=_.deletions;h===null?(_.deletions=[E],_.flags|=16):h.push(E)}}function n(_,E){if(!t)return null;for(;E!==null;)e(_,E),E=E.sibling;return null}function r(_,E){for(_=new Map;E!==null;)E.key!==null?_.set(E.key,E):_.set(E.index,E),E=E.sibling;return _}function i(_,E){return _=Ai(_,E),_.index=0,_.sibling=null,_}function s(_,E,h){return _.index=h,t?(h=_.alternate,h!==null?(h=h.index,h<E?(_.flags|=2,E):h):(_.flags|=2,E)):(_.flags|=1048576,E)}function l(_){return t&&_.alternate===null&&(_.flags|=2),_}function c(_,E,h,k){return E===null||E.tag!==6?(E=Ih(h,_.mode,k),E.return=_,E):(E=i(E,h),E.return=_,E)}function u(_,E,h,k){var T=h.type;return T===Ks?p(_,E,h.props.children,k,h.key):E!==null&&(E.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===yi&&sy(T)===E.type)?(k=i(E,h.props),k.ref=da(_,E,h),k.return=_,k):(k=Qu(h.type,h.key,h.props,null,_.mode,k),k.ref=da(_,E,h),k.return=_,k)}function f(_,E,h,k){return E===null||E.tag!==4||E.stateNode.containerInfo!==h.containerInfo||E.stateNode.implementation!==h.implementation?(E=Rh(h,_.mode,k),E.return=_,E):(E=i(E,h.children||[]),E.return=_,E)}function p(_,E,h,k,T){return E===null||E.tag!==7?(E=cs(h,_.mode,k,T),E.return=_,E):(E=i(E,h),E.return=_,E)}function m(_,E,h){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Ih(""+E,_.mode,h),E.return=_,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case mu:return h=Qu(E.type,E.key,E.props,null,_.mode,h),h.ref=da(_,null,E),h.return=_,h;case Xs:return E=Rh(E,_.mode,h),E.return=_,E;case yi:var k=E._init;return m(_,k(E._payload),h)}if(ka(E)||oa(E))return E=cs(E,_.mode,h,null),E.return=_,E;bu(_,E)}return null}function w(_,E,h,k){var T=E!==null?E.key:null;if(typeof h=="string"&&h!==""||typeof h=="number")return T!==null?null:c(_,E,""+h,k);if(typeof h=="object"&&h!==null){switch(h.$$typeof){case mu:return h.key===T?u(_,E,h,k):null;case Xs:return h.key===T?f(_,E,h,k):null;case yi:return T=h._init,w(_,E,T(h._payload),k)}if(ka(h)||oa(h))return T!==null?null:p(_,E,h,k,null);bu(_,h)}return null}function y(_,E,h,k,T){if(typeof k=="string"&&k!==""||typeof k=="number")return _=_.get(h)||null,c(E,_,""+k,T);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case mu:return _=_.get(k.key===null?h:k.key)||null,u(E,_,k,T);case Xs:return _=_.get(k.key===null?h:k.key)||null,f(E,_,k,T);case yi:var N=k._init;return y(_,E,h,N(k._payload),T)}if(ka(k)||oa(k))return _=_.get(h)||null,p(E,_,k,T,null);bu(E,k)}return null}function x(_,E,h,k){for(var T=null,N=null,I=E,M=E=0,L=null;I!==null&&M<h.length;M++){I.index>M?(L=I,I=null):L=I.sibling;var A=w(_,I,h[M],k);if(A===null){I===null&&(I=L);break}t&&I&&A.alternate===null&&e(_,I),E=s(A,E,M),N===null?T=A:N.sibling=A,N=A,I=L}if(M===h.length)return n(_,I),it&&rs(_,M),T;if(I===null){for(;M<h.length;M++)I=m(_,h[M],k),I!==null&&(E=s(I,E,M),N===null?T=I:N.sibling=I,N=I);return it&&rs(_,M),T}for(I=r(_,I);M<h.length;M++)L=y(I,_,M,h[M],k),L!==null&&(t&&L.alternate!==null&&I.delete(L.key===null?M:L.key),E=s(L,E,M),N===null?T=L:N.sibling=L,N=L);return t&&I.forEach(function(R){return e(_,R)}),it&&rs(_,M),T}function C(_,E,h,k){var T=oa(h);if(typeof T!="function")throw Error(se(150));if(h=T.call(h),h==null)throw Error(se(151));for(var N=T=null,I=E,M=E=0,L=null,A=h.next();I!==null&&!A.done;M++,A=h.next()){I.index>M?(L=I,I=null):L=I.sibling;var R=w(_,I,A.value,k);if(R===null){I===null&&(I=L);break}t&&I&&R.alternate===null&&e(_,I),E=s(R,E,M),N===null?T=R:N.sibling=R,N=R,I=L}if(A.done)return n(_,I),it&&rs(_,M),T;if(I===null){for(;!A.done;M++,A=h.next())A=m(_,A.value,k),A!==null&&(E=s(A,E,M),N===null?T=A:N.sibling=A,N=A);return it&&rs(_,M),T}for(I=r(_,I);!A.done;M++,A=h.next())A=y(I,_,M,A.value,k),A!==null&&(t&&A.alternate!==null&&I.delete(A.key===null?M:A.key),E=s(A,E,M),N===null?T=A:N.sibling=A,N=A);return t&&I.forEach(function(j){return e(_,j)}),it&&rs(_,M),T}function S(_,E,h,k){if(typeof h=="object"&&h!==null&&h.type===Ks&&h.key===null&&(h=h.props.children),typeof h=="object"&&h!==null){switch(h.$$typeof){case mu:e:{for(var T=h.key,N=E;N!==null;){if(N.key===T){if(T=h.type,T===Ks){if(N.tag===7){n(_,N.sibling),E=i(N,h.props.children),E.return=_,_=E;break e}}else if(N.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===yi&&sy(T)===N.type){n(_,N.sibling),E=i(N,h.props),E.ref=da(_,N,h),E.return=_,_=E;break e}n(_,N);break}else e(_,N);N=N.sibling}h.type===Ks?(E=cs(h.props.children,_.mode,k,h.key),E.return=_,_=E):(k=Qu(h.type,h.key,h.props,null,_.mode,k),k.ref=da(_,E,h),k.return=_,_=k)}return l(_);case Xs:e:{for(N=h.key;E!==null;){if(E.key===N)if(E.tag===4&&E.stateNode.containerInfo===h.containerInfo&&E.stateNode.implementation===h.implementation){n(_,E.sibling),E=i(E,h.children||[]),E.return=_,_=E;break e}else{n(_,E);break}else e(_,E);E=E.sibling}E=Rh(h,_.mode,k),E.return=_,_=E}return l(_);case yi:return N=h._init,S(_,E,N(h._payload),k)}if(ka(h))return x(_,E,h,k);if(oa(h))return C(_,E,h,k);bu(_,h)}return typeof h=="string"&&h!==""||typeof h=="number"?(h=""+h,E!==null&&E.tag===6?(n(_,E.sibling),E=i(E,h),E.return=_,_=E):(n(_,E),E=Ih(h,_.mode,k),E.return=_,_=E),l(_)):n(_,E)}return S}var xo=d3(!0),f3=d3(!1),mc=ji(null),yc=null,ro=null,Up=null;function Gp(){Up=ro=yc=null}function Vp(t){var e=mc.current;et(mc),t._currentValue=e}function O0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function fo(t,e){yc=t,Up=ro=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yn=!0),t.firstContext=null)}function $n(t){var e=t._currentValue;if(Up!==t)if(t={context:t,memoizedValue:e,next:null},ro===null){if(yc===null)throw Error(se(308));ro=t,yc.dependencies={lanes:0,firstContext:t}}else ro=ro.next=t;return e}var as=null;function Wp(t){as===null?as=[t]:as.push(t)}function h3(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Wp(e)):(n.next=i.next,i.next=n),e.interleaved=n,Zr(t,r)}function Zr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var vi=!1;function $p(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function p3(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ni(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,De&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Zr(t,n)}return i=r.interleaved,i===null?(e.next=e,Wp(r)):(e.next=i.next,i.next=e),r.interleaved=e,Zr(t,n)}function Wu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Mp(t,n)}}function oy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vc(t,e,n,r){var i=t.updateQueue;vi=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var u=c,f=u.next;u.next=null,l===null?s=f:l.next=f,l=u;var p=t.alternate;p!==null&&(p=p.updateQueue,c=p.lastBaseUpdate,c!==l&&(c===null?p.firstBaseUpdate=f:c.next=f,p.lastBaseUpdate=u))}if(s!==null){var m=i.baseState;l=0,p=f=u=null,c=s;do{var w=c.lane,y=c.eventTime;if((r&w)===w){p!==null&&(p=p.next={eventTime:y,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var x=t,C=c;switch(w=e,y=n,C.tag){case 1:if(x=C.payload,typeof x=="function"){m=x.call(y,m,w);break e}m=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=C.payload,w=typeof x=="function"?x.call(y,m,w):x,w==null)break e;m=ct({},m,w);break e;case 2:vi=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,w=i.effects,w===null?i.effects=[c]:w.push(c))}else y={eventTime:y,lane:w,tag:c.tag,payload:c.payload,callback:c.callback,next:null},p===null?(f=p=y,u=m):p=p.next=y,l|=w;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;w=c,c=w.next,w.next=null,i.lastBaseUpdate=w,i.shared.pending=null}}while(1);if(p===null&&(u=m),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ps|=l,t.lanes=l,t.memoizedState=m}}function ay(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(se(191,i));i.call(r)}}}var pl={},Pr=ji(pl),qa=ji(pl),Ja=ji(pl);function ls(t){if(t===pl)throw Error(se(174));return t}function Hp(t,e){switch(Ke(Ja,e),Ke(qa,t),Ke(Pr,pl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:y0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=y0(e,t)}et(Pr),Ke(Pr,e)}function wo(){et(Pr),et(qa),et(Ja)}function g3(t){ls(Ja.current);var e=ls(Pr.current),n=y0(e,t.type);e!==n&&(Ke(qa,t),Ke(Pr,n))}function Yp(t){qa.current===t&&(et(Pr),et(qa))}var lt=ji(0);function xc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Eh=[];function Xp(){for(var t=0;t<Eh.length;t++)Eh[t]._workInProgressVersionPrimary=null;Eh.length=0}var $u=Jr.ReactCurrentDispatcher,bh=Jr.ReactCurrentBatchConfig,hs=0,ut=null,Ct=null,It=null,wc=!1,Ra=!1,el=0,j8=0;function Kt(){throw Error(se(321))}function Kp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!fr(t[n],e[n]))return!1;return!0}function Qp(t,e,n,r,i,s){if(hs=s,ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$u.current=t===null||t.memoizedState===null?B8:U8,t=n(r,i),Ra){s=0;do{if(Ra=!1,el=0,25<=s)throw Error(se(301));s+=1,It=Ct=null,e.updateQueue=null,$u.current=G8,t=n(r,i)}while(Ra)}if($u.current=_c,e=Ct!==null&&Ct.next!==null,hs=0,It=Ct=ut=null,wc=!1,e)throw Error(se(300));return t}function Zp(){var t=el!==0;return el=0,t}function kr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?ut.memoizedState=It=t:It=It.next=t,It}function Hn(){if(Ct===null){var t=ut.alternate;t=t!==null?t.memoizedState:null}else t=Ct.next;var e=It===null?ut.memoizedState:It.next;if(e!==null)It=e,Ct=t;else{if(t===null)throw Error(se(310));Ct=t,t={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},It===null?ut.memoizedState=It=t:It=It.next=t}return It}function tl(t,e){return typeof e=="function"?e(t):e}function Nh(t){var e=Hn(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=Ct,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var c=l=null,u=null,f=s;do{var p=f.lane;if((hs&p)===p)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:t(r,f.action);else{var m={lane:p,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(c=u=m,l=r):u=u.next=m,ut.lanes|=p,ps|=p}f=f.next}while(f!==null&&f!==s);u===null?l=r:u.next=c,fr(r,e.memoizedState)||(yn=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ut.lanes|=s,ps|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ph(t){var e=Hn(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);fr(s,e.memoizedState)||(yn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function m3(){}function y3(t,e){var n=ut,r=Hn(),i=e(),s=!fr(r.memoizedState,i);if(s&&(r.memoizedState=i,yn=!0),r=r.queue,qp(w3.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||It!==null&&It.memoizedState.tag&1){if(n.flags|=2048,nl(9,x3.bind(null,n,r,i,e),void 0,null),Rt===null)throw Error(se(349));hs&30||v3(n,e,i)}return i}function v3(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function x3(t,e,n,r){e.value=n,e.getSnapshot=r,_3(e)&&S3(t)}function w3(t,e,n){return n(function(){_3(e)&&S3(t)})}function _3(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!fr(t,n)}catch{return!0}}function S3(t){var e=Zr(t,1);e!==null&&cr(e,t,1,-1)}function ly(t){var e=kr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tl,lastRenderedState:t},e.queue=t,t=t.dispatch=z8.bind(null,ut,t),[e.memoizedState,t]}function nl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function k3(){return Hn().memoizedState}function Hu(t,e,n,r){var i=kr();ut.flags|=t,i.memoizedState=nl(1|e,n,void 0,r===void 0?null:r)}function Vc(t,e,n,r){var i=Hn();r=r===void 0?null:r;var s=void 0;if(Ct!==null){var l=Ct.memoizedState;if(s=l.destroy,r!==null&&Kp(r,l.deps)){i.memoizedState=nl(e,n,s,r);return}}ut.flags|=t,i.memoizedState=nl(1|e,n,s,r)}function uy(t,e){return Hu(8390656,8,t,e)}function qp(t,e){return Vc(2048,8,t,e)}function C3(t,e){return Vc(4,2,t,e)}function T3(t,e){return Vc(4,4,t,e)}function E3(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function b3(t,e,n){return n=n!=null?n.concat([t]):null,Vc(4,4,E3.bind(null,e,t),n)}function Jp(){}function N3(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function P3(t,e){var n=Hn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function M3(t,e,n){return hs&21?(fr(n,e)||(n=Fv(),ut.lanes|=n,ps|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yn=!0),t.memoizedState=n)}function O8(t,e){var n=We;We=n!==0&&4>n?n:4,t(!0);var r=bh.transition;bh.transition={};try{t(!1),e()}finally{We=n,bh.transition=r}}function A3(){return Hn().memoizedState}function D8(t,e,n){var r=Mi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},I3(t))R3(e,n);else if(n=h3(t,e,n,r),n!==null){var i=rn();cr(n,t,r,i),L3(n,e,r)}}function z8(t,e,n){var r=Mi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(I3(t))R3(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,c=s(l,n);if(i.hasEagerState=!0,i.eagerState=c,fr(c,l)){var u=e.interleaved;u===null?(i.next=i,Wp(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=h3(t,e,i,r),n!==null&&(i=rn(),cr(n,t,r,i),L3(n,e,r))}}function I3(t){var e=t.alternate;return t===ut||e!==null&&e===ut}function R3(t,e){Ra=wc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function L3(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Mp(t,n)}}var _c={readContext:$n,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},B8={readContext:$n,useCallback:function(t,e){return kr().memoizedState=[t,e===void 0?null:e],t},useContext:$n,useEffect:uy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Hu(4194308,4,E3.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Hu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Hu(4,2,t,e)},useMemo:function(t,e){var n=kr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=kr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=D8.bind(null,ut,t),[r.memoizedState,t]},useRef:function(t){var e=kr();return t={current:t},e.memoizedState=t},useState:ly,useDebugValue:Jp,useDeferredValue:function(t){return kr().memoizedState=t},useTransition:function(){var t=ly(!1),e=t[0];return t=O8.bind(null,t[1]),kr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ut,i=kr();if(it){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),Rt===null)throw Error(se(349));hs&30||v3(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,uy(w3.bind(null,r,s,t),[t]),r.flags|=2048,nl(9,x3.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=kr(),e=Rt.identifierPrefix;if(it){var n=$r,r=Wr;n=(r&~(1<<32-ur(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=el++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=j8++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},U8={readContext:$n,useCallback:N3,useContext:$n,useEffect:qp,useImperativeHandle:b3,useInsertionEffect:C3,useLayoutEffect:T3,useMemo:P3,useReducer:Nh,useRef:k3,useState:function(){return Nh(tl)},useDebugValue:Jp,useDeferredValue:function(t){var e=Hn();return M3(e,Ct.memoizedState,t)},useTransition:function(){var t=Nh(tl)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:m3,useSyncExternalStore:y3,useId:A3,unstable_isNewReconciler:!1},G8={readContext:$n,useCallback:N3,useContext:$n,useEffect:qp,useImperativeHandle:b3,useInsertionEffect:C3,useLayoutEffect:T3,useMemo:P3,useReducer:Ph,useRef:k3,useState:function(){return Ph(tl)},useDebugValue:Jp,useDeferredValue:function(t){var e=Hn();return Ct===null?e.memoizedState=t:M3(e,Ct.memoizedState,t)},useTransition:function(){var t=Ph(tl)[0],e=Hn().memoizedState;return[t,e]},useMutableSource:m3,useSyncExternalStore:y3,useId:A3,unstable_isNewReconciler:!1};function ir(t,e){if(t&&t.defaultProps){e=ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function D0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Wc={isMounted:function(t){return(t=t._reactInternals)?ys(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=rn(),i=Mi(t),s=Hr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ni(t,s,i),e!==null&&(cr(e,t,i,r),Wu(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=rn(),i=Mi(t),s=Hr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ni(t,s,i),e!==null&&(cr(e,t,i,r),Wu(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=rn(),r=Mi(t),i=Hr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ni(t,i,r),e!==null&&(cr(e,t,r,n),Wu(e,t,r))}};function cy(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!Xa(n,r)||!Xa(i,s):!0}function F3(t,e,n){var r=!1,i=Ri,s=e.contextType;return typeof s=="object"&&s!==null?s=$n(s):(i=wn(e)?ds:Jt.current,r=e.contextTypes,s=(r=r!=null)?yo(t,i):Ri),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Wc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function dy(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Wc.enqueueReplaceState(e,e.state,null)}function z0(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},$p(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=$n(s):(s=wn(e)?ds:Jt.current,i.context=yo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(D0(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Wc.enqueueReplaceState(i,i.state,null),vc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function _o(t,e){try{var n="",r=e;do n+=mx(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Mh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function B0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var V8=typeof WeakMap=="function"?WeakMap:Map;function j3(t,e,n){n=Hr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){kc||(kc=!0,Q0=r),B0(t,e)},n}function O3(t,e,n){n=Hr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){B0(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){B0(t,e),typeof r!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function fy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new V8;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=rw.bind(null,t,e,n),e.then(t,t))}function hy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function py(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hr(-1,1),e.tag=2,Ni(n,e,1))),n.lanes|=1),t)}var W8=Jr.ReactCurrentOwner,yn=!1;function nn(t,e,n,r){e.child=t===null?f3(e,null,n,r):xo(e,t.child,n,r)}function gy(t,e,n,r,i){n=n.render;var s=e.ref;return fo(e,i),r=Qp(t,e,n,r,s,i),n=Zp(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,qr(t,e,i)):(it&&n&&Dp(e),e.flags|=1,nn(t,e,r,i),e.child)}function my(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!ag(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,D3(t,e,s,r,i)):(t=Qu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:Xa,n(l,r)&&t.ref===e.ref)return qr(t,e,i)}return e.flags|=1,t=Ai(s,r),t.ref=e.ref,t.return=e,e.child=t}function D3(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Xa(s,r)&&t.ref===e.ref)if(yn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(yn=!0);else return e.lanes=t.lanes,qr(t,e,i)}return U0(t,e,n,r,i)}function z3(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(so,Cn),Cn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ke(so,Cn),Cn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ke(so,Cn),Cn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ke(so,Cn),Cn|=r;return nn(t,e,i,n),e.child}function B3(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function U0(t,e,n,r,i){var s=wn(n)?ds:Jt.current;return s=yo(e,s),fo(e,i),n=Qp(t,e,n,r,s,i),r=Zp(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,qr(t,e,i)):(it&&r&&Dp(e),e.flags|=1,nn(t,e,n,i),e.child)}function yy(t,e,n,r,i){if(wn(n)){var s=!0;hc(e)}else s=!1;if(fo(e,i),e.stateNode===null)Yu(t,e),F3(e,n,r),z0(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,c=e.memoizedProps;l.props=c;var u=l.context,f=n.contextType;typeof f=="object"&&f!==null?f=$n(f):(f=wn(n)?ds:Jt.current,f=yo(e,f));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof l.getSnapshotBeforeUpdate=="function";m||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||u!==f)&&dy(e,l,r,f),vi=!1;var w=e.memoizedState;l.state=w,vc(e,r,l,i),u=e.memoizedState,c!==r||w!==u||xn.current||vi?(typeof p=="function"&&(D0(e,n,p,r),u=e.memoizedState),(c=vi||cy(e,n,c,r,w,u,f))?(m||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),l.props=r,l.state=u,l.context=f,r=c):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,p3(t,e),c=e.memoizedProps,f=e.type===e.elementType?c:ir(e.type,c),l.props=f,m=e.pendingProps,w=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=$n(u):(u=wn(n)?ds:Jt.current,u=yo(e,u));var y=n.getDerivedStateFromProps;(p=typeof y=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==m||w!==u)&&dy(e,l,r,u),vi=!1,w=e.memoizedState,l.state=w,vc(e,r,l,i);var x=e.memoizedState;c!==m||w!==x||xn.current||vi?(typeof y=="function"&&(D0(e,n,y,r),x=e.memoizedState),(f=vi||cy(e,n,f,r,w,x,u)||!1)?(p||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,x,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,x,u)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),l.props=r,l.state=x,l.context=u,r=f):(typeof l.componentDidUpdate!="function"||c===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return G0(t,e,n,r,s,i)}function G0(t,e,n,r,i,s){B3(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&ny(e,n,!1),qr(t,e,s);r=e.stateNode,W8.current=e;var c=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=xo(e,t.child,null,s),e.child=xo(e,null,c,s)):nn(t,e,c,s),e.memoizedState=r.state,i&&ny(e,n,!0),e.child}function U3(t){var e=t.stateNode;e.pendingContext?ty(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ty(t,e.context,!1),Hp(t,e.containerInfo)}function vy(t,e,n,r,i){return vo(),Bp(i),e.flags|=256,nn(t,e,n,r),e.child}var V0={dehydrated:null,treeContext:null,retryLane:0};function W0(t){return{baseLanes:t,cachePool:null,transitions:null}}function G3(t,e,n){var r=e.pendingProps,i=lt.current,s=!1,l=(e.flags&128)!==0,c;if((c=l)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ke(lt,i&1),t===null)return j0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=Yc(l,r,0,null),t=cs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=W0(n),e.memoizedState=V0,t):eg(e,l));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return $8(t,e,l,r,c,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,c=i.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ai(i,u),r.subtreeFlags=i.subtreeFlags&14680064),c!==null?s=Ai(c,s):(s=cs(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?W0(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=V0,r}return s=t.child,t=s.sibling,r=Ai(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function eg(t,e){return e=Yc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Nu(t,e,n,r){return r!==null&&Bp(r),xo(e,t.child,null,n),t=eg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function $8(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=Mh(Error(se(422))),Nu(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Yc({mode:"visible",children:r.children},i,0,null),s=cs(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&xo(e,t.child,null,l),e.child.memoizedState=W0(l),e.memoizedState=V0,s);if(!(e.mode&1))return Nu(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var c=r.dgst;return r=c,s=Error(se(419)),r=Mh(s,r,void 0),Nu(t,e,l,r)}if(c=(l&t.childLanes)!==0,yn||c){if(r=Rt,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Zr(t,i),cr(r,t,i,-1))}return og(),r=Mh(Error(se(421))),Nu(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=iw.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Tn=bi(i.nextSibling),En=e,it=!0,or=null,t!==null&&(Bn[Un++]=Wr,Bn[Un++]=$r,Bn[Un++]=fs,Wr=t.id,$r=t.overflow,fs=e),e=eg(e,r.children),e.flags|=4096,e)}function xy(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),O0(t.return,e,n)}function Ah(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function V3(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(nn(t,e,r.children,n),r=lt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xy(t,n,e);else if(t.tag===19)xy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ke(lt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&xc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ah(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&xc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ah(e,!0,n,null,s);break;case"together":Ah(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Yu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ps|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=Ai(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ai(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function H8(t,e,n){switch(e.tag){case 3:U3(e),vo();break;case 5:g3(e);break;case 1:wn(e.type)&&hc(e);break;case 4:Hp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ke(mc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ke(lt,lt.current&1),e.flags|=128,null):n&e.child.childLanes?G3(t,e,n):(Ke(lt,lt.current&1),t=qr(t,e,n),t!==null?t.sibling:null);Ke(lt,lt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return V3(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ke(lt,lt.current),r)break;return null;case 22:case 23:return e.lanes=0,z3(t,e,n)}return qr(t,e,n)}var W3,$0,$3,H3;W3=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};$0=function(){};$3=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ls(Pr.current);var s=null;switch(n){case"input":i=h0(t,i),r=h0(t,r),s=[];break;case"select":i=ct({},i,{value:void 0}),r=ct({},r,{value:void 0}),s=[];break;case"textarea":i=m0(t,i),r=m0(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=dc)}v0(n,r);var l;n=null;for(f in i)if(!r.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var c=i[f];for(l in c)c.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Ua.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in r){var u=r[f];if(c=i!=null?i[f]:void 0,r.hasOwnProperty(f)&&u!==c&&(u!=null||c!=null))if(f==="style")if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(s||(s=[]),s.push(f,n)),n=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(s=s||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Ua.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Je("scroll",t),s||c===u||(s=[])):(s=s||[]).push(f,u))}n&&(s=s||[]).push("style",n);var f=s;(e.updateQueue=f)&&(e.flags|=4)}};H3=function(t,e,n,r){n!==r&&(e.flags|=4)};function fa(t,e){if(!it)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Y8(t,e,n){var r=e.pendingProps;switch(zp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(e),null;case 1:return wn(e.type)&&fc(),Qt(e),null;case 3:return r=e.stateNode,wo(),et(xn),et(Jt),Xp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Eu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,or!==null&&(J0(or),or=null))),$0(t,e),Qt(e),null;case 5:Yp(e);var i=ls(Ja.current);if(n=e.type,t!==null&&e.stateNode!=null)$3(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(se(166));return Qt(e),null}if(t=ls(Pr.current),Eu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Tr]=e,r[Za]=s,t=(e.mode&1)!==0,n){case"dialog":Je("cancel",r),Je("close",r);break;case"iframe":case"object":case"embed":Je("load",r);break;case"video":case"audio":for(i=0;i<Ta.length;i++)Je(Ta[i],r);break;case"source":Je("error",r);break;case"img":case"image":case"link":Je("error",r),Je("load",r);break;case"details":Je("toggle",r);break;case"input":Nm(r,s),Je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Je("invalid",r);break;case"textarea":Mm(r,s),Je("invalid",r)}v0(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var c=s[l];l==="children"?typeof c=="string"?r.textContent!==c&&(s.suppressHydrationWarning!==!0&&Tu(r.textContent,c,t),i=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(s.suppressHydrationWarning!==!0&&Tu(r.textContent,c,t),i=["children",""+c]):Ua.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&Je("scroll",r)}switch(n){case"input":yu(r),Pm(r,s,!0);break;case"textarea":yu(r),Am(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=dc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=wv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[Tr]=e,t[Za]=r,W3(t,e,!1,!1),e.stateNode=t;e:{switch(l=x0(n,r),n){case"dialog":Je("cancel",t),Je("close",t),i=r;break;case"iframe":case"object":case"embed":Je("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ta.length;i++)Je(Ta[i],t);i=r;break;case"source":Je("error",t),i=r;break;case"img":case"image":case"link":Je("error",t),Je("load",t),i=r;break;case"details":Je("toggle",t),i=r;break;case"input":Nm(t,r),i=h0(t,r),Je("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ct({},r,{value:void 0}),Je("invalid",t);break;case"textarea":Mm(t,r),i=m0(t,r),Je("invalid",t);break;default:i=r}v0(n,i),c=i;for(s in c)if(c.hasOwnProperty(s)){var u=c[s];s==="style"?kv(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&_v(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ga(t,u):typeof u=="number"&&Ga(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ua.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Je("scroll",t):u!=null&&Cp(t,s,u,l))}switch(n){case"input":yu(t),Pm(t,r,!1);break;case"textarea":yu(t),Am(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ii(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ao(t,!!r.multiple,s,!1):r.defaultValue!=null&&ao(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=dc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qt(e),null;case 6:if(t&&e.stateNode!=null)H3(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(se(166));if(n=ls(Ja.current),ls(Pr.current),Eu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Tr]=e,(s=r.nodeValue!==n)&&(t=En,t!==null))switch(t.tag){case 3:Tu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Tu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Tr]=e,e.stateNode=r}return Qt(e),null;case 13:if(et(lt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(it&&Tn!==null&&e.mode&1&&!(e.flags&128))c3(),vo(),e.flags|=98560,s=!1;else if(s=Eu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(se(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(se(317));s[Tr]=e}else vo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qt(e),s=!1}else or!==null&&(J0(or),or=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||lt.current&1?Tt===0&&(Tt=3):og())),e.updateQueue!==null&&(e.flags|=4),Qt(e),null);case 4:return wo(),$0(t,e),t===null&&Ka(e.stateNode.containerInfo),Qt(e),null;case 10:return Vp(e.type._context),Qt(e),null;case 17:return wn(e.type)&&fc(),Qt(e),null;case 19:if(et(lt),s=e.memoizedState,s===null)return Qt(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)fa(s,!1);else{if(Tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=xc(t),l!==null){for(e.flags|=128,fa(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ke(lt,lt.current&1|2),e.child}t=t.sibling}s.tail!==null&&yt()>So&&(e.flags|=128,r=!0,fa(s,!1),e.lanes=4194304)}else{if(!r)if(t=xc(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),fa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!it)return Qt(e),null}else 2*yt()-s.renderingStartTime>So&&n!==1073741824&&(e.flags|=128,r=!0,fa(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=yt(),e.sibling=null,n=lt.current,Ke(lt,r?n&1|2:n&1),e):(Qt(e),null);case 22:case 23:return sg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Cn&1073741824&&(Qt(e),e.subtreeFlags&6&&(e.flags|=8192)):Qt(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function X8(t,e){switch(zp(e),e.tag){case 1:return wn(e.type)&&fc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return wo(),et(xn),et(Jt),Xp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yp(e),null;case 13:if(et(lt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));vo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return et(lt),null;case 4:return wo(),null;case 10:return Vp(e.type._context),null;case 22:case 23:return sg(),null;case 24:return null;default:return null}}var Pu=!1,qt=!1,K8=typeof WeakSet=="function"?WeakSet:Set,ye=null;function io(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ht(t,e,r)}else n.current=null}function H0(t,e,n){try{n()}catch(r){ht(t,e,r)}}var wy=!1;function Q8(t,e){if(P0=lc,t=Zv(),Op(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,c=-1,u=-1,f=0,p=0,m=t,w=null;t:for(;;){for(var y;m!==n||i!==0&&m.nodeType!==3||(c=l+i),m!==s||r!==0&&m.nodeType!==3||(u=l+r),m.nodeType===3&&(l+=m.nodeValue.length),(y=m.firstChild)!==null;)w=m,m=y;for(;;){if(m===t)break t;if(w===n&&++f===i&&(c=l),w===s&&++p===r&&(u=l),(y=m.nextSibling)!==null)break;m=w,w=m.parentNode}m=y}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(M0={focusedElem:t,selectionRange:n},lc=!1,ye=e;ye!==null;)if(e=ye,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ye=t;else for(;ye!==null;){e=ye;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var C=x.memoizedProps,S=x.memoizedState,_=e.stateNode,E=_.getSnapshotBeforeUpdate(e.elementType===e.type?C:ir(e.type,C),S);_.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var h=e.stateNode.containerInfo;h.nodeType===1?h.textContent="":h.nodeType===9&&h.documentElement&&h.removeChild(h.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(k){ht(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,ye=t;break}ye=e.return}return x=wy,wy=!1,x}function La(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&H0(e,n,s)}i=i.next}while(i!==r)}}function $c(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Y0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Y3(t){var e=t.alternate;e!==null&&(t.alternate=null,Y3(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Tr],delete e[Za],delete e[R0],delete e[I8],delete e[R8])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function X3(t){return t.tag===5||t.tag===3||t.tag===4}function _y(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||X3(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function X0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=dc));else if(r!==4&&(t=t.child,t!==null))for(X0(t,e,n),t=t.sibling;t!==null;)X0(t,e,n),t=t.sibling}function K0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(K0(t,e,n),t=t.sibling;t!==null;)K0(t,e,n),t=t.sibling}var Dt=null,sr=!1;function pi(t,e,n){for(n=n.child;n!==null;)K3(t,e,n),n=n.sibling}function K3(t,e,n){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Oc,n)}catch{}switch(n.tag){case 5:qt||io(n,e);case 6:var r=Dt,i=sr;Dt=null,pi(t,e,n),Dt=r,sr=i,Dt!==null&&(sr?(t=Dt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(sr?(t=Dt,n=n.stateNode,t.nodeType===8?Ch(t.parentNode,n):t.nodeType===1&&Ch(t,n),Ha(t)):Ch(Dt,n.stateNode));break;case 4:r=Dt,i=sr,Dt=n.stateNode.containerInfo,sr=!0,pi(t,e,n),Dt=r,sr=i;break;case 0:case 11:case 14:case 15:if(!qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&H0(n,e,l),i=i.next}while(i!==r)}pi(t,e,n);break;case 1:if(!qt&&(io(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){ht(n,e,c)}pi(t,e,n);break;case 21:pi(t,e,n);break;case 22:n.mode&1?(qt=(r=qt)||n.memoizedState!==null,pi(t,e,n),qt=r):pi(t,e,n);break;default:pi(t,e,n)}}function Sy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new K8),e.forEach(function(r){var i=sw.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function nr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,c=l;e:for(;c!==null;){switch(c.tag){case 5:Dt=c.stateNode,sr=!1;break e;case 3:Dt=c.stateNode.containerInfo,sr=!0;break e;case 4:Dt=c.stateNode.containerInfo,sr=!0;break e}c=c.return}if(Dt===null)throw Error(se(160));K3(s,l,i),Dt=null,sr=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){ht(i,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Q3(e,t),e=e.sibling}function Q3(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(nr(e,t),Sr(t),r&4){try{La(3,t,t.return),$c(3,t)}catch(C){ht(t,t.return,C)}try{La(5,t,t.return)}catch(C){ht(t,t.return,C)}}break;case 1:nr(e,t),Sr(t),r&512&&n!==null&&io(n,n.return);break;case 5:if(nr(e,t),Sr(t),r&512&&n!==null&&io(n,n.return),t.flags&32){var i=t.stateNode;try{Ga(i,"")}catch(C){ht(t,t.return,C)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&s.type==="radio"&&s.name!=null&&vv(i,s),x0(c,l);var f=x0(c,s);for(l=0;l<u.length;l+=2){var p=u[l],m=u[l+1];p==="style"?kv(i,m):p==="dangerouslySetInnerHTML"?_v(i,m):p==="children"?Ga(i,m):Cp(i,p,m,f)}switch(c){case"input":p0(i,s);break;case"textarea":xv(i,s);break;case"select":var w=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var y=s.value;y!=null?ao(i,!!s.multiple,y,!1):w!==!!s.multiple&&(s.defaultValue!=null?ao(i,!!s.multiple,s.defaultValue,!0):ao(i,!!s.multiple,s.multiple?[]:"",!1))}i[Za]=s}catch(C){ht(t,t.return,C)}}break;case 6:if(nr(e,t),Sr(t),r&4){if(t.stateNode===null)throw Error(se(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(C){ht(t,t.return,C)}}break;case 3:if(nr(e,t),Sr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ha(e.containerInfo)}catch(C){ht(t,t.return,C)}break;case 4:nr(e,t),Sr(t);break;case 13:nr(e,t),Sr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(rg=yt())),r&4&&Sy(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(qt=(f=qt)||p,nr(e,t),qt=f):nr(e,t),Sr(t),r&8192){if(f=t.memoizedState!==null,(t.stateNode.isHidden=f)&&!p&&t.mode&1)for(ye=t,p=t.child;p!==null;){for(m=ye=p;ye!==null;){switch(w=ye,y=w.child,w.tag){case 0:case 11:case 14:case 15:La(4,w,w.return);break;case 1:io(w,w.return);var x=w.stateNode;if(typeof x.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(C){ht(r,n,C)}}break;case 5:io(w,w.return);break;case 22:if(w.memoizedState!==null){Cy(m);continue}}y!==null?(y.return=w,ye=y):Cy(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,f?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(c=m.stateNode,u=m.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=Sv("display",l))}catch(C){ht(t,t.return,C)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(C){ht(t,t.return,C)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:nr(e,t),Sr(t),r&4&&Sy(t);break;case 21:break;default:nr(e,t),Sr(t)}}function Sr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(X3(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ga(i,""),r.flags&=-33);var s=_y(t);K0(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,c=_y(t);X0(t,c,l);break;default:throw Error(se(161))}}catch(u){ht(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Z8(t,e,n){ye=t,Z3(t)}function Z3(t,e,n){for(var r=(t.mode&1)!==0;ye!==null;){var i=ye,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||Pu;if(!l){var c=i.alternate,u=c!==null&&c.memoizedState!==null||qt;c=Pu;var f=qt;if(Pu=l,(qt=u)&&!f)for(ye=i;ye!==null;)l=ye,u=l.child,l.tag===22&&l.memoizedState!==null?Ty(i):u!==null?(u.return=l,ye=u):Ty(i);for(;s!==null;)ye=s,Z3(s),s=s.sibling;ye=i,Pu=c,qt=f}ky(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ye=s):ky(t)}}function ky(t){for(;ye!==null;){var e=ye;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qt||$c(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!qt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ir(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ay(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ay(e,l,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var p=f.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&Ha(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}qt||e.flags&512&&Y0(e)}catch(w){ht(e,e.return,w)}}if(e===t){ye=null;break}if(n=e.sibling,n!==null){n.return=e.return,ye=n;break}ye=e.return}}function Cy(t){for(;ye!==null;){var e=ye;if(e===t){ye=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ye=n;break}ye=e.return}}function Ty(t){for(;ye!==null;){var e=ye;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{$c(4,e)}catch(u){ht(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){ht(e,i,u)}}var s=e.return;try{Y0(e)}catch(u){ht(e,s,u)}break;case 5:var l=e.return;try{Y0(e)}catch(u){ht(e,l,u)}}}catch(u){ht(e,e.return,u)}if(e===t){ye=null;break}var c=e.sibling;if(c!==null){c.return=e.return,ye=c;break}ye=e.return}}var q8=Math.ceil,Sc=Jr.ReactCurrentDispatcher,tg=Jr.ReactCurrentOwner,Wn=Jr.ReactCurrentBatchConfig,De=0,Rt=null,wt=null,Bt=0,Cn=0,so=ji(0),Tt=0,rl=null,ps=0,Hc=0,ng=0,Fa=null,mn=null,rg=0,So=1/0,Gr=null,kc=!1,Q0=null,Pi=null,Mu=!1,ki=null,Cc=0,ja=0,Z0=null,Xu=-1,Ku=0;function rn(){return De&6?yt():Xu!==-1?Xu:Xu=yt()}function Mi(t){return t.mode&1?De&2&&Bt!==0?Bt&-Bt:F8.transition!==null?(Ku===0&&(Ku=Fv()),Ku):(t=We,t!==0||(t=window.event,t=t===void 0?16:Gv(t.type)),t):1}function cr(t,e,n,r){if(50<ja)throw ja=0,Z0=null,Error(se(185));dl(t,n,r),(!(De&2)||t!==Rt)&&(t===Rt&&(!(De&2)&&(Hc|=n),Tt===4&&_i(t,Bt)),_n(t,r),n===1&&De===0&&!(e.mode&1)&&(So=yt()+500,Gc&&Oi()))}function _n(t,e){var n=t.callbackNode;Fx(t,e);var r=ac(t,t===Rt?Bt:0);if(r===0)n!==null&&Lm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Lm(n),e===1)t.tag===0?L8(Ey.bind(null,t)):a3(Ey.bind(null,t)),M8(function(){!(De&6)&&Oi()}),n=null;else{switch(jv(r)){case 1:n=Pp;break;case 4:n=Rv;break;case 16:n=oc;break;case 536870912:n=Lv;break;default:n=oc}n=s5(n,q3.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function q3(t,e){if(Xu=-1,Ku=0,De&6)throw Error(se(327));var n=t.callbackNode;if(ho()&&t.callbackNode!==n)return null;var r=ac(t,t===Rt?Bt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Tc(t,r);else{e=r;var i=De;De|=2;var s=e5();(Rt!==t||Bt!==e)&&(Gr=null,So=yt()+500,us(t,e));do try{tw();break}catch(c){J3(t,c)}while(1);Gp(),Sc.current=s,De=i,wt!==null?e=0:(Rt=null,Bt=0,e=Tt)}if(e!==0){if(e===2&&(i=C0(t),i!==0&&(r=i,e=q0(t,i))),e===1)throw n=rl,us(t,0),_i(t,r),_n(t,yt()),n;if(e===6)_i(t,r);else{if(i=t.current.alternate,!(r&30)&&!J8(i)&&(e=Tc(t,r),e===2&&(s=C0(t),s!==0&&(r=s,e=q0(t,s))),e===1))throw n=rl,us(t,0),_i(t,r),_n(t,yt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(se(345));case 2:is(t,mn,Gr);break;case 3:if(_i(t,r),(r&130023424)===r&&(e=rg+500-yt(),10<e)){if(ac(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){rn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=I0(is.bind(null,t,mn,Gr),e);break}is(t,mn,Gr);break;case 4:if(_i(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-ur(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=yt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*q8(r/1960))-r,10<r){t.timeoutHandle=I0(is.bind(null,t,mn,Gr),r);break}is(t,mn,Gr);break;case 5:is(t,mn,Gr);break;default:throw Error(se(329))}}}return _n(t,yt()),t.callbackNode===n?q3.bind(null,t):null}function q0(t,e){var n=Fa;return t.current.memoizedState.isDehydrated&&(us(t,e).flags|=256),t=Tc(t,e),t!==2&&(e=mn,mn=n,e!==null&&J0(e)),t}function J0(t){mn===null?mn=t:mn.push.apply(mn,t)}function J8(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!fr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _i(t,e){for(e&=~ng,e&=~Hc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ur(e),r=1<<n;t[n]=-1,e&=~r}}function Ey(t){if(De&6)throw Error(se(327));ho();var e=ac(t,0);if(!(e&1))return _n(t,yt()),null;var n=Tc(t,e);if(t.tag!==0&&n===2){var r=C0(t);r!==0&&(e=r,n=q0(t,r))}if(n===1)throw n=rl,us(t,0),_i(t,e),_n(t,yt()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,is(t,mn,Gr),_n(t,yt()),null}function ig(t,e){var n=De;De|=1;try{return t(e)}finally{De=n,De===0&&(So=yt()+500,Gc&&Oi())}}function gs(t){ki!==null&&ki.tag===0&&!(De&6)&&ho();var e=De;De|=1;var n=Wn.transition,r=We;try{if(Wn.transition=null,We=1,t)return t()}finally{We=r,Wn.transition=n,De=e,!(De&6)&&Oi()}}function sg(){Cn=so.current,et(so)}function us(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,P8(n)),wt!==null)for(n=wt.return;n!==null;){var r=n;switch(zp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fc();break;case 3:wo(),et(xn),et(Jt),Xp();break;case 5:Yp(r);break;case 4:wo();break;case 13:et(lt);break;case 19:et(lt);break;case 10:Vp(r.type._context);break;case 22:case 23:sg()}n=n.return}if(Rt=t,wt=t=Ai(t.current,null),Bt=Cn=e,Tt=0,rl=null,ng=Hc=ps=0,mn=Fa=null,as!==null){for(e=0;e<as.length;e++)if(n=as[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}as=null}return t}function J3(t,e){do{var n=wt;try{if(Gp(),$u.current=_c,wc){for(var r=ut.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}wc=!1}if(hs=0,It=Ct=ut=null,Ra=!1,el=0,tg.current=null,n===null||n.return===null){Tt=1,rl=e,wt=null;break}e:{var s=t,l=n.return,c=n,u=e;if(e=Bt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,p=c,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var w=p.alternate;w?(p.updateQueue=w.updateQueue,p.memoizedState=w.memoizedState,p.lanes=w.lanes):(p.updateQueue=null,p.memoizedState=null)}var y=hy(l);if(y!==null){y.flags&=-257,py(y,l,c,s,e),y.mode&1&&fy(s,f,e),e=y,u=f;var x=e.updateQueue;if(x===null){var C=new Set;C.add(u),e.updateQueue=C}else x.add(u);break e}else{if(!(e&1)){fy(s,f,e),og();break e}u=Error(se(426))}}else if(it&&c.mode&1){var S=hy(l);if(S!==null){!(S.flags&65536)&&(S.flags|=256),py(S,l,c,s,e),Bp(_o(u,c));break e}}s=u=_o(u,c),Tt!==4&&(Tt=2),Fa===null?Fa=[s]:Fa.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var _=j3(s,u,e);oy(s,_);break e;case 1:c=u;var E=s.type,h=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(Pi===null||!Pi.has(h)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=O3(s,c,e);oy(s,k);break e}}s=s.return}while(s!==null)}n5(n)}catch(T){e=T,wt===n&&n!==null&&(wt=n=n.return);continue}break}while(1)}function e5(){var t=Sc.current;return Sc.current=_c,t===null?_c:t}function og(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Rt===null||!(ps&268435455)&&!(Hc&268435455)||_i(Rt,Bt)}function Tc(t,e){var n=De;De|=2;var r=e5();(Rt!==t||Bt!==e)&&(Gr=null,us(t,e));do try{ew();break}catch(i){J3(t,i)}while(1);if(Gp(),De=n,Sc.current=r,wt!==null)throw Error(se(261));return Rt=null,Bt=0,Tt}function ew(){for(;wt!==null;)t5(wt)}function tw(){for(;wt!==null&&!Ex();)t5(wt)}function t5(t){var e=i5(t.alternate,t,Cn);t.memoizedProps=t.pendingProps,e===null?n5(t):wt=e,tg.current=null}function n5(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=X8(n,e),n!==null){n.flags&=32767,wt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tt=6,wt=null;return}}else if(n=Y8(n,e,Cn),n!==null){wt=n;return}if(e=e.sibling,e!==null){wt=e;return}wt=e=t}while(e!==null);Tt===0&&(Tt=5)}function is(t,e,n){var r=We,i=Wn.transition;try{Wn.transition=null,We=1,nw(t,e,n,r)}finally{Wn.transition=i,We=r}return null}function nw(t,e,n,r){do ho();while(ki!==null);if(De&6)throw Error(se(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(jx(t,s),t===Rt&&(wt=Rt=null,Bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Mu||(Mu=!0,s5(oc,function(){return ho(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Wn.transition,Wn.transition=null;var l=We;We=1;var c=De;De|=4,tg.current=null,Q8(t,n),Q3(n,t),S8(M0),lc=!!P0,M0=P0=null,t.current=n,Z8(n),bx(),De=c,We=l,Wn.transition=s}else t.current=n;if(Mu&&(Mu=!1,ki=t,Cc=i),s=t.pendingLanes,s===0&&(Pi=null),Mx(n.stateNode),_n(t,yt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(kc)throw kc=!1,t=Q0,Q0=null,t;return Cc&1&&t.tag!==0&&ho(),s=t.pendingLanes,s&1?t===Z0?ja++:(ja=0,Z0=t):ja=0,Oi(),null}function ho(){if(ki!==null){var t=jv(Cc),e=Wn.transition,n=We;try{if(Wn.transition=null,We=16>t?16:t,ki===null)var r=!1;else{if(t=ki,ki=null,Cc=0,De&6)throw Error(se(331));var i=De;for(De|=4,ye=t.current;ye!==null;){var s=ye,l=s.child;if(ye.flags&16){var c=s.deletions;if(c!==null){for(var u=0;u<c.length;u++){var f=c[u];for(ye=f;ye!==null;){var p=ye;switch(p.tag){case 0:case 11:case 15:La(8,p,s)}var m=p.child;if(m!==null)m.return=p,ye=m;else for(;ye!==null;){p=ye;var w=p.sibling,y=p.return;if(Y3(p),p===f){ye=null;break}if(w!==null){w.return=y,ye=w;break}ye=y}}}var x=s.alternate;if(x!==null){var C=x.child;if(C!==null){x.child=null;do{var S=C.sibling;C.sibling=null,C=S}while(C!==null)}}ye=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,ye=l;else e:for(;ye!==null;){if(s=ye,s.flags&2048)switch(s.tag){case 0:case 11:case 15:La(9,s,s.return)}var _=s.sibling;if(_!==null){_.return=s.return,ye=_;break e}ye=s.return}}var E=t.current;for(ye=E;ye!==null;){l=ye;var h=l.child;if(l.subtreeFlags&2064&&h!==null)h.return=l,ye=h;else e:for(l=E;ye!==null;){if(c=ye,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:$c(9,c)}}catch(T){ht(c,c.return,T)}if(c===l){ye=null;break e}var k=c.sibling;if(k!==null){k.return=c.return,ye=k;break e}ye=c.return}}if(De=i,Oi(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Oc,t)}catch{}r=!0}return r}finally{We=n,Wn.transition=e}}return!1}function by(t,e,n){e=_o(n,e),e=j3(t,e,1),t=Ni(t,e,1),e=rn(),t!==null&&(dl(t,1,e),_n(t,e))}function ht(t,e,n){if(t.tag===3)by(t,t,n);else for(;e!==null;){if(e.tag===3){by(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Pi===null||!Pi.has(r))){t=_o(n,t),t=O3(e,t,1),e=Ni(e,t,1),t=rn(),e!==null&&(dl(e,1,t),_n(e,t));break}}e=e.return}}function rw(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=rn(),t.pingedLanes|=t.suspendedLanes&n,Rt===t&&(Bt&n)===n&&(Tt===4||Tt===3&&(Bt&130023424)===Bt&&500>yt()-rg?us(t,0):ng|=n),_n(t,e)}function r5(t,e){e===0&&(t.mode&1?(e=wu,wu<<=1,!(wu&130023424)&&(wu=4194304)):e=1);var n=rn();t=Zr(t,e),t!==null&&(dl(t,e,n),_n(t,n))}function iw(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),r5(t,n)}function sw(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(e),r5(t,n)}var i5;i5=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||xn.current)yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yn=!1,H8(t,e,n);yn=!!(t.flags&131072)}else yn=!1,it&&e.flags&1048576&&l3(e,gc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Yu(t,e),t=e.pendingProps;var i=yo(e,Jt.current);fo(e,n),i=Qp(null,e,r,t,i,n);var s=Zp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wn(r)?(s=!0,hc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,$p(e),i.updater=Wc,e.stateNode=i,i._reactInternals=e,z0(e,r,t,n),e=G0(null,e,r,!0,s,n)):(e.tag=0,it&&s&&Dp(e),nn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Yu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=aw(r),t=ir(r,t),i){case 0:e=U0(null,e,r,t,n);break e;case 1:e=yy(null,e,r,t,n);break e;case 11:e=gy(null,e,r,t,n);break e;case 14:e=my(null,e,r,ir(r.type,t),n);break e}throw Error(se(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),U0(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),yy(t,e,r,i,n);case 3:e:{if(U3(e),t===null)throw Error(se(387));r=e.pendingProps,s=e.memoizedState,i=s.element,p3(t,e),vc(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=_o(Error(se(423)),e),e=vy(t,e,r,n,i);break e}else if(r!==i){i=_o(Error(se(424)),e),e=vy(t,e,r,n,i);break e}else for(Tn=bi(e.stateNode.containerInfo.firstChild),En=e,it=!0,or=null,n=f3(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vo(),r===i){e=qr(t,e,n);break e}nn(t,e,r,n)}e=e.child}return e;case 5:return g3(e),t===null&&j0(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,A0(r,i)?l=null:s!==null&&A0(r,s)&&(e.flags|=32),B3(t,e),nn(t,e,l,n),e.child;case 6:return t===null&&j0(e),null;case 13:return G3(t,e,n);case 4:return Hp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=xo(e,null,r,n):nn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),gy(t,e,r,i,n);case 7:return nn(t,e,e.pendingProps,n),e.child;case 8:return nn(t,e,e.pendingProps.children,n),e.child;case 12:return nn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,Ke(mc,r._currentValue),r._currentValue=l,s!==null)if(fr(s.value,l)){if(s.children===i.children&&!xn.current){e=qr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var c=s.dependencies;if(c!==null){l=s.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Hr(-1,n&-n),u.tag=2;var f=s.updateQueue;if(f!==null){f=f.shared;var p=f.pending;p===null?u.next=u:(u.next=p.next,p.next=u),f.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),O0(s.return,n,e),c.lanes|=n;break}u=u.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(se(341));l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),O0(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}nn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,fo(e,n),i=$n(i),r=r(i),e.flags|=1,nn(t,e,r,n),e.child;case 14:return r=e.type,i=ir(r,e.pendingProps),i=ir(r.type,i),my(t,e,r,i,n);case 15:return D3(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),Yu(t,e),e.tag=1,wn(r)?(t=!0,hc(e)):t=!1,fo(e,n),F3(e,r,i),z0(e,r,i,n),G0(null,e,r,!0,t,n);case 19:return V3(t,e,n);case 22:return z3(t,e,n)}throw Error(se(156,e.tag))};function s5(t,e){return Iv(t,e)}function ow(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(t,e,n,r){return new ow(t,e,n,r)}function ag(t){return t=t.prototype,!(!t||!t.isReactComponent)}function aw(t){if(typeof t=="function")return ag(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ep)return 11;if(t===bp)return 14}return 2}function Ai(t,e){var n=t.alternate;return n===null?(n=Vn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qu(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")ag(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case Ks:return cs(n.children,i,s,e);case Tp:l=8,i|=8;break;case u0:return t=Vn(12,n,e,i|2),t.elementType=u0,t.lanes=s,t;case c0:return t=Vn(13,n,e,i),t.elementType=c0,t.lanes=s,t;case d0:return t=Vn(19,n,e,i),t.elementType=d0,t.lanes=s,t;case gv:return Yc(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hv:l=10;break e;case pv:l=9;break e;case Ep:l=11;break e;case bp:l=14;break e;case yi:l=16,r=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=Vn(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function cs(t,e,n,r){return t=Vn(7,t,r,e),t.lanes=n,t}function Yc(t,e,n,r){return t=Vn(22,t,r,e),t.elementType=gv,t.lanes=n,t.stateNode={isHidden:!1},t}function Ih(t,e,n){return t=Vn(6,t,null,e),t.lanes=n,t}function Rh(t,e,n){return e=Vn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function lw(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hh(0),this.expirationTimes=hh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function lg(t,e,n,r,i,s,l,c,u){return t=new lw(t,e,n,c,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Vn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$p(s),t}function uw(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function o5(t){if(!t)return Ri;t=t._reactInternals;e:{if(ys(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(wn(n))return o3(t,n,e)}return e}function a5(t,e,n,r,i,s,l,c,u){return t=lg(n,r,!0,t,i,s,l,c,u),t.context=o5(null),n=t.current,r=rn(),i=Mi(n),s=Hr(r,i),s.callback=e??null,Ni(n,s,i),t.current.lanes=i,dl(t,i,r),_n(t,r),t}function Xc(t,e,n,r){var i=e.current,s=rn(),l=Mi(i);return n=o5(n),e.context===null?e.context=n:e.pendingContext=n,e=Hr(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ni(i,e,l),t!==null&&(cr(t,i,l,s),Wu(t,i,l)),l}function Ec(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ny(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ug(t,e){Ny(t,e),(t=t.alternate)&&Ny(t,e)}function cw(){return null}var l5=typeof reportError=="function"?reportError:function(t){console.error(t)};function cg(t){this._internalRoot=t}Kc.prototype.render=cg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));Xc(t,e,null,null)};Kc.prototype.unmount=cg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;gs(function(){Xc(null,t,null,null)}),e[Qr]=null}};function Kc(t){this._internalRoot=t}Kc.prototype.unstable_scheduleHydration=function(t){if(t){var e=zv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wi.length&&e!==0&&e<wi[n].priority;n++);wi.splice(n,0,t),n===0&&Uv(t)}};function dg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Qc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Py(){}function dw(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var f=Ec(l);s.call(f)}}var l=a5(e,r,t,0,null,!1,!1,"",Py);return t._reactRootContainer=l,t[Qr]=l.current,Ka(t.nodeType===8?t.parentNode:t),gs(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var c=r;r=function(){var f=Ec(u);c.call(f)}}var u=lg(t,0,!1,null,null,!1,!1,"",Py);return t._reactRootContainer=u,t[Qr]=u.current,Ka(t.nodeType===8?t.parentNode:t),gs(function(){Xc(e,u,n,r)}),u}function Zc(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var c=i;i=function(){var u=Ec(l);c.call(u)}}Xc(e,l,t,i)}else l=dw(n,e,t,i,r);return Ec(l)}Ov=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ca(e.pendingLanes);n!==0&&(Mp(e,n|1),_n(e,yt()),!(De&6)&&(So=yt()+500,Oi()))}break;case 13:gs(function(){var r=Zr(t,1);if(r!==null){var i=rn();cr(r,t,1,i)}}),ug(t,1)}};Ap=function(t){if(t.tag===13){var e=Zr(t,134217728);if(e!==null){var n=rn();cr(e,t,134217728,n)}ug(t,134217728)}};Dv=function(t){if(t.tag===13){var e=Mi(t),n=Zr(t,e);if(n!==null){var r=rn();cr(n,t,e,r)}ug(t,e)}};zv=function(){return We};Bv=function(t,e){var n=We;try{return We=t,e()}finally{We=n}};_0=function(t,e,n){switch(e){case"input":if(p0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Uc(r);if(!i)throw Error(se(90));yv(r),p0(r,i)}}}break;case"textarea":xv(t,n);break;case"select":e=n.value,e!=null&&ao(t,!!n.multiple,e,!1)}};Ev=ig;bv=gs;var fw={usingClientEntryPoint:!1,Events:[hl,Js,Uc,Cv,Tv,ig]},ha={findFiberByHostInstance:os,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hw={bundleType:ha.bundleType,version:ha.version,rendererPackageName:ha.rendererPackageName,rendererConfig:ha.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Mv(t),t===null?null:t.stateNode},findFiberByHostInstance:ha.findFiberByHostInstance||cw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Au.isDisabled&&Au.supportsFiber)try{Oc=Au.inject(hw),Nr=Au}catch{}}Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fw;Nn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dg(e))throw Error(se(200));return uw(t,e,null,n)};Nn.createRoot=function(t,e){if(!dg(t))throw Error(se(299));var n=!1,r="",i=l5;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=lg(t,1,!1,null,null,n,!1,r,i),t[Qr]=e.current,Ka(t.nodeType===8?t.parentNode:t),new cg(e)};Nn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=Mv(e),t=t===null?null:t.stateNode,t};Nn.flushSync=function(t){return gs(t)};Nn.hydrate=function(t,e,n){if(!Qc(e))throw Error(se(200));return Zc(null,t,e,!0,n)};Nn.hydrateRoot=function(t,e,n){if(!dg(t))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=l5;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=a5(e,null,t,1,n??null,i,!1,s,l),t[Qr]=e.current,Ka(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Kc(e)};Nn.render=function(t,e,n){if(!Qc(e))throw Error(se(200));return Zc(null,t,e,!1,n)};Nn.unmountComponentAtNode=function(t){if(!Qc(t))throw Error(se(40));return t._reactRootContainer?(gs(function(){Zc(null,null,t,!1,function(){t._reactRootContainer=null,t[Qr]=null})}),!0):!1};Nn.unstable_batchedUpdates=ig;Nn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Qc(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return Zc(t,e,n,!1,r)};Nn.version="18.3.1-next-f1338f8080-20240426";function u5(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u5)}catch(t){console.error(t)}}u5(),uv.exports=Nn;var pw=uv.exports,My=pw;a0.createRoot=My.createRoot,a0.hydrateRoot=My.hydrateRoot;const Ay=({isLoading:t,onSave:e,onSaveAs:n,canSaveAs:r,onLoad:i,onClear:s,buttonStyle:l})=>P.jsxs("div",{className:"flex flex-wrap gap-2",children:[P.jsx("button",{style:{...l(!1),opacity:t?.5:1},onClick:e,disabled:t,title:"Save as PNML",children:"Save"}),P.jsx("button",{style:{...l(!1),opacity:t||!r?.5:1},onClick:n,disabled:t||!r,title:"Save As (choose location and filename)",children:"Save as"}),P.jsx("button",{style:{...l(!1),opacity:t?.5:1},onClick:i,disabled:t,title:"Load PNML file",children:"Load"}),P.jsx("button",{style:{...l(!1)},onClick:s,title:"Clear canvas",children:"Clear"})]}),gw=({mode:t,setMode:e,buttonStyle:n})=>P.jsxs("div",{className:"flex flex-wrap gap-2",children:[P.jsx("button",{style:{...n(t==="select")},"data-testid":"toolbar-select",onClick:()=>{t!=="select"&&e("select")},children:"Select"}),P.jsx("button",{style:n(t==="place"),"data-testid":"toolbar-place",onClick:()=>{t!=="place"&&e("place")},children:"Place"}),P.jsx("button",{style:n(t==="transition"),"data-testid":"toolbar-transition",onClick:()=>{t!=="transition"&&e("transition")},children:"Transition"}),P.jsx("button",{style:n(t==="arc"),"data-testid":"toolbar-arc",onClick:()=>{t!=="arc"&&e("arc")},children:"Arc"})]}),mw=({canUndo:t,canRedo:e,onUndo:n,onRedo:r,buttonStyle:i})=>P.jsxs("div",{className:"flex flex-wrap gap-2",children:[P.jsx("button",{style:{...i(!1),opacity:t?1:.5},onClick:n,disabled:!t,title:"Undo (Ctrl+Z)",children:"Undo"}),P.jsx("button",{style:{...i(!1),opacity:e?1:.5},onClick:r,disabled:!e,title:"Redo (Ctrl+Y)",children:"Redo"})]}),Iy=({onOpenSettings:t,buttonStyle:e})=>P.jsx("div",{className:"flex flex-wrap gap-2",children:P.jsx("button",{style:e(!1),onClick:t,title:"Simulation Settings","data-testid":"toolbar-settings",children:"Settings"})});function Lh(t){const e={types:[]};try{const r=new DOMParser().parseFromString(t,"application/xml"),i=r.getElementsByTagName("parsererror")[0];if(i)throw new Error(i.textContent||"Invalid XML");const l=Array.from(r.getElementsByTagName("*")).filter(f=>f.localName==="algebraicDataTypes")[0];if(!l)return e;const u=Array.from(l.childNodes).filter(f=>f.nodeType===1).filter(f=>f.localName==="type");for(const f of u){const p=f.getAttribute("name")||"",w=Array.from(f.childNodes).filter(S=>S.nodeType===1&&S.localName==="operation").map(S=>{const E=Array.from(S.childNodes).filter(h=>h.nodeType===1&&h.localName==="param").map(h=>({index:Number(h.getAttribute("index")||"0"),type:h.getAttribute("type")||""}));return{name:S.getAttribute("name")||"",arity:Number(S.getAttribute("arity")||"0"),result:S.getAttribute("result")||"",params:E}}),y=Array.from(f.childNodes).find(S=>S.nodeType===1&&S.localName==="axioms"),C=(y?Array.from(y.childNodes).filter(S=>S.nodeType===1&&S.localName==="axiom"):[]).map(S=>({name:S.getAttribute("name")||"",equation:(S.textContent||"").trim()}));e.types.push({name:p,operations:w,axioms:C})}return e}catch(n){return console.error("Error parsing ADT XML:",n),e}}function yw(t){const e=[],n=new Set;for(const r of t.types||[]){r.name||e.push("Type missing name"),n.has(r.name)&&e.push(`Duplicate type: ${r.name}`),n.add(r.name);for(const i of r.operations||[])i.name||e.push(`Operation missing name in type ${r.name}`),(!Number.isInteger(i.arity)||i.arity<0)&&e.push(`Invalid arity for ${r.name}.${i.name}`),i.result||e.push(`Operation ${r.name}.${i.name} missing result type`);for(const i of r.axioms||[])(!i.equation||!i.equation.includes("="))&&e.push(`Axiom in ${r.name} must be an equation with '='`)}return{valid:e.length===0,errors:e}}const vw=`<?xml version="1.0"?>
<algebraicDataTypes xmlns="http://example.org/apn-adt">
  <type name="Int">
    <operation name="+" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="-" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="*" arity="2" result="Int">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&lt;" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&lt;=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&gt;" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <operation name="&gt;=" arity="2" result="Bool">
      <param index="0" type="Int"/>
      <param index="1" type="Int"/>
    </operation>
    <axioms>
      <axiom name="commutativity">x + y = y + x</axiom>
      <axiom name="associativity">(x + y) + z = x + (y + z)</axiom>
      <axiom name="multiplication_commutativity">x * y = y * x</axiom>
      <axiom name="multiplication_associativity">(x * y) * z = x * (y * z)</axiom>
      <axiom name="distributivity">x * (y + z) = (x * y) + (x * z)</axiom>
    </axioms>
  </type>
  <type name="Bool">
    <operation name="and" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="or" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="not" arity="1" result="Bool">
      <param index="0" type="Bool"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Bool"/>
      <param index="1" type="Bool"/>
    </operation>
    <axioms>
      <axiom name="and_commutativity">x and y = y and x</axiom>
      <axiom name="and_associativity">(x and y) and z = x and (y and z)</axiom>
      <axiom name="or_commutativity">x or y = y or x</axiom>
      <axiom name="or_associativity">(x or y) or z = x or (y or z)</axiom>
      <axiom name="de_morgan_and">not (x and y) = (not x) or (not y)</axiom>
      <axiom name="de_morgan_or">not (x or y) = (not x) and (not y)</axiom>
      <axiom name="double_negation">not (not x) = x</axiom>
    </axioms>
  </type>
  <type name="Pair">
    <operation name="fst" arity="1" result="Any">
      <param index="0" type="Pair"/>
    </operation>
    <operation name="snd" arity="1" result="Any">
      <param index="0" type="Pair"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="Pair"/>
      <param index="1" type="Pair"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="Pair"/>
      <param index="1" type="Pair"/>
    </operation>
    <axioms>
      <axiom name="pair_equality">(x, y) == (a, b) = (x == a) and (y == b)</axiom>
      <axiom name="fst_projection">fst((x, y)) = x</axiom>
      <axiom name="snd_projection">snd((x, y)) = y</axiom>
    </axioms>
  </type>
  <type name="String">
    <operation name="concat" arity="2" result="String">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="substring" arity="3" result="String">
      <param index="0" type="String"/>
      <param index="1" type="Int"/>
      <param index="2" type="Int"/>
    </operation>
    <operation name="isSubstringOf" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="length" arity="1" result="Int">
      <param index="0" type="String"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="String"/>
      <param index="1" type="String"/>
    </operation>
    <axioms>
      <axiom name="concat_associativity">concat(concat(x, y), z) = concat(x, concat(y, z))</axiom>
      <axiom name="concat_empty_left">concat('', x) = x</axiom>
      <axiom name="concat_empty_right">concat(x, '') = x</axiom>
      <axiom name="substring_bounds">substring(x, 0, length(x)) = x</axiom>
      <axiom name="length_concat">length(concat(x, y)) = length(x) + length(y)</axiom>
    </axioms>
  </type>
  <type name="List">
    <operation name="length" arity="1" result="Int">
      <param index="0" type="List"/>
    </operation>
    <operation name="concat" arity="2" result="List">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="head" arity="1" result="Any">
      <param index="0" type="List"/>
    </operation>
    <operation name="tail" arity="1" result="List">
      <param index="0" type="List"/>
    </operation>
    <operation name="append" arity="2" result="List">
      <param index="0" type="List"/>
      <param index="1" type="Any"/>
    </operation>
    <operation name="sublist" arity="3" result="List">
      <param index="0" type="List"/>
      <param index="1" type="Int"/>
      <param index="2" type="Int"/>
    </operation>
    <operation name="isSublistOf" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="==" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <operation name="!=" arity="2" result="Bool">
      <param index="0" type="List"/>
      <param index="1" type="List"/>
    </operation>
    <axioms>
      <axiom name="length_empty">length([]) = 0</axiom>
      <axiom name="concat_empty_left">concat([], x) = x</axiom>
      <axiom name="concat_empty_right">concat(x, []) = x</axiom>
      <axiom name="head_cons">head([h | t]) = h</axiom>
      <axiom name="tail_cons">tail([h | t]) = t</axiom>
      <axiom name="length_concat">length(concat(x, y)) = length(x) + length(y)</axiom>
    </axioms>
  </type>
</algebraicDataTypes>`,c5=z.createContext(null);function xw({children:t}){const e=z.useMemo(()=>Lh(vw),[]),[n,r]=z.useState([]),i=z.useMemo(()=>{const p=new Map;for(const m of e.types||[])p.set(m.name,{...m,__readonly:!0});for(const m of n){const w=Lh(m);for(const y of w.types||[])p.has(y.name)||p.set(y.name,{...y,__readonly:!1})}return p},[e,n]),s=z.useCallback(()=>Array.from(i.keys()),[i]),l=z.useCallback(p=>i.get(p)||null,[i]),c=z.useCallback(p=>{const m=Lh(p),w=yw(m);if(!w.valid)return{ok:!1,errors:w.errors};for(const y of m.types||[])if(i.has(y.name))return{ok:!1,errors:[`Duplicate type: ${y.name}`]};return r(y=>[...y,p]),{ok:!0}},[i]),u=z.useCallback(()=>n.join(`
`),[n]),f=z.useMemo(()=>({listTypes:s,getType:l,registerCustomADTXml:c,exportCustomADTXml:u,baseReadOnly:!0,addOrReplaceCustomADT:p=>c(p),clearCustomADTs:()=>r([])}),[s,l,c,u]);return P.jsx(c5.Provider,{value:f,children:t})}function ww(){const t=z.useContext(c5);if(!t)throw new Error("useAdtRegistry must be used within AdtProvider");return t}function zt(t){if(typeof t!="string")throw new Error("Expression must be a string");const e=t.trim();let n=0;function r(S){return S>="0"&&S<="9"}function i(){for(;n<e.length&&/\s/.test(e[n]);)n++}function s(){i();let S=n;for(;n<e.length&&r(e[n]);)n++;if(S===n)throw new Error(`Expected int at position ${n}`);const _=e.slice(S,n);return{type:"int",value:parseInt(_,10)}}function l(S){return/[A-Za-z_]/.test(S)}function c(S){return/[A-Za-z0-9_]/.test(S)}function u(){if(i(),e[n]!=="'")throw new Error(`Expected string literal at position ${n}`);n++;let S="";for(;n<e.length&&e[n]!=="'";){if(e[n]==="\\"&&n+1<e.length){n++;const _=e[n];_==="n"?S+=`
`:_==="t"?S+="	":_==="r"?S+="\r":_==="\\"?S+="\\":_==="'"?S+="'":S+=_}else S+=e[n];n++}if(n>=e.length)throw new Error("Unterminated string literal");return n++,{type:"string",value:S}}function f(){i();let S=n;if(!l(e[n]))throw new Error(`Expected identifier at position ${n}`);for(n++;n<e.length&&c(e[n]);)n++;const _=e.slice(S,n);if(_&&/^[A-Z]/.test(_))throw new Error(`Variable names must start with lowercase letter, got '${_}' (use 't' instead of 'T', 'f' instead of 'F')`);if(i(),e[n]==="("){n++;const h=[];if(i(),e[n]!==")")do if(i(),h.push(y()),i(),e[n]===",")n++;else break;while(n<e.length);if(i(),e[n]!==")")throw new Error(`Expected ')' after function arguments at position ${n}`);return n++,{type:"funcall",name:_,args:h}}const E=n;if(i(),e[n]===":"){n++,i();const h=n;for(;n<e.length&&/[A-Za-z]/.test(e[n]);)n++;const k=e.slice(h,n).toLowerCase();return k==="int"||k==="bool"||k==="pair"||k==="string"||k==="list"?{type:"var",name:_,varType:k}:(n=E,{type:"var",name:_})}return{type:"var",name:_}}function p(){if(i(),e[n]!=="[")throw new Error(`Expected '[' at position ${n}`);n++;const S=[];if(i(),e[n]==="]")return n++,{type:"list",elements:[]};for(;n<e.length;){if(i(),S.push(y()),i(),e[n]==="]")return n++,{type:"list",elements:S};if(e[n]===","){n++;continue}throw new Error(`Expected ',' or ']' at position ${n}`)}throw new Error("Unterminated list literal")}function m(){if(i(),n>=e.length)throw new Error(`Unexpected end of input at position ${n}`);if(e[n]==="("){n++,i();const S=y();if(i(),e[n]===","){n++;const _=y();if(i(),n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,{type:"pair",fst:S,snd:_}}if(n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,S}if(e[n]==="[")return p();if(e[n]==="'")return u();if(r(e[n]))return s();if(/[A-Za-z_]/.test(e[n]))return f();throw new Error(`Unexpected character '${e[n]}' at position ${n}`)}function w(){let S=m();for(i();n<e.length&&(e[n]==="*"||e[n]==="/");){const _=e[n++],E=m();S={type:"binop",op:_,left:S,right:E},i()}return S}function y(){let S=w();for(i();n<e.length&&(e[n]==="+"||e[n]==="-");){const _=e[n++],E=w();S={type:"binop",op:_,left:S,right:E},i()}return S}let x=y();if(i(),n<e.length)throw new Error(`Unexpected character '${e[n]}' at position ${n}`);function C(S){return!S||typeof S!="object"||(S.type==="bin"&&(S.type="binop"),S.left&&(S.left=C(S.left)),S.right&&(S.right=C(S.right)),Array.isArray(S.args)&&(S.args=S.args.map(C)),Array.isArray(S.elements)&&(S.elements=S.elements.map(C))),S}return x=C(x),x}function d5(t){if(typeof t!="string")throw new Error("Pattern must be a string");const e=t.trim();let n=0;function r(){for(;n<e.length&&/\s/.test(e[n]);)n++}function i(){if(r(),n>=e.length)throw new Error(`Unexpected end of input at position ${n}`);if(e.slice(n,n+1)==="T")return n++,{type:"boolLit",value:!0};if(e.slice(n,n+1)==="F")return n++,{type:"boolLit",value:!1};if(e.slice(n,n+4)==="true")return n+=4,{type:"boolLit",value:!0};if(e.slice(n,n+5)==="false")return n+=5,{type:"boolLit",value:!1};if(/[0-9]/.test(e[n])){let l=n;for(;n<e.length&&/[0-9]/.test(e[n]);)n++;return{type:"int",value:parseInt(e.slice(l,n),10)}}if(e[n]==="["){n++,r();const l=[];for(;n<e.length&&e[n]!=="]";)l.push(i()),r(),e[n]===","&&(n++,r());if(n>=e.length||e[n]!=="]")throw new Error(`Expected ']' at position ${n}`);return n++,{type:"listPattern",elements:l}}if(/[a-zA-Z_]/.test(e[n])){let l=n;for(;n<e.length&&/[a-zA-Z0-9_]/.test(e[n]);)n++;const c=e.slice(l,n);if(r(),e[n]===":"){n++,r();let u=n;for(;n<e.length&&/[a-zA-Z]/.test(e[n]);)n++;const f=e.slice(u,n).toLowerCase();if(f==="int"||f==="bool"||f==="pair"||f==="string"||f==="list")return{type:"var",name:c,varType:f};throw new Error(`Unknown type '${f}' at position ${u}`)}return{type:"var",name:c}}if(e[n]==="("){n++,r();const l=[];for(;n<e.length&&e[n]!==")";)l.push(i()),r(),n<e.length&&e[n]===","&&(n++,r());if(n>=e.length||e[n]!==")")throw new Error(`Expected ')' at position ${n}`);return n++,l.length===2?{type:"pairPattern",fst:l[0],snd:l[1]}:{type:"tuplePattern",elements:l}}throw new Error(`Unexpected character '${e[n]}' at position ${n}`)}const s=i();if(r(),n<e.length)throw new Error(`Unexpected character '${e[n]}' at position ${n}`);return s}function Ry(t,e){const n=new Map;function r(s,l){switch(s.type){case"int":return!(typeof l!="number"||l!==s.value);case"boolLit":return!(typeof l!="boolean"||l!==s.value);case"var":if(s.varType){const c=s.varType;if(c==="int"&&typeof l!="number"||c==="bool"&&typeof l!="boolean"||c==="string"&&typeof l!="string"||c==="list"&&!Array.isArray(l)||c==="pair"&&(!l||typeof l!="object"||!l.__pair__))return!1}if(n.has(s.name)){if(n.get(s.name)!==l)return!1}else n.set(s.name,l);return!0;case"pairPattern":return!(!l||typeof l!="object"||!l.__pair__||!r(s.fst,l.fst)||!r(s.snd,l.snd));case"tuplePattern":if(!Array.isArray(l)||l.length!==s.elements.length)return!1;for(let c=0;c<s.elements.length;c++)if(!r(s.elements[c],l[c]))return!1;return!0;case"listPattern":if(!Array.isArray(l)||l.length!==s.elements.length)return!1;for(let c=0;c<s.elements.length;c++)if(!r(s.elements[c],l[c]))return!1;return!0;default:return!1}}return r(t,e)?Object.fromEntries(n):null}function Ly(t,e=20){if(!t)return[];if(Array.isArray(t.valueTokens))return t.valueTokens.slice(0,e);const n=Number(t.tokens||0);return Number.isFinite(n)&&n>0?Array.from({length:Math.min(n,e)},()=>1):[]}function f5(t){return t.replace(/:int\b/g,":Int").replace(/:bool\b/g,":Bool").replace(/:pair\b/g,":Pair").replace(/:string\b/g,":String").replace(/:list\b/g,":List")}function il(t){return typeof t=="number"?"Int":typeof t=="boolean"?"Bool":typeof t=="string"?"String":Array.isArray(t)?"List":t&&typeof t=="object"&&t.__pair__?"Pair":"Int"}function Zu(t,e,n=null,r={}){if(!t||(!e||e.size===0)&&!n)return t;let i=t;const{overwrite:s=!1}=r||{},l=t.match(/\b[a-z][a-zA-Z0-9_]*\b/g);return l&&l.forEach(c=>{if(c!=="true"&&c!=="false"&&c!=="and"&&c!=="or"&&c!=="not"){const u=e.get(c)||n;if(!u)return;if(s){const f=new RegExp(`\\b${c}(?::[A-Za-z]+)?\\b`,"g");i=i.replace(f,`${c}:${u}`)}else if(!t.includes(`${c}:`)){const f=new RegExp(`\\b${c}(?!:)\\b`,"g");i=i.replace(f,`${c}:${u}`)}}}),i}const _w="modulepreload",Sw=function(t,e){return new URL(t,e).href},Fy={},Yr=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Sw(s,r),s in Fy)return;Fy[s]=!0;const l=s.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(!!r)for(let p=i.length-1;p>=0;p--){const m=i[p];if(m.href===s&&(!l||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${c}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":_w,l||(f.as="script",f.crossOrigin=""),f.href=s,document.head.appendChild(f),l)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})},ep={silent:0,error:1,warn:2,info:3,debug:4},kw=(()=>{var r,i,s;const t=typeof globalThis<"u"?globalThis.__PETRI_NET_LOG_LEVEL__:void 0,e=typeof process<"u"?((r=process.env)==null?void 0:r.VITE_LOG_LEVEL)||((i=process.env)==null?void 0:i.LOG_LEVEL):void 0,n=typeof process<"u"&&((s=process.env)==null?void 0:s.NODE_ENV)==="production"?"warn":"debug";return(t||e||n||"warn").toLowerCase()})();function h5(t){if(!t)return"warn";const e=String(t).toLowerCase();return ep[e]!==void 0?e:"warn"}let Cw=h5(kw);function Iu(t){const e=h5(t);return ep[e]<=ep[Cw]}const ve={debug:(...t)=>{Iu("debug")&&console.debug(...t)},info:(...t)=>{Iu("info")&&console.info(...t)},warn:(...t)=>{Iu("warn")&&console.warn(...t)},error:(...t)=>{Iu("error")&&console.error(...t)}};let Fh=null;async function Tw(){if(typeof process<"u"&&process.env&&{}.JEST_WORKER_ID){ve.debug("Jest worker detected, skipping Z3 asset fetch");return}if(typeof document>"u"){if(typeof globalThis.initZ3=="function")return;const e=globalThis.Module;try{const r=(()=>{try{const{origin:y,pathname:x}=self.location||{};if(!y)return"";if(typeof x=="string"){const C=x.indexOf("/assets/");if(C!==-1)return`${y}${x.slice(0,C+1)}`;const S=x.lastIndexOf("/"),_=S>=0?x.slice(0,S+1):"/";return`${y}${_}`}return`${y}/`}catch{return""}})(),i=y=>{const x=y.startsWith("/")?y.slice(1):y;return r?`${r}${x}`:`/${x}`},s=i("z3-built.wasm.base64");ve.debug("[Z3 worker] fetching WASM base64 from",s);const l=await fetch(s);if(!l.ok)throw new Error(`Failed to fetch WASM base64 from ${s}: ${l.status}`);const u=`data:application/wasm;base64,${await l.text()}`,f={...typeof e=="object"?e:{},locateFile:y=>{if(y.endsWith(".wasm"))return ve.debug("[Z3 worker] locateFile",y,"->",`${u.substring(0,50)}...`),u;const x=i(y);return ve.debug("[Z3 worker] locateFile",y,"->",x),x}};globalThis.Module=f;const p=i("z3-built.js"),m=await fetch(p);if(!m.ok)throw new Error(`Failed to fetch z3-built.js from ${p}: ${m.status}`);const w=await m.text();if((0,eval)(w),await new Promise(y=>setTimeout(y,20)),typeof globalThis.initZ3!="function")throw new Error("initZ3 not defined after eval");return}catch(n){throw new Error(`Failed to load Z3 in worker: ${n.message}`)}finally{typeof e=="object"?globalThis.Module=e:delete globalThis.Module}}typeof globalThis.initZ3!="function"&&(ve.debug("initZ3 not found, loading Z3 built assets..."),await new Promise((e,n)=>{const r=document.createElement("script");r.src="/z3-built.js",r.async=!0,r.addEventListener("load",()=>{typeof globalThis.initZ3=="function"?(ve.debug("Z3 built assets loaded successfully"),e()):n(new Error("initZ3 function not found after loading z3-built.js"))}),r.addEventListener("error",i=>{n(new Error(`Failed to load z3-built.js: ${(i==null?void 0:i.message)||i}`))}),document.head.appendChild(r)}))}async function Ew(){return Fh||(Fh=(async()=>{try{ve.debug("Initializing Z3 context..."),await Tw();const{init:t}=await Yr(()=>import("./browser-da8be5b0.js").then(r=>r.b),[],import.meta.url);if(!t)throw new Error("Z3 init function not found. Z3-solver package may not be properly installed.");ve.debug("Calling Z3 init...");const e=await t();if(!e)throw new Error("Z3 initialization failed. Check browser console for WASM loading errors.");ve.debug("Creating Z3 context...");const n=new e.Context("main");if(!n)throw new Error("Failed to create Z3 context.");return ve.debug("Z3 context initialized successfully"),{z3:e,ctx:n}}catch(t){ve.error("Z3 initialization error:",t);const e=typeof process<"u"&&process.env&&{}.JEST_WORKER_ID;if(typeof document<"u"&&!e){ve.debug("Retrying Z3 initialization with asset loading...");try{typeof globalThis.initZ3!="function"&&(ve.debug("initZ3 not found, loading Z3 built assets..."),await new Promise((s,l)=>{const c=document.createElement("script");c.src="/z3-built.js",c.async=!0,c.addEventListener("load",()=>{typeof globalThis.initZ3=="function"?(ve.debug("Z3 built assets loaded successfully"),s()):l(new Error("initZ3 function not found after loading z3-built.js"))}),c.addEventListener("error",u=>{l(new Error(`Failed to load z3-built.js: ${(u==null?void 0:u.message)||u}`))}),document.head.appendChild(c)}));const{init:n}=await Yr(()=>import("./browser-da8be5b0.js").then(s=>s.b),[],import.meta.url),r=await n(),i=new r.Context("main");return ve.debug("Z3 context initialized successfully (fallback)"),{z3:r,ctx:i}}catch(n){ve.error("Fallback Z3 initialization also failed:",n)}}if(e||typeof document>"u"){ve.debug("Retrying Z3 initialization for Node.js...");try{const{init:n}=await Yr(()=>import("./browser-da8be5b0.js").then(s=>s.b),[],import.meta.url),r=await n(),i=new r.Context("main");return ve.debug("Z3 context initialized successfully (Node.js)"),{z3:r,ctx:i}}catch(n){ve.error("Node.js Z3 initialization also failed:",n)}}throw new Error(`initZ3 was not imported correctly. Please consult documentation on how to load Z3 in browser. Details: ${t.message}`)}})()),Fh}function pa(t,e=new Set){return t&&(t.type==="var"&&e.add(t.name),t.type==="pair"&&(pa(t.fst,e),pa(t.snd,e)),t.type==="binop"&&(pa(t.left,e),pa(t.right,e)),t.type==="funcall"&&t.args&&t.args.forEach(n=>pa(n,e))),e}function zn(t,e,n){var s;const{Int:r,String:i}=t;switch(e.type){case"int":return r.val(e.value);case"string":return i.val(e.value);case"pair":const l=zn(t,e.fst,n),c=zn(t,e.snd,n);return l.concat(i.val(",")).concat(c);case"var":return n(e.name);case"funcall":{if(e.name==="length"&&e.args&&e.args.length===1&&((s=e.args[0])==null?void 0:s.type)==="string")return r.val((e.args[0].value||"").length);if(e.name==="concat"&&e.args&&e.args.length===2){const u=zn(t,e.args[0],n),f=zn(t,e.args[1],n);return u.concat(f)}if(e.name==="substring"&&e.args&&e.args.length===3){const u=zn(t,e.args[0],n),f=zn(t,e.args[1],n),p=zn(t,e.args[2],n);return u.substr(f,p)}if(e.name==="length"&&e.args&&e.args.length===1)return zn(t,e.args[0],n).length();throw new Error(`Unknown function '${e.name}'`)}case"binop":{const u=zn(t,e.left,n),f=zn(t,e.right,n);switch(e.op){case"+":return u.add(f);case"-":return u.sub(f);case"*":return u.mul(f);case"/":return u.div(f);default:throw new Error(`Unknown operator '${e.op}'`)}}default:throw new Error(`Unknown AST node '${e.type}'`)}}function lr(t,e){function n(r){if(r.type==="int")return r.value|0;if(r.type==="string")return r.value;if(r.type==="list")return(r.elements||[]).map(n);if(r.type==="pair")return{__pair__:!0,fst:n(r.fst),snd:n(r.snd)};if(r.type==="var"){const i=e==null?void 0:e[r.name];if(i===void 0)throw new Error(`Unbound variable '${r.name}'`);return i}if(r.type==="funcall"){if(r.name==="concat"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(typeof i=="string"&&typeof s=="string")return i+s;if(Array.isArray(i)&&Array.isArray(s))return[...i,...s];throw new Error("concat requires two strings or two lists")}if(r.name==="substring"&&r.args&&r.args.length===3){const i=n(r.args[0]),s=n(r.args[1]),l=n(r.args[2]);if(typeof i!="string"||typeof s!="number"||typeof l!="number")throw new Error("substring requires string, int, int");return i.substr(s,l)}if(r.name==="length"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Error("length requires string or list")}if(r.name==="isSubstringOf"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(typeof i!="string"||typeof s!="string")throw new Error("isSubstringOf requires two strings");return s.includes(i)}if(r.name==="head"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!Array.isArray(i)||i.length===0)throw new Error("head requires non-empty list");return i[0]}if(r.name==="tail"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!Array.isArray(i))throw new Error("tail requires list");return i.length===0?[]:i.slice(1)}if(r.name==="append"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(!Array.isArray(i))throw new Error("append requires list");return[...i,s]}if(r.name==="sublist"&&r.args&&r.args.length===3){const i=n(r.args[0]),s=n(r.args[1]),l=n(r.args[2]);if(!Array.isArray(i)||typeof s!="number"||typeof l!="number")throw new Error("sublist requires list, int, int");return i.slice(s,s+l)}if(r.name==="isSublistOf"&&r.args&&r.args.length===2){const i=n(r.args[0]),s=n(r.args[1]);if(!Array.isArray(i)||!Array.isArray(s))throw new Error("isSublistOf requires two lists");const l=i.length;if(l===0)return!0;for(let c=0;c<=s.length-l;c++){let u=!0;for(let f=0;f<l;f++)if(s[c+f]!==i[f]){u=!1;break}if(u)return!0}return!1}if(r.name==="fst"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!i||typeof i!="object"||i.__pair__!==!0)throw new Error("fst requires pair");return i.fst}if(r.name==="snd"&&r.args&&r.args.length===1){const i=n(r.args[0]);if(!i||typeof i!="object"||i.__pair__!==!0)throw new Error("snd requires pair");return i.snd}throw new Error(`Unknown function '${r.name}'`)}if(r.type==="binop"){const i=n(r.left),s=n(r.right);if(typeof i!="number"||typeof s!="number")throw new Error("Arithmetic operands must be numbers");switch(r.op){case"+":return i+s|0;case"-":return i-s|0;case"*":return i*s|0;case"/":if(s===0)throw new Error("Division by zero");return Math.trunc(i/s)|0;default:throw new Error(`Unknown operator '${r.op}'`)}}throw new Error(`Unknown node type '${r.type}'`)}return n(t)}function bw(t,e){if(typeof t!="string")throw new Error("Predicate must be a string");const n=t.trim(),r=[">=","<=","==","!=",">","<"];let i=0,s=-1,l=null;for(let m=0;m<n.length;m++){const w=n[m];if(w==="("?i++:w===")"&&(i=Math.max(0,i-1)),i!==0)continue;const y=n.slice(m,m+2);if(r.includes(y)){l=y,s=m;break}if(r.includes(w)){l=w,s=m;break}}if(!l||s<0)throw new Error("Predicate must contain a comparison operator");const c=n.slice(0,s).trim(),u=n.slice(s+l.length).trim(),f=e(c),p=e(u);return{type:"cmp",op:l,left:f,right:p}}function ko(t,e){if(typeof t!="string")throw new Error("Boolean expression must be a string");const n=t.trim();let r=0;const i=()=>{for(;r<n.length&&/\s/.test(n[r]);)r++},s=(k,T)=>(k===0||/[^A-Za-z0-9_]/.test(n[k-1]||""))&&(k+T===n.length||/[^A-Za-z0-9_]/.test(n[k+T]||"")),l=k=>(i(),n.slice(r,r+k.length).toLowerCase()===k&&s(r,k.length)),c=()=>{i();const k=r;if(!/[A-Za-z_]/.test(n[r]||""))throw new Error(`Expected identifier at position ${r}`);for(r++;r<n.length&&/[A-Za-z0-9_]/.test(n[r]);)r++;const T=n.slice(k,r);if(T&&/^[A-Z]/.test(T))throw new Error(`Variable names must start with lowercase letter, got '${T}'`);const N=r;if(i(),n[r]===":"){r++,i();const I=r;for(;r<n.length&&/[A-Za-z]/.test(n[r]);)r++;const M=n.slice(I,r).toLowerCase();return M==="int"||M==="bool"||M==="pair"?{name:T,varType:M}:(r=N,{name:T})}return{name:T}},u=k=>{const T=String(k||"").trim();if(/^true$/i.test(T)||T==="T")return{type:"boolLit",value:!0};if(/^false$/i.test(T)||T==="F")return{type:"boolLit",value:!1};if(/^-?\d+$/.test(T))return{type:"int",value:parseInt(T,10)};if(T.startsWith("(")&&T.endsWith(")")){const L=T.slice(1,-1).trim();let A=0,R=-1;for(let j=0;j<L.length;j++){const G=L[j];if(G==="(")A++;else if(G===")")A=Math.max(0,A-1);else if(G===","&&A===0){R=j;break}}if(R>=0){const j=L.slice(0,R).trim(),G=L.slice(R+1).trim();if(j.length&&G.length)return{type:"pairLit",fst:u(j),snd:u(G)}}}try{if(typeof e=="function")return e(T)}catch{}const N=T.match(/^([A-Za-z_][A-Za-z0-9_]*)(?::([A-Za-z]+))?$/);if(!N)throw new Error(`Unrecognized term '${T}'`);const I=N[1];if(I&&/^[A-Z]/.test(I))throw new Error(`Variable names must start with lowercase letter, got '${I}'`);const M=(N[2]||"").toLowerCase();return M==="bool"?{type:"boolVar",name:I,varType:"bool"}:M==="pair"?{type:"pairVar",name:I,varType:"pair"}:{type:"var",name:I}},f=()=>{if(i(),r>=n.length)throw new Error("Unexpected end");if(n[r]==="T"&&s(r,1))return r+=1,{type:"boolLit",value:!0};if(n[r]==="F"&&s(r,1))return r+=1,{type:"boolLit",value:!1};if(l("true"))return r+=4,{type:"boolLit",value:!0};if(l("false"))return r+=5,{type:"boolLit",value:!1};if(n.slice(r).startsWith("isSubstringOf")){if(r+=13,i(),n[r]!=="(")throw new Error("Expected '('");let A=r+1,R=1;for(r++;r<n.length&&R>0;r++){const D=n[r];D==="("?R++:D===")"&&R--}if(R!==0)throw new Error("Unterminated isSubstringOf arguments");const j=n.slice(A,r-1).trim();let G=0,U="";const O=[];for(let D=0;D<j.length;D++){const X=j[D];if(X==="("){G++,U+=X;continue}if(X===")"){G=Math.max(0,G-1),U+=X;continue}if(X===","&&G===0){O.push(U.trim()),U="";continue}U+=X}if(U.trim().length&&O.push(U.trim()),O.length!==2)throw new Error("isSubstringOf expects two arguments");const V=e(O[0]),$=e(O[1]);return{type:"boolFuncall",name:"isSubstringOf",args:[V,$]}}const k=[">=","<=","==","!=",">","<"];let T=0,N=-1,I=null;for(let A=r;A<n.length;A++){const R=n[A];if(R==="("?T++:R===")"&&(T=Math.max(0,T-1)),T!==0)continue;if(n.slice(A,A+3)==="<->"){A+=2;continue}if(n.slice(A,A+2)==="->"){A+=1;continue}const j=n.slice(A,A+2);if(k.includes(j)){I=j,N=A;break}if(k.includes(R)){I=R,N=A;break}}if(I&&N>=0){const A=n.slice(r,N).trim(),R=N+I.length;let j=n.length;T=0;const G=(D,X)=>(D===0||/[^A-Za-z0-9_]/.test(n[D-1]||""))&&(D+X===n.length||/[^A-Za-z0-9_]/.test(n[D+X]||"")),U=D=>{const X=n.slice(D),H=["&&","||","^","->","<->"],re=["and","or","xor","implies","iff"];for(const K of H)if(X.startsWith(K))return!0;for(const K of re)if(X.toLowerCase().startsWith(K)&&G(D,K.length))return!0;return!1};for(let D=R;D<n.length;D++){const X=n[D];if(X==="("){T++;continue}if(X===")"){if(T===0){j=D;break}T=Math.max(0,T-1);continue}if(T===0&&U(D)){j=D;break}}const O=n.slice(R,j).trim(),V=u(A),$=u(O);return r=j,{type:"cmp",op:I,left:V,right:$}}if(n[r]==="("){r++;const A=E();if(i(),n[r]!==")")throw new Error(`Expected ')' at ${r}`);return r++,A}const{name:M,varType:L}=c();return L?{type:"boolVar",name:M,varType:L}:{type:"boolVar",name:M}},p={not:["not"],and:["and"],xor:["xor"],or:["or"],implies:["implies"],iff:["iff"]},m={not:["!"],and:["&&"],xor:["^"],or:["||"],implies:["->"],iff:["<->"]},w=(k,T)=>{i();for(const N of k)if(n.slice(r,r+N.length)===N)return r+=N.length,!0;for(const N of T)if(n.slice(r,r+N.length).toLowerCase()===N&&s(r,N.length))return r+=N.length,!0;return!1},y=()=>(i(),w(m.not,p.not)?{type:"not",expr:y()}:f()),x=()=>{let k=y();for(;i(),w(m.and,p.and);){const T=y();k={type:"and",left:k,right:T}}return k},C=()=>{let k=x();for(;i(),w(m.xor,p.xor);){const T=x();k={type:"xor",left:k,right:T}}return k},S=()=>{let k=C();for(;i(),w(m.or,p.or);){const T=C();k={type:"or",left:k,right:T}}return k},_=()=>{let k=S();for(;i(),w(m.implies,p.implies);){const T=S();k={type:"implies",left:k,right:T}}return k},E=()=>{let k=_();for(;i(),w(m.iff,p.iff);){const T=_();k={type:"iff",left:k,right:T}}return k},h=E();if(i(),r!==n.length)throw new Error(`Unexpected token '${n[r]}' at position ${r}`);return h}function po(t,e,n){const r=l=>{if(typeof l=="boolean")return l;if(typeof l=="number")return l!==0;if(l&&typeof l=="object"&&l.__pair__)return!0;throw new Error("Non-bool binding in bool expression")},i=l=>{if(!l)throw new Error("Invalid term");if(l.type==="int"||l.type==="bin"||l.type==="var"){try{return lr(l,e)}catch{}if(l.type==="var"&&typeof(e==null?void 0:e[l.name])<"u")return e[l.name]}return l.type==="boolLit"?!!l.value:l.type==="boolVar"?!!(e!=null&&e[l.name]):l.type==="pairVar"?e==null?void 0:e[l.name]:l.type==="pairLit"?{__pair__:!0,fst:i(l.fst),snd:i(l.snd)}:lr(l,e)},s=l=>{switch(l.type){case"boolLit":return!!l.value;case"boolVar":return r(e==null?void 0:e[l.name]);case"boolFuncall":{if(l.name==="isSubstringOf"&&l.args&&l.args.length===2){const c=lr(l.args[0],e||{}),u=lr(l.args[1],e||{});if(typeof c!="string"||typeof u!="string")throw new Error("isSubstringOf requires two string arguments");return u.includes(c)}throw new Error(`Unknown boolean function '${l.name}'`)}case"not":return!s(l.expr);case"and":return s(l.left)&&s(l.right);case"or":return s(l.left)||s(l.right);case"xor":{const c=s(l.left),u=s(l.right);return c&&!u||!c&&u}case"implies":{const c=s(l.left),u=s(l.right);return!c||u}case"iff":{const c=s(l.left),u=s(l.right);return c===u}case"cmp":{const c=i(l.left),u=i(l.right),f=(p,m)=>p&&typeof p=="object"&&p.__pair__&&m&&typeof m=="object"&&m.__pair__?f(p.fst,m.fst)&&f(p.snd,m.snd):p===m;switch(l.op){case"==":return f(c,u);case"!=":return!f(c,u);case"<":return c<u;case"<=":return c<=u;case">":return c>u;case">=":return c>=u;default:return!1}}default:throw new Error(`Unknown bool AST node '${l.type}'`)}};return s(t)}async function Nw(t,e,n){const{ctx:r}=await Ew(),{Int:i,Bool:s,Solver:l,And:c,Not:u,Or:f}=r,p=typeof t=="string"?ko(t,n):t,m=new Set,w=new Set,y=h=>{if(h)switch(h.type){case"boolVar":w.add(h.name);break;case"and":case"or":y(h.left),y(h.right);break;case"not":y(h.expr);break;case"cmp":{const k=T=>{T&&(T.type==="var"&&m.add(T.name),T.type==="bin"&&(k(T.left),k(T.right)))};k(h.left),k(h.right);break}}};y(p);const x=new Map(Array.from(m).map(h=>[h,i.const(h)])),C=new Map(Array.from(w).map(h=>[h,s.const(h)])),S=h=>{switch(h.type){case"boolLit":return h.value?s.val(!0):s.val(!1);case"boolVar":return C.get(h.name);case"boolFuncall":{if(h.name==="isSubstringOf"&&h.args&&h.args.length===2)try{const k=lr(h.args[0],e||{}),T=lr(h.args[1],e||{});if(typeof k!="string"||typeof T!="string")throw new Error("isSubstringOf requires two string arguments");return T.includes(k)?s.val(!0):s.val(!1)}catch{try{const T=zn(r,h.args[1],I=>x.get(I)),N=zn(r,h.args[0],I=>x.get(I));return T.contains(N)}catch{return s.val(!1)}}throw new Error(`Unknown boolean function '${h.name}'`)}case"not":return u(S(h.expr));case"and":return c(S(h.left),S(h.right));case"or":return f(S(h.left),S(h.right));case"cmp":{const k=N=>N&&(N.type==="int"||N.type==="var"||N.type==="bin"||N.type==="binop");if(k(h.left)&&k(h.right)){const N=L=>{if(L.type==="int")return i.val(L.value);if(L.type==="var")return x.get(L.name);if(L.type==="bin"||L.type==="binop"){const A=N(L.left),R=N(L.right);switch(L.op){case"+":return A.add(R);case"-":return A.sub(R);case"*":return A.mul(R);case"/":return A.div(R);default:throw new Error("Unknown arithmetic operator")}}throw new Error("Unknown arithmetic AST in bool comparison")},I=N(h.left),M=N(h.right);switch(h.op){case"==":return I.eq(M);case"!=":return u(I.eq(M));case"<":return I.lt(M);case"<=":return I.le(M);case">":return I.gt(M);case">=":return I.ge(M);default:throw new Error(`Unsupported predicate operator '${h.op}'`)}}return po({type:"cmp",op:h.op,left:h.left,right:h.right},e||{})?s.val(!0):s.val(!1)}default:throw new Error(`Unknown bool AST node '${h.type}'`)}},_=new l;try{let h=1e4;try{typeof window<"u"&&window.__Z3_SETTINGS__&&typeof window.__Z3_SETTINGS__.solverTimeoutMs=="number"&&(h=window.__Z3_SETTINGS__.solverTimeoutMs|0)}catch{}_.set("timeout",h)}catch{}if(e&&typeof e=="object"){const h=[];for(const[k,T]of Object.entries(e))x.has(k)&&typeof T=="number"?h.push(x.get(k).eq(i.val(T|0))):C.has(k)&&typeof T=="boolean"&&h.push(C.get(k).eq(T?s.val(!0):s.val(!1)));h.length&&_.add(c(...h))}_.add(S(p));const E=await _.check();return String(E)==="sat"}async function Pw(t,e,n=5){const{solveEquation:r}=await Yr(()=>import("./eval-bool-7ff785a0.js"),[],import.meta.url);return await r(t,e,n)}function Mw(t,e,n=zt){if(!t||typeof t!="string")return{};const r={},i=t.split(",");for(const s of i){const l=s.indexOf("=");if(l===-1)continue;const c=s.slice(0,l).trim(),u=s.slice(l+1).trim();if(!c)continue;const f=n(u);r[c]=lr(f,e)}return r}function Aw(t){return t&&typeof t=="object"&&(t.__pair__||Object.prototype.hasOwnProperty.call(t,"fst")&&Object.prototype.hasOwnProperty.call(t,"snd"))}function Oa(t){return typeof t=="boolean"?t?"T":"F":typeof t=="string"?`'${t}'`:Array.isArray(t)?`[${t.map(Oa).join(", ")}]`:Aw(t)?`(${Oa(t.fst)}, ${Oa(t.snd)})`:String(t)}function p5(t){return!Array.isArray(t)||t.length===0?"":t.map(Oa).join(", ")}const jy="text-xs font-semibold text-gray-600 uppercase tracking-wider";function Iw({isOpen:t,onClose:e}){const n=ww(),r=n.listTypes(),[i,s]=z.useState("x + 2 * y"),[l,c]=z.useState("x=3, y=4"),[u,f]=z.useState(null),[p,m]=z.useState([]),[w,y]=z.useState(null),x=z.useMemo(()=>r.map(h=>n.getType(h)),[r,n]);if(!t)return null;function C(E){const h=String(E||"").trim();if(!h)return{};try{const T=JSON.parse(h);if(T&&typeof T=="object"&&!Array.isArray(T))return T}catch{}const k={};for(const T of h.split(",")){const N=T.trim();if(!N)continue;const I=N.indexOf("=");if(I===-1)continue;const M=N.slice(0,I).trim(),L=N.slice(I+1).trim(),A=Number.parseInt(L,10);M&&(k[M]=Number.isFinite(A)?A:0)}return k}function S(E){let h=0;for(let k=0;k<E.length;k++){const T=E[k];if(T==="("?h++:T===")"&&(h=Math.max(0,h-1)),h===0&&T==="="){const N=E[k-1]||"",I=E[k+1]||"";if(N!=="="&&I!=="="&&N!=="<"&&N!==">")return k}}return-1}const _=async()=>{y(null),f(null),m([]);try{const E=String(i||"").trim();if(!E)throw new Error("Please enter an expression or an equation.");const h=S(E),k=C(l);if(h>=0){const T=zt(E.slice(0,h)),N=zt(E.slice(h+1));if(Object.keys(k).length>0){const M=await po({type:"cmp",op:"==",left:T,right:N},k,zt);f(!!M)}else{const{solutions:I}=await Pw(T,N,5);m(I||[])}}else try{const T=zt(E),N=await lr(T,k);f(N)}catch{const N=ko(E,zt),I=po(N,k,zt);f(!!I)}}catch(E){y(String(E.message||E))}};return P.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30",children:P.jsxs("div",{className:"bg-white rounded shadow-lg w-[1000px] max-h-[85vh] overflow-y-auto p-4",children:[P.jsxs("div",{className:"flex items-center justify-between mb-3",children:[P.jsx("h3",{className:"text-lg font-semibold",children:"ADT Manager - Available Types and Operations"}),P.jsx("button",{className:"px-2 py-1 bg-gray-200 rounded",onClick:e,children:"Close"})]}),P.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[P.jsxs("div",{children:[P.jsx("div",{className:jy,children:"Available Data Types"}),x.map(E=>P.jsxs("div",{className:"mt-3 p-3 border rounded bg-gray-50",children:[P.jsxs("div",{className:"flex items-center justify-between mb-3",children:[P.jsx("div",{className:"font-semibold text-lg",children:E.name}),E.__readonly&&P.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded",children:"Built-in"})]}),P.jsxs("div",{className:"mb-3",children:[P.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-700",children:"Operations"}),P.jsxs("div",{className:"space-y-1",children:[(E.operations||[]).map((h,k)=>P.jsxs("div",{className:"text-sm font-mono bg-white p-2 rounded border",children:[P.jsx("span",{className:"text-blue-600 font-semibold",children:h.name}),P.jsxs("span",{className:"text-gray-600",children:["(",h.params?h.params.map((T,N)=>`${T.type} ${String.fromCharCode(97+N)}`).join(", "):"no params",")"]}),P.jsx("span",{className:"text-gray-500",children:"  "}),P.jsx("span",{className:"text-green-600 font-semibold",children:h.result})]},k)),(!E.operations||E.operations.length===0)&&P.jsx("div",{className:"text-sm text-gray-500 italic",children:"(no operations)"})]})]}),P.jsxs("div",{children:[P.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-700",children:"Axioms"}),P.jsxs("div",{className:"space-y-1",children:[(E.axioms||[]).map((h,k)=>P.jsxs("div",{className:"text-sm font-mono bg-white p-2 rounded border",children:[P.jsx("span",{className:"text-purple-600 font-semibold",children:h.name?h.name+": ":""}),P.jsx("span",{className:"text-gray-800",children:h.equation})]},k)),(!E.axioms||E.axioms.length===0)&&P.jsx("div",{className:"text-sm text-gray-500 italic",children:"(no axioms)"})]})]})]},E.name))]}),P.jsxs("div",{children:[P.jsx("div",{className:jy,children:"Interactive Tools"}),P.jsxs("div",{className:"mt-3 p-3 border rounded bg-gray-50",children:[P.jsx("div",{className:"text-sm font-semibold mb-3 text-gray-700",children:"Sandbox"}),P.jsxs("div",{className:"space-y-3",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Expression or Equation"}),P.jsx("input",{className:"w-full border rounded p-2 text-sm font-mono",placeholder:"Enter an expression (e.g., x + 2*y) or equation with '=' (e.g., x + y = 7)",value:i,onChange:E=>s(E.target.value),"data-testid":"sandbox-expr"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Variable Bindings"}),P.jsx("input",{className:"w-full border rounded p-2 text-sm font-mono",placeholder:'{"x":3, "y":4} or x=3, y=4',value:l,onChange:E=>c(E.target.value),"data-testid":"sandbox-bindings"})]}),P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded text-sm",onClick:_,"data-testid":"sandbox-run",children:"Run"}),u!==null&&P.jsxs("span",{className:"text-sm","data-testid":"sandbox-result",children:["Result: ",P.jsx("span",{className:"font-mono bg-green-100 px-2 py-1 rounded",children:Oa(u)})]})]}),w&&P.jsx("div",{className:"p-2 text-red-700 bg-red-100 border border-red-200 rounded text-sm whitespace-pre-wrap",children:w}),p&&p.length>0&&P.jsxs("div",{className:"text-sm","data-testid":"sandbox-solutions",children:[P.jsx("div",{className:"font-semibold mb-2 text-gray-700",children:"Solutions (up to 5):"}),P.jsx("div",{className:"space-y-1",children:p.map((E,h)=>P.jsx("div",{className:"font-mono bg-white p-2 rounded border","data-testid":"sandbox-sol-entry",children:JSON.stringify(E)},h))})]})]})]}),P.jsxs("div",{className:"mt-4 p-3 border rounded bg-blue-50",children:[P.jsx("div",{className:"text-sm font-semibold mb-2 text-blue-800",children:"Usage Notes"}),P.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[P.jsx("div",{children:" Int operations: +(Int a, Int b), *(Int a, Int b), ==(Int a, Int b), etc."}),P.jsx("div",{children:" Bool operations: and(Bool a, Bool b), or(Bool a, Bool b), not(Bool a)"}),P.jsx("div",{children:" Pair operations: fst(Pair p), snd(Pair p), ==(Pair a, Pair b)"}),P.jsx("div",{children:" Pair literals: (value1, value2)"}),P.jsx("div",{children:" All operations support pattern matching and deconstruction"}),P.jsx("div",{children:" Parameter names (a, b, c, ...) are automatically assigned for display"})]})]})]})]})]})})}const bc="http://example.org/apn",Rw="http://www.pnml.org/version-2009/grammar/pnml",Lw=500,g5={startX:40,startY:40,spacing:80,columns:25,transitionOffsetX:220};function jh(t){return t?Array.from(t):[]}function Fw(t){const n=new DOMParser().parseFromString(t,"application/xml"),r=n.querySelector("parsererror");if(r)throw console.error("XML parsing error:",r.textContent),new Error("Invalid XML: "+r.textContent);const i=n.documentElement,s=i.namespaceURI||Rw;return{xmlDoc:n,pnmlElement:i,PNML_NS:s}}function jw(t,e){const n=t.getElementsByTagNameNS(e,"net");if(n&&n.length>0)return n[0];const r=t.getElementsByTagName("net");return r&&r.length>0?r[0]:null}function Ow(t,e){const n=t.getElementsByTagNameNS(e,"page");if(n&&n.length>0)return n[0];const r=t.getElementsByTagName("page");return r&&r.length>0?r[0]:null}function m5(t){const e=(i,s)=>{if(!i)return[];const l=typeof i.getElementsByTagNameNS=="function"?i.getElementsByTagNameNS(t,s):[];if(l&&l.length>0)return jh(l);const c=typeof i.getElementsByTagNameNS=="function"?i.getElementsByTagNameNS(bc,s):[];if(c&&c.length>0)return jh(c);const u=typeof i.getElementsByTagName=="function"?i.getElementsByTagName(s):[];return u&&u.length>0?jh(u):[]},n=(i,s)=>e(i,s);return{getElements:e,findChildElements:n,getTextContent:(i,s)=>{const l=n(i,s);if(l.length===0)return"";const c=l[0],u=c.getElementsByTagName("text").length?c.getElementsByTagName("text"):c.getElementsByTagNameNS(bc,"text");if(u&&u.length>0){const f=u[0];if(f&&typeof f.textContent=="string")return f.textContent}return typeof c.textContent=="string"?c.textContent:""}}}function Oh(t,e,n){return t?m5(e).getElements(t,n):[]}function Dw(t){return t>=Lw}function y5(t,e,n,r,i){const{findChildElements:s}=e,{applyAutoLayout:l,layout:c=g5}=n,{startX:u,startY:f,spacing:p,columns:m,transitionOffsetX:w}=c,y=zw(t,s);if(y.found||!l)return{x:y.x,y:y.y};const x=r%m,C=Math.floor(r/m),S=u+x*p,_=f+C*p;return i==="transition"?{x:S+w,y:_}:{x:S,y:_}}function zw(t,e){const n=e(t,"graphics");if(n.length>0){const r=e(n[0],"position");if(r.length>0){const i=parseInt(r[0].getAttribute("x")||"0",10),s=parseInt(r[0].getAttribute("y")||"0",10);return{x:i,y:s,found:!0}}}return{x:0,y:0,found:!1}}function Bw(t,e={}){return{applyAutoLayout:t,layout:{...g5,...e}}}function fg(t){const e=[];let n="",r=0,i=0,s=!1;for(let c=0;c<t.length;c++){const u=t[c];if(s){n+=u,u==="'"&&t[c-1]!=="\\"&&(s=!1);continue}if(u==="'"){s=!0,n+=u;continue}if(u==="("){r++,n+=u;continue}if(u===")"){r=Math.max(0,r-1),n+=u;continue}if(u==="["){i++,n+=u;continue}if(u==="]"){i=Math.max(0,i-1),n+=u;continue}if(u===","&&r===0&&i===0){e.push(n.trim()),n="";continue}n+=u}const l=n.trim();return l.length>0&&e.push(l),e.filter(Boolean)}function Da(t){const e=String(t||"").trim(),n=e.toLowerCase();if(e==="T"||n==="true")return!0;if(e==="F"||n==="false")return!1;if(/^[+-]?\d+$/.test(e))return parseInt(e,10);if(e.startsWith("'")&&e.endsWith("'")&&e.length>=2)return e.slice(1,-1).replace(/\\(.)/g,(i,s)=>s==="n"?`
`:s==="t"?"	":s==="r"?"\r":s==="\\"?"\\":s==="'"?"'":s);if(e.startsWith("[")&&e.endsWith("]")){const r=e.slice(1,-1).trim();return r.length===0?[]:fg(r).map(s=>Da(s))}if(e.startsWith("(")&&e.endsWith(")")){const r=e.slice(1,-1).trim();let i=0,s=-1;for(let l=0;l<r.length;l++){const c=r[l];if(c==="(")i++;else if(c===")")i=Math.max(0,i-1);else if(c===","&&i===0){s=l;break}}if(s>=0){const l=r.slice(0,s).trim(),c=r.slice(s+1).trim();return{__pair__:!0,fst:Da(l),snd:Da(c)}}}return null}const Uw=t=>`P${t+1}`;function Gw(t,e,n){const{getTextContent:r,getElements:i}=e,s=[];return t.forEach((l,c)=>{try{const u=l.getAttribute("id"),f=r(l,"name")||Uw(c),p=y5(l,e,n,c,"place");let m=0,w;const y=i(l,"valueTokens").filter(C=>C.namespaceURI===bc&&C.parentElement===l);if(y.length>0){const C=y[0],S=C.getElementsByTagNameNS?C.getElementsByTagNameNS(bc,"token"):C.getElementsByTagName("token"),_=Array.from(S||[]).map(E=>{let h=r(E,"text");!h&&typeof E.textContent=="string"&&(h=E.textContent);const k=typeof h=="string"?h.trim():"";return k?Da(k):null}).filter(E=>E!==null);w=_,m=_.length}else{const C=r(l,"initialMarking");if(C){const S=C.trim();if(S.startsWith("[")&&S.endsWith("]"))try{const _=S.slice(1,-1).trim();w=(_.length?fg(_):[]).map(Da).filter(h=>h!==null),m=Array.isArray(w)?w.length:0}catch(_){console.warn(`Could not parse token list for ${u}:`,_)}else{const _=parseInt(S,10);Number.isFinite(_)&&(m=_)}}}const x=r(l,"type");s.push({id:u,name:f,label:f,x:p.x,y:p.y,tokens:m,valueTokens:w,type:x||void 0})}catch(u){console.error("Error processing place:",u)}}),s}const Vw=t=>`T${t+1}`;function Ww(t,e,n){const{getTextContent:r}=e,i=[];return t.forEach((s,l)=>{try{const c=s.getAttribute("id"),u=r(s,"name")||Vw(l),f=y5(s,e,n,l,"transition"),p=r(s,"guard"),m=r(s,"action");i.push({id:c,name:u,label:u,x:f.x,y:f.y,guard:p||void 0,action:m||void 0})}catch(c){console.error("Error processing transition:",c)}}),i}const $w="north",Hw="south";function Yw(t,e,n){const{getTextContent:r,findChildElements:i}=e,s=[],{placeIds:l,transitionIds:c}=n;return t.forEach(u=>{try{const f=u.getAttribute("id"),p=u.getAttribute("source"),m=u.getAttribute("target");if(!p||!m){console.warn(`Skipping arc ${f} due to missing source or target`);return}let w=$w,y=Hw;const x=i(u,"graphics");if(x.length>0){const k=i(x[0],"metadata");if(k.length>0){const T=i(k[0],"sourceDirection");T.length>0&&T[0].textContent&&(w=T[0].textContent);const N=i(k[0],"targetDirection");N.length>0&&N[0].textContent&&(y=N[0].textContent)}}const C=Xw(f,p,m,l,c);let S=1;const _=r(u,"inscription");if(_){const k=parseInt(_,10);Number.isFinite(k)?S=k:console.warn(`Could not parse weight for ${f}: '${_}', defaulting to 1`)}const E=r(u,"binding");let h;if(E&&E.includes(","))try{h=fg(E)}catch{h=E.split(",").map(T=>T.trim()).filter(Boolean)}else E&&(h=[E.trim()]);s.push({id:f,source:p,target:m,type:C,weight:S,binding:h?void 0:E||void 0,bindings:h||void 0,sourceDirection:w,targetDirection:y})}catch(f){console.error("Error processing arc:",f)}}),s}function Xw(t,e,n,r,i){const s=r.includes(e),l=i.includes(e),c=r.includes(n),u=i.includes(n);return s&&u?"place-to-transition":l&&c?"transition-to-place":e.toLowerCase().includes("place")&&n.toLowerCase().includes("transition")?"place-to-transition":e.toLowerCase().includes("transition")&&n.toLowerCase().includes("place")?"transition-to-place":(console.warn(`Could not determine arc type for ${t}, defaulting to place-to-transition`),"place-to-transition")}function Kw(t){const e={places:[],transitions:[],arcs:[]};try{const{xmlDoc:n,PNML_NS:r}=Fw(t),i=jw(n,r);if(!i)return console.error("No net element found in the PNML file"),e;const s=i.getAttribute("netMode");s&&(e.netMode=s);const l=Ow(i,r);if(!l)return console.error("No page element found in the PNML file"),e;const c=m5(r),u=Oh(l,r,"place"),f=Oh(l,r,"transition"),p=Oh(l,r,"arc"),m=u.length+f.length,w=Bw(Dw(m));return e.places=Gw(u,c,w),e.transitions=Ww(f,c,w),e.arcs=Yw(p,c,{placeIds:e.places.map(y=>y.id),transitionIds:e.transitions.map(y=>y.id)}),e}catch(n){return console.error("Error parsing PNML:",n),e}}const gn="http://example.org/apn";function Qw(t){try{const e=document.implementation.createDocument("http://www.pnml.org/version-2009/grammar/pnml","pnml",null),n=e.documentElement;let r=!1;const i=e.createElement("net");i.setAttribute("id","net1"),i.setAttribute("type","http://www.pnml.org/version-2009/grammar/ptnet"),n.appendChild(i),t.netMode&&i.setAttribute("netMode",t.netMode);const s=e.createElement("name"),l=e.createElement("text");l.textContent="Petri Net",s.appendChild(l),i.appendChild(s);const c=e.createElement("page");c.setAttribute("id","page1"),i.appendChild(c);const u=t.places||[];u.forEach(C=>{const S=e.createElement("place");S.setAttribute("id",C.id);const _=e.createElement("name"),E=e.createElement("text");E.textContent=C.label||C.name||`P${C.id}`,_.appendChild(E),S.appendChild(_);const h=e.createElement("graphics"),k=e.createElement("position");if(k.setAttribute("x",C.x||0),k.setAttribute("y",C.y||0),h.appendChild(k),S.appendChild(h),C.type){const N=e.createElementNS(gn,"apn:type"),I=e.createElementNS(gn,"apn:text");I.textContent=String(C.type),N.appendChild(I),S.appendChild(N),r=!0}const T=N=>typeof N=="boolean"?N?"T":"F":typeof N=="string"?`'${N.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}'`:Array.isArray(N)?`[${N.map(T).join(", ")}]`:N&&typeof N=="object"&&N.__pair__?`(${T(N.fst)}, ${T(N.snd)})`:String(N);if(Array.isArray(C.valueTokens)){const N=e.createElementNS(gn,"apn:valueTokens");C.valueTokens.forEach(I=>{const M=e.createElementNS(gn,"apn:token"),L=e.createElementNS(gn,"apn:text");L.textContent=T(I),M.appendChild(L),N.appendChild(M)}),S.appendChild(N),r=!0}else if(C.tokens>0){const N=e.createElement("initialMarking"),I=e.createElement("text");I.textContent=C.tokens,N.appendChild(I),S.appendChild(N)}c.appendChild(S)});const f=t.transitions||[];f.forEach(C=>{const S=e.createElement("transition");S.setAttribute("id",C.id);const _=e.createElement("name"),E=e.createElement("text");E.textContent=C.label||C.name||`T${C.id}`,_.appendChild(E),S.appendChild(_);const h=e.createElement("graphics"),k=e.createElement("position");if(k.setAttribute("x",C.x||0),k.setAttribute("y",C.y||0),h.appendChild(k),S.appendChild(h),C.guard){const T=e.createElementNS(gn,"apn:guard"),N=e.createElementNS(gn,"apn:text");N.textContent=String(C.guard),T.appendChild(N),S.appendChild(T),r=!0}if(C.action){const T=e.createElementNS(gn,"apn:action"),N=e.createElementNS(gn,"apn:text");N.textContent=String(C.action),T.appendChild(N),S.appendChild(T),r=!0}c.appendChild(S)});const p=t.arcs||[],m=new Set(u.map(C=>C.id)),w=new Set(f.map(C=>C.id));return p.filter(C=>{const S=C.source||C.sourceId,_=C.target||C.targetId;if(!S||!_||S==="undefined"||_==="undefined")return console.warn(`Skipping invalid arc ${C.id} during save - missing or undefined source/target`),!1;const E=m.has(S)||w.has(S),h=m.has(_)||w.has(_);return!E||!h?(console.warn(`Skipping invalid arc ${C.id} during save - references non-existent elements`),!1):!0}).forEach(C=>{const S=e.createElement("arc");S.setAttribute("id",C.id);const _=C.source||C.sourceId,E=C.target||C.targetId;S.setAttribute("source",_),S.setAttribute("target",E);const h=e.createElement("graphics"),k=e.createElement("metadata"),T=e.createElement("sourceDirection");T.textContent=C.sourceDirection||"north",k.appendChild(T);const N=e.createElement("targetDirection");if(N.textContent=C.targetDirection||"south",k.appendChild(N),h.appendChild(k),S.appendChild(h),C.weight>1&&!(C.binding||Array.isArray(C.bindings)&&C.bindings.length)){const I=e.createElement("inscription"),M=e.createElement("text");M.textContent=C.weight,I.appendChild(M),S.appendChild(I)}if(Array.isArray(C.bindings)&&C.bindings.length>0){const I=e.createElementNS(gn,"apn:binding"),M=e.createElementNS(gn,"apn:text");M.textContent=C.bindings.join(", "),I.appendChild(M),S.appendChild(I),r=!0}else if(C.binding){const I=e.createElementNS(gn,"apn:binding"),M=e.createElementNS(gn,"apn:text");M.textContent=String(C.binding),I.appendChild(M),S.appendChild(I),r=!0}c.appendChild(S)}),r&&n.setAttribute("xmlns:apn",gn),new XMLSerializer().serializeToString(e)}catch(e){throw console.error("Error generating PNML:",e),e}}async function Oy(t){try{return Qw(t)}catch(e){throw console.error("Error exporting to PNML:",e),e}}async function Zw(t){try{return Kw(t)}catch(e){throw console.error("Error importing from PNML:",e),e}}class qw{constructor(){this.listeners=new Map}on(e,n){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(n)}off(e,n){if(!this.listeners.has(e))return;const r=this.listeners.get(e),i=r.indexOf(n);i>-1&&r.splice(i,1)}emit(e,n){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)try{i(n)}catch(s){console.error(`Error in event listener for ${e}:`,s)}}removeAllListeners(e){e?this.listeners.delete(e):this.listeners.clear()}listenerCount(e){return this.listeners.has(e)?this.listeners.get(e).length:0}}const oo={transitionsChanged:"transitionsChanged",transitionFired:"transitionFired"},ga=new qw;class v5{constructor(){this.isInitialized=!1,this.petriNet=null,this.eventBus=null,this.simulationMode="single"}async initialize(e,n={}){if(!this.validatePetriNet(e))throw new Error("Invalid Petri net structure");this.petriNet=this.normalizeNet(e),this.isInitialized=!0,this.simulationMode=n.simulationMode||"single",await this.initializeSpecific(this.petriNet,n)}async initializeSpecific(e,n){}async update(e){if(!this.isInitialized)throw new Error("Simulator not initialized");if(!this.validatePetriNet(e))throw new Error("Invalid Petri net structure");this.petriNet=this.normalizeNet(e),await this.updateSpecific(this.petriNet)}async updateSpecific(e){}async getEnabledTransitions(){return this.isInitialized?await this.getEnabledTransitionsSpecific():[]}async getEnabledTransitionsSpecific(){return[]}async fireTransition(e,n={}){if(!this.isInitialized)throw new Error("Simulator not initialized");if(!(n.skipEnabledCheck||!1)&&!(await this.getEnabledTransitions()).includes(e))throw new Error(`Transition ${e} is not enabled`);return await this.fireTransitionSpecific(e,n)}async fireTransitionSpecific(e){return this.petriNet}async stepSimulation(){if(!this.isInitialized)throw new Error("Simulator not initialized");return await this.stepSimulationSpecific()}async stepSimulationSpecific(){return this.petriNet}reset(){this.isInitialized=!1,this.petriNet=null,this.simulationMode="single",this.resetSpecific()}resetSpecific(){}setEventBus(e){this.eventBus=e}emitTransitionsChanged(e={}){if(!this.eventBus)return;const n=Array.isArray(e.enabled)?e.enabled:[],r=Array.isArray(e.previouslyEnabled)?e.previouslyEnabled:[],i=typeof e.hasEnabled=="boolean"?e.hasEnabled:n.length>0;this.eventBus.emit(oo.transitionsChanged,{enabled:n,previouslyEnabled:r,hasEnabled:i})}emitTransitionFired(e={}){if(!this.eventBus)return;const{transitionId:n,newPetriNet:r}=e||{};n&&this.eventBus.emit(oo.transitionFired,{transitionId:n,newPetriNet:r})}getType(){throw new Error("getType() must be implemented by subclasses")}validatePetriNet(e){if(!e||typeof e!="object")return!1;const{places:n,transitions:r,arcs:i}=e;return!(!Array.isArray(n)||!Array.isArray(r)||!Array.isArray(i))}normalizeNet(e){const n=JSON.parse(JSON.stringify(e||{places:[],transitions:[],arcs:[]})),r=Array.isArray(n.places)?n.places:[],i=Array.isArray(n.transitions)?n.transitions:[],s=Array.isArray(n.arcs)?n.arcs:[],l=new Set(r.map(u=>String(u.id))),c=new Set(i.map(u=>String(u.id)));for(const u of r){if(u.id=String(u.id),Array.isArray(u.valueTokens)){const f=u.valueTokens.length;(!Number.isFinite(u.tokens)||u.tokens!==f)&&(u.tokens=f)}else Number.isFinite(u.tokens)||(u.tokens=0);!u.label&&u.name&&(u.label=u.name),!u.name&&u.label&&(u.name=u.label)}for(const u of s){u.id!==void 0&&(u.id=String(u.id));const f=u.sourceId||u.source,p=u.targetId||u.target;u.sourceId=String(f),u.targetId=String(p),u.source===void 0&&(u.source=u.sourceId),u.target===void 0&&(u.target=u.targetId);const m=Number(u.weight);u.weight=Number.isFinite(m)&&m>0?m:1,Array.isArray(u.bindings)||(u.binding?u.bindings=[String(u.binding)]:u.bindings=[]),u.sourceType||(u.sourceType=l.has(u.sourceId)?"place":c.has(u.sourceId)?"transition":u.sourceType),u.targetType||(u.targetType=l.has(u.targetId)?"place":c.has(u.targetId)?"transition":u.targetType)}return n.places=r,n.transitions=i,n.arcs=s,n}isReady(){return this.isInitialized&&this.petriNet!==null}getSimulationStats(){if(!this.isInitialized)return{enabledTransitions:[],totalTokens:0,totalPlaces:0,totalTransitions:0};const{places:e,transitions:n}=this.petriNet,r=e.reduce((i,s)=>i+(s.tokens||0),0);return{enabledTransitions:[],totalTokens:r,totalPlaces:e.length,totalTransitions:n.length}}}function Jw(t){if(!(t!=null&&t.transitions)||!(t!=null&&t.places)||!(t!=null&&t.arcs))return!1;for(const e of t.transitions)if(x5(e.id,t))return!1;return!0}function x5(t,e){const n=e9(t,e.places,e.arcs);for(const r of n){const i=e.arcs.find(l=>(l.sourceId===r.id||l.source===r.id)&&(l.targetId===t||l.target===t));if(!i)continue;const s=i.weight||1;if((r.tokens||0)<s)return!1}return!0}function e9(t,e,n){const r=[];for(const i of n){const s=i.sourceId||i.source;if((i.targetId||i.target)===t){const c=e.find(u=>u.id===s);c&&r.push(c)}}return r}function t9(t){var l,c,u,f,p;if(!t)return null;const e=((l=t.places)==null?void 0:l.length)||0,n=((c=t.transitions)==null?void 0:c.length)||0,r=((u=t.arcs)==null?void 0:u.length)||0,i=((f=t.places)==null?void 0:f.reduce((m,w)=>m+(w.tokens||0),0))||0,s=((p=t.transitions)==null?void 0:p.filter(m=>x5(m.id,t)))||[];return{placeCount:e,transitionCount:n,arcCount:r,totalTokens:i,enabledTransitionCount:s.length,enabledTransitions:s.map(m=>m.id),isDeadlock:Jw(t)}}function w5(t,e){const n=new Map;for(const r of t)r.srcId&&(n.has(r.srcId)||n.set(r.srcId,[]),n.get(r.srcId).push(r));for(const[r,i]of n.entries()){const s=e[r];if(!s)continue;const l=i.filter(u=>u.countFallback).length;if(l>0){const u=Number(s.tokens||0);s.tokens=Math.max(0,u-l)}const c=i.filter(u=>!u.countFallback);if(Array.isArray(s.valueTokens)&&c.length>0){c.sort((u,f)=>f.tokenIndex-u.tokenIndex);for(const u of c)u.tokenIndex>=0&&u.tokenIndex<s.valueTokens.length&&s.valueTokens.splice(u.tokenIndex,1);s.tokens=s.valueTokens.length}}}function n9(t,e,n,r,i){const{evaluateArithmeticWithBindings:s,evaluateBooleanWithBindings:l,evaluatePatternLiteral:c,parseArithmetic:u}=i;for(const f of t){const p=f.targetId,m=r[p];if(!m)continue;const w=e.get(f.id)||[];if(w.length>0){Array.isArray(m.valueTokens)||(m.valueTokens=[]);for(const y of w)try{let x;const{kind:C,ast:S}=y;S&&(S.type==="var"||S.type==="boolVar"||S.type==="pairVar")?x=(n||{})[S.name]:C==="arith"?x=s(S,n):C==="bool"?x=l(S,n,u):C==="pattern"?x=c(S,n||{}):C==="pair"&&S.type==="pairLit"&&(x=c(S,n||{})),Array.isArray(m.valueTokens)||(m.valueTokens=[]),typeof x=="number"?m.valueTokens.push(x|0):typeof x=="boolean"||typeof x=="string"||r9(x)?m.valueTokens.push(x):Array.isArray(x)&&(C==="arith"||C==="pair"||S&&(S.type==="list"||S.type==="listPattern"||S.type==="tuplePattern")?m.valueTokens.push(x):m.valueTokens.push(...x))}catch{}}else if(f.weight&&(f.weight|0)>0){const y=f.weight|0;for(let x=0;x<y;x++){const C=Object.values(n||{});if(Array.isArray(m.valueTokens)){const S=C[0];m.valueTokens.push(typeof S=="boolean"?!!S:Number.isFinite(S)?S|0:1)}else m.tokens=Number(m.tokens||0)+1|0}}else Array.isArray(m.valueTokens)?m.valueTokens.push(1):m.tokens=Number(m.tokens||0)+1|0;Array.isArray(m.valueTokens)&&(m.tokens=m.valueTokens.length)}}function r9(t){return!!(t&&typeof t=="object"&&t.__pair__===!0&&"fst"in t&&"snd"in t)}class i9 extends v5{constructor(){super(),this.maxTokens=1/0}getType(){return"pt"}async initializeSpecific(e,n={}){const r=Number(n.maxTokens);this.maxTokens=Number.isFinite(r)&&r>=0?r:1/0,this.validatePTNet(e),this.initializeTokens(e),ve.debug("P/T Simulator initialized with",e.places.length,"places and",e.transitions.length,"transitions")}async updateSpecific(e){this.initializeTokens(e);const n=await this.getEnabledTransitionsSpecific();this.emitTransitionsChanged({enabled:n})}async getEnabledTransitionsSpecific(){if(!this.petriNet)return[];const{places:e,transitions:n,arcs:r}=this.petriNet,i=[];for(const s of n)this.isTransitionEnabled(s,e,r)&&i.push(s.id);return i}isTransitionEnabled(e,n,r){const i=r.filter(s=>s.target===e.id&&s.source!==e.id);for(const s of i){const l=n.find(f=>f.id===s.source);if(!l)continue;const c=s.weight||1;if((l.tokens||0)<c)return!1}return!0}async fireTransitionSpecific(e,n={}){const{places:r,transitions:i,arcs:s}=this.petriNet,l=n.skipEnabledCheck||!1,c=l?[]:await this.getEnabledTransitionsSpecific();if(!i.find(S=>S.id===e))throw new Error(`Transition ${e} not found`);const f=JSON.parse(JSON.stringify(this.petriNet)),p=f.places,m=s.filter(S=>S.target===e&&S.source!==e),w=s.filter(S=>S.source===e&&S.target!==e),y=[];for(const S of m){const _=(S.weight||1)|0;for(let E=0;E<_;E++)y.push({srcId:S.source,countFallback:!0})}const x=Object.fromEntries(p.map(S=>[S.id,S]));w5(y,x);const C=w.map(S=>({id:S.id,sourceId:S.source,targetId:S.target,weight:S.weight||1}));for(const S of C){const _=x[S.targetId];if(!_)continue;Array.isArray(_.valueTokens)&&delete _.valueTokens;const E=(S.weight||1)|0;_.tokens=Number(_.tokens||0)+E|0}for(const S of p)Array.isArray(S.valueTokens)?(S.tokens=Math.min(this.maxTokens,Array.isArray(S.valueTokens)?S.valueTokens.length:S.tokens||0),delete S.valueTokens):S.tokens=Math.min(this.maxTokens,S.tokens||0);if(this.petriNet=f,!l){this.emitTransitionFired({transitionId:e,newPetriNet:f});const S=await this.getEnabledTransitionsSpecific();this.emitTransitionsChanged({enabled:S,previouslyEnabled:c})}return f}async stepSimulationSpecific(){return this.petriNet}resetSpecific(){this.maxTokens=1/0}validatePTNet(e){const{transitions:n}=e;for(const r of n){if(r.guard&&typeof r.guard=="string"&&(r.guard.includes("+")||r.guard.includes("-")||r.guard.includes("*")||r.guard.includes("/")||r.guard.includes("=")||r.guard.includes("<")||r.guard.includes(">")||r.guard.includes("!=")))throw new Error("P/T simulator cannot handle algebraic expressions. Use algebraic simulator instead.");if(r.action&&typeof r.action=="string"&&(r.action.includes("+")||r.action.includes("-")||r.action.includes("*")||r.action.includes("/")||r.action.includes("=")))throw new Error("P/T simulator cannot handle algebraic expressions. Use algebraic simulator instead.")}}initializeTokens(e){const{places:n}=e;for(const r of n)(r.tokens===void 0||r.tokens===null)&&(r.tokens=0),r.tokens=Math.min(this.maxTokens,Math.max(0,r.tokens))}getSimulationStats(){if(!this.isInitialized)return{enabledTransitions:[],totalTokens:0,totalPlaces:0,totalTransitions:0};const{places:e,transitions:n}=this.petriNet,r=e.reduce((s,l)=>s+(l.tokens||0),0);return{enabledTransitions:this.getEnabledTransitionsSync(),totalTokens:r,totalPlaces:e.length,totalTransitions:n.length}}getEnabledTransitionsSync(){if(!this.petriNet)return[];const{places:e,transitions:n,arcs:r}=this.petriNet,i=[];for(const s of n)this.isTransitionEnabled(s,e,r)&&i.push(s.id);return i}}function Cr(t,e){if(!t)return null;switch(t.type){case"pairLit":return{__pair__:!0,fst:Cr(t.fst,e),snd:Cr(t.snd,e)};case"list":return(t.elements||[]).map(n=>Cr(n,e));case"pairPattern":return{__pair__:!0,fst:Cr(t.fst,e),snd:Cr(t.snd,e)};case"tuplePattern":return(t.elements||t.components||[]).map(n=>Cr(n,e));case"listPattern":return(t.elements||[]).map(n=>Cr(n,e));case"boolLit":return!!t.value;case"int":return t.value|0;case"var":case"boolVar":case"pairVar":return(e||{})[t.name];default:return null}}function s9(t,e,n,r){var i;try{const s=(t.arcs||[]).filter(l=>l.sourceId===n&&(l.targetType==="place"||!l.targetType));for(const l of s){const c=((i=e==null?void 0:e.bindingAstsByArc)==null?void 0:i.get(l.id))||[];for(const u of c){const{ast:f}=u||{};if(f&&(f.type==="var"||f.type==="boolVar"||f.type==="pairVar")){const p=r?r[f.name]:void 0;if(p===void 0)continue;const m=f.varType;if(m==="int"&&typeof p!="number"||m==="bool"&&typeof p!="boolean"||m==="string"&&typeof p!="string"||m==="pair"&&!(p&&typeof p=="object"&&p.__pair__===!0)||m==="list"&&!Array.isArray(p))return!1}}}return!0}catch{return!1}}const o9=["concat","substring","length","head","tail","append","sublist","isSublistOf","isSubstringOf","fst","snd"],a9=new Set(o9);function l9(t,e,n,r){const i=new Map;for(const s of t.transitions||[])if(s.guard&&typeof s.guard=="string")try{const l=n(String(s.guard),e);i.set(s.id,l)}catch{try{const c=r(String(s.guard),e);i.set(s.id,c)}catch{}}return i}function u9(t,e){if(!t)return!1;const n=t.length;for(let r=0;r<n;r+=1){const i=t[r];if(!/[A-Za-z_]/.test(i))continue;let s=r+1;for(;s<n&&/[A-Za-z0-9_]/.test(t[s]);)s+=1;const l=t.slice(r,s);if(e.has(l)){let c=s;for(;c<n&&/\s/.test(t[c]);)c+=1;if(c<n&&t[c]==="(")return!0}r=s-1}return!1}function c9(t,e,n,r,i){const s=new Map;for(const l of t.arcs||[]){const c=l.id,u=Array.isArray(l.bindings)?l.bindings:l.binding?[l.binding]:[],f=[];for(const p of u){const m=String(p),w=m.trim(),y=u9(w,i),x=h=>{if(!h||typeof h!="object")return!0;switch(h.type){case"funcall":return i.has(h.name)?(h.args||[]).every(x):!1;case"pair":return x(h.fst)&&x(h.snd);case"list":return(h.elements||[]).every(x);case"binop":return x(h.left)&&x(h.right);default:return!0}},C=()=>{let h=null;try{h=n(m)}catch{h=null}return!h||!x(h)?!1:(h.type==="var"&&h.varType==="bool"?f.push({kind:"bool",ast:{type:"boolVar",name:h.name,varType:"bool"}}):h.type==="var"&&h.varType==="pair"?f.push({kind:"pair",ast:{type:"pairVar",name:h.name,varType:"pair"}}):f.push({kind:"arith",ast:h}),!0)},S=()=>{try{const h=e(m);return f.push({kind:"pattern",ast:h}),!0}catch{return!1}};let _=!1;if(y?(_=C(),_||(_=S())):(_=S(),_||(_=C())),_)continue;const E=m==="T"?!0:m==="F"?!1:null;if(E!==null){f.push({kind:"bool",ast:{type:"boolLit",value:E}});continue}try{f.push({kind:"bool",ast:r(m,n)});continue}catch{}}f.length&&s.set(c,f)}return s}function Dy(t){return!!(t&&typeof t=="object"&&t.__pair__===!0&&"fst"in t&&"snd"in t)}async function zy({transition:t,inputArcs:e,placesById:n,bindingAstsByArc:r,guardAst:i,parseArithmetic:s,evaluateBooleanPredicate:l,matchPattern:c,getTokensForPlace:u,evaluateArithmeticWithBindings:f,evaluateBooleanWithBindings:p,evaluatePatternLiteral:m,maxTokensPerPlace:w=20}){const y=[],x=async(C,S)=>{if(C>=e.length){if(!i)return{env:S,picks:y};try{return p(i,S||{},s)?{env:S,picks:y}:null}catch{try{return await l(i,S||{},s)?{env:S,picks:y}:null}catch{return null}}}const _=e[C],E=_.id,h=_.sourceId||_.source,k=n[h],T=u(k,w),N=r.get(E)||[],I=N.length||(_.weight?Math.max(1,_.weight|0):0);if(I===0)return x(C+1,S);if(T.length<I)return null;const M=new Array(T.length).fill(!1),L=async(A,R)=>{if(A>=I)return x(C+1,R);for(let j=0;j<T.length;j++){if(M[j])continue;M[j]=!0;const G=T[j];let U=!0,O=R;const V=N[A];if(V){const{kind:$,ast:D}=V;if($==="pattern"){const X=c(D,G);if(X===null)U=!1;else{for(const[H,re]of Object.entries(X))if(O&&Object.prototype.hasOwnProperty.call(O,H)&&O[H]!==re){U=!1;break}U&&(O={...O||{},...X})}}else if(D&&(D.type==="var"||D.type==="boolVar"||D.type==="pairVar"))O&&Object.prototype.hasOwnProperty.call(O,D.name)&&O[D.name]!==G?U=!1:(typeof G=="boolean"&&D.varType&&D.varType!=="bool"&&(U=!1),typeof G=="number"&&D.varType&&D.varType!=="int"&&(U=!1),typeof G=="string"&&D.varType&&D.varType!=="string"&&(U=!1),Array.isArray(G)&&D.varType&&D.varType!=="list"&&(U=!1),Dy(G)&&D.varType&&D.varType!=="pair"&&(U=!1),U&&(O={...O||{},[D.name]:G}));else if($==="arith")try{const X=f(D,R||{});(typeof G!="number"||X!==(G|0))&&(U=!1)}catch{U=!1}else if($==="bool")try{const X=p(D,R||{},s);(typeof G!="bool"||X!==G)&&(U=!1)}catch{U=!1}else if($==="pair")try{if(D.type==="pairLit"){const X=m(D,R||{});(!Dy(G)||JSON.stringify(X)!==JSON.stringify(G))&&(U=!1)}}catch{U=!1}}if(U){y.push({arcId:_.id,srcId:h,tokenIndex:j,value:G,countFallback:!Array.isArray(k==null?void 0:k.valueTokens)});const $=await L(A+1,O);if($)return $;y.pop()}M[j]=!1}return null};return L(0,S||{})};return x(0,{})}function _5(t){const e=new Set;function n(r){if(r)switch(r.type){case"var":e.add(r.name);break;case"pairPattern":n(r.fst),n(r.snd);break;case"listPattern":Array.isArray(r.elements)&&r.elements.forEach(n);break;case"tuplePattern":r.elements&&r.elements.forEach(n);break}}return n(t),Array.from(e)}function S5(t){const e=new Set;function n(r){if(r)switch(r.type){case"var":case"boolVar":case"pairVar":e.add(r.name);break;case"binop":case"cmp":n(r.left),n(r.right);break;case"unop":n(r.operand);break;case"call":r.args&&r.args.forEach(n);break;case"pairPattern":n(r.fst),n(r.snd);break;case"tuplePattern":r.elements&&r.elements.forEach(n);break;case"pairLit":n(r.fst),n(r.snd);break}}return n(t),Array.from(e)}function d9(t,e,n,r,i){const s=new Set;for(const u of i){const f=e.get(u.id)||[];for(const p of f){const{kind:m,ast:w}=p||{};m==="pattern"&&_5(w).forEach(x=>s.add(x))}}const l=n.get(r);if(l){const u=S5(l);for(const f of u)if(!s.has(f))return!0}const c=(t.arcs||[]).filter(u=>u.sourceId===r&&(u.targetType==="place"||!u.targetType));for(const u of c){const f=e.get(u.id)||[];if(f.length===0)return!0;for(const p of f){const{kind:m,ast:w}=p||{};if(m==="pattern"&&w.type==="var"&&!s.has(w.name))return!0}}return!1}function f9(t){const e=(t.places||[]).map(l=>({id:l.id,label:l.label||"",tokens:Number(Array.isArray(l.valueTokens)?l.valueTokens.length:l.tokens||0),x:Number(l.x||0),y:Number(l.y||0),name:l.name||"",type:"place",valueTokens:Array.isArray(l.valueTokens)?[...l.valueTokens]:void 0})),n=(t.transitions||[]).map(l=>({id:l.id,label:l.label||"",x:Number(l.x||0),y:Number(l.y||0),name:l.name||"",type:"transition",guard:l.guard,action:l.action})),r=new Set(e.map(l=>l.id)),i=new Set(n.map(l=>l.id)),s=(t.arcs||[]).map(l=>{const c=l.sourceId||l.source,u=l.targetId||l.target,f=r.has(c)?"place":i.has(c)?"transition":l.sourceType||"place",p=r.has(u)?"place":i.has(u)?"transition":l.targetType||"transition",m=l.type||`${f}-to-${p}`;return{id:l.id,sourceId:c,targetId:u,source:c,target:u,weight:Number(l.weight||1),sourceType:f,targetType:p,type:m,bindings:Array.isArray(l.bindings)?[...l.bindings]:l.binding?[l.binding]:[]}});return{places:e,transitions:n,arcs:s}}let br=[],h9=1;const za=new Map;let By=0,Dh=null;const gl=typeof Worker<"u",hg=typeof SharedArrayBuffer<"u",vn={poolSize:0,idleTimeoutMs:3e5,prewarmOnAlgebraicMode:!0,solverTimeoutMs:1e4};function p9(){try{if(typeof globalThis<"u"){const t=globalThis;t.__Z3_SETTINGS__={...t.__Z3_SETTINGS__||{},...vn}}}catch{}}function Mo(t){return Math.max(0,(Number.isFinite(t)?t:0)|0)}function g9(t={}){typeof t.poolSize=="number"&&(vn.poolSize=Mo(t.poolSize)),typeof t.idleTimeoutMs=="number"&&(vn.idleTimeoutMs=Math.max(1e3,t.idleTimeoutMs|0)),typeof t.prewarmOnAlgebraicMode=="boolean"&&(vn.prewarmOnAlgebraicMode=t.prewarmOnAlgebraicMode),typeof t.solverTimeoutMs=="number"&&(vn.solverTimeoutMs=Math.max(0,t.solverTimeoutMs|0)),m9()}function k5(){if(!gl)throw new Error("Z3 worker pool unavailable in this environment");if(!hg)throw new Error("SharedArrayBuffer not available. COOP/COEP headers may not be set correctly.");const t=new Worker(new URL(""+new URL("z3.worker-1562d2b4.js",import.meta.url).href,self.location),{type:"module"});return t.onerror=e=>{console.error("Z3 worker error:",e)},t.onmessage=({data:e})=>{const{id:n,ok:r,result:i,error:s}=e||{},l=za.get(n);l&&(za.delete(n),r?l.resolve(i):l.reject(new Error(s)),C5())},t}function m9(){if(p9(),!gl)return;const t=Mo(vn.poolSize);for(;br.length<t;)br.push(k5());for(;br.length>t;){const e=br.pop();try{e.terminate()}catch{}}}function y9(){if(!gl)throw new Error("Z3 worker pool unavailable in this environment");if(Mo(vn.poolSize)<=0)throw new Error("Z3 worker pool disabled");br.length===0&&br.push(k5());const e=br[By%br.length];return By++,e}function C5(){gl&&(vn.idleTimeoutMs<=0||(Dh&&clearTimeout(Dh),Dh=setTimeout(()=>{const t=Mo(vn.poolSize);for(;br.length>t;){const e=br.pop();try{e.terminate()}catch{}}},vn.idleTimeoutMs)))}function Ao(t,...e){const n=y9(),r=h9++;return new Promise((i,s)=>{const l=setTimeout(()=>{za.delete(r),s(new Error(`Z3 worker operation "${t}" timed out after ${vn.solverTimeoutMs}ms`))},vn.solverTimeoutMs||1e4);za.set(r,{resolve:c=>{clearTimeout(l),i(c)},reject:c=>{clearTimeout(l),s(c)}});try{n.postMessage({id:r,op:t,args:e})}catch(c){clearTimeout(l),za.delete(r),s(c);return}C5()})}function tp(){return Mo(vn.poolSize)}function np(){return gl&&hg&&Mo(vn.poolSize)>0}function v9(){return hg}const x9=t=>Ao("parseBooleanExpr",t),rp=(t,e,n)=>Ao("evaluateBooleanPredicate",t,e),w9=(t,e,n)=>Ao("evaluateArithmeticWithBindings",t,e),_9=(t,e)=>Ao("evaluateAction",t,e),S9=(t,e)=>Ao("solveEquation",t,e),k9=(t,e,n)=>Ao("solveInequality",t,e,n),Ba=Object.freeze(Object.defineProperty({__proto__:null,evaluateAction:_9,evaluateArithmeticWithBindings:w9,evaluateBooleanPredicate:rp,getConfiguredPoolSize:tp,isSharedArrayBufferAvailable:v9,isWorkerPoolEnabled:np,parseBooleanExpr:x9,setZ3WorkerConfig:g9,solveEquation:S9,solveInequality:k9},Symbol.toStringTag,{value:"Module"})),zh=async(t,e,n)=>{try{if((typeof np=="function"?np():!1)&&typeof rp=="function")try{return await rp(t,e,n)}catch{}}catch{}return Nw(t,e,n)},Uy=t=>JSON.parse(JSON.stringify(t||{places:[],transitions:[],arcs:[]})),C9=(t,e)=>{const n=new Set,r=l=>{if(l)switch(l.type){case"boolVar":case"pairVar":n.add(l.name);break;case"and":case"or":r(l.left),r(l.right);break;case"not":r(l.expr);break;case"cmp":i(l.left),i(l.right);break}},i=l=>{l&&(l.type==="var"||l.type==="boolVar"||l.type==="pairVar"?n.add(l.name):l.type==="bin"?(i(l.left),i(l.right)):l.type==="pairLit"&&(i(l.fst),i(l.snd)))};r(t);const s=new Set(Object.keys(e||{}));return Array.from(n).filter(l=>!s.has(l))},Gy=t=>{try{const e=Array.isArray(t==null?void 0:t.transitions)?t.transitions.slice():[],n=Array.isArray(t==null?void 0:t.arcs)?t.arcs.slice():[];e.sort((s,l)=>String(s.id).localeCompare(String(l.id))),n.sort((s,l)=>String(s.id).localeCompare(String(l.id)));const r=e.map(s=>`${s.id}|g:${String(s.guard||"")}|a:${String(s.action||"")}`).join(";"),i=n.map(s=>`${s.id}|b:${Array.isArray(s.bindings)?s.bindings.join(","):s.binding?String(s.binding):""}`).join(";");return`${r}||${i}`}catch{return String(Math.random())}};class T9 extends v5{constructor(){super(),this.lastEnabledTransitions=[],this.cache={guardAstByTransition:new Map,bindingAstsByArc:new Map},this._cacheSignature=null,this._config={maxTokensPerPlace:1/0},this._enabledCache=new Map}getType(){return"algebraic"}async initializeSpecific(e,n={}){this.lastEnabledTransitions=[],this._enabledCache.clear(),this._cacheSignature=null,this.petriNet=Uy(e),n&&typeof n.maxTokensPerPlace=="number"&&n.maxTokensPerPlace>=0?this._config.maxTokensPerPlace=n.maxTokensPerPlace|0:this._config.maxTokensPerPlace=1/0,await this.buildCaches(),await this.checkTransitionStateChanges()}async buildCaches(){this.cache.guardAstByTransition.clear(),this.cache.bindingAstsByArc.clear(),this.cache.guardAstByTransition=l9(this.petriNet,zt,ko,bw),this.cache.bindingAstsByArc=c9(this.petriNet,d5,zt,ko,a9),this._cacheSignature=Gy(this.petriNet)}getStatus(){var e,n,r;return{isInitialized:this.isInitialized,hasPyodide:!1,hasSimulator:!0,hasPetriNet:!!this.petriNet,simulationMode:this.simulationMode,petriNetSize:this.petriNet?{places:((e=this.petriNet.places)==null?void 0:e.length)||0,transitions:((n=this.petriNet.transitions)==null?void 0:n.length)||0,arcs:((r=this.petriNet.arcs)==null?void 0:r.length)||0}:null}}async setSimulationMode(e){if(e==="single"||e==="maximal")this.simulationMode=e;else throw new Error("Mode must be 'single' or 'maximal'")}_outputBindingsTypeCompatible(e,n){return s9(this.petriNet,this.cache,e,n)}_invalidateEnabledCache(e){if(!e||e.size===0)return;const n=this.petriNet.arcs||[];for(const r of n){const i=r.sourceId||r.source;if((r.type==="place-to-transition"||r.sourceType==="place")&&e.has(i)){const l=String(r.targetId||r.target);this._enabledCache.delete(l)}}}_clearEnabledCache(){this._enabledCache.clear()}async updateSpecific(e){const r=Gy(e)!==this._cacheSignature;this.petriNet=Uy(e),r&&await this.buildCaches(),this._clearEnabledCache(),await this.checkTransitionStateChanges()}async getEnabledTransitionsSpecific(){const e=Array.isArray(this.petriNet.transitions)?this.petriNet.transitions:[];if(e.length===0)return[];const n=[];for(let i=0;i<e.length;i++){const s=String(e[i].id);this._enabledCache.has(s)||n.push(e[i])}if(n.length>0){const i=typeof tp=="function"?Number(tp()||0):0,s=Math.max(1,Math.min(n.length,i>0?i:1));if(s<=1)for(const l of n)try{const c=await this.isTransitionEnabled(l.id);this._enabledCache.set(String(l.id),c)}catch{this._enabledCache.set(String(l.id),!1)}else{const l=new Array(n.length).fill(!1);let c=0;const u=async()=>{for(;;){const p=c++;if(p>=n.length)break;const m=n[p];try{const w=await this.isTransitionEnabled(m.id);l[p]=w}catch{}}},f=Array.from({length:s},()=>u());await Promise.all(f);for(let p=0;p<n.length;p++)this._enabledCache.set(String(n[p].id),l[p])}}const r=[];for(const i of e){const s=String(i.id);this._enabledCache.get(s)===!0&&r.push(s)}return r}async checkForUnboundVariables(e,n){return d9(this.petriNet,this.cache.bindingAstsByArc,this.cache.guardAstByTransition,e,n)}extractVariablesFromPattern(e){return _5(e)}extractVariablesFromExpression(e){return S5(e)}async isTransitionEnabled(e){if(!this.isInitialized)return!1;const n=(this.petriNet.transitions||[]).find(u=>u.id===e);if(!n)return!1;const r=(this.petriNet.arcs||[]).filter(u=>(u.targetId===e||u.target===e)&&(u.sourceType==="place"||!u.sourceType));if(r.length===0)return!0;if(await this.checkForUnboundVariables(e,r))return ve.debug("Transition disabled due to unbound variables:",e),!1;const s=this.cache.guardAstByTransition.get(e),l=Object.fromEntries((this.petriNet.places||[]).map(u=>[u.id,u])),c=await zy({transition:n,inputArcs:r,placesById:l,bindingAstsByArc:this.cache.bindingAstsByArc,guardAst:s,parseArithmetic:zt,evaluateBooleanPredicate:zh,matchPattern:Ry,getTokensForPlace:Ly,evaluateArithmeticWithBindings:lr,evaluateBooleanWithBindings:po,evaluatePatternLiteral:Cr,maxTokensPerPlace:this._config.maxTokensPerPlace});return c?this._outputBindingsTypeCompatible(e,c.env||{}):!1}async stepSimulationSpecific(){return this.getCurrentState()}async fireTransitionSpecific(e,n={}){const r=n.skipEnabledCheck||!1,i=r?[]:await this.getEnabledTransitionsSpecific(),s=(this.petriNet.transitions||[]).find(x=>x.id===e);if(!s)return this.getCurrentState();const l=(this.petriNet.arcs||[]).filter(x=>(x.targetId===e||x.target===e)&&(x.sourceType==="place"||!x.sourceType)),c=(this.petriNet.arcs||[]).filter(x=>(x.sourceId===e||x.source===e)&&(x.targetType==="place"||!x.targetType)),u=Object.fromEntries((this.petriNet.places||[]).map(x=>[x.id,x])),f=this.cache.guardAstByTransition.get(e),p=await zy({transition:s,inputArcs:l,placesById:u,bindingAstsByArc:this.cache.bindingAstsByArc,guardAst:f,parseArithmetic:zt,evaluateBooleanPredicate:zh,matchPattern:Ry,getTokensForPlace:Ly,evaluateArithmeticWithBindings:lr,evaluateBooleanWithBindings:po,evaluatePatternLiteral:Cr,maxTokensPerPlace:this._config.maxTokensPerPlace});if(!p)throw new Error(`Transition ${e} is not enabled`);let m=p.env||{};const w=p.picks||[];if(f&&C9(f,m).length>0)try{if(!await zh(f,m,zt))throw new Error("Guard unsatisfied under any extension")}catch{}const y=new Set;for(const x of w)y.add(x.srcId);for(const x of c)y.add(x.targetId||x.target);if(w5(w,u),n9(c,this.cache.bindingAstsByArc,m,u,{evaluateArithmeticWithBindings:lr,evaluateBooleanWithBindings:po,evaluatePatternLiteral:Cr,parseArithmetic:zt}),s.action&&typeof s.action=="string")try{const x=Mw(s.action,m,zt)}catch{}if(this._invalidateEnabledCache(y),!r){await this.checkTransitionStateChanges();const x=this.getCurrentState();this.emitTransitionFired({transitionId:e,newPetriNet:x});const C=await this.getEnabledTransitionsSpecific();return this.emitTransitionsChanged({enabled:C,previouslyEnabled:i}),x}return this.getCurrentState()}getCurrentState(){return f9(this.petriNet)}async checkTransitionStateChanges(){if(this.isInitialized)try{const e=await this.getEnabledTransitionsSpecific();if(JSON.stringify([...e].sort())!==JSON.stringify([...this.lastEnabledTransitions].sort())){const r=[...this.lastEnabledTransitions];this.lastEnabledTransitions=[...e],this.emitTransitionsChanged({enabled:e,previouslyEnabled:r})}}catch{}}resetSpecific(){this.lastEnabledTransitions=[],this.cache.guardAstByTransition.clear(),this.cache.bindingAstsByArc.clear(),this._cacheSignature=null,this._config.maxTokensPerPlace=1/0,this._clearEnabledCache()}}class E9{static createSimulator(e){switch(e){case"pt":return new i9;case"algebraic":return new T9;default:throw new Error(`Unknown net mode: ${e}`)}}static getAvailableTypes(){return["pt","algebraic"]}static isSupported(e){return this.getAvailableTypes().includes(e)}}const Vy=async()=>{try{await new Promise(t=>setTimeout(t,0))}catch{}try{typeof requestAnimationFrame<"u"&&await new Promise(t=>requestAnimationFrame(()=>t()))}catch{}},b9=t=>{const e=new Set;if(!t||!Array.isArray(t.transitions))return e;const n=Array.isArray(t.arcs)?t.arcs:[],r=Array.isArray(t.places)?t.places:[],i=new Set(r.map(s=>String(s.id)));for(const s of t.transitions){const l=String(s.id);let c=!1,u=!1;for(const f of n){const p=String(f.sourceId||f.source),m=String(f.targetId||f.target);if(m===l&&p!==l&&i.has(p)&&(c=!0),p===l&&m!==l&&i.has(m)&&(u=!0),c&&u)break}!c&&!u&&e.add(l)}return e},N9=(t,e,n)=>{const r=new Map;for(const c of t)r.set(c,new Set);for(const c of e||[]){const u=c.targetId||c.target,f=c.sourceId||c.source;(c.type==="place-to-transition"||c.sourceType==="place")&&r.has(u)&&r.get(u).add(f)}const i=t.slice();for(let c=i.length-1;c>0;c--){const u=Math.random()*(c+1)|0,f=i[c];i[c]=i[u],i[u]=f}const s=new Set,l=[];for(const c of i){const u=r.get(c)||new Set;let f=!0;for(const p of u)if(s.has(p)){f=!1;break}if(f){l.push(c);for(const p of u)s.add(p);if(n>0&&l.length>=n)break}}return l},P9=(t=[])=>t.map(e=>{if(typeof e=="string")return e;if(e&&typeof e=="object"){if(e.id)return e.id;if(e.get)return e.get("id")}return String(e)}).filter(Boolean),M9=async({simulator:t,mode:e="single",maxSteps:n=1e5,timeBudgetMs:r=3e4,yieldEvery:i=100,onProgress:s,shouldCancel:l,batchMax:c=0,progressEveryMs:u=0,yieldEveryMs:f=0})=>{const p=typeof performance<"u"&&performance.now?()=>performance.now():()=>Date.now(),m=p();let w=0,y=m,x=m,C=-1;const S=T=>{if(!s)return;const N=T-m,I=u>0?Math.floor(N/u):0;if(I!==C){C=I;try{s({steps:w,elapsedMs:N})}catch{}}},_=b9(t.petriNet||{}),E=async()=>{const T=await t.getEnabledTransitions();return P9(T).filter(I=>!_.has(String(I)))},h=async()=>{if(l&&l())return!1;const T=p(),N=T-m;if(i>0&&w%i===0){const I=p();S(I),await Vy();const M=p();return x=M,y=M,u>0&&S(M),!(r>0&&M-m>r||l&&l())}if(u>0&&T-y>=u&&(S(T),y=T),f>0&&T-x>=f){await Vy();const I=p();if(x=I,u>0&&I-y>=u&&(S(I),y=I),r>0&&I-m>r||l&&l())return!1}return!(r>0&&N>r||l&&l())};let k=!0;for(;k&&w<n&&!(l&&l());){const T=await E();if(!T||T.length===0)break;if(e==="maximal"){const N=t.petriNet||{},I=c>0?c:Number.POSITIVE_INFINITY;let M=N9(T,N.arcs||[],I);if(!M||M.length===0){const L=T[Math.floor(Math.random()*T.length)];M=L?[L]:[]}if(l&&l()){k=!1;break}await Promise.all(M.map(L=>t.fireTransition(L,{skipEnabledCheck:!0}))),w+=M.length,k=await h()}else{const N=T[Math.floor(Math.random()*T.length)];await t.fireTransition(N),w+=1,k=await h()}}if(s)try{s({steps:w,elapsedMs:p()-m})}catch{}return{petriNet:t.petriNet||null,steps:w}},Wy=(t,e={})=>{ve.debug("determineNetMode called with:",{petriNet:t,options:e});const n=(e==null?void 0:e.netMode)||(t==null?void 0:t.netMode);if(ve.debug("Found netMode from options/petriNet:",n),n){const r=n==="algebraic-int"?"algebraic":n;return ve.debug("Using configured netMode:",r),r}return ve.debug("No configured netMode, detecting from content"),T5(t)},T5=t=>{const e=t||{},n=Array.isArray(e.transitions)?e.transitions:[],r=Array.isArray(e.arcs)?e.arcs:[],i=Array.isArray(e.places)?e.places:[];ve.debug("Net mode detection:",{places:i,transitions:n,arcs:r});for(const s of n){if(typeof s.guard=="string"&&s.guard.trim().length>0)return ve.debug("Found guard, using algebraic mode"),"algebraic";if(typeof s.action=="string"&&s.action.trim().length>0)return ve.debug("Found action, using algebraic mode"),"algebraic"}for(const s of r){const l=Array.isArray(s.bindings)?s.bindings:s.binding?[s.binding]:[];if(ve.debug("Checking arc bindings:",l),l.some(u=>typeof u=="string"&&(/:[ ]*(integer|boolean)/i.test(u)||u==="T"||u==="F"||/[+\-*/()]/.test(u))))return ve.debug("Found algebraic binding, using algebraic mode"),"algebraic"}return i.some(s=>Array.isArray(s.valueTokens)&&s.valueTokens.length>0)?(ve.debug("Found valueTokens, using algebraic mode"),"algebraic"):(ve.debug("Using P/T mode"),"pt")};class A9{constructor(){this.currentSimulator=null,this._ready=!1,this.netMode=null,this.eventBus=null,this.pendingListeners=new Map}async initialize(e,n={}){try{ve.debug("SimulatorCore.initialize called with:",{petriNet:e,options:n});const r=Wy(e,n);return this.currentSimulator=E9.createSimulator(r),this.netMode=r,this.eventBus&&this.currentSimulator.setEventBus(this.eventBus),await this.currentSimulator.initialize(e,n),this._ready=!0,this.setupPendingListeners(),ve.debug(`Simulator initialized with ${r} simulator`),{success:!0,netMode:r,simulatorType:this.currentSimulator.getType()}}catch(r){throw console.error("Failed to initialize simulator:",r),this._ready=!1,this.currentSimulator=null,r}}async update(e){if(!this.currentSimulator)return{success:!0};try{return await this.currentSimulator.update(e),{success:!0}}catch(n){throw console.error("Failed to update simulator:",n),n}}async getEnabledTransitions(){if(!this.currentSimulator)return[];try{return await this.currentSimulator.getEnabledTransitions()}catch(e){return console.error("Failed to get enabled transitions:",e),[]}}async fireTransition(e){if(!this.currentSimulator)throw new Error("Simulator not initialized");try{return await this.currentSimulator.fireTransition(e)}catch(n){throw console.error(`Failed to fire transition ${e}:`,n),n}}async stepSimulation(){if(!this.currentSimulator)throw new Error("Simulator not initialized");try{const e=await this.currentSimulator.getEnabledTransitions();if(!e||e.length===0)return this.currentSimulator.petriNet||null;const n=e[Math.floor(Math.random()*e.length)],r=typeof n=="string"?n:n&&n.id?n.id:String(n);return await this.currentSimulator.fireTransition(r)}catch(e){throw console.error("Failed to step simulation:",e),e}}async runToCompletion({mode:e="single",maxSteps:n=1e5,timeBudgetMs:r=3e4,yieldEvery:i=100,onProgress:s,shouldCancel:l,batchMax:c=0,progressEveryMs:u=0,yieldEveryMs:f=0}={}){if(!this.currentSimulator)throw new Error("Simulator not initialized");const p=this.currentSimulator.eventBus||null;try{this.currentSimulator.setEventBus&&this.currentSimulator.setEventBus(null)}catch{}try{return this.currentSimulator.setSimulationMode&&(this.currentSimulator.simulationMode=e),await M9({simulator:this.currentSimulator,mode:e,maxSteps:n,timeBudgetMs:r,yieldEvery:i,onProgress:s,shouldCancel:l,batchMax:c,progressEveryMs:u,yieldEveryMs:f})}finally{try{this.currentSimulator.setEventBus&&this.currentSimulator.setEventBus(p)}catch{}}}reset(){this.currentSimulator&&this.currentSimulator.reset(),this.currentSimulator=null,this._ready=!1,this.netMode=null,this.pendingListeners.clear()}deactivateSimulation(){this._active=!1}activateSimulation(e=!1){if(!this.currentSimulator)throw new Error("Simulator not initialized");ve.debug(`Simulation activated (continuous: ${e})`)}async isReady(){return this._ready&&this.currentSimulator&&this.currentSimulator.isReady()}getSimulatorStatus(){var e;return{isReady:this._ready,netMode:this.netMode,simulatorType:((e=this.currentSimulator)==null?void 0:e.getType())||"none",simulatorStatus:{simulator:this.currentSimulator}}}getSimulatorType(){var e;return((e=this.currentSimulator)==null?void 0:e.getType())||"none"}getSimulationMode(){var e;return((e=this.currentSimulator)==null?void 0:e.simulationMode)||"single"}setSimulationMode(e){this.currentSimulator&&(this.currentSimulator.simulationMode=e)}setEventBus(e){this.eventBus=e,this.currentSimulator&&this.currentSimulator.setEventBus(e)}__queueListener(e,n){this.pendingListeners.has(e)||this.pendingListeners.set(e,[]),this.pendingListeners.get(e).push(n)}setupPendingListeners(){if(!(!this.currentSimulator||!this.eventBus)){for(const[e,n]of this.pendingListeners)for(const r of n)this.eventBus.on(e,r);this.pendingListeners.clear()}}determineNetMode(e,n){return Wy(e,n)}detectNetModeFromContent(e){return T5(e)}}const xi=new A9;function I9(){try{return typeof window>"u"||typeof Worker>"u"||typeof process<"u"&&process.env&&{}.JEST_WORKER_ID?null:new Worker(new URL(""+new URL("simulation.worker-04867299.js",import.meta.url).href,self.location),{type:"module"})}catch(t){return console.error("Failed to create simulation worker:",t),null}}var R9="Expected a function",$y=0/0,L9="[object Symbol]",F9=/^\s+|\s+$/g,j9=/^[-+]0x[0-9a-f]+$/i,O9=/^0b[01]+$/i,D9=/^0o[0-7]+$/i,z9=parseInt,B9=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,U9=typeof self=="object"&&self&&self.Object===Object&&self,G9=B9||U9||Function("return this")(),V9=Object.prototype,W9=V9.toString,$9=Math.max,H9=Math.min,Bh=function(){return G9.Date.now()};function Y9(t,e,n){var r,i,s,l,c,u,f=0,p=!1,m=!1,w=!0;if(typeof t!="function")throw new TypeError(R9);e=Hy(e)||0,ip(n)&&(p=!!n.leading,m="maxWait"in n,s=m?$9(Hy(n.maxWait)||0,e):s,w="trailing"in n?!!n.trailing:w);function y(N){var I=r,M=i;return r=i=void 0,f=N,l=t.apply(M,I),l}function x(N){return f=N,c=setTimeout(_,e),p?y(N):l}function C(N){var I=N-u,M=N-f,L=e-I;return m?H9(L,s-M):L}function S(N){var I=N-u,M=N-f;return u===void 0||I>=e||I<0||m&&M>=s}function _(){var N=Bh();if(S(N))return E(N);c=setTimeout(_,C(N))}function E(N){return c=void 0,w&&r?y(N):(r=i=void 0,l)}function h(){c!==void 0&&clearTimeout(c),f=0,r=u=i=c=void 0}function k(){return c===void 0?l:E(Bh())}function T(){var N=Bh(),I=S(N);if(r=arguments,i=this,u=N,I){if(c===void 0)return x(u);if(m)return c=setTimeout(_,e),y(u)}return c===void 0&&(c=setTimeout(_,e)),l}return T.cancel=h,T.flush=k,T}function ip(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function X9(t){return!!t&&typeof t=="object"}function K9(t){return typeof t=="symbol"||X9(t)&&W9.call(t)==L9}function Hy(t){if(typeof t=="number")return t;if(K9(t))return $y;if(ip(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ip(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(F9,"");var n=O9.test(t);return n||D9.test(t)?z9(t.slice(2),n?2:8):j9.test(t)?$y:+t}var Q9=Y9;const Z9=ul(Q9),q9=({elements:t,netMode:e,simulatorCore:n,setElements:r,updateHistory:i,setEnabledTransitionIds:s,setIsSimulatorReady:l,setSimulationError:c,latestElementsRef:u,forceResetCounter:f})=>{z.useEffect(()=>{u.current=t},[t,u]),z.useEffect(()=>{try{n.setEventBus(ga)}catch{}},[n]),z.useEffect(()=>{(async()=>{var x,C;if(!(t&&t.places&&t.transitions&&t.arcs&&t.places.length>0&&t.transitions.length>0&&t.arcs.length>0)){try{await((x=n.deactivateSimulation)==null?void 0:x.call(n)),await((C=n.reset)==null?void 0:C.call(n)),s([]),l(!1),c(null)}catch(S){ve.error("Failed to reset simulator:",S)}return}try{ve.debug("Simulator force reset counter:",f),ve.debug("Initializing/updating simulator",{elements:t,netMode:e}),await n.initialize(t,{netMode:e})}catch(S){ve.error("Failed to initialize simulator:",S),s([]),l(!1);return}try{await n.update(u.current)}catch(S){ve.error("Failed to update simulator:",S),s([]),l(!1),c("Failed to update simulator");return}try{if(n.isReady&&await n.isReady()){const S=await n.getEnabledTransitions();s(S||[]),l(S&&S.length>0)}else{const S=t9(u.current),_=(S==null?void 0:S.enabledTransitions)||[];s(_),l(_.length>0)}c(S=>S==="Failed to update simulator"?null:S)}catch(S){ve.error("Failed to compute enabled transitions:",S),s([]),l(!1),c("Failed to update simulator")}})()},[t,e,n,f,s,l,c,u]),z.useEffect(()=>{const w=x=>{s(x.enabled||[]),l(x.hasEnabled);try{typeof window<"u"&&(window.__ENABLED_TRANSITIONS__=Array.isArray(x.enabled)?x.enabled:[])}catch{}},y=x=>{try{typeof window<"u"&&(window.__LAST_FIRED_TRANSITION_ID__=x.transitionId||null)}catch{}x.newPetriNet&&(r(x.newPetriNet),u.current=x.newPetriNet,i&&i(x.newPetriNet,!0))};return ga.on(oo.transitionsChanged,w),ga.on(oo.transitionFired,y),()=>{ga.off(oo.transitionsChanged,w),ga.off(oo.transitionFired,y)}},[r,i,s,l,u]),z.useEffect(()=>()=>{try{n.deactivateSimulation()}catch{}},[n]);const p=z.useCallback(async()=>{try{if(n.isReady&&await n.isReady()){const w=await n.getEnabledTransitions();s(w||[]);const y=Array.isArray(w)&&w.length>0;return l(y),w||[]}return s([]),l(!1),[]}catch(w){return console.error("Error refreshing enabled transitions:",w),c("Failed to refresh enabled transitions"),[]}},[n,s,l,c]),m=z.useMemo(()=>Z9(p,100),[p]);return z.useEffect(()=>()=>{m.cancel()},[m]),{refreshEnabledTransitions:p,debouncedRefresh:m}};class J9{constructor(){this.conflictCache=new Map}areTransitionsInConflict(e,n,r,i){const s=`${e}-${n}`,l=`${n}-${e}`;if(this.conflictCache.has(s))return this.conflictCache.get(s);if(this.conflictCache.has(l))return this.conflictCache.get(l);const c=this._requiredCategories(e,i),u=this._requiredCategories(n,i);let f=!1;for(const[p,m]of c.entries()){const w=u.get(p);if(w&&(m.has("int")&&w.has("int")||m.has("bool")&&w.has("bool"))){f=!0;break}}return this.conflictCache.set(s,f),f}_requiredCategories(e,n){const r=new Map;for(const i of n){const s=i.sourceId||i.source;if(!((i.targetId||i.target)===e&&(i.sourceType==="place"||i.type==="place-to-transition")))continue;const c=Array.isArray(i.bindings)?i.bindings:i.binding?[i.binding]:[];r.has(s)||r.set(s,new Set);const u=r.get(s);for(const f of c){const p=String(f||"");/:[ ]*boolean/i.test(p)||p==="T"||p==="F"?u.add("bool"):u.add("int")}c.length===0&&u.add("int")}return r}findNonConflictingTransitions(e,n,r){if(e.length<=1)return e;this.conflictCache.clear();const i=[];for(let s=e.length;s>=1;s--){const l=this.getCombinations(e,s);for(const c of l)this.isNonConflictingSet(c,n,r)&&i.push(c);if(i.length>0)return i}return e.map(s=>[s])}isNonConflictingSet(e,n,r){for(let i=0;i<e.length;i++)for(let s=i+1;s<e.length;s++)if(this.areTransitionsInConflict(e[i].id,e[s].id,n,r))return!1;return!0}getCombinations(e,n){if(n===0)return[[]];if(n>e.length)return[];const r=[],i=(s,l)=>{if(l.length===n){r.push([...l]);return}for(let c=s;c<e.length;c++)l.push(e[c]),i(c+1,l),l.pop()};return i(0,[]),r}getInputPlaces(e,n,r){const i=[];for(const s of r){const l=s.sourceId||s.source,c=s.targetId||s.target;if(s.sourceType==="place"&&c===e||s.type==="place-to-transition"&&c===e){const f=n.find(p=>p.id===l);f&&i.push(f)}}return i}getOutputPlaces(e,n,r){const i=[];for(const s of r){const l=s.sourceId||s.source,c=s.targetId||s.target;if(s.targetType==="place"&&l===e||s.type==="transition-to-place"&&l===e){const f=n.find(p=>p.id===c);f&&i.push(f)}}return i}clearCache(){this.conflictCache.clear()}getCacheStats(){return{size:this.conflictCache.size,keys:Array.from(this.conflictCache.keys())}}}const e_=1e3,Nc=t=>(t||[]).map(e=>typeof e=="string"?e:e&&typeof e=="object"?e.id??(e.get?e.get("id"):void 0):String(e)).filter(Boolean),E5=t=>(t.current||(t.current=new J9),t.current),t_=({simulatorCore:t,setElements:e,updateHistory:n,clearError:r,refreshEnabledTransitions:i,setSimulationError:s,latestElementsRef:l})=>async c=>{try{if(t.getSimulatorType&&t.getSimulatorType()==="none")throw new Error("Simulator not initialized. Please wait for initialization to complete.");await t.activateSimulation(!1);const u=await t.fireTransition(c);if(!u||typeof u!="object")throw new Error("Invalid Petri net returned from simulator");if(!u.places||!Array.isArray(u.places)||!u.transitions||!Array.isArray(u.transitions)||!u.arcs||!Array.isArray(u.arcs))throw new Error("Incomplete Petri net structure returned from simulator");const f=JSON.parse(JSON.stringify(u));e(f),l.current=f,n&&n(f,!0),r(),await i(),setTimeout(()=>{try{t.activateSimulation()}catch{}},50)}catch(u){console.error(`Error firing transition ${c}:`,u),s(u.message||`Failed to fire transition ${c}.`)}},n_=({simulatorCore:t,handleFireTransition:e,conflictResolverRef:n,latestElementsRef:r,refreshEnabledTransitions:i,setSimulationError:s,stopAllSimulations:l})=>async()=>{var c,u;try{if(t.getSimulatorType&&t.getSimulatorType()==="none")throw new Error("Simulator not initialized. Please wait for initialization to complete.");let f="single";try{f=t.getSimulationMode?t.getSimulationMode():"single"}catch{}if(f==="maximal"){const y=await t.getEnabledTransitions();if(!y||y.length===0)return;const x=E5(n),C=Nc(y).map(k=>({id:k})),S=x.findNonConflictingTransitions(C,((c=r.current)==null?void 0:c.places)||[],((u=r.current)==null?void 0:u.arcs)||[]),_=Array.isArray(S)?S:Array.from(S||[]),E=_.length?_[Math.floor(Math.random()*_.length)]:[],h=Array.isArray(E)?E:E?[E]:[];for(const k of h)await e(k.id);await i();return}const p=await t.getEnabledTransitions();if(!p||p.length===0)return;const m=Nc(p),w=m[Math.floor(Math.random()*m.length)];await e(w)}catch(f){console.error("Error in step simulation:",f),s("Error during simulation step: "+(f.message||"Unknown error")),l()}},r_=t=>new Promise(e=>setTimeout(e,t)),i_=({simulatorCore:t,isContinuousSimulatingRef:e,isRunningRef:n,setIsContinuousSimulating:r,setEnabledTransitionIds:i,stepSimulation:s,refreshEnabledTransitions:l,setSimulationError:c})=>async()=>{if(!(e.current||n.current))try{await t.activateSimulation();const u=await t.getEnabledTransitions();if(!u||u.length===0)return;r(!0),e.current=!0;const f=Nc(u);for(i(f);e.current;){await s();const p=await l();if(!p||p.length===0)break;await r_(e_)}}catch(u){console.error("Error starting continuous simulation:",u),c("Failed to start continuous simulation")}finally{e.current=!1,r(!1);try{t.deactivateSimulation()}catch{}}},s_=(t,e)=>{const n=Number(t);return!Number.isFinite(n)||n<=0?null:Math.max(1,Math.min(e,Math.floor(n)))},o_=()=>{try{const t=window.__Z3_SETTINGS__||{};return{poolSize:Number.isFinite(Number(t.poolSize))?Number(t.poolSize):0,idleTimeoutMs:t.idleTimeoutMs,prewarmOnAlgebraicMode:t.prewarmOnAlgebraicMode,solverTimeoutMs:t.solverTimeoutMs}}catch{return{poolSize:0}}},a_=({simulationSettings:t})=>{let e=!1;try{e=!!window.__PETRI_NET_NON_VISUAL_RUN__}catch{}const n=typeof window<"u"&&window.__PETRI_NET_SETTINGS__?window.__PETRI_NET_SETTINGS__:{};!e&&(t!=null&&t.useNonVisualRun)&&(e=!0);const r=t==null?void 0:t.batchMode,i=r!==void 0?!!r:!!(n!=null&&n.batchMode);i&&(e=!0);const s=!!((t==null?void 0:t.limitIterations)??(n==null?void 0:n.limitIterations)),l=s_((t==null?void 0:t.maxIterations)??(n==null?void 0:n.maxIterations),1e6);return{useNonVisual:e,batchMode:i,limitIterationsFlag:s,maxIterations:l}},l_=({simulatorCore:t,isContinuousSimulatingRef:e,isRunningRef:n,setIsRunning:r,setIsContinuousSimulating:i,refreshEnabledTransitions:s,simulationSettings:l,ensureWorker:c,setElements:u,latestElementsRef:f,updateHistory:p,setSimulationError:m,conflictResolverRef:w,elements:y,handleFireTransition:x,setCompletionStats:C,netMode:S})=>async()=>{if(!(e.current||n.current))try{await t.activateSimulation(!1),r(!0),i(!1),n.current=!0,await s();const{useNonVisual:_,batchMode:E,limitIterationsFlag:h,maxIterations:k}=a_({simulationSettings:l}),T=2e5,N=h?k??T:T;let I=null,M=!1;const L=async O=>{try{if(I||(I=o_()),Number(I.poolSize||0)>=O)return;(await Yr(()=>Promise.resolve().then(()=>Ba),void 0,import.meta.url)).setZ3WorkerConfig({...I,poolSize:O}),M=!0}catch{}},A=async()=>{if(M){try{(await Yr(()=>Promise.resolve().then(()=>Ba),void 0,import.meta.url)).setZ3WorkerConfig(I||{})}catch{}M=!1}};let R=!1;if(E){if(!(await Yr(()=>Promise.resolve().then(()=>Ba),void 0,import.meta.url)).isSharedArrayBufferAvailable()){const $="SharedArrayBuffer not available. This is required for batch mode. Please ensure COOP/COEP headers are set correctly (service worker should handle this). Try refreshing the page.";console.error($),m($),n.current=!1,r(!1);return}await L(8);const V=await c();if(V)try{let $="single";try{$=t.getSimulationMode?t.getSimulationMode():"single"}catch{}const D=setTimeout(()=>{V.removeEventListener("message",X),V.removeEventListener("error",H);const re="Simulation worker timed out after 5 minutes. This may indicate that Z3 workers are not responding. Check browser console for errors.";console.error(re),m(re),A(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}},5*60*1e3),X=async re=>{const{op:K,payload:ne}=re.data||{};if(K==="done"){clearTimeout(D),V.removeEventListener("message",X),V.removeEventListener("error",H),ne&&ne.elements&&typeof ne.elements=="object"&&(u(ne.elements),f.current=ne.elements,p&&p(ne.elements,!0)),await A(),await s(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}ne!=null&&ne.stats&&C({elapsedMs:ne.stats.elapsedMs,transitionsFired:ne.stats.steps?ne.stats.steps.toLocaleString():"0"})}else K==="error"&&(clearTimeout(D),V.removeEventListener("message",X),V.removeEventListener("error",H),m((ne==null?void 0:ne.message)||"Worker error"),await A(),n.current=!1,r(!1))},H=re=>{clearTimeout(D),V.removeEventListener("message",X),V.removeEventListener("error",H);const K=`Worker error: ${re.message||"Unknown error"}. This may indicate that Z3 workers failed to initialize.`;console.error(K,re),m(K),A(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}};V.addEventListener("message",X),V.addEventListener("error",H),V.postMessage({op:"start",payload:{elements:f.current,simOptions:{netMode:S},run:{mode:$,batchMax:0,maxSteps:N,timeBudgetMs:0,yieldEvery:5e3,progressEveryMs:0,yieldEveryMs:0},z3:typeof window<"u"?window.__Z3_SETTINGS__||{}:{}}}),R=!0}catch($){console.error("Worker run failed, falling back to in-thread run:",$),m(`Worker initialization failed: ${$.message}. Falling back to in-thread execution.`),await A()}else{const $="Failed to create simulation worker. SharedArrayBuffer may not be available.";console.error($),m($),n.current=!1,r(!1);return}}if(R)return;if(_&&typeof t.runToCompletion=="function"){let O="single";try{O=t.getSimulationMode?t.getSimulationMode():"single"}catch{}const V=()=>{try{return!!window.__PETRI_NET_CANCEL_RUN__}catch{return!1}},$=performance.now?performance.now():Date.now();try{const D=await t.runToCompletion({mode:O,maxSteps:N,timeBudgetMs:0,yieldEvery:5e3,progressEveryMs:0,yieldEveryMs:0,onProgress:()=>{},shouldCancel:V,batchMax:0}),X=performance.now?performance.now():Date.now(),H=Math.round(X-$);D&&D.petriNet&&typeof D.petriNet=="object"&&(u(D.petriNet),f.current=D.petriNet,p&&p(D.petriNet,!0)),C({elapsedMs:H,transitionsFired:D!=null&&D.steps?D.steps.toLocaleString():"0"})}finally{await A(),await s(),n.current=!1,r(!1);try{t.deactivateSimulation()}catch{}}return}let j=N;const G=E5(w),U=async()=>{if(!n.current){r(!1);return}if(j<=0){n.current=!1,r(!1);return}try{const O=await t.getEnabledTransitions();if(!O||O.length===0){n.current=!1,r(!1);return}const V=Nc(O).map(re=>({id:re})),$=G.findNonConflictingTransitions(V,y.places||[],y.arcs||[]),D=Array.isArray($)?$:Array.from($||[]),X=D.length?D[Math.floor(Math.random()*D.length)]:[],H=Array.isArray(X)?X:X?[X]:[];for(const re of H){if(j<=0)break;await x(re.id),j-=1}if(j<=0){n.current=!1,r(!1);return}setTimeout(U,50)}catch(O){console.error("Error in run simulation:",O),m(O.message||"Error during simulation run"),n.current=!1,r(!1)}};U()}catch(_){console.error("Error starting run simulation:",_),m("Failed to start run simulation")}},u_=(t,e,n,r,i={},s)=>{const[l,c]=z.useState(!1),[u,f]=z.useState(!1),[p,m]=z.useState([]),[w,y]=z.useState(null),[x,C]=z.useState(!1),[S,_]=z.useState(0),[E,h]=z.useState(null),k=z.useRef(!1),T=z.useRef(!1),N=z.useRef(t),I=z.useRef(null),M=z.useRef(null),L=s||xi,A=z.useCallback(async()=>{if(M.current)return M.current;try{const re=I9();return M.current=re,re}catch(re){return console.error("Failed to create simulation worker:",re),null}},[]),{refreshEnabledTransitions:R,debouncedRefresh:j}=q9({elements:t,netMode:r,simulatorCore:L,setElements:e,updateHistory:n,setEnabledTransitionIds:m,setIsSimulatorReady:C,setSimulationError:y,latestElementsRef:N,forceResetCounter:S});z.useEffect(()=>{N.current=t},[t]);const G=z.useCallback(()=>{y(null)},[]),U=z.useCallback(()=>{ve.debug("Forcing simulator reset"),_(re=>re+1)},[]),O=z.useCallback(()=>{var re,K;c(!1),f(!1),k.current=!1,T.current=!1;try{L.deactivateSimulation()}catch{}G(),m([]);try{(K=(re=M.current)==null?void 0:re.postMessage)==null||K.call(re,{op:"cancel"})}catch{}},[G,L]);z.useEffect(()=>{l||u?(L.activateSimulation(),R()):(L.deactivateSimulation(),R())},[l,u,R]),z.useEffect(()=>((u||l)&&j(),()=>j.cancel()),[u,l,j]);const V=z.useMemo(()=>t_({simulatorCore:L,setElements:e,updateHistory:n,clearError:G,refreshEnabledTransitions:R,setSimulationError:y,latestElementsRef:N}),[L,e,n,G,R,y]),$=z.useMemo(()=>n_({simulatorCore:L,handleFireTransition:V,conflictResolverRef:I,latestElementsRef:N,refreshEnabledTransitions:R,setSimulationError:y,stopAllSimulations:O}),[L,V,I,R,y,O]),D=z.useMemo(()=>i_({simulatorCore:L,isContinuousSimulatingRef:k,isRunningRef:T,setIsContinuousSimulating:c,setEnabledTransitionIds:m,stepSimulation:$,refreshEnabledTransitions:R,setSimulationError:y}),[L,k,T,c,m,$,R,y]),X=z.useMemo(()=>l_({simulatorCore:L,isContinuousSimulatingRef:k,isRunningRef:T,setIsRunning:f,setIsContinuousSimulating:c,refreshEnabledTransitions:R,simulationSettings:i,ensureWorker:A,setElements:e,latestElementsRef:N,updateHistory:n,setSimulationError:y,conflictResolverRef:I,elements:t,handleFireTransition:V,setCompletionStats:h,netMode:r}),[L,k,T,f,c,R,i==null?void 0:i.limitIterations,i==null?void 0:i.maxIterations,i==null?void 0:i.batchMode,i==null?void 0:i.useNonVisualRun,A,e,N,n,y,I,t,V,h,r]),H=z.useCallback(()=>{h(null)},[]);return{isContinuousSimulating:l,isRunning:u,enabledTransitionIds:p,simulationError:w,isSimulatorReady:x,handleFireTransition:V,stepSimulation:$,startContinuousSimulation:D,startRunSimulation:X,stopAllSimulations:O,clearError:G,forceSimulatorReset:U,completionStats:E,dismissCompletionDialog:H}};function c_(t){if(!t||typeof t!="object")return"pt";const e=Array.isArray(t.places)?t.places:[],n=Array.isArray(t.transitions)?t.transitions:[],r=Array.isArray(t.arcs)?t.arcs:[];return e.some(s=>Array.isArray(s.valueTokens)&&s.valueTokens.length>0||!!s.type)||n.some(s=>!!s.guard||!!s.action)||r.some(s=>Array.isArray(s.bindings)&&s.bindings.length>0||!!s.binding)?"algebraic-int":"pt"}function d_(t){const{elements:e,setElements:n,updateHistory:r,simulationSettings:i,setSimulationSettings:s,resetEditor:l,forceSimulatorReset:c,setIsLoading:u,setError:f,setSuccess:p,setIsAdtOpen:m,saveFileHandle:w,setSaveFileHandle:y,setIsMobileMenuOpen:x}=t||{},C=()=>{m&&m(!0)},S=async(T,N)=>{const I=await T.createWritable();await I.write(new Blob([N],{type:"application/xml"})),await I.close()};return{handleSave:async()=>{try{u==null||u(!0),f==null||f(null),p==null||p(null);const T={...e||{},netMode:(i==null?void 0:i.netMode)||"pt"},N=await Oy(T),I="petri-net.pnml";if(typeof window<"u"&&typeof window.showSaveFilePicker=="function")try{if(w)await S(w,N);else{const L=await window.showSaveFilePicker({suggestedName:I,types:[{description:"PNML Files",accept:{"application/xml":[".pnml",".xml"],"text/xml":[".pnml",".xml"]}}],excludeAcceptAllOption:!1});await S(L,N),y==null||y(L)}}catch(L){if(L&&(L.name==="AbortError"||L.name==="SecurityError"))p==null||p("Save cancelled.");else{const A=new Blob([N],{type:"application/xml"}),R=URL.createObjectURL(A),j=document.createElement("a");j.href=R,j.download=I,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(R)}}else{const L=new Blob([N],{type:"application/xml"}),A=URL.createObjectURL(L),R=document.createElement("a");R.href=A,R.download=I,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(A)}p==null||p("Petri net saved."),x==null||x(!1)}catch(T){console.error("Error saving Petri net:",T),f==null||f(`Error saving Petri net: ${T.message}`)}finally{u==null||u(!1)}},handleSaveAs:async()=>{try{u==null||u(!0),f==null||f(null),p==null||p(null);const T={...e||{},netMode:(i==null?void 0:i.netMode)||"pt"},N=await Oy(T),I="petri-net.pnml";if(typeof window<"u"&&typeof window.showSaveFilePicker=="function")try{const L=await window.showSaveFilePicker({suggestedName:I,types:[{description:"PNML Files",accept:{"application/xml":[".pnml",".xml"],"text/xml":[".pnml",".xml"]}}],excludeAcceptAllOption:!1});await S(L,N),y==null||y(L)}catch(L){if(L&&(L.name==="AbortError"||L.name==="SecurityError"))p==null||p("Save cancelled.");else{const A=new Blob([N],{type:"application/xml"}),R=URL.createObjectURL(A),j=document.createElement("a");j.href=R,j.download=I,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(R)}}else{const L=new Blob([N],{type:"application/xml"}),A=URL.createObjectURL(L),R=document.createElement("a");R.href=A,R.download=I,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(A)}p==null||p("Petri net saved."),x==null||x(!1)}catch(T){console.error("Error saving Petri net:",T),f==null||f(`Error saving Petri net: ${T.message}`)}finally{u==null||u(!1)}},handleLoad:()=>{const T=document.createElement("input");T.type="file",T.accept=".pnml,.xml";try{T.style.display="none",document.body.appendChild(T)}catch{}T.onchange=async N=>{const I=N.target.files[0];if(I)try{u==null||u(!0),f==null||f(null),p==null||p(null);const M=await new Promise((O,V)=>{const $=new FileReader;$.onload=D=>O(D.target.result),$.onerror=V,$.readAsText(I)});if(!M||String(M).trim()==="")throw new Error("The selected file is empty");if(!String(M).includes("<pnml")&&!String(M).includes("<PNML"))throw new Error("The file does not appear to be a valid PNML file");const L=Zw(M),A=new Promise((O,V)=>{setTimeout(()=>V(new Error("Operation timed out. The file may be too large or invalid.")),1e4)}),R=await Promise.race([L,A]);if(!R||typeof R!="object")throw new Error("Invalid data structure in the imported file");const j={places:Array.isArray(R.places)?R.places:[],transitions:Array.isArray(R.transitions)?R.transitions:[],arcs:Array.isArray(R.arcs)?R.arcs:[]},G=(j.arcs||[]).filter(O=>{if(O.source==="undefined"||O.target==="undefined"||!O.source||!O.target)return!1;const V=j.places.some(D=>D.id===O.source)||j.transitions.some(D=>D.id===O.source),$=j.places.some(D=>D.id===O.target)||j.transitions.some(D=>D.id===O.target);return V&&$});j.arcs=G.map(O=>{if(!O.type||O.type!=="place-to-transition"&&O.type!=="transition-to-place"){const V=j.places.some(D=>D.id===O.source),$=j.places.some(D=>D.id===O.target);return V&&!$?{...O,type:"place-to-transition"}:!V&&$?{...O,type:"transition-to-place"}:{...O,type:"place-to-transition"}}return O}),c&&c(),n==null||n(j);const U=j.netMode;if(U)s==null||s(O=>({...O||{},netMode:U}));else try{const O=c_(j);s==null||s(V=>({...V||{},netMode:O}))}catch{}r&&r(j),p==null||p(`Petri net loaded successfully with ${j.places.length} places, ${j.transitions.length} transitions, and ${j.arcs.length} arcs.`),x==null||x(!1)}catch(M){console.error("Error loading Petri net:",M),f==null||f(`Error loading Petri net: ${M.message}`)}finally{u==null||u(!1);try{T&&T.parentNode&&T.parentNode.removeChild(T)}catch{}}},T.click()},handleClear:()=>{var T,N;try{(T=xi.deactivateSimulation)==null||T.call(xi),(N=xi.reset)==null||N.call(xi)}catch{}if(l)l();else{const I={places:[],transitions:[],arcs:[]};n==null||n(I),s==null||s(M=>({...M||{},netMode:"pt"})),r&&r(I)}p==null||p("Canvas cleared successfully."),x==null||x(!1)},handleOpenAdtManager:C}}const Ot=[];for(let t=0;t<256;++t)Ot.push((t+256).toString(16).slice(1));function f_(t,e=0){return(Ot[t[e+0]]+Ot[t[e+1]]+Ot[t[e+2]]+Ot[t[e+3]]+"-"+Ot[t[e+4]]+Ot[t[e+5]]+"-"+Ot[t[e+6]]+Ot[t[e+7]]+"-"+Ot[t[e+8]]+Ot[t[e+9]]+"-"+Ot[t[e+10]]+Ot[t[e+11]]+Ot[t[e+12]]+Ot[t[e+13]]+Ot[t[e+14]]+Ot[t[e+15]]).toLowerCase()}let Uh;const h_=new Uint8Array(16);function p_(){if(!Uh){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Uh=crypto.getRandomValues.bind(crypto)}return Uh(h_)}const g_=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Yy={randomUUID:g_};function go(t,e,n){var i;if(Yy.randomUUID&&!e&&!t)return Yy.randomUUID();t=t||{};const r=t.random??((i=t.rng)==null?void 0:i.call(t))??p_();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){if(n=n||0,n<0||n+16>e.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let s=0;s<16;++s)e[n+s]=r[s];return e}return f_(r)}function b5(t,e){const n=new Set((e||[]).filter(l=>l.type==="place"||l.type==="transition").map(l=>l.id)),r=(t.places||[]).filter(l=>n.has(l.id)),i=(t.transitions||[]).filter(l=>n.has(l.id)),s=(t.arcs||[]).filter(l=>n.has(l.source)&&n.has(l.target));return{places:r,transitions:i,arcs:s}}function N5(t,e,n){if(!t)return null;const r=new Map,i=n&&typeof n.x=="number"?n.x:(n==null?void 0:n.dx)||0,s=n&&typeof n.y=="number"?n.y:(n==null?void 0:n.dy)||0,l=[],c=(t.places||[]).map(p=>{const m=e();r.set(p.id,m);const w=typeof p.x=="number"&&isFinite(p.x)?p.x:0,y=typeof p.y=="number"&&isFinite(p.y)?p.y:0,x={...p,id:m,x:w+i,y:y+s};return l.push({id:m,type:"place"}),x}),u=(t.transitions||[]).map(p=>{const m=e();r.set(p.id,m);const w=typeof p.x=="number"&&isFinite(p.x)?p.x:0,y=typeof p.y=="number"&&isFinite(p.y)?p.y:0,x={...p,id:m,x:w+i,y:y+s};return l.push({id:m,type:"transition"}),x}),f=(t.arcs||[]).map(p=>({...p,id:e(),source:r.get(p.source),target:r.get(p.target)}));return{newPlaces:c,newTransitions:u,newArcs:f,newSelection:l}}function m_(t,e){const n=new Set(Array.isArray(e)?e.map(i=>typeof i=="string"?i:i.id):[]),r={...t};return r.places=(t.places||[]).filter(i=>!n.has(i.id)),r.transitions=(t.transitions||[]).filter(i=>!n.has(i.id)),r.arcs=(t.arcs||[]).filter(i=>!n.has(i.source)&&!n.has(i.target)),r}function P5(t){const{elements:e,setElements:n,selectedElement:r,selectedElements:i,clearSelection:s,setSelection:l,clipboardRef:c,netMode:u,setClipboard:f,getClipboard:p,onClipboardMismatch:m,handleUndo:w,handleRedo:y,setMode:x,arcStart:C,setArcStart:S,setTempArcEnd:_,setSelectedElement:E}=t;z.useEffect(()=>{const h=T=>{const I=navigator.platform.toUpperCase().includes("MAC")?T.metaKey:T.ctrlKey;T.key==="Shift"&&t.isShiftPressedRef&&(t.isShiftPressedRef.current=!0);const M=T.target,L=M==null?void 0:M.tagName,A=L==="INPUT"||L==="TEXTAREA"||(M==null?void 0:M.isContentEditable);if(!A&&(T.key==="Delete"||T.key==="Backspace")){if(i.length===0&&!r)return;T.preventDefault(),n(R=>{const j=[],G=new Set;i.length>0?i.forEach(O=>{(O.type==="place"||O.type==="transition")&&j.push(O.id),O.type==="arc"&&G.add(O.id)}):r&&((r.type==="place"||r.type==="transition")&&j.push(r.id),r.type==="arc"&&G.add(r.id));let U=R;return j.length>0&&(U=m_(U,j)),G.size>0&&(U={...U,arcs:U.arcs.filter(O=>!G.has(O.id))}),U}),s();return}if(!A&&I&&(T.key==="a"||T.key==="A")){T.preventDefault();const R=[...e.places.map(j=>({id:j.id,type:"place"})),...e.transitions.map(j=>({id:j.id,type:"transition"})),...e.arcs.map(j=>({id:j.id,type:"arc"}))];l(R);return}if(!A&&I&&(T.key==="z"||T.key==="Z")&&typeof w=="function"){T.preventDefault(),w();return}if(!A&&I&&(T.key==="y"||T.key==="Y")&&typeof y=="function"){T.preventDefault(),y();return}if(!A&&!I){if((T.key==="p"||T.key==="P")&&typeof x=="function"){T.preventDefault(),x("place");return}if((T.key==="t"||T.key==="T")&&typeof x=="function"){T.preventDefault(),x("transition");return}if((T.key==="a"||T.key==="A")&&typeof x=="function"){T.preventDefault(),x("arc");return}if((T.key==="s"||T.key==="S")&&typeof x=="function"){T.preventDefault(),x("select");return}if(T.key==="Escape"){T.preventDefault(),typeof x=="function"&&x("select"),typeof S=="function"&&C&&S(null),typeof _=="function"&&_(null),typeof E=="function"&&E(null);return}}if(!A&&I&&(T.key==="c"||T.key==="C")){if(i.length===0)return;T.preventDefault();const R=b5(e,i),j=u||"pt";typeof f=="function"?f(R):c&&(c.current={payload:R,netMode:j,source:"local",timestamp:Date.now()});return}if(!A&&I&&(T.key==="v"||T.key==="V")){const R=u||"pt",j=typeof p=="function"?p():c==null?void 0:c.current;if(!j)return;const G=j.payload||j;if(!G)return;const U=j.netMode||R;if(U&&R&&U!==R){typeof m=="function"?m(U,R,j):console.warn(`Blocked paste: shared clipboard contains ${U} net, editor mode is ${R}.`);return}T.preventDefault();const{newPlaces:O,newTransitions:V,newArcs:$,newSelection:D}=N5(G,go,{x:40,y:40});n(X=>({...X,places:[...X.places,...O],transitions:[...X.transitions,...V],arcs:[...X.arcs,...$]})),l(D);return}},k=T=>{T.key==="Shift"&&t.isShiftPressedRef&&(t.isShiftPressedRef.current=!1)};return document.addEventListener("keydown",h),document.addEventListener("keyup",k),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",k)}},[e,i,r,n,s,l,c,t,w,y,x,C,S,_,E])}function y_(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var M5=y_,v_=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,x_=v_,w_=x_,__=typeof self=="object"&&self&&self.Object===Object&&self,S_=w_||__||Function("return this")(),A5=S_,k_=A5,C_=function(){return k_.Date.now()},T_=C_,E_=/\s/;function b_(t){for(var e=t.length;e--&&E_.test(t.charAt(e)););return e}var N_=b_,P_=N_,M_=/^\s+/;function A_(t){return t&&t.slice(0,P_(t)+1).replace(M_,"")}var I_=A_,R_=A5,L_=R_.Symbol,I5=L_,Xy=I5,R5=Object.prototype,F_=R5.hasOwnProperty,j_=R5.toString,ma=Xy?Xy.toStringTag:void 0;function O_(t){var e=F_.call(t,ma),n=t[ma];try{t[ma]=void 0;var r=!0}catch{}var i=j_.call(t);return r&&(e?t[ma]=n:delete t[ma]),i}var D_=O_,z_=Object.prototype,B_=z_.toString;function U_(t){return B_.call(t)}var G_=U_,Ky=I5,V_=D_,W_=G_,$_="[object Null]",H_="[object Undefined]",Qy=Ky?Ky.toStringTag:void 0;function Y_(t){return t==null?t===void 0?H_:$_:Qy&&Qy in Object(t)?V_(t):W_(t)}var X_=Y_;function K_(t){return t!=null&&typeof t=="object"}var Q_=K_,Z_=X_,q_=Q_,J_="[object Symbol]";function e7(t){return typeof t=="symbol"||q_(t)&&Z_(t)==J_}var t7=e7,n7=I_,Zy=M5,r7=t7,qy=0/0,i7=/^[-+]0x[0-9a-f]+$/i,s7=/^0b[01]+$/i,o7=/^0o[0-7]+$/i,a7=parseInt;function l7(t){if(typeof t=="number")return t;if(r7(t))return qy;if(Zy(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Zy(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=n7(t);var n=s7.test(t);return n||o7.test(t)?a7(t.slice(2),n?2:8):i7.test(t)?qy:+t}var u7=l7,c7=M5,Gh=T_,Jy=u7,d7="Expected a function",f7=Math.max,h7=Math.min;function p7(t,e,n){var r,i,s,l,c,u,f=0,p=!1,m=!1,w=!0;if(typeof t!="function")throw new TypeError(d7);e=Jy(e)||0,c7(n)&&(p=!!n.leading,m="maxWait"in n,s=m?f7(Jy(n.maxWait)||0,e):s,w="trailing"in n?!!n.trailing:w);function y(N){var I=r,M=i;return r=i=void 0,f=N,l=t.apply(M,I),l}function x(N){return f=N,c=setTimeout(_,e),p?y(N):l}function C(N){var I=N-u,M=N-f,L=e-I;return m?h7(L,s-M):L}function S(N){var I=N-u,M=N-f;return u===void 0||I>=e||I<0||m&&M>=s}function _(){var N=Gh();if(S(N))return E(N);c=setTimeout(_,C(N))}function E(N){return c=void 0,w&&r?y(N):(r=i=void 0,l)}function h(){c!==void 0&&clearTimeout(c),f=0,r=u=i=c=void 0}function k(){return c===void 0?l:E(Gh())}function T(){var N=Gh(),I=S(N);if(r=arguments,i=this,u=N,I){if(c===void 0)return x(u);if(m)return clearTimeout(c),c=setTimeout(_,e),y(u)}return c===void 0&&(c=setTimeout(_,e)),l}return T.cancel=h,T.flush=k,T}var g7=p7;const m7=ul(g7);function y7(t,e){return!t||!e||!Vh(t.places,e.places,L5)||!Vh(t.transitions,e.transitions,sp)||!Vh(t.arcs,e.arcs,F5)?!1:(ve.debug("HistoryManager: States are identical"),!0)}function Vh(t=[],e=[],n){if(t.length!==e.length){const i=n===L5?"places":n===sp?"transitions":"arcs";return ve.debug(`HistoryManager: States differ in number of ${i}`),!1}const r=new Map;e.forEach(i=>r.set(i.id,i));for(const i of t){const s=r.get(i.id);if(!s)return ve.debug(`HistoryManager: ${n===F5?"Arc":n===sp?"Transition":"Place"} ${i.id} not found in second state`),!1;if(!n(i,s))return!1}return!0}function L5(t,e){const n=JSON.stringify(t.valueTokens||[])===JSON.stringify(e.valueTokens||[]),r=t.x===e.x&&t.y===e.y&&t.tokens===e.tokens&&t.label===e.label&&t.name===e.name&&n;return r||ve.debug(`HistoryManager: Place ${t.id} differs - x: ${t.x} vs ${e.x}, y: ${t.y} vs ${e.y}, tokens: ${t.tokens} vs ${e.tokens}, label: ${t.label} vs ${e.label}, name: ${t.name} vs ${e.name}`),r}function sp(t,e){const n=t.x===e.x&&t.y===e.y&&t.label===e.label&&t.name===e.name&&(t.guard||"")===(e.guard||"");return n||ve.debug(`HistoryManager: Transition ${t.id} differs - x: ${t.x} vs ${e.x}, y: ${t.y} vs ${e.y}, label: ${t.label} vs ${e.label}, name: ${t.name} vs ${e.name}`),n}function F5(t,e){if(!(t.source===e.source&&t.target===e.target&&t.weight===e.weight))return ve.debug(`HistoryManager: Arc ${t.id} differs - source: ${t.source} vs ${e.source}, target: ${t.target} vs ${e.target}, weight: ${t.weight} vs ${e.weight}`),!1;const r=(t.label||"")===(e.label||"")&&(t.sourceType||"")===(e.sourceType||"")&&(t.targetType||"")===(e.targetType||"")&&JSON.stringify(t.bindings||[])===JSON.stringify(e.bindings||[])&&JSON.stringify(t.anglePoints||[])===JSON.stringify(e.anglePoints||[]);return r||ve.debug(`HistoryManager: Arc ${t.id} differs in secondary properties`),r}function qu(t){if(!t||!t.places||!t.transitions||!t.arcs)return{places:[],transitions:[],arcs:[]};const e=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(i=>e(i));const r={};for(const i in n)if(Object.prototype.hasOwnProperty.call(n,i)){const s=n[i];s===null||typeof s!="object"?r[i]=s:Array.isArray(s)?r[i]=[...s]:r[i]={...s}}return r};return{places:t.places.map(e),transitions:t.transitions.map(e),arcs:t.arcs.map(e)}}function Wh(t){return!t||!t.places||!t.transitions||!t.arcs?{places:[],transitions:[],arcs:[]}:qu(t)}class e2{constructor(e){this.states=[qu(e)],this.currentIndex=0,this.maxStates=50}addState(e){const n=qu(e),r=this.states[this.currentIndex];return this.currentIndex>=0&&y7(r,n)?(ve.debug("HistoryManager: State unchanged, not adding to history"),{canUndo:this.canUndo(),canRedo:this.canRedo()}):(ve.debug(`HistoryManager: Adding new state to history. Current index: ${this.currentIndex}, States count: ${this.states.length}`),this.currentIndex<this.states.length-1&&(ve.debug(`HistoryManager: Removing ${this.states.length-this.currentIndex-1} future states`),this.states=this.states.slice(0,this.currentIndex+1)),this.states.push(n),this.currentIndex++,this.states.length>this.maxStates&&(this.states.shift(),this.currentIndex--),ve.debug(`HistoryManager: New state added. Current index: ${this.currentIndex}, States count: ${this.states.length}`),{canUndo:this.canUndo(),canRedo:this.canRedo()})}undo(){if(!this.canUndo())return ve.debug("HistoryManager: Cannot undo - no previous states"),null;this.currentIndex--;const e=this.states[this.currentIndex];return ve.debug(`HistoryManager: Undoing to index ${this.currentIndex}, states count: ${this.states.length}`),{state:Wh(e),canUndo:this.canUndo(),canRedo:this.canRedo()}}redo(){if(!this.canRedo())return ve.debug("HistoryManager: Cannot redo - no future states"),null;this.currentIndex++;const e=this.states[this.currentIndex];return ve.debug(`HistoryManager: Redoing to index ${this.currentIndex}, states count: ${this.states.length}`),{state:Wh(e),canUndo:this.canUndo(),canRedo:this.canRedo()}}canUndo(){return this.currentIndex>0}canRedo(){return this.currentIndex<this.states.length-1}getCurrentState(){return this.states[this.currentIndex]}deepCopyState(e){return qu(e)}validateState(e){return Wh(e)}}const v7="petri-net-shared-clipboard";function x7({clipboardRef:t,netMode:e,instanceId:n,onIncompatibleClipboard:r}){const i=z.useRef(null),s=z.useRef(e||"pt"),l=z.useRef(r||null);z.useEffect(()=>{s.current=e||"pt"},[e]),z.useEffect(()=>{l.current=r||null},[r]),z.useEffect(()=>{if(typeof window>"u"||typeof window.BroadcastChannel!="function")return;const f=new window.BroadcastChannel(v7);i.current=f;const p=m=>{var C;const w=m==null?void 0:m.data;if(!w||w.type!=="PETRI_NET_CLIPBOARD_UPDATE"||w.instanceId===n)return;const y={payload:w.payload,netMode:w.netMode,source:"remote",instanceId:w.instanceId,timestamp:w.timestamp||Date.now()};t&&(t.current=y);const x=s.current;y.netMode&&x&&y.netMode!==x&&((C=l.current)==null||C.call(l,y.netMode,x,y))};return f.addEventListener("message",p),()=>{f.removeEventListener("message",p),i.current=null,f.close()}},[t,n]);const c=z.useCallback(f=>{if(!f)return;const p={payload:f,netMode:s.current,source:"local",instanceId:n,timestamp:Date.now()};t&&(t.current=p);const m=i.current;if(m&&typeof m.postMessage=="function")try{m.postMessage({type:"PETRI_NET_CLIPBOARD_UPDATE",payload:f,netMode:p.netMode,instanceId:n,timestamp:p.timestamp})}catch(w){console.warn("Failed to broadcast clipboard payload:",w)}},[t,n]),u=z.useCallback(()=>t==null?void 0:t.current,[t]);return{setClipboard:c,getClipboard:u}}const j5=z.createContext(),w7=({children:t})=>{const[r,i]=z.useState({width:800,height:600}),[s,l]=z.useState({width:1e4,height:7500}),[c,u]=z.useState({x:0,y:0}),[f,p]=z.useState(1),[m,w]=z.useState(!0),y=20,x=z.useRef(null),[C,S]=z.useState(null),_=z.useRef(null),[E,h]=z.useState(!1),[k,T]=z.useState({visible:!1,position:null,elementType:null}),N=z.useRef("select"),M={stageDimensions:r,setStageDimensions:i,virtualCanvasDimensions:s,setVirtualCanvasDimensions:l,canvasScroll:c,setCanvasScroll:u,zoomLevel:f,setZoomLevel:p,gridSnappingEnabled:m,toggleGridSnapping:()=>{w(L=>!L)},gridSize:y,MIN_ZOOM:.1,MAX_ZOOM:3,appRef:x,containerRef:C,setContainerRef:S,stageRef:_,isDragging:E,setIsDragging:h,snapIndicator:k,setSnapIndicator:T,prevModeRef:N};return P.jsx(j5.Provider,{value:M,children:t})},Io=()=>{const t=z.useContext(j5);if(t===void 0)throw new Error("useEditorUI must be used within an EditorUIProvider");return t};function t2(t){if(!(t!=null&&t.valueTokens)||t.valueTokens.length===0)return null;const e=il(t.valueTokens[0]);return t.valueTokens.every(r=>il(r)===e)?e:null}function ml(t,e,n=!0){if(!n)return console.log("[TypeInference] Disabled, returning original state"),t;if(e!=="algebraic-int"||!(t!=null&&t.places)||!(t!=null&&t.arcs)||!(t!=null&&t.transitions))return console.log("[TypeInference] Skipping - netMode:",e,"hasPlaces:",!!(t!=null&&t.places)),t;console.log("[TypeInference] Starting with overwrite=",n);const r={arcs:[],transitions:[]},i=!!n;t.places.forEach(c=>{const u=t2(c);u&&t.arcs.filter(p=>p.source===c.id).forEach(p=>{if(p.bindings&&p.bindings.length>0){const m=[];let w=!1;for(const y of p.bindings){if(!y){m.push(y);continue}const x=new Map,C=y.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(C&&C.forEach(_=>{if(_!=="true"&&_!=="false"&&_!=="and"&&_!=="or"&&_!=="not")if(!y.includes(`${_}:`))x.set(_,u);else{const E=y.match(new RegExp(`${_}:(Int|Bool|Pair|String|List)`,"i"));E&&E[1]&&x.set(_,E[1])}}),u==="List"){const _=Array.isArray(c.valueTokens)?c.valueTokens:[];let E=null;if(_.length>0&&Array.isArray(_[0])&&_[0].length>0){const h=il(_[0][0]);_.every(T=>Array.isArray(T)&&T.every(N=>il(N)===h))&&(E=h)}if(E)for(const[h,k]of Array.from(x.entries()))k==="List"&&x.set(h,E);else x.clear()}const S=x.size>0?Zu(y,x,null,{overwrite:i}):y;S!==y&&(w=!0),m.push(S)}w&&r.arcs.push({arcId:p.id,newBindings:m})}})});const s=t.arcs.map(c=>{const u=r.arcs.find(f=>f.arcId===c.id);return u?u.newBindings?{...c,bindings:[...u.newBindings]}:{...c,bindings:[u.newBinding]}:c});return t.transitions.forEach(c=>{const u=s.filter(m=>m.target===c.id),f=new Map;if(console.log("[TypeInference] Processing transition:",c.id,"inputArcs:",u.length),u.forEach(m=>{m.bindings&&m.bindings.length>0&&m.bindings.forEach(w=>{if(!w)return;console.log("[TypeInference] Input arc binding:",w);const y=w.match(/\b([a-z][a-zA-Z0-9_]*)\:(Int|Bool|Pair|String|List)\b/gi);y&&y.forEach(C=>{const S=C.match(/\b([a-z][a-zA-Z0-9_]*)\:(Int|Bool|Pair|String|List)\b/i);S&&S[1]&&S[2]&&f.set(S[1],S[2])});const x=w.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(console.log("[TypeInference] All variable matches in binding:",x),x){const C=t.places.find(S=>S.id===m.source);if(C){const S=t2(C);S&&x.forEach(_=>{_!=="true"&&_!=="false"&&_!=="and"&&_!=="or"&&_!=="not"&&(f.has(_)||f.set(_,S))})}}})}),console.log("[TypeInference] Extracted variable types for",c.id,":",JSON.stringify(Array.from(f.entries()))),c.guard&&f.size>0){const m=c.guard.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(m){const w=new Map;if(m.forEach(y=>{if(y!=="true"&&y!=="false"&&y!=="and"&&y!=="or"&&y!=="not"){const x=f.get(y);if(!x)return;i?w.set(y,x):new RegExp(`\\b${y}\\s*:(Int|Bool|Pair|String|List)\\b`,"i").test(c.guard)||w.set(y,x)}}),console.log("[TypeInference] Guard type map for",c.id,":",Array.from(w.entries())),w.size>0){const y=Zu(c.guard,w,null,{overwrite:i});console.log("[TypeInference] Guard before:",c.guard),console.log("[TypeInference] Guard after:",y),y!==c.guard&&r.transitions.push({transitionId:c.id,newGuard:y})}}}s.filter(m=>m.source===c.id).forEach(m=>{if(m.bindings&&m.bindings.length>0){const w=[];let y=!1;for(const x of m.bindings){if(!x){w.push(x);continue}const C=new Map,S=x.match(/\b[a-z][a-zA-Z0-9_]*\b/g);S&&S.forEach(E=>{if(E!=="true"&&E!=="false"&&E!=="and"&&E!=="or"&&E!=="not"){const h=f.get(E);if(!h)return;i?C.set(E,h):new RegExp(`\\b${E}\\s*:(Int|Bool|Pair|String|List)\\b`,"i").test(x)||C.set(E,h)}});const _=C.size>0?Zu(x,C,null,{overwrite:i}):x;_!==x&&(y=!0),w.push(_)}y&&r.arcs.push({arcId:m.id,newBindings:w})}})}),r.arcs.length===0&&r.transitions.length===0?t:{...t,arcs:t.arcs.map(c=>{const u=r.arcs.find(f=>f.arcId===c.id);return u?u.newBindings?{...c,bindings:[...u.newBindings]}:{...c,bindings:[u.newBinding]}:c}),transitions:t.transitions.map(c=>{const u=r.transitions.find(f=>f.transitionId===c.id);return u?{...c,guard:u.newGuard}:c})}}const pg=z.createContext(),_7=({children:t})=>{const{gridSnappingEnabled:e,gridSize:n,setCanvasScroll:r,setZoomLevel:i}=Io(),[s,l]=z.useState({places:[],transitions:[],arcs:[]}),[c,u]=z.useState(null),[f,p]=z.useState([]),[m,w]=z.useState("select"),[y,x]=z.useState(null),[C,S]=z.useState(null),[_,E]=z.useState(!1),[h,k]=z.useState({maxIterations:2e5,limitIterations:!1,netMode:"pt",useNonVisualRun:!1,batchMode:!1,showInferredTypes:!1}),[T,N]=z.useState({poolSize:1,idleTimeoutMs:3e5,prewarmOnAlgebraicMode:!0,solverTimeoutMs:1e4}),[I,M]=z.useState(null),L=z.useRef(new e2({places:[],transitions:[],arcs:[]})),[A,R]=z.useState(!1),[j,G]=z.useState(!1),U=z.useRef(m7(oe=>{const xe=L.current.addState(oe);R(xe.canUndo),G(xe.canRedo)},500)),[O,V]=z.useState(!1),$=z.useRef(m),D=z.useRef(null),X=z.useRef(null),H=z.useRef(go()),re=z.useRef(!1),K=(h==null?void 0:h.netMode)||"pt",ne=z.useRef(!!(h!=null&&h.showInferredTypes)),te=z.useRef(null),he=z.useCallback((oe,xe)=>{console.warn(`Shared clipboard net mode mismatch: received ${oe||"unknown"} while editor is ${xe||K}. Copy/paste is disabled until both editors use the same mode.`)},[K]),{setClipboard:de,getClipboard:B}=x7({clipboardRef:X,netMode:K,instanceId:H.current,onIncompatibleClipboard:he}),Q=(oe,xe=!1)=>{if(xe){const ke=L.current.addState(oe);R(ke.canUndo),G(ke.canRedo)}else U.current(oe)},{isContinuousSimulating:J,isRunning:ie,enabledTransitionIds:ce,simulationError:_e,isSimulatorReady:Se,handleFireTransition:Oe,stepSimulation:Ce,startContinuousSimulation:Qe,startRunSimulation:Ve,stopAllSimulations:tt,forceSimulatorReset:ln,completionStats:Gt,dismissCompletionDialog:Vt}=u_(s,l,Q,(h==null?void 0:h.netMode)||"pt",h);z.useEffect(()=>(!O&&$.current===m&&Q(s),$.current=m,()=>U.current.cancel()),[s,O,m]),z.useEffect(()=>{const oe=!!(h!=null&&h.showInferredTypes),xe=ne.current;if(oe!==xe){if(ne.current=oe,oe&&K==="algebraic-int"){l(ke=>(te.current=ke,ml(ke,K,!0)));return}!oe&&te.current&&(l(te.current),te.current=null)}},[h==null?void 0:h.showInferredTypes,K,l]);const Xn=()=>{if(!A)return;ve.debug("Undoing to previous state...");const oe=L.current.undo();oe&&(ve.debug("Undo result:",oe.state),l(oe.state),R(oe.canUndo),G(oe.canRedo),ln())},Kn=()=>{if(!j)return;ve.debug("Redoing to next state...");const oe=L.current.redo();oe&&(ve.debug("Redo result:",oe.state),l(oe.state),R(oe.canUndo),G(oe.canRedo),ln())},Lt=(oe,xe)=>e?{x:Math.round(oe/n)*n,y:Math.round(xe/n)*n}:{x:oe,y:xe},Ar=oe=>{k(oe),E(!1)};z.useEffect(()=>{(async()=>{if(!(typeof window>"u"))try{const{setZ3WorkerConfig:xe}=await Yr(()=>Promise.resolve().then(()=>Ba),void 0,import.meta.url);xe(T)}catch{}})()},[T]);const Ir=()=>{const oe={places:[],transitions:[],arcs:[]};l(oe),u(null),p([]),w("select"),x(null),S(null),k({maxIterations:2e5,limitIterations:!1,netMode:"pt",useNonVisualRun:!1,batchMode:!1,showInferredTypes:!1}),r({x:0,y:0}),i(1),L.current=new e2(oe),R(!1),G(!1),ve.debug("Editor completely reset")},le=(oe,xe)=>oe?f.some(ke=>ke.id===oe&&ke.type===xe):!1,ue=()=>{u(null),p([])},fe=oe=>{if(p(Array.isArray(oe)?oe:[]),Array.isArray(oe)&&oe.length>0){const xe=oe[oe.length-1],ke=xe.type==="place"?s.places.find(ft=>ft.id===xe.id):xe.type==="transition"?s.transitions.find(ft=>ft.id===xe.id):s.arcs.find(ft=>ft.id===xe.id);ke&&u({...ke,type:xe.type})}else u(null)};return P5({elements:s,setElements:l,selectedElement:c,selectedElements:f,clearSelection:ue,setSelection:fe,clipboardRef:X,isShiftPressedRef:re,netMode:K,setClipboard:de,getClipboard:B,onClipboardMismatch:he}),P.jsx(pg.Provider,{value:{elements:s,setElements:l,selectedElement:c,setSelectedElement:u,mode:m,setMode:w,arcStart:y,setArcStart:x,tempArcEnd:C,setTempArcEnd:S,isDragging:O,setIsDragging:V,isContinuousSimulating:J,isRunning:ie,isSimulatorReady:Se,enabledTransitionIds:ce,simulationError:_e,stepSimulation:Ce,handleFireTransition:Oe,startContinuousSimulation:Qe,startRunSimulation:Ve,stopAllSimulations:tt,completionStats:Gt,dismissCompletionDialog:Vt,isSettingsDialogOpen:_,setIsSettingsDialogOpen:E,simulationSettings:h,setSimulationSettings:k,netMode:K,historyManagerRef:L,canUndo:A,setCanUndo:R,canRedo:j,setCanRedo:G,handleUndo:Xn,handleRedo:Kn,updateHistory:Q,snapToGrid:Lt,handleSaveSettings:Ar,z3Settings:T,setZ3Settings:N,resetEditor:Ir,simulatorCore:xi,forceSimulatorReset:ln,selectedElements:f,setSelectedElements:p,isIdSelected:le,clearSelection:ue,setSelection:fe,multiDragRef:D,clipboardRef:X,setClipboard:de,getClipboard:B,onClipboardMismatch:he,instanceId:H.current,isShiftPressedRef:re,saveFileHandle:I,setSaveFileHandle:M},children:t})},sn=()=>{const t=z.useContext(pg);if(t===void 0)throw new Error("usePetriNet must be used within a PetriNetProvider");return t},S7=({mode:t,setMode:e,gridSnappingEnabled:n,onToggleGridSnapping:r,canUndo:i,canRedo:s,onUndo:l,onRedo:c,elements:u,setElements:f,updateHistory:p,simulationSettings:m,setSimulationSettings:w,simulationMode:y,setSimulationMode:x,isSimulating:C,startSimulation:S,stopSimulation:_,clearCanvas:E,onOpenSettings:h,resetEditor:k})=>{const[T,N]=z.useState(!1),[I,M]=z.useState(null),[L,A]=z.useState(null),[R,j]=z.useState(!1),[G,U]=z.useState(!1),{saveFileHandle:O,setSaveFileHandle:V}=(()=>{try{return sn()}catch{return{saveFileHandle:null,setSaveFileHandle:()=>{}}}})(),{handleSave:$,handleSaveAs:D,handleLoad:X,handleClear:H,handleOpenAdtManager:re}=d_({elements:u,setElements:f,updateHistory:p,simulationSettings:m,setSimulationSettings:w,resetEditor:k,setIsLoading:N,setError:M,setSuccess:A,setIsAdtOpen:j,saveFileHandle:O,setSaveFileHandle:V,setIsMobileMenuOpen:U});z.useEffect(()=>{if(!L)return;const J=setTimeout(()=>A(null),5e3);return()=>clearTimeout(J)},[L]);const K=z.useMemo(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(min-width: 1024px)"):null,[]);z.useEffect(()=>{if(!K)return;const J=ie=>{ie.matches&&U(!1)};return K.addEventListener?K.addEventListener("change",J):K.addListener(J),()=>{K.removeEventListener?K.removeEventListener("change",J):K.removeListener(J)}},[K]);const ne=(J="desktop")=>ie=>({padding:"0.375rem 0.5rem",borderRadius:"0.25rem",backgroundColor:ie?"#4338ca":"white",color:ie?"rgba(255, 255, 255, 0.85)":"rgba(31, 41, 55, 0.7)",border:ie?"1px solid #3730a3":"1px solid #d1d5db",borderBottom:ie?"2px solid #312e81":"2px solid #9ca3af",margin:J==="mobile"?"0 0 0.5rem 0":"0 0.125rem",minWidth:J==="mobile"?"100%":"80px",width:J==="mobile"?"100%":"80px",fontSize:"0.75rem",fontWeight:600,cursor:"pointer",transition:"all 0.15s ease-in-out",textAlign:"center",height:"32px",display:"inline-flex",alignItems:"center",justifyContent:"center",boxShadow:ie?"inset 0 1px 0 rgba(255, 255, 255, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1)":"inset 0 1px 0 rgba(255, 255, 255, 0.7), 0 2px 4px rgba(0, 0, 0, 0.1)",position:"relative",top:"0",transform:ie?"translateY(1px)":"translateY(0)",textShadow:ie?"0 -1px 1px rgba(0, 0, 0, 0.5), 0 1px 0 rgba(255, 255, 255, 0.15)":"0 1px 0 rgba(255, 255, 255, 0.5), 0 -1px 0 rgba(0, 0, 0, 0.2)"}),te=z.useMemo(()=>ne("desktop"),[]),he=z.useMemo(()=>ne("mobile"),[]),de=J=>({padding:"0.5rem",marginTop:"0.5rem",borderRadius:"0.25rem",backgroundColor:J?"#fee2e2":"#d1fae5",color:J?"#b91c1c":"#047857",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem"}),B=()=>P.jsxs("div",{className:"hidden lg:flex items-start",children:[P.jsxs("div",{className:"file-operations p-2",children:[P.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"File"}),P.jsx(Ay,{isLoading:T,onSave:$,onSaveAs:D,canSaveAs:!!O,onLoad:X,onClear:H,buttonStyle:te})]}),P.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),P.jsxs("div",{className:"editing-tools p-2",children:[P.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"Editing"}),P.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[P.jsxs("div",{className:"flex items-center mr-4",children:[P.jsx("input",{type:"checkbox",id:"grid-snap-toggle","data-testid":"grid-snap-toggle",checked:n,onChange:r,className:"mr-1"}),P.jsx("label",{htmlFor:"grid-snap-toggle",className:"text-xs text-gray-700",children:"Snap to Grid"})]}),P.jsx(gw,{mode:t,setMode:e,buttonStyle:te})]})]}),P.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),P.jsxs("div",{className:"adt-tools p-2",children:[P.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"ADT Manager"}),P.jsx("div",{className:"flex justify-between",children:P.jsx("button",{style:te(!1),onClick:re,title:"Open ADT Manager","data-testid":"toolbar-adt-manager",children:"ADT"})})]}),P.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),P.jsxs("div",{className:"history-tools p-2",children:[P.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"History"}),P.jsx(mw,{canUndo:i,canRedo:s,onUndo:l,onRedo:c,buttonStyle:te})]}),P.jsx("div",{className:"h-full",style:{borderRight:"1px solid rgba(180, 180, 190, 0.9)",borderLeft:"1px solid rgba(255, 255, 255, 0.9)",margin:"0 12px",height:"50px",alignSelf:"center",opacity:.85}}),P.jsxs("div",{className:"settings-tools p-2 ml-auto",children:[P.jsx("h3",{className:"text-xs font-semibold text-gray-600 mb-1 uppercase tracking-wider",children:"Settings"}),P.jsx(Iy,{onOpenSettings:h,buttonStyle:te})]})]}),Q=()=>P.jsxs("div",{className:"flex flex-col space-y-6",children:[P.jsxs("div",{className:"file-operations",children:[P.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"File"}),P.jsx(Ay,{isLoading:T,onSave:$,onSaveAs:D,canSaveAs:!!O,onLoad:X,onClear:H,buttonStyle:he})]}),P.jsxs("div",{className:"editing-tools",children:[P.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"Editing"}),P.jsxs("div",{className:"flex items-center",children:[P.jsx("input",{type:"checkbox",id:"grid-snap-toggle-mobile","data-testid":"grid-snap-toggle-mobile",checked:n,onChange:r,className:"mr-2"}),P.jsx("label",{htmlFor:"grid-snap-toggle-mobile",className:"text-sm text-gray-700",children:"Snap to Grid"})]})]}),P.jsxs("div",{className:"adt-tools",children:[P.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"ADT Manager"}),P.jsx("button",{style:he(!1),onClick:()=>{U(!1),re()},title:"Open ADT Manager","data-testid":"toolbar-adt-manager-mobile",children:"ADT"})]}),P.jsxs("div",{className:"settings-tools",children:[P.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:"Settings"}),P.jsx(Iy,{onOpenSettings:()=>{U(!1),h()},buttonStyle:he})]})]});return P.jsxs("div",{className:"toolbar-container flex flex-col p-2 bg-gray-50 border-b border-gray-200 shadow-sm",style:{minHeight:"70px"},children:[P.jsx("div",{className:"hidden lg:block",children:B()}),P.jsxs("div",{className:"lg:hidden flex items-center gap-3 px-2 py-1",children:[P.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 rounded-md border border-gray-200 shadow-sm bg-white font-semibold text-gray-700",onClick:()=>U(!0),"aria-label":"Open toolbar menu",children:[P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),P.jsx("span",{children:"Menu"})]}),P.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[P.jsx("button",{type:"button",className:`p-2 rounded-md border border-gray-200 shadow-sm bg-white text-gray-700 transition-all ${i?"hover:bg-gray-50 active:scale-95":"opacity-50 cursor-not-allowed"}`,onClick:l,disabled:!i,title:"Undo","aria-label":"Undo",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})})}),P.jsx("button",{type:"button",className:`p-2 rounded-md border border-gray-200 shadow-sm bg-white text-gray-700 transition-all ${s?"hover:bg-gray-50 active:scale-95":"opacity-50 cursor-not-allowed"}`,onClick:c,disabled:!s,title:"Redo","aria-label":"Redo",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 15l6-6m0 0l-6-6m6 6H9a6 6 0 000 12h3"})})})]})]}),R&&P.jsx(Iw,{isOpen:R,onClose:()=>j(!1)}),I&&P.jsxs("div",{style:de(!0),children:[I,P.jsx("button",{onClick:()=>M(null),style:{marginLeft:"0.5rem"},children:""})]}),L&&P.jsxs("div",{style:de(!1),children:[L,P.jsx("button",{onClick:()=>A(null),style:{marginLeft:"0.5rem"},children:""})]}),P.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 pointer-events-none",children:[P.jsx("div",{className:`absolute inset-0 bg-black transition-opacity duration-300 ease-in-out ${G?"opacity-40 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>U(!1)}),P.jsx("div",{className:`fixed w-80 left-0 top-16 bottom-0 z-50 bg-white shadow-2xl overflow-y-auto transform transition-transform duration-300 ease-in-out ${G?"translate-x-0":"-translate-x-full"} pointer-events-auto`,onWheel:J=>J.stopPropagation(),children:P.jsxs("div",{className:"p-5",children:[P.jsx("div",{className:"mb-4",children:P.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Menu"})}),Q()]})})]})]})},k7=({mode:t,tokens:e,valueTokensInput:n,onTokensChange:r,onValueTokensChange:i,onValueTokensBlur:s})=>t==="pt"?P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tokens (PT mode)"}),P.jsx("input",{type:"number",min:"0",value:e,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}):t==="algebraic-int"?P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Algebraic Tokens"}),P.jsx("input",{type:"text",value:n,onChange:i,onBlur:s,className:"w-full px-3 py-2 border border-gray-300 rounded-md font-mono text-sm",placeholder:"e.g., 2, 3, 'hello', T, F, (1, 2), [1, 2, 3]"})]}):null,C7=({mode:t,weight:e,bindingsInput:n,bindingError:r,onWeightChange:i,onBindingsChange:s,onBindingsBlur:l})=>t==="pt"?P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),P.jsx("input",{type:"number",min:"1",value:e,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}):t==="algebraic-int"?P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bindings"}),P.jsx("input",{type:"text",value:n,onChange:s,onBlur:l,className:`w-full px-3 py-2 border rounded-md font-mono text-sm ${r?"border-red-500":"border-gray-300"}`,placeholder:"e.g., x, y, (a, b)"}),r&&P.jsx("p",{className:"text-red-600 text-xs mt-1",children:r})]}):null,T7=({guardText:t,guardError:e,onGuardChange:n,onGuardBlur:r})=>P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Guard"}),P.jsx("input",{type:"text",value:t,onChange:n,onBlur:r,className:`w-full px-3 py-2 border rounded-md font-mono text-sm ${e?"border-red-500":"border-gray-300"}`,placeholder:"e.g., x > 0 and y < 10"}),e&&P.jsx("p",{className:"text-red-600 text-xs mt-1",children:e})]});function E7(){const t=z.useCallback(r=>{const i=[];let s="",l=0,c=0,u=!1;for(let p=0;p<r.length;p++){const m=r[p];if(u){s+=m,m==="'"&&r[p-1]!=="\\"&&(u=!1);continue}if(m==="'"){u=!0,s+=m;continue}if(m==="("){l++,s+=m;continue}if(m===")"){l=Math.max(0,l-1),s+=m;continue}if(m==="["){c++,s+=m;continue}if(m==="]"){c=Math.max(0,c-1),s+=m;continue}if(m===","&&l===0&&c===0){i.push(s.trim()),s="";continue}s+=m}const f=s.trim();return f.length>0&&i.push(f),i},[]),e=z.useCallback(r=>{const i=String(r||"").trim(),s=i.toLowerCase();if(i==="T"||s==="true")return!0;if(i==="F"||s==="false")return!1;if(/^[+-]?\d+$/.test(i))return parseInt(i,10);if(i.startsWith("'")&&i.endsWith("'"))return i.slice(1,-1);if(i.startsWith("[")&&i.endsWith("]")){const l=i.slice(1,-1).trim();return l?t(l).map(e):[]}if(i.startsWith("(")&&i.endsWith(")")){const l=i.slice(1,-1).trim();let c=0,u=-1;for(let f=0;f<l.length;f++){const p=l[f];if(p==="(")c++;else if(p===")")c=Math.max(0,c-1);else if(p===","&&c===0){u=f;break}}if(u>=0)return{__pair__:!0,fst:e(l.slice(0,u)),snd:e(l.slice(u+1))}}return null},[t]);return{parseValueTokensInput:z.useCallback(r=>{const i=String(r||"").trim();return i?t(i).map(e).filter(s=>s!==null):[]},[t,e]),splitTopLevelCommas:t}}function b7(){const t=z.useCallback(n=>{const r=[];let i="",s=0,l=0;for(let c=0;c<n.length;c++){const u=n[c];if(u==="(")s++;else if(u===")")s=Math.max(0,s-1);else if(u==="[")l++;else if(u==="]")l=Math.max(0,l-1);else if(u===","&&s===0&&l===0){r.push(i.trim()),i="";continue}i+=u}return i.trim()&&r.push(i.trim()),r.filter(Boolean)},[]),e=z.useCallback(n=>{const r=t(String(n||""));for(const i of r){try{d5(i);continue}catch{}try{zt(i);continue}catch{}try{ko(i,zt);continue}catch{}return{ok:!1,error:`Invalid binding: ${i}`}}return{ok:!0,bindings:r}},[t]);return{splitTopLevel:t,validateBindings:e}}const N7=({getElementInfo:t,setElements:e,updateHistory:n,setFormValues:r})=>z.useCallback(i=>{const s=i.target.value;r(u=>({...u,label:s}));const{elementId:l,elementType:c}=t();c==="place"?e(u=>({...u,places:u.places.map(f=>f.id===l?{...f,label:s}:f)})):c==="transition"?e(u=>({...u,transitions:u.transitions.map(f=>f.id===l?{...f,label:s}:f)})):c==="arc"&&e(u=>({...u,arcs:u.arcs.map(f=>f.id===l?{...f,label:s}:f)})),n()},[t,e,n,r]),P7=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,parseValueTokensInput:l,showInferredTypes:c})=>{const u=z.useCallback(m=>{let w=parseInt(m.target.value,10);Number.isFinite(w)||(w=0),w<0&&(w=0),e(x=>({...x,tokens:w}));const{elementId:y}=n();r(x=>({...x,places:x.places.map(C=>C.id===y?{...C,tokens:w}:C)})),i()},[n,r,i,e]),f=z.useCallback(()=>{const m=t.valueTokensInput.trim(),{elementId:w}=n();if(!m){r(x=>({...x,places:x.places.map(C=>C.id===w?{...C,valueTokens:[],tokens:0}:C)})),i();return}const y=l(m);r(x=>{const C={...x,places:x.places.map(S=>S.id===w?{...S,valueTokens:y,tokens:y.length}:S)};return ml(C,s,c)}),i()},[t.valueTokensInput,n,s,l,r,i,c]),p=z.useCallback(m=>Array.isArray(m.valueTokens)?p5(m.valueTokens):"",[]);return{handleTokensChange:u,handleValueTokensBlur:f,serializeTokensFromElement:p}},M7=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,validateBindings:l,showInferredTypes:c})=>{const u=z.useCallback(m=>{const w=parseInt(m.target.value,10)||1;e(x=>({...x,weight:w}));const{elementId:y}=n();r(x=>({...x,arcs:x.arcs.map(C=>C.id===y?{...C,weight:w}:C)})),i()},[n,r,i,e]),f=z.useCallback(()=>{const m=t.bindingsInput.trim();e(S=>({...S,bindingError:null}));const{elementId:w}=n();if(!m){r(S=>({...S,arcs:S.arcs.map(_=>_.id===w?{..._,bindings:[]}:_)})),i();return}const{ok:y,bindings:x,error:C}=l(m);if(!y){e(S=>({...S,bindingError:C}));return}r(S=>({...S,arcs:S.arcs.map(_=>_.id===w?{..._,bindings:x}:_)})),i(),r(S=>{const _={...S,arcs:S.arcs.map(E=>E.id===w?{...E,bindings:x}:E)};return ml(_,s,c)}),i()},[t.bindingsInput,n,s,r,e,i,l,c]),p=z.useCallback((m,w)=>m!=="arc"||!Array.isArray(w.bindings)?"":w.bindings.map(y=>{const x=String(y||"");return/^true$/i.test(x)?"T":/^false$/i.test(x)?"F":f5(x)}).join(", "),[]);return{handleWeightChange:u,handleBindingsBlur:f,serializeBindingsFromElement:p}},A7=({formValues:t,setFormValues:e,getElementInfo:n,setElements:r,updateHistory:i,netMode:s,showInferredTypes:l})=>({handleGuardBlur:z.useCallback(()=>{const u=t.guardText.trim();e(p=>({...p,guardError:null}));const{elementId:f}=n();if(!u){r(p=>({...p,transitions:p.transitions.map(m=>m.id===f?{...m,guard:""}:m)})),i();return}try{ko(u,zt),r(p=>({...p,transitions:p.transitions.map(m=>m.id===f?{...m,guard:u}:m)})),i(),r(p=>{const m={...p,transitions:p.transitions.map(w=>w.id===f?{...w,guard:u}:w)};return ml(m,s,l)}),i()}catch(p){e(m=>({...m,guardError:`Invalid guard: ${p.message}`}))}},[t.guardText,n,s,r,e,i,l])}),I7=({elements:t,netMode:e,setElements:n,updateHistory:r,showInferredTypes:i})=>{const s=i??!0,l=z.useCallback(u=>{if(!s||!(t!=null&&t.places)||!(t!=null&&t.arcs)||e!=="algebraic-int")return;const f=t.places.find(y=>y.id===u);if(!f||!f.valueTokens||f.valueTokens.length===0)return;const p=il(f.valueTokens[f.valueTokens.length-1]),w=t.arcs.filter(y=>y.source===u).reduce((y,x)=>{if(!Array.isArray(x.bindings)||x.bindings.length===0)return y;const C=x.bindings[0];if(!C||!s&&C.includes(":"))return y;const S=C.match(/\b[a-z][a-zA-Z0-9_]*\b/g);if(!S)return y;const _=new Map;if(S.forEach(h=>{["true","false","and","or","not"].includes(h)||_.set(h,p)}),_.size===0)return y;const E=Zu(C,_,null,{overwrite:s});return E!==C&&y.push({arcId:x.id,newBinding:E}),y},[]);w.length!==0&&(n(y=>({...y,arcs:y.arcs.map(x=>{const C=w.find(S=>S.arcId===x.id);return C?{...x,bindings:[C.newBinding]}:x})})),r())},[t,e,n,r,s]),c=z.useCallback(()=>{if(!s)return;const u=ml(t,e,s);u!==t&&(n(u),r())},[t,e,n,r,s]);return{inferTypesForPlace:l,performGlobalTypeInference:c}};function R7({selectedElement:t,elements:e,setElements:n,updateHistory:r,netMode:i,showInferredTypes:s=!0}){const[l,c]=z.useState({label:"",tokens:0,weight:1,valueTokensInput:"",bindingsInput:"",bindingError:null,guardText:"",guardError:null}),{parseValueTokensInput:u}=E7(),{validateBindings:f}=b7(),p=z.useCallback(()=>{if(!t)return{elementId:"",elementType:""};const T=t.id||t.element&&t.element.id||"",N=t.type||T.split("-")[0];return{elementId:T,elementType:N}},[t]),{handleTokensChange:m,handleValueTokensBlur:w,serializeTokensFromElement:y}=P7({formValues:l,setFormValues:c,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,parseValueTokensInput:u,showInferredTypes:s}),{handleWeightChange:x,handleBindingsBlur:C,serializeBindingsFromElement:S}=M7({formValues:l,setFormValues:c,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,validateBindings:f,showInferredTypes:s}),{handleGuardBlur:_}=A7({formValues:l,setFormValues:c,getElementInfo:p,setElements:n,updateHistory:r,netMode:i,showInferredTypes:s}),E=N7({getElementInfo:p,setElements:n,updateHistory:r,setFormValues:c}),{inferTypesForPlace:h,performGlobalTypeInference:k}=I7({elements:e,netMode:i,setElements:n,updateHistory:r,showInferredTypes:s});return z.useEffect(()=>{if(!t)return;const{elementType:T}=p(),N=T==="transition"?String(t.guard||"").replace(/\btrue\b/gi,"T").replace(/\bfalse\b/gi,"F"):"";c(I=>({...I,label:t.label||"",tokens:t.tokens||0,weight:t.weight!==void 0?t.weight:1,valueTokensInput:y(t),bindingsInput:S(T,t),guardText:N}))},[t,p,y,S,c]),{formValues:l,setFormValues:c,handleLabelChange:E,handleTokensChange:m,handleWeightChange:x,handleValueTokensBlur:w,handleBindingsBlur:C,handleGuardBlur:_,inferTypesForPlace:h,performGlobalTypeInference:k,getElementInfo:p}}const L7=({selectedElement:t,elements:e,setElements:n,updateHistory:r,simulationSettings:i})=>{const s=z.useContext(pg)||{};s.enabledTransitionIds,s.isSimulatorReady;const l=(i==null?void 0:i.netMode)||"pt",c=!!(i!=null&&i.showInferredTypes),{formValues:u,setFormValues:f,handleLabelChange:p,handleTokensChange:m,handleWeightChange:w,handleValueTokensBlur:y,handleBindingsBlur:x,handleGuardBlur:C,getElementInfo:S}=R7({selectedElement:t,elements:e,setElements:n,updateHistory:r,netMode:l,showInferredTypes:c});if(!t)return null;const{elementType:_}=S();return P.jsxs("div",{className:"properties-panel w-full px-4 py-2 overflow-y-auto mx-0",children:[P.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Properties"}),P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),P.jsx("input",{type:"text",value:u.label,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"P1, P2, etc."})]}),t&&_==="place"&&P.jsx(k7,{mode:l,tokens:u.tokens,valueTokensInput:u.valueTokensInput,onTokensChange:m,onValueTokensChange:E=>f(h=>({...h,valueTokensInput:E.target.value})),onValueTokensBlur:y}),t&&_==="arc"&&P.jsx(C7,{mode:l,weight:u.weight,bindingsInput:u.bindingsInput,bindingError:u.bindingError,onWeightChange:w,onBindingsChange:E=>f(h=>({...h,bindingsInput:E.target.value})),onBindingsBlur:x}),t&&_==="transition"&&l==="algebraic-int"&&P.jsx(T7,{guardText:u.guardText,guardError:u.guardError,onGuardChange:E=>f(h=>({...h,guardText:E.target.value})),onGuardBlur:C})]})},F7=({enabledTransitions:t,isLoading:e,isOpen:n,onClose:r,onFire:i})=>n?P.jsxs("div",{"data-testid":"enabled-transitions",className:"enabled-transitions-panel mt-4 p-4 bg-gray-50 border border-gray-200 rounded-md",children:[P.jsxs("div",{className:"flex justify-between items-center mb-3",children:[P.jsx("h3",{className:"text-md font-semibold",children:"Enabled Transitions"}),P.jsx("span",{onClick:r,role:"button",tabIndex:0,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),r&&r())},className:"text-gray-500 hover:text-gray-800 cursor-pointer select-none","aria-label":"Close enabled transitions panel",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e?P.jsx("p",{className:"text-gray-500",children:"Loading..."}):t.length===0?P.jsx("p",{className:"text-gray-500",children:"No enabled transitions"}):P.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto pr-1",children:t.map(s=>P.jsx("button",{type:"button",className:"flex items-center text-left hover:bg-gray-100 rounded px-1 py-0.5",onClick:()=>i&&i(s.id),"data-testid":`enabled-${s.label||s.id}`,title:s.label||s.id,children:P.jsx("span",{className:"font-medium",children:s.label||s.id.substring(11,17)})},s.id))})]}):null,j7=({elements:t,enabledTransitionIds:e})=>{const{handleFireTransition:n,netMode:r}=sn(),[i,s]=z.useState(!1),[l,c]=z.useState(!1);return P.jsxs("div",{className:"pt-4 mt-4 px-4",children:[P.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Petri Net"}),P.jsxs("div",{className:"mb-4 pl-1",children:[P.jsxs("div",{className:"flex justify-between items-center mb-2",children:[P.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Current Markings"}),P.jsxs("button",{"data-testid":"toggle-markings",className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm flex items-center space-x-1 transition-colors",onClick:()=>s(!i),children:[P.jsx("span",{children:i?"Hide":"Show"}),P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})]})]}),i&&P.jsx("div",{"data-testid":"current-marking",className:"markings-panel p-3 bg-gray-50 border border-gray-200 rounded-md",children:(t.places||[]).length===0?P.jsx("p",{className:"text-gray-500 text-sm",children:"No places defined"}):P.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-64 overflow-y-auto pr-1",children:(t.places||[]).filter(u=>r==="algebraic-int"?(Array.isArray(u.valueTokens)?u.valueTokens:[]).length>0:!0).map(u=>{const f=u.label||u.name||u.id.substring(6,12),p=u.tokens||0,m=Array.isArray(u.valueTokens)?u.valueTokens:[],w=r==="algebraic-int"&&Array.isArray(u.valueTokens),y=w?p5(m):"";return P.jsxs("div",{className:"flex items-start text-sm",children:[P.jsx("span",{className:"font-medium text-gray-800 mr-2 truncate",title:f,children:f}),w?P.jsx("div",{className:"flex-1 text-gray-800 bg-purple-50 border border-purple-200 rounded px-2 py-1 whitespace-pre-wrap break-words overflow-visible",title:y,children:y||"[]"}):P.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-purple-100 text-purple-800 border border-purple-200 font-semibold min-w-[2rem] justify-center",children:p})]},u.id)})})})]}),P.jsxs("div",{className:"mb-2 pl-1",children:[P.jsxs("div",{className:"flex justify-between items-center mb-2",children:[P.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Enabled Transitions"}),P.jsxs("button",{"data-testid":"show-enabled-transitions",className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm flex items-center space-x-1 transition-colors",onClick:()=>c(!l),children:[P.jsx("span",{children:l?"Hide":"Show"}),P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})]})]}),l&&P.jsx(F7,{isOpen:!0,enabledTransitions:(e||[]).map(u=>{const f=(t.transitions||[]).find(p=>p.id===u);return{id:u,label:f&&(f.label||f.name)||u}}),isLoading:!1,onClose:()=>c(!1),onFire:u=>n&&n(u)})]})]})};const n2=({stats:t,onDismiss:e})=>{if(!t)return null;const n=r=>{if(r<1e3)return`${r}ms`;const i=Math.floor(r/1e3),s=Math.floor(i/60),l=i%60;return s>0?`${s}m ${l}s`:`${i}s`};return P.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:P.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md mx-4",children:[P.jsxs("div",{className:"flex items-center mb-4",children:[P.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3",children:P.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),P.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Simulation Complete"})]}),P.jsxs("div",{className:"space-y-3 mb-6",children:[P.jsxs("div",{className:"flex justify-between items-center",children:[P.jsx("span",{className:"text-gray-600",children:"Duration:"}),P.jsx("span",{className:"font-medium text-gray-900",children:n(t.elapsedMs)})]}),P.jsxs("div",{className:"flex justify-between items-center",children:[P.jsx("span",{className:"text-gray-600",children:"Transitions Fired:"}),P.jsx("span",{className:"font-medium text-gray-900",children:t.transitionsFired})]})]}),P.jsx("div",{className:"flex justify-end",children:P.jsx("button",{onClick:e,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"OK"})})]})})},r2=({isMobile:t=!1})=>{const{isContinuousSimulating:e,isRunning:n,enabledTransitionIds:r,simulationError:i,isSimulatorReady:s,stepSimulation:l,startContinuousSimulation:c,startRunSimulation:u,stopAllSimulations:f,completionStats:p,dismissCompletionDialog:m}=sn(),[w,y]=z.useState(!1),[x,C]=z.useState(!1),S=e||n,_=s&&r.length>0,E=_?"opacity-100":"opacity-50";z.useEffect(()=>{S&&y(!0)},[S]);const h=()=>{C(!0),setTimeout(()=>{y(!1),C(!1)},200)},k=()=>{C(!1),y(!0)};if(t){const T=i&&P.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-full mb-2 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg text-xs whitespace-nowrap z-50",children:i}),N=({onClick:I,className:M=""})=>P.jsx("button",{onClick:I,className:`flex flex-col items-center justify-center cursor-pointer transition-all hover:opacity-70 py-1 ${M}`,title:"Tap to expand/collapse",children:P.jsxs("div",{className:"flex flex-col gap-0.5",children:[P.jsx("div",{className:"w-6 h-0.5 bg-gray-400 rounded-full"}),P.jsx("div",{className:"w-6 h-0.5 bg-gray-400 rounded-full"}),P.jsx("div",{className:"w-6 h-0.5 bg-gray-400 rounded-full"})]})});return P.jsxs(P.Fragment,{children:[P.jsxs("div",{"data-testid":"simulation-manager-mobile",className:`fixed bottom-4 left-1/2 transform -translate-x-1/2 z-40 transition-all duration-200 ease-out ${E}`,children:[T,!w&&!x&&P.jsx("div",{className:`bg-white/95 backdrop-blur-md rounded-full px-3 py-1.5 shadow-2xl border border-gray-200/50 flex items-center justify-center transition-all duration-200 ease-out ${_?"":"opacity-60"}`,children:P.jsx(N,{onClick:k})}),(w||x)&&S&&P.jsxs("div",{className:`bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-gray-200/50 flex flex-col items-center ${w&&!x?"animate-slide-up":x?"animate-slide-down":""}`,children:[P.jsx("div",{className:"w-full flex justify-center pt-1.5 pb-0.5",children:P.jsx(N,{onClick:h})}),P.jsxs("div",{className:"flex items-center gap-3 px-4 pb-2",children:[n&&P.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[P.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full sim-pulse-strong"}),P.jsx("span",{className:"text-xs font-medium",children:"Running"})]}),P.jsx("button",{"data-testid":"sim-stop-mobile",className:"bg-red-600 text-white rounded-full p-3 hover:bg-red-700 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!0}catch{}f()},disabled:!S,title:"Stop simulation",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:P.jsx("rect",{x:"7",y:"7",width:"10",height:"10"})})})]})]}),(w||x)&&!S&&P.jsxs("div",{className:`bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-gray-200/50 flex flex-col items-center ${w&&!x?"animate-slide-up":x?"animate-slide-down":""} ${_?"":"opacity-60"}`,children:[P.jsx("div",{className:"w-full flex justify-center pt-1.5 pb-0.5",children:P.jsx(N,{onClick:h})}),P.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2",children:[P.jsx("button",{"data-testid":"sim-step-mobile",className:"bg-blue-600 text-white rounded-full p-3 hover:bg-blue-700 disabled:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md",onClick:l,disabled:!s||r.length===0,title:"Step forward",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})})}),P.jsx("button",{"data-testid":"sim-simulate-mobile",className:"bg-green-600 text-white rounded-full p-3 hover:bg-green-700 disabled:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md",onClick:c,disabled:!s||r.length===0,title:"Simulate with animation",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:P.jsx("path",{fillRule:"evenodd",d:"M10 18V6l8 6-8 6z",clipRule:"evenodd"})})}),P.jsx("button",{"data-testid":"sim-run-mobile",className:"bg-yellow-600 text-white rounded-full p-3 hover:bg-yellow-700 disabled:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md",onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!1}catch{}u()},disabled:!s||r.length===0,title:"Run to completion",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 5l7 7-7 7"})})})]})]})]}),P.jsx(n2,{stats:p,onDismiss:m})]})}return P.jsxs("div",{"data-testid":"simulation-manager",className:"simulation-manager w-full px-4 py-2 mx-0",children:[P.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Simulation"}),i&&P.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded mb-4",children:i}),P.jsxs("div",{className:"bg-gray-200 p-3 rounded-lg shadow-lg border border-gray-300",children:[P.jsxs("div",{className:"flex items-center justify-between space-x-3 mb-3",children:[P.jsxs("button",{"data-testid":"sim-step",className:"flex-1 h-12 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:l,disabled:!s||S||r.length===0,title:"Execute one step forward",children:[P.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),P.jsx("span",{className:"text-xs font-bold",children:"Step"})]}),P.jsxs("button",{"data-testid":"sim-simulate",className:"flex-1 h-12 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:c,disabled:!s||S||r.length===0,title:"Simulate with animation",children:[P.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:P.jsx("path",{fillRule:"evenodd",d:"M10 18V6l8 6-8 6z",clipRule:"evenodd"})})}),P.jsx("span",{className:"text-xs font-bold",children:"Simulate"})]}),P.jsxs("button",{"data-testid":"sim-run",className:"flex-1 h-12 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400 flex flex-col items-center justify-center transition-all shadow-md",onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!1}catch{}u()},disabled:!s||S||r.length===0,title:"Run to completion",children:[P.jsx("div",{style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7"})})}),P.jsx("span",{className:"text-xs font-bold",children:"Run"})]})]}),P.jsx("div",{children:P.jsxs("button",{"data-testid":"sim-stop",className:"w-full h-10 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 flex items-center justify-center space-x-2 transition-all shadow-md",onClick:()=>{try{window.__PETRI_NET_CANCEL_RUN__=!0}catch{}f()},disabled:!S,title:"Stop simulation or run",children:[P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:P.jsx("rect",{x:"7",y:"7",width:"10",height:"10"})}),P.jsx("span",{className:"text-sm font-bold",children:"STOP"})]})}),n&&P.jsx("div",{className:"mt-2 flex items-center justify-center",children:P.jsxs("span",{className:"inline-flex items-center space-x-1 text-green-600",children:[P.jsx("span",{className:"w-4 h-4 bg-green-500 rounded-full sim-pulse-strong"}),P.jsx("span",{className:"font-medium text-sm",children:"Simulation running..."})]})})]}),P.jsx(n2,{stats:p,onDismiss:m})]})},O7=({isOpen:t,onClose:e})=>{const{z3Settings:n,setZ3Settings:r}=sn(),[i,s]=z.useState(0),[l,c]=z.useState(3e5),[u,f]=z.useState(!0),[p,m]=z.useState(1e4);z.useEffect(()=>{t&&(s(Number((n==null?void 0:n.poolSize)??0)),c(Number((n==null?void 0:n.idleTimeoutMs)??3e5)),f(!!((n==null?void 0:n.prewarmOnAlgebraicMode)??!0)),m(Number((n==null?void 0:n.solverTimeoutMs)??1e4)))},[t,n]);const w=()=>{const y={poolSize:Math.max(0,Number(i)||0),idleTimeoutMs:Math.max(1e3,Number(l)||3e5),prewarmOnAlgebraicMode:!!u,solverTimeoutMs:Math.max(100,Number(p)||1e4)};try{typeof window<"u"&&Yr(()=>Promise.resolve().then(()=>Ba),void 0,import.meta.url).then(x=>x.setZ3WorkerConfig(y)).catch(()=>{})}catch{}try{r(y)}catch{}e==null||e()};return t?P.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:P.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-md mx-4",children:[P.jsxs("div",{className:"flex justify-between items-center mb-4",children:[P.jsx("h2",{className:"text-xl font-semibold",children:"Z3 Settings"}),P.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:""})]}),P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Worker Pool"}),P.jsx("div",{className:"space-y-3",children:P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsx("div",{className:"text-sm",children:"Pool size (0 = on-demand)"}),P.jsx("input",{type:"number",min:0,max:8,value:i,onChange:y=>s(y.target.value),className:"w-24 border rounded px-2 py-1 text-sm"})]})})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lifecycle"}),P.jsxs("div",{className:"space-y-3",children:[P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsx("div",{className:"text-sm",children:"idleTimeoutMs"}),P.jsx("input",{type:"number",min:1e3,max:36e5,step:1e3,value:l,onChange:y=>c(y.target.value),className:"w-28 border rounded px-2 py-1 text-sm"})]}),P.jsxs("label",{className:"flex items-center text-sm",children:[P.jsx("input",{type:"checkbox",checked:u,onChange:y=>f(y.target.checked),className:"mr-2"}),"Pre-warm when switching to Algebraic mode"]}),P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsx("div",{className:"text-sm",children:"Solver timeout (ms)"}),P.jsx("input",{type:"number",min:100,max:6e4,step:100,value:p,onChange:y=>m(y.target.value),className:"w-28 border rounded px-2 py-1 text-sm"})]})]})]}),P.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded p-3",children:[P.jsx("h3",{className:"text-sm font-medium text-purple-800 mb-1",children:"Notes"}),P.jsxs("ul",{className:"text-xs text-purple-700 space-y-1",children:[P.jsx("li",{children:" Pool size 0 keeps workers off until a batch run forces 8 workers"}),P.jsx("li",{children:" Idle timeout trims the pool back to the configured size after bursts"}),P.jsx("li",{children:" Pre-warm hides first-use latency when switching to algebraic-int"}),P.jsx("li",{children:" Solver timeout applies to boolean predicate checks (headless runs benefit from a shorter timeout)"})]})]})]}),P.jsxs("div",{className:"mt-6 flex justify-end",children:[P.jsx("button",{onClick:e,className:"px-3 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors mr-2",children:"Cancel"}),P.jsx("button",{onClick:w,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"Save"})]})]})}):null},ya=2e5,D7=({isOpen:t,onClose:e})=>{const{simulatorCore:n,simulationSettings:r,handleSaveSettings:i,elements:s,z3Settings:l,setZ3Settings:c}=sn(),[u,f]=z.useState("single"),[p,m]=z.useState(!1),[w,y]=z.useState(ya),[x,C]=z.useState(!1),[S,_]=z.useState("pt"),[E,h]=z.useState(!1),[k,T]=z.useState(!1),[N,I]=z.useState(!1),[M,L]=z.useState(!1),[A,R]=z.useState(!1);z.useEffect(()=>{var U,O,V;if(t){try{if(n){const ne=n.getSimulationMode?n.getSimulationMode():"single";f(ne)}}catch(ne){ve.warn("Could not get current simulation mode:",ne)}const $=Number((r==null?void 0:r.maxIterations)??ya),D=!!(r!=null&&r.limitIterations);C(D);const X=Number.isFinite($)&&$>0?Math.max(1,Math.min(1e6,Math.floor($))):ya;y(X);const H=(r==null?void 0:r.netMode)||"pt";_(H);const re=!!(r!=null&&r.batchMode);L(re);const K=!!(re||r!=null&&r.useNonVisualRun);I(K),R(!!(r!=null&&r.showInferredTypes)),re&&u!=="maximal"&&j("maximal");try{const ne=(((U=s==null?void 0:s.places)==null?void 0:U.length)||0)>0||(((O=s==null?void 0:s.transitions)==null?void 0:O.length)||0)>0||(((V=s==null?void 0:s.arcs)==null?void 0:V.length)||0)>0;h(!!ne)}catch{h(!1)}}},[t,n,r]);const j=async U=>{if(!n||!n.setSimulationMode){f(U);return}m(!0);try{await n.setSimulationMode(U),f(U),ve.info("Simulation mode changed to:",U)}catch(O){ve.error("Failed to change simulation mode:",O),f(u)}finally{m(!1)}},G=()=>{const U=!!x,O=Math.max(1,Math.min(1e6,Math.floor(Number(w)||ya)));i({...r,maxIterations:U?O:ya,limitIterations:U,netMode:S,useNonVisualRun:M?!0:N,batchMode:M,showInferredTypes:A}),e==null||e()};return t?P.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[P.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-w-md mx-4 max-h-[90vh] flex flex-col",children:[P.jsxs("div",{className:"flex justify-between items-center mb-4",children:[P.jsx("h2",{className:"text-xl font-semibold",children:"Simulation Settings"}),P.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold","data-testid":"settings-close",children:""})]}),P.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 pr-2",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limits"}),P.jsxs("div",{className:"space-y-3",children:[P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsx("div",{className:"text-sm",children:"Max iterations"}),P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("input",{type:"number",min:1,max:1e6,value:w,onChange:U=>y(U.target.value),disabled:!x,className:"w-24 border rounded px-2 py-1 text-sm disabled:bg-gray-100"}),P.jsxs("label",{className:"flex items-center text-sm",children:[P.jsx("input",{type:"checkbox",checked:x,onChange:U=>{const O=U.target.checked;C(O),O&&(!Number.isFinite(Number(w))||Number(w)<=0)&&y(100)},className:"mr-1"}),"Limit iterations"]})]})]}),!x&&P.jsx("div",{className:"text-xs text-gray-600",children:"Default runs allow up to 200,000 steps when this option is unchecked."})]})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Run Options"}),P.jsxs("label",{className:"flex items-center text-sm",children:[P.jsx("input",{type:"checkbox",checked:M?!0:N,onChange:U=>{const O=U.target.checked;I(O)},disabled:M,className:"mr-2"}),P.jsxs("span",{className:"text-sm",children:[P.jsx("strong",{children:"Use non-visual execution for Run"})," - No per-step animations"]})]}),P.jsxs("label",{className:"flex items-center text-sm mt-2",children:[P.jsx("input",{type:"checkbox",checked:M,onChange:U=>{const O=U.target.checked;if(L(O),O){I(!0),j("maximal");try{c(V=>{const $=V?{...V}:l?{...l}:{};return Number($.poolSize||0)>=8?$:{...$,poolSize:8}})}catch{}}},className:"mr-2"}),P.jsxs("span",{className:"text-sm",children:[P.jsx("strong",{children:"Batch mode"})," - Always headless, keeps background worker active"]})]}),M&&P.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Batch mode forces non-visual execution and reuses the simulation worker after the first run."})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type Annotations"}),P.jsxs("label",{className:"flex items-center text-sm",children:[P.jsx("input",{type:"checkbox",checked:A,onChange:U=>R(U.target.checked),className:"mr-2"}),P.jsxs("span",{className:"text-sm",children:[P.jsx("strong",{children:"Show inferred variable types"}),"  Display automatically inferred types in guards and bindings"]})]}),P.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"When off, only manually annotated types remain visible so expressions stay concise."})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Simulation Mode"}),P.jsxs("div",{className:"space-y-2",children:[P.jsxs("label",{className:"flex items-center",children:[P.jsx("input",{type:"radio",name:"simulationMode",value:"single",checked:u==="single",onChange:U=>j(U.target.value),disabled:p,className:"mr-2"}),P.jsxs("span",{className:"text-sm",children:[P.jsx("strong",{children:"Single Transition"})," - Fire one enabled transition at random"]})]}),P.jsxs("label",{className:"flex items-center",children:[P.jsx("input",{type:"radio",name:"simulationMode",value:"maximal",checked:u==="maximal",onChange:U=>j(U.target.value),disabled:p,className:"mr-2"}),P.jsxs("span",{className:"text-sm",children:[P.jsx("strong",{children:"Maximal Concurrent"})," - Fire all non-conflicting enabled transitions simultaneously"]})]})]})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Net Type"}),P.jsxs("div",{className:"space-y-2",children:[P.jsxs("label",{className:"flex items-center",children:[P.jsx("input",{type:"radio",name:"netMode",value:"pt",checked:S==="pt",onChange:U=>_(U.target.value),disabled:E,className:"mr-2"}),P.jsxs("span",{className:"text-sm",children:[P.jsx("strong",{children:"P/T Net"})," - Classic place/transition nets with counts"]})]}),P.jsxs("label",{className:"flex items-center",children:[P.jsx("input",{type:"radio",name:"netMode",value:"algebraic-int",checked:S==="algebraic-int",onChange:U=>_(U.target.value),disabled:E,className:"mr-2"}),P.jsxs("span",{className:"text-sm",children:[P.jsx("strong",{children:"Algebraic (Integer)"})," - Integer tokens with guard and term labels"]})]}),E&&P.jsx("div",{className:"text-xs text-gray-600",children:"Net type is locked while the canvas has elements. Clear the canvas to switch."})]})]}),p&&P.jsx("div",{className:"text-center text-sm text-gray-600",children:"Updating simulation mode..."})]}),P.jsxs("div",{className:"mt-6 pt-4 flex justify-end border-t border-gray-200",children:[P.jsx("button",{onClick:()=>T(!0),className:"px-3 py-2 bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors mr-auto",children:"Z3 Settings"}),P.jsx("button",{onClick:e,className:"px-3 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors mr-2","data-testid":"settings-cancel",children:"Cancel"}),P.jsx("button",{onClick:G,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors","data-testid":"settings-save",children:"Save"})]})]}),k&&P.jsx(O7,{isOpen:k,onClose:()=>T(!1)})]}):null};var O5={exports:{}},qc={},Pc={},Ae={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object globalThis]")}t.glob=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.20",isBrowser:n(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var i;return(i=t.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const r=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=r,t.Konva._injectGlobal(t.Konva)})(Ae);var dt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=Ae;class n{constructor(k=[1,0,0,1,0,0]){this.dirty=!1,this.m=k&&k.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(k){k.m[0]=this.m[0],k.m[1]=this.m[1],k.m[2]=this.m[2],k.m[3]=this.m[3],k.m[4]=this.m[4],k.m[5]=this.m[5]}point(k){const T=this.m;return{x:T[0]*k.x+T[2]*k.y+T[4],y:T[1]*k.x+T[3]*k.y+T[5]}}translate(k,T){return this.m[4]+=this.m[0]*k+this.m[2]*T,this.m[5]+=this.m[1]*k+this.m[3]*T,this}scale(k,T){return this.m[0]*=k,this.m[1]*=k,this.m[2]*=T,this.m[3]*=T,this}rotate(k){const T=Math.cos(k),N=Math.sin(k),I=this.m[0]*T+this.m[2]*N,M=this.m[1]*T+this.m[3]*N,L=this.m[0]*-N+this.m[2]*T,A=this.m[1]*-N+this.m[3]*T;return this.m[0]=I,this.m[1]=M,this.m[2]=L,this.m[3]=A,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(k,T){const N=this.m[0]+this.m[2]*T,I=this.m[1]+this.m[3]*T,M=this.m[2]+this.m[0]*k,L=this.m[3]+this.m[1]*k;return this.m[0]=N,this.m[1]=I,this.m[2]=M,this.m[3]=L,this}multiply(k){const T=this.m[0]*k.m[0]+this.m[2]*k.m[1],N=this.m[1]*k.m[0]+this.m[3]*k.m[1],I=this.m[0]*k.m[2]+this.m[2]*k.m[3],M=this.m[1]*k.m[2]+this.m[3]*k.m[3],L=this.m[0]*k.m[4]+this.m[2]*k.m[5]+this.m[4],A=this.m[1]*k.m[4]+this.m[3]*k.m[5]+this.m[5];return this.m[0]=T,this.m[1]=N,this.m[2]=I,this.m[3]=M,this.m[4]=L,this.m[5]=A,this}invert(){const k=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),T=this.m[3]*k,N=-this.m[1]*k,I=-this.m[2]*k,M=this.m[0]*k,L=k*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),A=k*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=T,this.m[1]=N,this.m[2]=I,this.m[3]=M,this.m[4]=L,this.m[5]=A,this}getMatrix(){return this.m}decompose(){const k=this.m[0],T=this.m[1],N=this.m[2],I=this.m[3],M=this.m[4],L=this.m[5],A=k*I-T*N,R={x:M,y:L,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(k!=0||T!=0){const j=Math.sqrt(k*k+T*T);R.rotation=T>0?Math.acos(k/j):-Math.acos(k/j),R.scaleX=j,R.scaleY=A/j,R.skewX=(k*N+T*I)/A,R.skewY=0}else if(N!=0||I!=0){const j=Math.sqrt(N*N+I*I);R.rotation=Math.PI/2-(I>0?Math.acos(-N/j):-Math.acos(N/j)),R.scaleX=A/j,R.scaleY=j,R.skewX=0,R.skewY=(k*N+T*I)/A}return R.rotation=t.Util._getRotation(R.rotation),R}}t.Transform=n;const r="[object Array]",i="[object Number]",s="[object String]",l="[object Boolean]",c=Math.PI/180,u=180/Math.PI,f="#",p="",m="0",w="Konva warning: ",y="Konva error: ",x="rgb(",C={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let _=[];const E=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(h){setTimeout(h,60)};t.Util={_isElement(h){return!!(h&&h.nodeType==1)},_isFunction(h){return!!(h&&h.constructor&&h.call&&h.apply)},_isPlainObject(h){return!!h&&h.constructor===Object},_isArray(h){return Object.prototype.toString.call(h)===r},_isNumber(h){return Object.prototype.toString.call(h)===i&&!isNaN(h)&&isFinite(h)},_isString(h){return Object.prototype.toString.call(h)===s},_isBoolean(h){return Object.prototype.toString.call(h)===l},isObject(h){return h instanceof Object},isValidSelector(h){if(typeof h!="string")return!1;const k=h[0];return k==="#"||k==="."||k===k.toUpperCase()},_sign(h){return h===0||h>0?1:-1},requestAnimFrame(h){_.push(h),_.length===1&&E(function(){const k=_;_=[],k.forEach(function(T){T()})})},createCanvasElement(){const h=document.createElement("canvas");try{h.style=h.style||{}}catch{}return h},createImageElement(){return document.createElement("img")},_isInDocument(h){for(;h=h.parentNode;)if(h==document)return!0;return!1},_urlToImage(h,k){const T=t.Util.createImageElement();T.onload=function(){k(T)},T.src=h},_rgbToHex(h,k,T){return((1<<24)+(h<<16)+(k<<8)+T).toString(16).slice(1)},_hexToRgb(h){h=h.replace(f,p);const k=parseInt(h,16);return{r:k>>16&255,g:k>>8&255,b:k&255}},getRandomColor(){let h=(Math.random()*16777215<<0).toString(16);for(;h.length<6;)h=m+h;return f+h},getRGB(h){let k;return h in C?(k=C[h],{r:k[0],g:k[1],b:k[2]}):h[0]===f?this._hexToRgb(h.substring(1)):h.substr(0,4)===x?(k=S.exec(h.replace(/ /g,"")),{r:parseInt(k[1],10),g:parseInt(k[2],10),b:parseInt(k[3],10)}):{r:0,g:0,b:0}},colorToRGBA(h){return h=h||"black",t.Util._namedColorToRBA(h)||t.Util._hex3ColorToRGBA(h)||t.Util._hex4ColorToRGBA(h)||t.Util._hex6ColorToRGBA(h)||t.Util._hex8ColorToRGBA(h)||t.Util._rgbColorToRGBA(h)||t.Util._rgbaColorToRGBA(h)||t.Util._hslColorToRGBA(h)},_namedColorToRBA(h){const k=C[h.toLowerCase()];return k?{r:k[0],g:k[1],b:k[2],a:1}:null},_rgbColorToRGBA(h){if(h.indexOf("rgb(")===0){h=h.match(/rgb\(([^)]+)\)/)[1];const k=h.split(/ *, */).map(Number);return{r:k[0],g:k[1],b:k[2],a:1}}},_rgbaColorToRGBA(h){if(h.indexOf("rgba(")===0){h=h.match(/rgba\(([^)]+)\)/)[1];const k=h.split(/ *, */).map((T,N)=>T.slice(-1)==="%"?N===3?parseInt(T)/100:parseInt(T)/100*255:Number(T));return{r:k[0],g:k[1],b:k[2],a:k[3]}}},_hex8ColorToRGBA(h){if(h[0]==="#"&&h.length===9)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:parseInt(h.slice(7,9),16)/255}},_hex6ColorToRGBA(h){if(h[0]==="#"&&h.length===7)return{r:parseInt(h.slice(1,3),16),g:parseInt(h.slice(3,5),16),b:parseInt(h.slice(5,7),16),a:1}},_hex4ColorToRGBA(h){if(h[0]==="#"&&h.length===5)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:parseInt(h[4]+h[4],16)/255}},_hex3ColorToRGBA(h){if(h[0]==="#"&&h.length===4)return{r:parseInt(h[1]+h[1],16),g:parseInt(h[2]+h[2],16),b:parseInt(h[3]+h[3],16),a:1}},_hslColorToRGBA(h){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(h)){const[k,...T]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(h),N=Number(T[0])/360,I=Number(T[1])/100,M=Number(T[2])/100;let L,A,R;if(I===0)return R=M*255,{r:Math.round(R),g:Math.round(R),b:Math.round(R),a:1};M<.5?L=M*(1+I):L=M+I-M*I;const j=2*M-L,G=[0,0,0];for(let U=0;U<3;U++)A=N+1/3*-(U-1),A<0&&A++,A>1&&A--,6*A<1?R=j+(L-j)*6*A:2*A<1?R=L:3*A<2?R=j+(L-j)*(2/3-A)*6:R=j,G[U]=R*255;return{r:Math.round(G[0]),g:Math.round(G[1]),b:Math.round(G[2]),a:1}}},haveIntersection(h,k){return!(k.x>h.x+h.width||k.x+k.width<h.x||k.y>h.y+h.height||k.y+k.height<h.y)},cloneObject(h){const k={};for(const T in h)this._isPlainObject(h[T])?k[T]=this.cloneObject(h[T]):this._isArray(h[T])?k[T]=this.cloneArray(h[T]):k[T]=h[T];return k},cloneArray(h){return h.slice(0)},degToRad(h){return h*c},radToDeg(h){return h*u},_degToRad(h){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(h)},_radToDeg(h){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(h)},_getRotation(h){return e.Konva.angleDeg?t.Util.radToDeg(h):h},_capitalize(h){return h.charAt(0).toUpperCase()+h.slice(1)},throw(h){throw new Error(y+h)},error(h){console.error(y+h)},warn(h){e.Konva.showWarnings&&console.warn(w+h)},each(h,k){for(const T in h)k(T,h[T])},_inRange(h,k,T){return k<=h&&h<T},_getProjectionToSegment(h,k,T,N,I,M){let L,A,R;const j=(h-T)*(h-T)+(k-N)*(k-N);if(j==0)L=h,A=k,R=(I-T)*(I-T)+(M-N)*(M-N);else{const G=((I-h)*(T-h)+(M-k)*(N-k))/j;G<0?(L=h,A=k,R=(h-I)*(h-I)+(k-M)*(k-M)):G>1?(L=T,A=N,R=(T-I)*(T-I)+(N-M)*(N-M)):(L=h+G*(T-h),A=k+G*(N-k),R=(L-I)*(L-I)+(A-M)*(A-M))}return[L,A,R]},_getProjectionToLine(h,k,T){const N=t.Util.cloneObject(h);let I=Number.MAX_VALUE;return k.forEach(function(M,L){if(!T&&L===k.length-1)return;const A=k[(L+1)%k.length],R=t.Util._getProjectionToSegment(M.x,M.y,A.x,A.y,h.x,h.y),j=R[0],G=R[1],U=R[2];U<I&&(N.x=j,N.y=G,I=U)}),N},_prepareArrayForTween(h,k,T){const N=[],I=[];if(h.length>k.length){const L=k;k=h,h=L}for(let L=0;L<h.length;L+=2)N.push({x:h[L],y:h[L+1]});for(let L=0;L<k.length;L+=2)I.push({x:k[L],y:k[L+1]});const M=[];return I.forEach(function(L){const A=t.Util._getProjectionToLine(L,N,T);M.push(A.x),M.push(A.y)}),M},_prepareToStringify(h){let k;h.visitedByCircularReferenceRemoval=!0;for(const T in h)if(h.hasOwnProperty(T)&&h[T]&&typeof h[T]=="object"){if(k=Object.getOwnPropertyDescriptor(h,T),h[T].visitedByCircularReferenceRemoval||t.Util._isElement(h[T]))if(k.configurable)delete h[T];else return null;else if(t.Util._prepareToStringify(h[T])===null)if(k.configurable)delete h[T];else return null}return delete h.visitedByCircularReferenceRemoval,h},_assign(h,k){for(const T in k)h[T]=k[T];return h},_getFirstPointerId(h){return h.touches?h.changedTouches[0].identifier:h.pointerId||999},releaseCanvas(...h){e.Konva.releaseCanvasOnDestroy&&h.forEach(k=>{k.width=0,k.height=0})},drawRoundedRectPath(h,k,T,N){let I=0,M=0,L=0,A=0;typeof N=="number"?I=M=L=A=Math.min(N,k/2,T/2):(I=Math.min(N[0]||0,k/2,T/2),M=Math.min(N[1]||0,k/2,T/2),A=Math.min(N[2]||0,k/2,T/2),L=Math.min(N[3]||0,k/2,T/2)),h.moveTo(I,0),h.lineTo(k-M,0),h.arc(k-M,M,M,Math.PI*3/2,0,!1),h.lineTo(k,T-A),h.arc(k-A,T-A,A,0,Math.PI/2,!1),h.lineTo(L,T),h.arc(L,T-L,L,Math.PI/2,Math.PI,!1),h.lineTo(0,I),h.arc(I,I,I,Math.PI,Math.PI*3/2,!1)}}})(dt);var st={},Re={},Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.RGBComponent=z7;Ee.alphaComponent=B7;Ee.getNumberValidator=U7;Ee.getNumberOrArrayOfNumbersValidator=G7;Ee.getNumberOrAutoValidator=V7;Ee.getStringValidator=W7;Ee.getStringOrGradientValidator=$7;Ee.getFunctionValidator=H7;Ee.getNumberArrayValidator=Y7;Ee.getBooleanValidator=X7;Ee.getComponentValidator=K7;const ei=Ae,pt=dt;function ti(t){return pt.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||pt.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function z7(t){return t>255?255:t<0?0:Math.round(t)}function B7(t){return t>1?1:t<1e-4?1e-4:t}function U7(){if(ei.Konva.isUnminified)return function(t,e){return pt.Util._isNumber(t)||pt.Util.warn(ti(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function G7(t){if(ei.Konva.isUnminified)return function(e,n){let r=pt.Util._isNumber(e),i=pt.Util._isArray(e)&&e.length==t;return!r&&!i&&pt.Util.warn(ti(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function V7(){if(ei.Konva.isUnminified)return function(t,e){var n=pt.Util._isNumber(t),r=t==="auto";return n||r||pt.Util.warn(ti(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function W7(){if(ei.Konva.isUnminified)return function(t,e){return pt.Util._isString(t)||pt.Util.warn(ti(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function $7(){if(ei.Konva.isUnminified)return function(t,e){const n=pt.Util._isString(t),r=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return n||r||pt.Util.warn(ti(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function H7(){if(ei.Konva.isUnminified)return function(t,e){return pt.Util._isFunction(t)||pt.Util.warn(ti(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function Y7(){if(ei.Konva.isUnminified)return function(t,e){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&t instanceof n||(pt.Util._isArray(t)?t.forEach(function(r){pt.Util._isNumber(r)||pt.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):pt.Util.warn(ti(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function X7(){if(ei.Konva.isUnminified)return function(t,e){var n=t===!0||t===!1;return n||pt.Util.warn(ti(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function K7(t){if(ei.Konva.isUnminified)return function(e,n){return e==null||pt.Util.isObject(e)||pt.Util.warn(ti(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=dt,n=Ee,r="get",i="set";t.Factory={addGetterSetter(s,l,c,u,f){t.Factory.addGetter(s,l,c),t.Factory.addSetter(s,l,u,f),t.Factory.addOverloadedGetterSetter(s,l)},addGetter(s,l,c){var u=r+e.Util._capitalize(l);s.prototype[u]=s.prototype[u]||function(){const f=this.attrs[l];return f===void 0?c:f}},addSetter(s,l,c,u){var f=i+e.Util._capitalize(l);s.prototype[f]||t.Factory.overWriteSetter(s,l,c,u)},overWriteSetter(s,l,c,u){var f=i+e.Util._capitalize(l);s.prototype[f]=function(p){return c&&p!==void 0&&p!==null&&(p=c.call(this,p,l)),this._setAttr(l,p),u&&u.call(this),this}},addComponentsGetterSetter(s,l,c,u,f){const p=c.length,m=e.Util._capitalize,w=r+m(l),y=i+m(l);s.prototype[w]=function(){const C={};for(let S=0;S<p;S++){const _=c[S];C[_]=this.getAttr(l+m(_))}return C};const x=(0,n.getComponentValidator)(c);s.prototype[y]=function(C){const S=this.attrs[l];u&&(C=u.call(this,C,l)),x&&x.call(this,C,l);for(const _ in C)C.hasOwnProperty(_)&&this._setAttr(l+m(_),C[_]);return C||c.forEach(_=>{this._setAttr(l+m(_),void 0)}),this._fireChangeEvent(l,S,C),f&&f.call(this),this},t.Factory.addOverloadedGetterSetter(s,l)},addOverloadedGetterSetter(s,l){var c=e.Util._capitalize(l),u=i+c,f=r+c;s.prototype[l]=function(){return arguments.length?(this[u](arguments[0]),this):this[f]()}},addDeprecatedGetterSetter(s,l,c,u){e.Util.error("Adding deprecated "+l);const f=r+e.Util._capitalize(l),p=l+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[f]=function(){e.Util.error(p);const m=this.attrs[l];return m===void 0?c:m},t.Factory.addSetter(s,l,u,function(){e.Util.error(p)}),t.Factory.addOverloadedGetterSetter(s,l)},backCompat(s,l){e.Util.each(l,function(c,u){const f=s.prototype[u],p=r+e.Util._capitalize(c),m=i+e.Util._capitalize(c);function w(){f.apply(this,arguments),e.Util.error('"'+c+'" method is deprecated and will be removed soon. Use ""'+u+'" instead.')}s.prototype[c]=w,s.prototype[p]=w,s.prototype[m]=w})},afterSetFilter(){this._filterUpToDate=!1}}})(Re);var dr={},Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.HitContext=Xr.SceneContext=Xr.Context=void 0;const D5=dt,Q7=Ae;function Z7(t){const e=[],n=t.length,r=D5.Util;for(let i=0;i<n;i++){let s=t[i];r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s)}return e}const i2=",",q7="(",J7=")",eS="([",tS="])",nS=";",rS="()",iS="=",s2=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],sS=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],oS=100;class Jc{constructor(e){this.canvas=e,Q7.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){let r=this.traceArr,i=r.length,s="",l,c,u,f;for(l=0;l<i;l++)c=r[l],u=c.method,u?(f=c.args,s+=u,e?s+=rS:D5.Util._isArray(f[0])?s+=eS+f.join(i2)+tS:(n&&(f=f.map(p=>typeof p=="number"?Math.floor(p):p)),s+=q7+f.join(i2)+J7)):(s+=c.property,e||(s+=iS+c.val)),s+=nS;return s}clearTrace(){this.traceArr=[]}_trace(e){let n=this.traceArr,r;n.push(e),r=n.length,r>=oS&&n.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){const n=e.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(e){const n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){const n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}setAttr(e,n){this._context[e]=n}arc(e,n,r,i,s,l){this._context.arc(e,n,r,i,s,l)}arcTo(e,n,r,i,s){this._context.arcTo(e,n,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,r,i,s,l){this._context.bezierCurveTo(e,n,r,i,s,l)}clearRect(e,n,r,i){this._context.clearRect(e,n,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,n){const r=arguments;if(r.length===2)return this._context.createImageData(e,n);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,r,i){return this._context.createLinearGradient(e,n,r,i)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,r,i,s,l){return this._context.createRadialGradient(e,n,r,i,s,l)}drawImage(e,n,r,i,s,l,c,u,f){const p=arguments,m=this._context;p.length===3?m.drawImage(e,n,r):p.length===5?m.drawImage(e,n,r,i,s):p.length===9&&m.drawImage(e,n,r,i,s,l,c,u,f)}ellipse(e,n,r,i,s,l,c,u){this._context.ellipse(e,n,r,i,s,l,c,u)}isPointInPath(e,n,r,i){return r?this._context.isPointInPath(r,e,n,i):this._context.isPointInPath(e,n,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,n,r,i){this._context.fillRect(e,n,r,i)}strokeRect(e,n,r,i){this._context.strokeRect(e,n,r,i)}fillText(e,n,r,i){i?this._context.fillText(e,n,r,i):this._context.fillText(e,n,r)}measureText(e){return this._context.measureText(e)}getImageData(e,n,r,i){return this._context.getImageData(e,n,r,i)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,r,i){this._context.rect(e,n,r,i)}roundRect(e,n,r,i,s){this._context.roundRect(e,n,r,i,s)}putImageData(e,n,r){this._context.putImageData(e,n,r)}quadraticCurveTo(e,n,r,i){this._context.quadraticCurveTo(e,n,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,r,i,s,l){this._context.setTransform(e,n,r,i,s,l)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,r,i){this._context.strokeText(e,n,r,i)}transform(e,n,r,i,s,l){this._context.transform(e,n,r,i,s,l)}translate(e,n){this._context.translate(e,n)}_enableTrace(){let e=this,n=s2.length,r=this.setAttr,i,s;const l=function(c){let u=e[c],f;e[c]=function(){return s=Z7(Array.prototype.slice.call(arguments,0)),f=u.apply(e,arguments),e._trace({method:c,args:s}),f}};for(i=0;i<n;i++)l(s2[i]);e.setAttr=function(){r.apply(e,arguments);const c=arguments[0];let u=arguments[1];(c==="shadowOffsetX"||c==="shadowOffsetY"||c==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),e._trace({property:c,val:u})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;!n||n==="source-over"||this.setAttr("globalCompositeOperation",n)}}Xr.Context=Jc;sS.forEach(function(t){Object.defineProperty(Jc.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class aS extends Jc{constructor(e,{willReadFrequently:n=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(e){const n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){const n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){const n=e.fill(),r=e.getFillPriority();if(n&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const l=e.getFillRadialGradientColorStops();if(l&&r==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):l&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const n=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(n.x,n.y,r.x,r.y);if(i){for(let l=0;l<i.length;l+=2)s.addColorStop(i[l],i[l+1]);this.setAttr("strokeStyle",s)}}_stroke(e){const n=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var n,r,i;const s=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",l=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,c=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},u=e.getAbsoluteScale(),f=this.canvas.getPixelRatio(),p=u.x*f,m=u.y*f;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",l*Math.min(Math.abs(p),Math.abs(m))),this.setAttr("shadowOffsetX",c.x*p),this.setAttr("shadowOffsetY",c.y*m)}}Xr.SceneContext=aS;class lS extends Jc{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const n=e.getStrokeScaleEnabled();if(!n){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(e);const r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),n||this.restore()}}}Xr.HitContext=lS;Object.defineProperty(dr,"__esModule",{value:!0});dr.HitCanvas=dr.SceneCanvas=dr.Canvas=void 0;const Mc=dt,z5=Xr,B5=Ae;let Ru;function uS(){if(Ru)return Ru;const t=Mc.Util.createCanvasElement(),e=t.getContext("2d");return Ru=function(){const n=B5.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/r}(),Mc.Util.releaseCanvas(t),Ru}class gg{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const r=(e||{}).pixelRatio||B5.Konva.pixelRatio||uS();this.pixelRatio=r,this._canvas=Mc.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const n=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const n=this.pixelRatio;this.getContext()._context.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,n){this.setWidth(e||0),this.setHeight(n||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(i){return Mc.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}dr.Canvas=gg;class cS extends gg{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new z5.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}dr.SceneCanvas=cS;class dS extends gg{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new z5.HitContext(this),this.setSize(e.width,e.height)}}dr.HitCanvas=dS;var ed={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=Ae,n=dt;t.DD={get isDragging(){let r=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return t.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];t.DD._dragElements.forEach((s,l)=>{const{node:c}=s,u=c.getStage();u.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=n.Util._getFirstPointerId(r));const f=u._changedPointerPositions.find(p=>p.id===s.pointerId);if(f){if(s.dragStatus!=="dragging"){const p=c.dragDistance();if(Math.max(Math.abs(f.x-s.startPointerPos.x),Math.abs(f.y-s.startPointerPos.y))<p||(c.startDrag({evt:r}),!c.isDragging()))return}c._setDragPosition(r,s),i.push(c)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];t.DD._dragElements.forEach(s=>{const{node:l}=s,c=l.getStage();if(r&&c.setPointersPositions(r),!c._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const f=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;f&&i.indexOf(f)===-1&&i.push(f)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){t.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(ed);Object.defineProperty(st,"__esModule",{value:!0});st.Node=void 0;const Fe=dt,yl=Re,va=dr,gi=Ae,Dn=ed,vt=Ee,Ju="absoluteOpacity",Lu="allEventListeners",Ur="absoluteTransform",o2="absoluteScale",ns="canvas",fS="Change",hS="children",pS="konva",op="listening",a2="mouseenter",l2="mouseleave",u2="set",c2="Shape",ec=" ",d2="stage",mi="transform",gS="Stage",ap="visible",mS=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(ec);let yS=1;class be{constructor(e){this._id=yS++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===mi||e===Ur)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){let r=this._cache.get(e);return(r===void 0||(e===mi||e===Ur)&&r.dirty===!0)&&(r=n.call(this),this._cache.set(e,r)),r}_calculate(e,n,r){if(!this._attachedDepsListeners.get(e)){const i=n.map(s=>s+"Change.konva").join(ec);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(ns)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Ur&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(ns)){const{scene:e,filter:n,hit:r}=this._cache.get(ns);Fe.Util.releaseCanvas(e,n,r),this._cache.delete(ns)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const n=e||{};let r={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(n.width||r.width),s=Math.ceil(n.height||r.height),l=n.pixelRatio,c=n.x===void 0?Math.floor(r.x):n.x,u=n.y===void 0?Math.floor(r.y):n.y,f=n.offset||0,p=n.drawBorder||!1,m=n.hitCanvasPixelRatio||1;if(!i||!s){Fe.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const w=Math.abs(Math.round(r.x)-c)>.5?1:0,y=Math.abs(Math.round(r.y)-u)>.5?1:0;i+=f*2+w,s+=f*2+y,c-=f,u-=f;const x=new va.SceneCanvas({pixelRatio:l,width:i,height:s}),C=new va.SceneCanvas({pixelRatio:l,width:0,height:0,willReadFrequently:!0}),S=new va.HitCanvas({pixelRatio:m,width:i,height:s}),_=x.getContext(),E=S.getContext();return S.isCache=!0,x.isCache=!0,this._cache.delete(ns),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(x.getContext()._context.imageSmoothingEnabled=!1,C.getContext()._context.imageSmoothingEnabled=!1),_.save(),E.save(),_.translate(-c,-u),E.translate(-c,-u),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Ju),this._clearSelfAndDescendantCache(o2),this.drawScene(x,this),this.drawHit(S,this),this._isUnderCache=!1,_.restore(),E.restore(),p&&(_.save(),_.beginPath(),_.rect(0,0,i,s),_.closePath(),_.setAttr("strokeStyle","red"),_.setAttr("lineWidth",5),_.stroke(),_.restore()),this._cache.set(ns,{scene:x,filter:C,hit:S,x:c,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(ns)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){const r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,s=1/0,l=-1/0,c=-1/0;const u=this.getAbsoluteTransform(n);return r.forEach(function(f){const p=u.point(f);i===void 0&&(i=l=p.x,s=c=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),l=Math.max(l,p.x),c=Math.max(c,p.y)}),{x:i,y:s,width:l-i,height:c-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);const r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){const n=this._getCanvasCache(),r=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),n=this._getCanvasCache(),r=n.scene,i=n.filter,s=i.getContext(),l,c,u,f;if(e){if(!this._filterUpToDate){const p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(l=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),c=s.getImageData(0,0,i.getWidth(),i.getHeight()),u=0;u<l;u++){if(f=e[u],typeof f!="function"){Fe.Util.error("Filter should be type of function, but got "+typeof f+" instead. Please check correct filters");continue}f.call(this,c),s.putImageData(c,0,0)}}catch(m){Fe.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,n){if(this._cache&&this._cache.delete(Lu),arguments.length===3)return this._delegate.apply(this,arguments);let r=e.split(ec),i=r.length,s,l,c,u,f;for(s=0;s<i;s++)l=r[s],c=l.split("."),u=c[0],f=c[1]||"",this.eventListeners[u]||(this.eventListeners[u]=[]),this.eventListeners[u].push({name:f,handler:n});return this}off(e,n){let r=(e||"").split(ec),i=r.length,s,l,c,u,f,p;if(this._cache&&this._cache.delete(Lu),!e)for(l in this.eventListeners)this._off(l);for(s=0;s<i;s++)if(c=r[s],u=c.split("."),f=u[0],p=u[1],f)this.eventListeners[f]&&this._off(f,p,n);else for(l in this.eventListeners)this._off(l,p,n);return this}dispatchEvent(e){const n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(r){n.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,r){const i=this;this.on(e,function(s){const l=s.target.findAncestors(n,!0,i);for(let c=0;c<l.length;c++)s=Fe.Util.cloneObject(s),s.currentTarget=l[c],r.call(l[c],s)})}remove(){return this.isDragging()&&this.stopDrag(),Dn.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ur),this._clearSelfAndDescendantCache(Ju),this._clearSelfAndDescendantCache(o2),this._clearSelfAndDescendantCache(d2),this._clearSelfAndDescendantCache(ap),this._clearSelfAndDescendantCache(op)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const n="get"+Fe.Util._capitalize(e);return Fe.Util._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){let e=this.getParent(),n=[];for(;e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let n,r;if(!e)return this;for(n in e)n!==hS&&(r=u2+Fe.Util._capitalize(n),Fe.Util._isFunction(this[r])?this[r](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache(op,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(ap,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);const r=this.getLayer();let i=!1;Dn.DD._dragElements.forEach(l=>{l.dragStatus==="dragging"&&(l.node.nodeType==="Stage"||l.node.getLayer()===r)&&(i=!0)});const s=!n&&!gi.Konva.hitOnDragEnabled&&(i||gi.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),n=this,r=0,i,s,l,c;function u(p){for(i=[],s=p.length,l=0;l<s;l++)c=p[l],r++,c.nodeType!==c2&&(i=i.concat(c.getChildren().slice())),c._id===n._id&&(l=s);i.length>0&&i[0].getDepth()<=e&&u(i)}const f=this.getStage();return n.nodeType!==gS&&f&&u(f.getChildren()),r}getDepth(){let e=0,n=this.parent;for(;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(mi),this._clearSelfAndDescendantCache(Ur)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const n=e.getPointerPosition();if(!n)return null;const r=this.getAbsoluteTransform().copy();return r.invert(),r.point(n)}getAbsolutePosition(e){let n=!1,r=this.parent;for(;r;){if(r.isCached()){n=!0;break}r=r.parent}n&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),s=new Fe.Transform,l=this.offset();return s.m=i.slice(),s.translate(l.x,l.y),s.getTranslation()}setAbsolutePosition(e){const{x:n,y:r,...i}=this._clearTransform();this.attrs.x=n,this.attrs.y=r,this._clearCache(mi);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(mi),this._clearSelfAndDescendantCache(Ur),this}_setTransform(e){let n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let n=e.x,r=e.y,i=this.x(),s=this.y();return n!==void 0&&(i+=n),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,n){let r=[],i=this.getParent(),s,l;if(!(n&&n._id===this._id)){for(r.unshift(this);i&&(!n||i._id!==n._id);)r.unshift(i),i=i.parent;for(s=r.length,l=0;l<s;l++)e(r[l])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return Fe.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return Fe.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return Fe.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return Fe.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return Fe.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&Fe.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Ju,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),n,r,i,s,l;const c={attrs:{},className:this.getClassName()};for(n in e)r=e[n],l=Fe.Util.isObject(r)&&!Fe.Util._isPlainObject(r)&&!Fe.Util._isArray(r),!l&&(i=typeof this[n]=="function"&&this[n],delete e[n],s=i?i.call(this):null,e[n]=r,s!==r&&(c.attrs[n]=r));return Fe.Util._prepareToStringify(c)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,r){const i=[];n&&this._isMatch(e)&&i.push(this);let s=this.parent;for(;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,n,r){return this.findAncestors(e,n,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let n=e.replace(/ /g,"").split(","),r=n.length,i,s;for(i=0;i<r;i++)if(s=n[i],Fe.Util.isValidSelector(s)||(Fe.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Fe.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Fe.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(d2,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,n={},r){return n.target=n.target||this,r?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Ur,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let n;if(e)return n=new Fe.Transform,this._eachAncestorReverse(function(r){const i=r.transformsEnabled();i==="all"?n.multiply(r.getTransform()):i==="position"&&n.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),n;{n=this._cache.get(Ur)||new Fe.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();const r=this.transformsEnabled();if(r==="all")n.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,l=this.attrs.offsetX||0,c=this.attrs.offsetY||0;n.translate(i-l,s-c)}return n.dirty=!1,n}}getAbsoluteScale(e){let n=this;for(;n;)n._isUnderCache&&(e=n),n=n.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(mi,this._getTransform)}_getTransform(){var e,n;const r=this._cache.get(mi)||new Fe.Transform;r.reset();const i=this.x(),s=this.y(),l=gi.Konva.getAngle(this.rotation()),c=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,u=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,f=this.attrs.skewX||0,p=this.attrs.skewY||0,m=this.attrs.offsetX||0,w=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),l!==0&&r.rotate(l),(f!==0||p!==0)&&r.skew(f,p),(c!==1||u!==1)&&r.scale(c,u),(m!==0||w!==0)&&r.translate(-1*m,-1*w),r.dirty=!1,r}clone(e){let n=Fe.Util.cloneObject(this.attrs),r,i,s,l,c;for(r in e)n[r]=e[r];const u=new this.constructor(n);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,l=0;l<s;l++)c=i[l],c.name.indexOf(pS)<0&&(u.eventListeners[r]||(u.eventListeners[r]=[]),u.eventListeners[r].push(c));return u}_toKonvaCanvas(e){e=e||{};const n=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(n.x),s=e.y!==void 0?e.y:Math.floor(n.y),l=e.pixelRatio||1,c=new va.SceneCanvas({width:e.width||Math.ceil(n.width)||(r?r.width():0),height:e.height||Math.ceil(n.height)||(r?r.height():0),pixelRatio:l}),u=c.getContext(),f=new va.SceneCanvas({width:c.width/c.pixelRatio+Math.abs(i),height:c.height/c.pixelRatio+Math.abs(s),pixelRatio:c.pixelRatio});return e.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(i||s)&&u.translate(-1*i,-1*s),this.drawScene(c,void 0,f),u.restore(),c}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const n=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(n,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((n,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,Fe.Util._urlToImage(this.toDataURL(e),function(s){n(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((n,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{n(s),i==null||i(s)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():gi.Konva.dragDistance}_off(e,n,r){let i=this.eventListeners[e],s,l,c;for(s=0;s<i.length;s++)if(l=i[s].name,c=i[s].handler,(l!=="konva"||n==="konva")&&(!n||l===n)&&(!r||r===c)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,n,r){this._fire(e+fS,{oldVal:n,newVal:r})}addName(e){if(!this.hasName(e)){const n=this.name(),r=n?n+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const n=this.name();return n?(n||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const n=(this.name()||"").split(/\s/g),r=n.indexOf(e);return r!==-1&&(n.splice(r,1),this.name(n.join(" "))),this}setAttr(e,n){const r=this[u2+Fe.Util._capitalize(e)];return Fe.Util._isFunction(r)?r.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(gi.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,n){const r=this.attrs[e];r===n&&!Fe.Util.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,n),this._requestDraw())}_setComponentAttr(e,n,r){let i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,n,r){if(n&&this.nodeType===c2&&(n.target=this),!((e===a2||e===l2)&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r))){this._fire(e,n);const s=(e===a2||e===l2)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!s&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,n,r):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){var n,r,i;const s=(n=this._cache.get(Lu))!==null&&n!==void 0?n:{};let l=s==null?void 0:s[e];if(l===void 0){l=[];let c=Object.getPrototypeOf(this);for(;c;){const u=(i=(r=c.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];l.push(...u),c=Object.getPrototypeOf(c)}s[e]=l,this._cache.set(Lu,s)}return l}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const r=this._getProtoListeners(e);if(r)for(var i=0;i<r.length;i++)r[i].handler.call(this,n);const s=this.eventListeners[e];if(s)for(var i=0;i<s.length;i++)s[i].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const n=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;const s=r._getPointerById(n)||r._changedPointerPositions[0]||i;Dn.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:n})}startDrag(e,n=!0){Dn.DD._dragElements.has(this._id)||this._createDragElement(e);const r=Dn.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const r=this.getStage()._getPointerById(n.pointerId);if(!r)return;let i={x:r.x-n.offset.x,y:r.y-n.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const l=s.call(this,i,e);l?i=l:Fe.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const n=Dn.DD._dragElements.get(this._id);n&&(n.dragStatus="stopped"),Dn.DD._endDragBefore(e),Dn.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Dn.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||gi.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Dn.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const n=Dn.DD._dragElements.get(this._id),r=n&&n.dragStatus==="dragging",i=n&&n.dragStatus==="ready";r?this.stopDrag():i&&Dn.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const r={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return Fe.Util.haveIntersection(r,this.getClientRect())}static create(e,n){return Fe.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){let r=be.prototype.getClassName.call(e),i=e.children,s,l,c;n&&(e.attrs.container=n),gi.Konva[r]||(Fe.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const u=gi.Konva[r];if(s=new u(e.attrs),i)for(l=i.length,c=0;c<l;c++)s.add(be._createNode(i[c]));return s}}st.Node=be;be.prototype.nodeType="Node";be.prototype._attrsAffectingSize=[];be.prototype.eventListeners={};be.prototype.on.call(be.prototype,mS,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(mi),this._clearSelfAndDescendantCache(Ur)});be.prototype.on.call(be.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(ap)});be.prototype.on.call(be.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(op)});be.prototype.on.call(be.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Ju)});const Ye=yl.Factory.addGetterSetter;Ye(be,"zIndex");Ye(be,"absolutePosition");Ye(be,"position");Ye(be,"x",0,(0,vt.getNumberValidator)());Ye(be,"y",0,(0,vt.getNumberValidator)());Ye(be,"globalCompositeOperation","source-over",(0,vt.getStringValidator)());Ye(be,"opacity",1,(0,vt.getNumberValidator)());Ye(be,"name","",(0,vt.getStringValidator)());Ye(be,"id","",(0,vt.getStringValidator)());Ye(be,"rotation",0,(0,vt.getNumberValidator)());yl.Factory.addComponentsGetterSetter(be,"scale",["x","y"]);Ye(be,"scaleX",1,(0,vt.getNumberValidator)());Ye(be,"scaleY",1,(0,vt.getNumberValidator)());yl.Factory.addComponentsGetterSetter(be,"skew",["x","y"]);Ye(be,"skewX",0,(0,vt.getNumberValidator)());Ye(be,"skewY",0,(0,vt.getNumberValidator)());yl.Factory.addComponentsGetterSetter(be,"offset",["x","y"]);Ye(be,"offsetX",0,(0,vt.getNumberValidator)());Ye(be,"offsetY",0,(0,vt.getNumberValidator)());Ye(be,"dragDistance",void 0,(0,vt.getNumberValidator)());Ye(be,"width",0,(0,vt.getNumberValidator)());Ye(be,"height",0,(0,vt.getNumberValidator)());Ye(be,"listening",!0,(0,vt.getBooleanValidator)());Ye(be,"preventDefault",!0,(0,vt.getBooleanValidator)());Ye(be,"filters",void 0,function(t){return this._filterUpToDate=!1,t});Ye(be,"visible",!0,(0,vt.getBooleanValidator)());Ye(be,"transformsEnabled","all",(0,vt.getStringValidator)());Ye(be,"size");Ye(be,"dragBoundFunc");Ye(be,"draggable",!1,(0,vt.getBooleanValidator)());yl.Factory.backCompat(be,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.Container=void 0;const Ro=Re,$h=st,td=Ee;class xs extends $h.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const n=this.children||[],r=[];return n.forEach(function(i){e(i)&&r.push(i)}),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let r=0;r<e.length;r++)this.add(e[r]);return this}const n=e[0];return n.getParent()?(n.moveTo(this),this):(this._validateAdd(n),n.index=this.getChildren().length,n.parent=this,n._clearCaches(),this.getChildren().push(n),this._fire("add",{child:n}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){const r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&n)}),r}_descendants(e){let n=!1;const r=this.getChildren();for(const i of r){if(n=e(i),n)return!0;if(i.hasChildren()&&(n=i._descendants(e),n))return!0}return!1}toObject(){const e=$h.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){let n=e.getParent();for(;n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){const n=$h.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){n.add(r.clone())}),n}getAllIntersections(e){const n=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&n.push(r)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,r){n.index=r}),this._requestDraw()}drawScene(e,n,r){const i=this.getLayer(),s=e||i&&i.getCanvas(),l=s&&s.getContext(),c=this._getCanvasCache(),u=c&&c.scene,f=s&&s.isCache;if(!this.isVisible()&&!f)return this;if(u){l.save();const p=this.getAbsoluteTransform(n).getMatrix();l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(l),l.restore()}else this._drawChildren("drawScene",s,n,r);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;const r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),l=this._getCanvasCache();if(l&&l.hit){s.save();const u=this.getAbsoluteTransform(n).getMatrix();s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,n);return this}_drawChildren(e,n,r,i){var s;const l=n&&n.getContext(),c=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),p=typeof c=="number"&&typeof u=="number"||f,m=r===this;if(p){l.save();const y=this.getAbsoluteTransform(r);let x=y.getMatrix();l.transform(x[0],x[1],x[2],x[3],x[4],x[5]),l.beginPath();let C;if(f)C=f.call(this,l,this);else{const S=this.clipX(),_=this.clipY();l.rect(S||0,_||0,c,u)}l.clip.apply(l,C),x=y.copy().invert().getMatrix(),l.transform(x[0],x[1],x[2],x[3],x[4],x[5])}const w=!m&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";w&&(l.save(),l._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(y){y[e](n,r,i)}),w&&l.restore(),p&&l.restore()}getClientRect(e={}){var n;const r=e.skipTransform,i=e.relativeTo;let s,l,c,u,f={x:1/0,y:1/0,width:0,height:0};const p=this;(n=this.children)===null||n===void 0||n.forEach(function(y){if(!y.visible())return;const x=y.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});x.width===0&&x.height===0||(s===void 0?(s=x.x,l=x.y,c=x.x+x.width,u=x.y+x.height):(s=Math.min(s,x.x),l=Math.min(l,x.y),c=Math.max(c,x.x+x.width),u=Math.max(u,x.y+x.height)))});const m=this.find("Shape");let w=!1;for(let y=0;y<m.length;y++)if(m[y]._isVisible(this)){w=!0;break}return w&&s!==void 0?f={x:s,y:l,width:c-s,height:u-l}:f={x:0,y:0,width:0,height:0},r?f:this._transformedRect(f,i)}}vs.Container=xs;Ro.Factory.addComponentsGetterSetter(xs,"clip",["x","y","width","height"]);Ro.Factory.addGetterSetter(xs,"clipX",void 0,(0,td.getNumberValidator)());Ro.Factory.addGetterSetter(xs,"clipY",void 0,(0,td.getNumberValidator)());Ro.Factory.addGetterSetter(xs,"clipWidth",void 0,(0,td.getNumberValidator)());Ro.Factory.addGetterSetter(xs,"clipHeight",void 0,(0,td.getNumberValidator)());Ro.Factory.addGetterSetter(xs,"clipFunc");var U5={},Di={};Object.defineProperty(Di,"__esModule",{value:!0});Di.getCapturedShape=xS;Di.createEvent=mg;Di.hasPointerCapture=wS;Di.setPointerCapture=_S;Di.releaseCapture=V5;const vS=Ae,sl=new Map,G5=vS.Konva._global.PointerEvent!==void 0;function xS(t){return sl.get(t)}function mg(t){return{evt:t,pointerId:t.pointerId}}function wS(t,e){return sl.get(t)===e}function _S(t,e){V5(t),e.getStage()&&(sl.set(t,e),G5&&e._fire("gotpointercapture",mg(new PointerEvent("gotpointercapture"))))}function V5(t,e){const n=sl.get(t);if(!n)return;const r=n.getStage();r&&r.content,sl.delete(t),G5&&n._fire("lostpointercapture",mg(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=dt,n=Re,r=vs,i=Ae,s=dr,l=ed,c=Ae,u=Di,f="Stage",p="string",m="px",w="mouseout",y="mouseleave",x="mouseover",C="mouseenter",S="mousemove",_="mousedown",E="mouseup",h="pointermove",k="pointerdown",T="pointerup",N="pointercancel",I="lostpointercapture",M="pointerout",L="pointerleave",A="pointerover",R="pointerenter",j="contextmenu",G="touchstart",U="touchend",O="touchmove",V="touchcancel",$="wheel",D=5,X=[[C,"_pointerenter"],[_,"_pointerdown"],[S,"_pointermove"],[E,"_pointerup"],[y,"_pointerleave"],[G,"_pointerdown"],[O,"_pointermove"],[U,"_pointerup"],[V,"_pointercancel"],[x,"_pointerover"],[$,"_wheel"],[j,"_contextmenu"],[k,"_pointerdown"],[h,"_pointermove"],[T,"_pointerup"],[N,"_pointercancel"],[I,"_lostpointercapture"]],H={mouse:{[M]:w,[L]:y,[A]:x,[R]:C,[h]:S,[k]:_,[T]:E,[N]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[M]:"touchout",[L]:"touchleave",[A]:"touchover",[R]:"touchenter",[h]:O,[k]:G,[T]:U,[N]:V,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[M]:M,[L]:L,[A]:A,[R]:R,[h]:h,[k]:k,[T]:T,[N]:N,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},re=de=>de.indexOf("pointer")>=0?"pointer":de.indexOf("touch")>=0?"touch":"mouse",K=de=>{const B=re(de);if(B==="pointer")return i.Konva.pointerEventsEnabled&&H.pointer;if(B==="touch")return H.touch;if(B==="mouse")return H.mouse};function ne(de={}){return(de.clipFunc||de.clipWidth||de.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),de}const te="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class he extends r.Container{constructor(B){super(ne(B)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ne(this.attrs)}),this._checkVisibility()}_validateAdd(B){const Q=B.getType()==="Layer",J=B.getType()==="FastLayer";Q||J||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const B=this.visible()?"":"none";this.content.style.display=B}setContainer(B){if(typeof B===p){if(B.charAt(0)==="."){const J=B.slice(1);B=document.getElementsByClassName(J)[0]}else{var Q;B.charAt(0)!=="#"?Q=B:Q=B.slice(1),B=document.getElementById(Q)}if(!B)throw"Can not find container in document with id "+Q}return this._setAttr("container",B),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),B.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const B=this.children,Q=B.length;for(let J=0;J<Q;J++)B[J].clear();return this}clone(B){return B||(B={}),B.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,B)}destroy(){super.destroy();const B=this.content;B&&e.Util._isInDocument(B)&&this.container().removeChild(B);const Q=t.stages.indexOf(this);return Q>-1&&t.stages.splice(Q,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const B=this._pointerPositions[0]||this._changedPointerPositions[0];return B?{x:B.x,y:B.y}:(e.Util.warn(te),null)}_getPointerById(B){return this._pointerPositions.find(Q=>Q.id===B)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(B){B=B||{},B.x=B.x||0,B.y=B.y||0,B.width=B.width||this.width(),B.height=B.height||this.height();const Q=new s.SceneCanvas({width:B.width,height:B.height,pixelRatio:B.pixelRatio||1}),J=Q.getContext()._context,ie=this.children;return(B.x||B.y)&&J.translate(-1*B.x,-1*B.y),ie.forEach(function(ce){if(!ce.isVisible())return;const _e=ce._toKonvaCanvas(B);J.drawImage(_e._canvas,B.x,B.y,_e.getWidth()/_e.getPixelRatio(),_e.getHeight()/_e.getPixelRatio())}),Q}getIntersection(B){if(!B)return null;const Q=this.children,J=Q.length,ie=J-1;for(let ce=ie;ce>=0;ce--){const _e=Q[ce].getIntersection(B);if(_e)return _e}return null}_resizeDOM(){const B=this.width(),Q=this.height();this.content&&(this.content.style.width=B+m,this.content.style.height=Q+m),this.bufferCanvas.setSize(B,Q),this.bufferHitCanvas.setSize(B,Q),this.children.forEach(J=>{J.setSize({width:B,height:Q}),J.draw()})}add(B,...Q){if(arguments.length>1){for(let ie=0;ie<arguments.length;ie++)this.add(arguments[ie]);return this}super.add(B);const J=this.children.length;return J>D&&e.Util.warn("The stage has "+J+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),B.setSize({width:this.width(),height:this.height()}),B.draw(),i.Konva.isBrowser&&this.content.appendChild(B.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(B){return u.hasPointerCapture(B,this)}setPointerCapture(B){u.setPointerCapture(B,this)}releaseCapture(B){u.releaseCapture(B,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&X.forEach(([B,Q])=>{this.content.addEventListener(B,J=>{this[Q](J)},{passive:!1})})}_pointerenter(B){this.setPointersPositions(B);const Q=K(B.type);Q&&this._fire(Q.pointerenter,{evt:B,target:this,currentTarget:this})}_pointerover(B){this.setPointersPositions(B);const Q=K(B.type);Q&&this._fire(Q.pointerover,{evt:B,target:this,currentTarget:this})}_getTargetShape(B){let Q=this[B+"targetShape"];return Q&&!Q.getStage()&&(Q=null),Q}_pointerleave(B){const Q=K(B.type),J=re(B.type);if(!Q)return;this.setPointersPositions(B);const ie=this._getTargetShape(J),ce=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;ie&&ce?(ie._fireAndBubble(Q.pointerout,{evt:B}),ie._fireAndBubble(Q.pointerleave,{evt:B}),this._fire(Q.pointerleave,{evt:B,target:this,currentTarget:this}),this[J+"targetShape"]=null):ce&&(this._fire(Q.pointerleave,{evt:B,target:this,currentTarget:this}),this._fire(Q.pointerout,{evt:B,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(B){const Q=K(B.type),J=re(B.type);if(!Q)return;this.setPointersPositions(B);let ie=!1;this._changedPointerPositions.forEach(ce=>{const _e=this.getIntersection(ce);if(l.DD.justDragged=!1,i.Konva["_"+J+"ListenClick"]=!0,!_e||!_e.isListening()){this[J+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&_e.setPointerCapture(ce.id),this[J+"ClickStartShape"]=_e,_e._fireAndBubble(Q.pointerdown,{evt:B,pointerId:ce.id}),ie=!0;const Se=B.type.indexOf("touch")>=0;_e.preventDefault()&&B.cancelable&&Se&&B.preventDefault()}),ie||this._fire(Q.pointerdown,{evt:B,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(B){const Q=K(B.type),J=re(B.type);if(!Q||(i.Konva.isDragging()&&l.DD.node.preventDefault()&&B.cancelable&&B.preventDefault(),this.setPointersPositions(B),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const ce={};let _e=!1;const Se=this._getTargetShape(J);this._changedPointerPositions.forEach(Oe=>{const Ce=u.getCapturedShape(Oe.id)||this.getIntersection(Oe),Qe=Oe.id,Ve={evt:B,pointerId:Qe},tt=Se!==Ce;if(tt&&Se&&(Se._fireAndBubble(Q.pointerout,{...Ve},Ce),Se._fireAndBubble(Q.pointerleave,{...Ve},Ce)),Ce){if(ce[Ce._id])return;ce[Ce._id]=!0}Ce&&Ce.isListening()?(_e=!0,tt&&(Ce._fireAndBubble(Q.pointerover,{...Ve},Se),Ce._fireAndBubble(Q.pointerenter,{...Ve},Se),this[J+"targetShape"]=Ce),Ce._fireAndBubble(Q.pointermove,{...Ve})):Se&&(this._fire(Q.pointerover,{evt:B,target:this,currentTarget:this,pointerId:Qe}),this[J+"targetShape"]=null)}),_e||this._fire(Q.pointermove,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(B){const Q=K(B.type),J=re(B.type);if(!Q)return;this.setPointersPositions(B);const ie=this[J+"ClickStartShape"],ce=this[J+"ClickEndShape"],_e={};let Se=!1;this._changedPointerPositions.forEach(Oe=>{const Ce=u.getCapturedShape(Oe.id)||this.getIntersection(Oe);if(Ce){if(Ce.releaseCapture(Oe.id),_e[Ce._id])return;_e[Ce._id]=!0}const Qe=Oe.id,Ve={evt:B,pointerId:Qe};let tt=!1;i.Konva["_"+J+"InDblClickWindow"]?(tt=!0,clearTimeout(this[J+"DblTimeout"])):l.DD.justDragged||(i.Konva["_"+J+"InDblClickWindow"]=!0,clearTimeout(this[J+"DblTimeout"])),this[J+"DblTimeout"]=setTimeout(function(){i.Konva["_"+J+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Ce&&Ce.isListening()?(Se=!0,this[J+"ClickEndShape"]=Ce,Ce._fireAndBubble(Q.pointerup,{...Ve}),i.Konva["_"+J+"ListenClick"]&&ie&&ie===Ce&&(Ce._fireAndBubble(Q.pointerclick,{...Ve}),tt&&ce&&ce===Ce&&Ce._fireAndBubble(Q.pointerdblclick,{...Ve}))):(this[J+"ClickEndShape"]=null,i.Konva["_"+J+"ListenClick"]&&this._fire(Q.pointerclick,{evt:B,target:this,currentTarget:this,pointerId:Qe}),tt&&this._fire(Q.pointerdblclick,{evt:B,target:this,currentTarget:this,pointerId:Qe}))}),Se||this._fire(Q.pointerup,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+J+"ListenClick"]=!1,B.cancelable&&J!=="touch"&&J!=="pointer"&&B.preventDefault()}_contextmenu(B){this.setPointersPositions(B);const Q=this.getIntersection(this.getPointerPosition());Q&&Q.isListening()?Q._fireAndBubble(j,{evt:B}):this._fire(j,{evt:B,target:this,currentTarget:this})}_wheel(B){this.setPointersPositions(B);const Q=this.getIntersection(this.getPointerPosition());Q&&Q.isListening()?Q._fireAndBubble($,{evt:B}):this._fire($,{evt:B,target:this,currentTarget:this})}_pointercancel(B){this.setPointersPositions(B);const Q=u.getCapturedShape(B.pointerId)||this.getIntersection(this.getPointerPosition());Q&&Q._fireAndBubble(T,u.createEvent(B)),u.releaseCapture(B.pointerId)}_lostpointercapture(B){u.releaseCapture(B.pointerId)}setPointersPositions(B){const Q=this._getContentPosition();let J=null,ie=null;B=B||window.event,B.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(B.touches,ce=>{this._pointerPositions.push({id:ce.identifier,x:(ce.clientX-Q.left)/Q.scaleX,y:(ce.clientY-Q.top)/Q.scaleY})}),Array.prototype.forEach.call(B.changedTouches||B.touches,ce=>{this._changedPointerPositions.push({id:ce.identifier,x:(ce.clientX-Q.left)/Q.scaleX,y:(ce.clientY-Q.top)/Q.scaleY})})):(J=(B.clientX-Q.left)/Q.scaleX,ie=(B.clientY-Q.top)/Q.scaleY,this.pointerPos={x:J,y:ie},this._pointerPositions=[{x:J,y:ie,id:e.Util._getFirstPointerId(B)}],this._changedPointerPositions=[{x:J,y:ie,id:e.Util._getFirstPointerId(B)}])}_setPointerPosition(B){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(B)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const B=this.content.getBoundingClientRect();return{top:B.top,left:B.left,scaleX:B.width/this.content.clientWidth||1,scaleY:B.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const B=this.container();if(!B)throw"Stage has no container. A container is required.";B.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),B.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(B){B.batchDraw()}),this}}t.Stage=he,he.prototype.nodeType=f,(0,c._registerNode)(he),n.Factory.addGetterSetter(he,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(de=>{de.batchDraw()})})})(U5);var vl={},Et={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=Ae,n=dt,r=Re,i=st,s=Ee,l=Ae,c=Di,u="hasShadow",f="shadowRGBA",p="patternImage",m="linearGradient",w="radialGradient";let y;function x(){return y||(y=n.Util.createCanvasElement().getContext("2d"),y)}t.shapes={};function C(L){const A=this.attrs.fillRule;A?L.fill(A):L.fill()}function S(L){L.stroke()}function _(L){const A=this.attrs.fillRule;A?L.fill(A):L.fill()}function E(L){L.stroke()}function h(){this._clearCache(u)}function k(){this._clearCache(f)}function T(){this._clearCache(p)}function N(){this._clearCache(m)}function I(){this._clearCache(w)}class M extends i.Node{constructor(A){super(A);let R;for(;R=n.Util.getRandomColor(),!(R&&!(R in t.shapes)););this.colorKey=R,t.shapes[R]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const R=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(R&&R.setTransform){const j=new n.Transform;j.translate(this.fillPatternX(),this.fillPatternY()),j.rotate(e.Konva.getAngle(this.fillPatternRotation())),j.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),j.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const G=j.getMatrix(),U=typeof DOMMatrix>"u"?{a:G[0],b:G[1],c:G[2],d:G[3],e:G[4],f:G[5]}:new DOMMatrix(G);R.setTransform(U)}return R}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){const A=this.fillLinearGradientColorStops();if(A){const R=x(),j=this.fillLinearGradientStartPoint(),G=this.fillLinearGradientEndPoint(),U=R.createLinearGradient(j.x,j.y,G.x,G.y);for(let O=0;O<A.length;O+=2)U.addColorStop(A[O],A[O+1]);return U}}_getRadialGradient(){return this._getCache(w,this.__getRadialGradient)}__getRadialGradient(){const A=this.fillRadialGradientColorStops();if(A){const R=x(),j=this.fillRadialGradientStartPoint(),G=this.fillRadialGradientEndPoint(),U=R.createRadialGradient(j.x,j.y,this.fillRadialGradientStartRadius(),G.x,G.y,this.fillRadialGradientEndRadius());for(let O=0;O<A.length;O+=2)U.addColorStop(A[O],A[O+1]);return U}}getShadowRGBA(){return this._getCache(f,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const A=n.Util.colorToRGBA(this.shadowColor());if(A)return"rgba("+A.r+","+A.g+","+A.b+","+A.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const A=this.hitStrokeWidth();return A==="auto"?this.hasStroke():this.strokeEnabled()&&!!A}intersects(A){const R=this.getStage();if(!R)return!1;const j=R.bufferHitCanvas;return j.getContext().clear(),this.drawHit(j,void 0,!0),j.context.getImageData(Math.round(A.x),Math.round(A.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(A){var R;if(!((R=this.attrs.perfectDrawEnabled)!==null&&R!==void 0?R:!0))return!1;const G=A||this.hasFill(),U=this.hasStroke(),O=this.getAbsoluteOpacity()!==1;if(G&&U&&O)return!0;const V=this.hasShadow(),$=this.shadowForStrokeEnabled();return!!(G&&U&&V&&$)}setStrokeHitEnabled(A){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),A?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const A=this.size();return{x:this._centroid?-A.width/2:0,y:this._centroid?-A.height/2:0,width:A.width,height:A.height}}getClientRect(A={}){let R=!1,j=this.getParent();for(;j;){if(j.isCached()){R=!0;break}j=j.getParent()}const G=A.skipTransform,U=A.relativeTo||R&&this.getStage()||void 0,O=this.getSelfRect(),$=!A.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,D=O.width+$,X=O.height+$,H=!A.skipShadow&&this.hasShadow(),re=H?this.shadowOffsetX():0,K=H?this.shadowOffsetY():0,ne=D+Math.abs(re),te=X+Math.abs(K),he=H&&this.shadowBlur()||0,de=ne+he*2,B=te+he*2,Q={width:de,height:B,x:-($/2+he)+Math.min(re,0)+O.x,y:-($/2+he)+Math.min(K,0)+O.y};return G?Q:this._transformedRect(Q,U)}drawScene(A,R,j){const G=this.getLayer();let U=A||G.getCanvas(),O=U.getContext(),V=this._getCanvasCache(),$=this.getSceneFunc(),D=this.hasShadow(),X,H;const re=U.isCache,K=R===this;if(!this.isVisible()&&!K)return this;if(V){O.save();const te=this.getAbsoluteTransform(R).getMatrix();return O.transform(te[0],te[1],te[2],te[3],te[4],te[5]),this._drawCachedSceneCanvas(O),O.restore(),this}if(!$)return this;if(O.save(),this._useBufferCanvas()&&!re){X=this.getStage();const te=j||X.bufferCanvas;H=te.getContext(),H.clear(),H.save(),H._applyLineJoin(this);var ne=this.getAbsoluteTransform(R).getMatrix();H.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),$.call(this,H,this),H.restore();const he=te.pixelRatio;D&&O._applyShadow(this),O._applyOpacity(this),O._applyGlobalCompositeOperation(this),O.drawImage(te._canvas,0,0,te.width/he,te.height/he)}else{if(O._applyLineJoin(this),!K){var ne=this.getAbsoluteTransform(R).getMatrix();O.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),O._applyOpacity(this),O._applyGlobalCompositeOperation(this)}D&&O._applyShadow(this),$.call(this,O,this)}return O.restore(),this}drawHit(A,R,j=!1){if(!this.shouldDrawHit(R,j))return this;const G=this.getLayer(),U=A||G.hitCanvas,O=U&&U.getContext(),V=this.hitFunc()||this.sceneFunc(),$=this._getCanvasCache(),D=$&&$.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),D){O.save();const H=this.getAbsoluteTransform(R).getMatrix();return O.transform(H[0],H[1],H[2],H[3],H[4],H[5]),this._drawCachedHitCanvas(O),O.restore(),this}if(!V)return this;if(O.save(),O._applyLineJoin(this),!(this===R)){const H=this.getAbsoluteTransform(R).getMatrix();O.transform(H[0],H[1],H[2],H[3],H[4],H[5])}return V.call(this,O,this),O.restore(),this}drawHitFromCache(A=0){const R=this._getCanvasCache(),j=this._getCachedSceneCanvas(),G=R.hit,U=G.getContext(),O=G.getWidth(),V=G.getHeight();U.clear(),U.drawImage(j._canvas,0,0,O,V);try{const $=U.getImageData(0,0,O,V),D=$.data,X=D.length,H=n.Util._hexToRgb(this.colorKey);for(let re=0;re<X;re+=4)D[re+3]>A?(D[re]=H.r,D[re+1]=H.g,D[re+2]=H.b,D[re+3]=255):D[re+3]=0;U.putImageData($,0,0)}catch($){n.Util.error("Unable to draw hit graph from cached scene canvas. "+$.message)}return this}hasPointerCapture(A){return c.hasPointerCapture(A,this)}setPointerCapture(A){c.setPointerCapture(A,this)}releaseCapture(A){c.releaseCapture(A,this)}}t.Shape=M,M.prototype._fillFunc=C,M.prototype._strokeFunc=S,M.prototype._fillFuncHit=_,M.prototype._strokeFuncHit=E,M.prototype._centroid=!1,M.prototype.nodeType="Shape",(0,l._registerNode)(M),M.prototype.eventListeners={},M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",h),M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",k),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",T),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",N),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",I),r.Factory.addGetterSetter(M,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(M,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(M,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(M,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(M,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(M,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(M,"lineJoin"),r.Factory.addGetterSetter(M,"lineCap"),r.Factory.addGetterSetter(M,"sceneFunc"),r.Factory.addGetterSetter(M,"hitFunc"),r.Factory.addGetterSetter(M,"dash"),r.Factory.addGetterSetter(M,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(M,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(M,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillPatternImage"),r.Factory.addGetterSetter(M,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(M,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(M,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(M,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(M,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(M,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(M,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(M,"fillEnabled",!0),r.Factory.addGetterSetter(M,"strokeEnabled",!0),r.Factory.addGetterSetter(M,"shadowEnabled",!0),r.Factory.addGetterSetter(M,"dashEnabled",!0),r.Factory.addGetterSetter(M,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(M,"fillPriority","color"),r.Factory.addComponentsGetterSetter(M,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(M,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(M,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(M,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(M,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(M,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(M,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(M,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(M,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(M,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(M,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(M,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(M,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(M,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(M,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(M,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(M,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(M,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(M,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(M,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(M,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(M,"fillPatternRotation",0),r.Factory.addGetterSetter(M,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(M,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Et);Object.defineProperty(vl,"__esModule",{value:!0});vl.Layer=void 0;const Br=dt,Hh=vs,Ws=st,yg=Re,f2=dr,SS=Ee,kS=Et,CS=Ae,TS="#",ES="beforeDraw",bS="draw",W5=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],NS=W5.length;let Lo=class extends Hh.Container{constructor(e){super(e),this.canvas=new f2.SceneCanvas,this.hitCanvas=new f2.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),e<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[e+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Ws.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Ws.Node.prototype.moveUp.call(this))return!1;const n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Ws.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Ws.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return Ws.Node.prototype.remove.call(this),e&&e.parentNode&&Br.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:n}){return this.canvas.setSize(e,n),this.hitCanvas.setSize(e,n),this._setSmoothEnabled(),this}_validateAdd(e){const n=e.getType();n!=="Group"&&n!=="Shape"&&Br.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),Ws.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Br.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Br.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Br.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let n=1,r=!1;for(;;){for(let i=0;i<NS;i++){const s=W5[i],l=this._getIntersection({x:e.x+s.x*n,y:e.y+s.y*n}),c=l.shape;if(c)return c;if(r=!!l.antialiased,!l.antialiased)break}if(r)n+=1;else return null}}_getIntersection(e){const n=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*n),Math.round(e.y*n),1,1).data,i=r[3];if(i===255){const s=Br.Util._rgbToHex(r[0],r[1],r[2]),l=kS.shapes[TS+s];return l?{shape:l}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,n){const r=this.getLayer(),i=e||r&&r.getCanvas();return this._fire(ES,{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),Hh.Container.prototype.drawScene.call(this,i,n),this._fire(bS,{node:this}),this}drawHit(e,n){const r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),Hh.Container.prototype.drawHit.call(this,i,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Br.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Br.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Br.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};vl.Layer=Lo;Lo.prototype.nodeType="Layer";(0,CS._registerNode)(Lo);yg.Factory.addGetterSetter(Lo,"imageSmoothingEnabled",!0);yg.Factory.addGetterSetter(Lo,"clearBeforeDraw",!0);yg.Factory.addGetterSetter(Lo,"hitGraphEnabled",!0,(0,SS.getBooleanValidator)());var nd={};Object.defineProperty(nd,"__esModule",{value:!0});nd.FastLayer=void 0;const PS=dt,MS=vl,AS=Ae;class vg extends MS.Layer{constructor(e){super(e),this.listening(!1),PS.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}nd.FastLayer=vg;vg.prototype.nodeType="FastLayer";(0,AS._registerNode)(vg);var Fo={};Object.defineProperty(Fo,"__esModule",{value:!0});Fo.Group=void 0;const IS=dt,RS=vs,LS=Ae;let xg=class extends RS.Container{_validateAdd(e){const n=e.getType();n!=="Group"&&n!=="Shape"&&IS.Util.throw("You may only add groups and shapes to groups.")}};Fo.Group=xg;xg.prototype.nodeType="Group";(0,LS._registerNode)(xg);var jo={};Object.defineProperty(jo,"__esModule",{value:!0});jo.Animation=void 0;const Yh=Ae,h2=dt,Xh=function(){return Yh.glob.performance&&Yh.glob.performance.now?function(){return Yh.glob.performance.now()}:function(){return new Date().getTime()}}();class Er{constructor(e,n){this.id=Er.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Xh(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){let n=[];return e&&(n=Array.isArray(e)?e:[e]),this.layers=n,this}getLayers(){return this.layers}addLayer(e){const n=this.layers,r=n.length;for(let i=0;i<r;i++)if(n[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const n=Er.animations,r=n.length;for(let i=0;i<r;i++)if(n[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Xh(),Er._addAnimation(this),this}stop(){return Er._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const n=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===n){this.animations.splice(s,1);break}}static _runFrames(){const e={},n=this.animations;for(let r=0;r<n.length;r++){const i=n[r],s=i.layers,l=i.func;i._updateFrameObject(Xh());const c=s.length;let u;if(l?u=l.call(i,i.frame)!==!1:u=!0,!!u)for(let f=0;f<c;f++){const p=s[f];p._id!==void 0&&(e[p._id]=p)}}for(const r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=Er;e.animations.length?(e._runFrames(),h2.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,h2.Util.requestAnimFrame(this._animationLoop))}}jo.Animation=Er;Er.animations=[];Er.animIdCounter=0;Er.animRunning=!1;var $5={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=dt,n=jo,r=st,i=Ae,s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},l=1,c=2,u=3,f=["fill","stroke","shadowColor"];let p=0;class m{constructor(x,C,S,_,E,h,k){this.prop=x,this.propFunc=C,this.begin=_,this._pos=_,this.duration=h,this._change=0,this.prevPos=0,this.yoyo=k,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=E-this.begin,this.pause()}fire(x){const C=this[x];C&&C()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=c,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=u,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===c?this.setTime(x):this.state===u&&this.setTime(this.duration-x)}pause(){this.state=l,this.fire("onPause")}getTimer(){return new Date().getTime()}}class w{constructor(x){const C=this,S=x.node,_=S._id,E=x.easing||t.Easings.Linear,h=!!x.yoyo;let k,T;typeof x.duration>"u"?k=.3:x.duration===0?k=.001:k=x.duration,this.node=S,this._id=p++;const N=S.getLayer()||(S instanceof i.Konva.Stage?S.getLayers():null);N||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){C.tween.onEnterFrame()},N),this.tween=new m(T,function(I){C._tweenFunc(I)},E,0,1,k*1e3,h),this._addListeners(),w.attrs[_]||(w.attrs[_]={}),w.attrs[_][this._id]||(w.attrs[_][this._id]={}),w.tweens[_]||(w.tweens[_]={});for(T in x)s[T]===void 0&&this._addAttr(T,x[T]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,C){const S=this.node,_=S._id;let E,h,k,T,N;const I=w.tweens[_][x];I&&delete w.attrs[_][I][x];let M=S.getAttr(x);if(e.Util._isArray(C))if(E=[],h=Math.max(C.length,M.length),x==="points"&&C.length!==M.length&&(C.length>M.length?(T=M,M=e.Util._prepareArrayForTween(M,C,S.closed())):(k=C,C=e.Util._prepareArrayForTween(C,M,S.closed()))),x.indexOf("fill")===0)for(let L=0;L<h;L++)if(L%2===0)E.push(C[L]-M[L]);else{const A=e.Util.colorToRGBA(M[L]);N=e.Util.colorToRGBA(C[L]),M[L]=A,E.push({r:N.r-A.r,g:N.g-A.g,b:N.b-A.b,a:N.a-A.a})}else for(let L=0;L<h;L++)E.push(C[L]-M[L]);else f.indexOf(x)!==-1?(M=e.Util.colorToRGBA(M),N=e.Util.colorToRGBA(C),E={r:N.r-M.r,g:N.g-M.g,b:N.b-M.b,a:N.a-M.a}):E=C-M;w.attrs[_][this._id][x]={start:M,diff:E,end:C,trueEnd:k,trueStart:T},w.tweens[_][x]=this._id}_tweenFunc(x){const C=this.node,S=w.attrs[C._id][this._id];let _,E,h,k,T,N,I,M;for(_ in S){if(E=S[_],h=E.start,k=E.diff,M=E.end,e.Util._isArray(h))if(T=[],I=Math.max(h.length,M.length),_.indexOf("fill")===0)for(N=0;N<I;N++)N%2===0?T.push((h[N]||0)+k[N]*x):T.push("rgba("+Math.round(h[N].r+k[N].r*x)+","+Math.round(h[N].g+k[N].g*x)+","+Math.round(h[N].b+k[N].b*x)+","+(h[N].a+k[N].a*x)+")");else for(N=0;N<I;N++)T.push((h[N]||0)+k[N]*x);else f.indexOf(_)!==-1?T="rgba("+Math.round(h.r+k.r*x)+","+Math.round(h.g+k.g*x)+","+Math.round(h.b+k.b*x)+","+(h.a+k.a*x)+")":T=h+k*x;C.setAttr(_,T)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,C=w.attrs[x._id][this._id];C.points&&C.points.trueEnd&&x.setAttr("points",C.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,C=w.attrs[x._id][this._id];C.points&&C.points.trueStart&&x.points(C.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const x=this.node._id,C=this._id,S=w.tweens[x];this.pause();for(const _ in S)delete w.tweens[x][_];delete w.attrs[x][C]}}t.Tween=w,w.attrs={},w.tweens={},r.Node.prototype.to=function(y){const x=y.onFinish;y.node=this,y.onFinish=function(){this.destroy(),x&&x()},new w(y).play()},t.Easings={BackEaseIn(y,x,C,S){return C*(y/=S)*y*((1.70158+1)*y-1.70158)+x},BackEaseOut(y,x,C,S){return C*((y=y/S-1)*y*((1.70158+1)*y+1.70158)+1)+x},BackEaseInOut(y,x,C,S){let _=1.70158;return(y/=S/2)<1?C/2*(y*y*(((_*=1.525)+1)*y-_))+x:C/2*((y-=2)*y*(((_*=1.525)+1)*y+_)+2)+x},ElasticEaseIn(y,x,C,S,_,E){let h=0;return y===0?x:(y/=S)===1?x+C:(E||(E=S*.3),!_||_<Math.abs(C)?(_=C,h=E/4):h=E/(2*Math.PI)*Math.asin(C/_),-(_*Math.pow(2,10*(y-=1))*Math.sin((y*S-h)*(2*Math.PI)/E))+x)},ElasticEaseOut(y,x,C,S,_,E){let h=0;return y===0?x:(y/=S)===1?x+C:(E||(E=S*.3),!_||_<Math.abs(C)?(_=C,h=E/4):h=E/(2*Math.PI)*Math.asin(C/_),_*Math.pow(2,-10*y)*Math.sin((y*S-h)*(2*Math.PI)/E)+C+x)},ElasticEaseInOut(y,x,C,S,_,E){let h=0;return y===0?x:(y/=S/2)===2?x+C:(E||(E=S*(.3*1.5)),!_||_<Math.abs(C)?(_=C,h=E/4):h=E/(2*Math.PI)*Math.asin(C/_),y<1?-.5*(_*Math.pow(2,10*(y-=1))*Math.sin((y*S-h)*(2*Math.PI)/E))+x:_*Math.pow(2,-10*(y-=1))*Math.sin((y*S-h)*(2*Math.PI)/E)*.5+C+x)},BounceEaseOut(y,x,C,S){return(y/=S)<1/2.75?C*(7.5625*y*y)+x:y<2/2.75?C*(7.5625*(y-=1.5/2.75)*y+.75)+x:y<2.5/2.75?C*(7.5625*(y-=2.25/2.75)*y+.9375)+x:C*(7.5625*(y-=2.625/2.75)*y+.984375)+x},BounceEaseIn(y,x,C,S){return C-t.Easings.BounceEaseOut(S-y,0,C,S)+x},BounceEaseInOut(y,x,C,S){return y<S/2?t.Easings.BounceEaseIn(y*2,0,C,S)*.5+x:t.Easings.BounceEaseOut(y*2-S,0,C,S)*.5+C*.5+x},EaseIn(y,x,C,S){return C*(y/=S)*y+x},EaseOut(y,x,C,S){return-C*(y/=S)*(y-2)+x},EaseInOut(y,x,C,S){return(y/=S/2)<1?C/2*y*y+x:-C/2*(--y*(y-2)-1)+x},StrongEaseIn(y,x,C,S){return C*(y/=S)*y*y*y*y+x},StrongEaseOut(y,x,C,S){return C*((y=y/S-1)*y*y*y*y+1)+x},StrongEaseInOut(y,x,C,S){return(y/=S/2)<1?C/2*y*y*y*y*y+x:C/2*((y-=2)*y*y*y*y+2)+x},Linear(y,x,C,S){return C*y/S+x}}})($5);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=Ae,n=dt,r=st,i=vs,s=U5,l=vl,c=nd,u=Fo,f=ed,p=Et,m=jo,w=$5,y=Xr,x=dr;t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:l.Layer,FastLayer:c.FastLayer,Group:u.Group,DD:f.DD,Shape:p.Shape,shapes:p.shapes,Animation:m.Animation,Tween:w.Tween,Easings:w.Easings,Context:y.Context,Canvas:x.Canvas}),t.default=t.Konva})(Pc);var rd={};Object.defineProperty(rd,"__esModule",{value:!0});rd.Arc=void 0;const id=Re,FS=Et,p2=Ae,sd=Ee,jS=Ae;class ni extends FS.Shape{_sceneFunc(e){const n=p2.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,r),e.arc(0,0,this.innerRadius(),n,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),r=this.clockwise(),i=p2.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),l=1,c=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),u=Math.sin(Math.min(i,Math.PI/2)),f=s*(s>0?e:n),p=l*n,m=c*(c>0?e:n),w=u*(u>0?n:e);return{x:f,y:r?-1*w:m,width:p-f,height:w-m}}}rd.Arc=ni;ni.prototype._centroid=!0;ni.prototype.className="Arc";ni.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,jS._registerNode)(ni);id.Factory.addGetterSetter(ni,"innerRadius",0,(0,sd.getNumberValidator)());id.Factory.addGetterSetter(ni,"outerRadius",0,(0,sd.getNumberValidator)());id.Factory.addGetterSetter(ni,"angle",0,(0,sd.getNumberValidator)());id.Factory.addGetterSetter(ni,"clockwise",!1,(0,sd.getBooleanValidator)());var od={},xl={};Object.defineProperty(xl,"__esModule",{value:!0});xl.Line=void 0;const ad=Re,OS=Ae,DS=Et,H5=Ee;function lp(t,e,n,r,i,s,l){const c=Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2)),u=Math.sqrt(Math.pow(i-n,2)+Math.pow(s-r,2)),f=l*c/(c+u),p=l*u/(c+u),m=n-f*(i-t),w=r-f*(s-e),y=n+p*(i-t),x=r+p*(s-e);return[m,w,y,x]}function g2(t,e){const n=t.length,r=[];for(let i=2;i<n-2;i+=2){const s=lp(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e);isNaN(s[0])||(r.push(s[0]),r.push(s[1]),r.push(t[i]),r.push(t[i+1]),r.push(s[2]),r.push(s[3]))}return r}let zi=class extends DS.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){let n=this.points(),r=n.length,i=this.tension(),s=this.closed(),l=this.bezier(),c,u,f;if(r){if(e.beginPath(),e.moveTo(n[0],n[1]),i!==0&&r>4){for(c=this.getTensionPoints(),u=c.length,f=s?0:4,s||e.quadraticCurveTo(c[0],c[1],c[2],c[3]);f<u-2;)e.bezierCurveTo(c[f++],c[f++],c[f++],c[f++],c[f++],c[f++]);s||e.quadraticCurveTo(c[u-2],c[u-1],n[r-2],n[r-1])}else if(l)for(f=2;f<r;)e.bezierCurveTo(n[f++],n[f++],n[f++],n[f++],n[f++],n[f++]);else for(f=2;f<r;f+=2)e.lineTo(n[f],n[f+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():g2(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),n=e.length,r=this.tension(),i=lp(e[n-2],e[n-1],e[0],e[1],e[2],e[3],r),s=lp(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],r),l=g2(e,r);return[i[2],i[3]].concat(l).concat([s[0],s[1],e[n-2],e[n-1],s[2],s[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let n=e[0],r=e[0],i=e[1],s=e[1],l,c;for(let u=0;u<e.length/2;u++)l=e[u*2],c=e[u*2+1],n=Math.min(n,l),r=Math.max(r,l),i=Math.min(i,c),s=Math.max(s,c);return{x:n,y:i,width:r-n,height:s-i}}};xl.Line=zi;zi.prototype.className="Line";zi.prototype._attrsAffectingSize=["points","bezier","tension"];(0,OS._registerNode)(zi);ad.Factory.addGetterSetter(zi,"closed",!1);ad.Factory.addGetterSetter(zi,"bezier",!1);ad.Factory.addGetterSetter(zi,"tension",0,(0,H5.getNumberValidator)());ad.Factory.addGetterSetter(zi,"points",[],(0,H5.getNumberArrayValidator)());var Oo={},Y5={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(l,c,u)=>{let f,p;const w=u/2;f=0;for(let y=0;y<20;y++)p=w*t.tValues[20][y]+w,f+=t.cValues[20][y]*r(l,c,p);return w*f};t.getCubicArcLength=e;const n=(l,c,u)=>{u===void 0&&(u=1);const f=l[0]-2*l[1]+l[2],p=c[0]-2*c[1]+c[2],m=2*l[1]-2*l[0],w=2*c[1]-2*c[0],y=4*(f*f+p*p),x=4*(f*m+p*w),C=m*m+w*w;if(y===0)return u*Math.sqrt(Math.pow(l[2]-l[0],2)+Math.pow(c[2]-c[0],2));const S=x/(2*y),_=C/y,E=u+S,h=_-S*S,k=E*E+h>0?Math.sqrt(E*E+h):0,T=S*S+h>0?Math.sqrt(S*S+h):0,N=S+Math.sqrt(S*S+h)!==0?h*Math.log(Math.abs((E+k)/(S+T))):0;return Math.sqrt(y)/2*(E*k-S*T+N)};t.getQuadraticArcLength=n;function r(l,c,u){const f=i(1,u,l),p=i(1,u,c),m=f*f+p*p;return Math.sqrt(m)}const i=(l,c,u)=>{const f=u.length-1;let p,m;if(f===0)return 0;if(l===0){m=0;for(let w=0;w<=f;w++)m+=t.binomialCoefficients[f][w]*Math.pow(1-c,f-w)*Math.pow(c,w)*u[w];return m}else{p=new Array(f);for(let w=0;w<f;w++)p[w]=f*(u[w+1]-u[w]);return i(l-1,c,p)}},s=(l,c,u)=>{let f=1,p=l/c,m=(l-u(p))/c,w=0;for(;f>.001;){const y=u(p+m),x=Math.abs(l-y)/c;if(x<f)f=x,p+=m;else{const C=u(p-m),S=Math.abs(l-C)/c;S<f?(f=S,p-=m):m/=2}if(w++,w>500)break}return p};t.t2length=s})(Y5);Object.defineProperty(Oo,"__esModule",{value:!0});Oo.Path=void 0;const zS=Re,BS=Et,US=Ae,$s=Y5;class kt extends BS.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=kt.parsePathData(this.data()),this.pathLength=kt.getPathLength(this.dataArray)}_sceneFunc(e){const n=this.dataArray;e.beginPath();let r=!1;for(let C=0;C<n.length;C++){const S=n[C].command,_=n[C].points;switch(S){case"L":e.lineTo(_[0],_[1]);break;case"M":e.moveTo(_[0],_[1]);break;case"C":e.bezierCurveTo(_[0],_[1],_[2],_[3],_[4],_[5]);break;case"Q":e.quadraticCurveTo(_[0],_[1],_[2],_[3]);break;case"A":var i=_[0],s=_[1],l=_[2],c=_[3],u=_[4],f=_[5],p=_[6],m=_[7],w=l>c?l:c,y=l>c?1:l/c,x=l>c?c/l:1;e.translate(i,s),e.rotate(p),e.scale(y,x),e.arc(0,0,w,u,u+f,1-m),e.scale(1/y,1/x),e.rotate(-p),e.translate(-i,-s);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],p=u.points[5],m=u.points[4]+p;let w=Math.PI/180;if(Math.abs(f-m)<w&&(w=Math.abs(f-m)),p<0)for(let y=f-w;y>m;y-=w){const x=kt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],y,0);e.push(x.x,x.y)}else for(let y=f+w;y<m;y+=w){const x=kt.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],y,0);e.push(x.x,x.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const p=kt.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);e.push(p.x,p.y)}else e=e.concat(u.points)});let n=e[0],r=e[0],i=e[1],s=e[1],l,c;for(let u=0;u<e.length/2;u++)l=e[u*2],c=e[u*2+1],isNaN(l)||(n=Math.min(n,l),r=Math.max(r,l)),isNaN(c)||(i=Math.min(i,c),s=Math.max(s,c));return{x:n,y:i,width:r-n,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return kt.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,n,r,i){return Math.sqrt((r-e)*(r-e)+(i-n)*(i-n))}static getPathLength(e){let n=0;for(let r=0;r<e.length;++r)n+=e[r].pathLength;return n}static getPointAtLengthOfDataArray(e,n){let r,i=0,s=n.length;if(!s)return null;for(;i<s&&e>n[i].pathLength;)e-=n[i].pathLength,++i;if(i===s)return r=n[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return r=n[i].points.slice(0,2),{x:r[0],y:r[1]};const l=n[i],c=l.points;switch(l.command){case"L":return kt.getPointOnLine(e,l.start.x,l.start.y,c[0],c[1]);case"C":return kt.getPointOnCubicBezier((0,$s.t2length)(e,kt.getPathLength(n),C=>(0,$s.getCubicArcLength)([l.start.x,c[0],c[2],c[4]],[l.start.y,c[1],c[3],c[5]],C)),l.start.x,l.start.y,c[0],c[1],c[2],c[3],c[4],c[5]);case"Q":return kt.getPointOnQuadraticBezier((0,$s.t2length)(e,kt.getPathLength(n),C=>(0,$s.getQuadraticArcLength)([l.start.x,c[0],c[2]],[l.start.y,c[1],c[3]],C)),l.start.x,l.start.y,c[0],c[1],c[2],c[3]);case"A":var u=c[0],f=c[1],p=c[2],m=c[3],w=c[4],y=c[5],x=c[6];return w+=y*e/l.pathLength,kt.getPointOnEllipticalArc(u,f,p,m,w,x)}return null}static getPointOnLine(e,n,r,i,s,l,c){l=l??n,c=c??r;const u=this.getLineLength(n,r,i,s);if(u<1e-10)return{x:n,y:r};if(i===n)return{x:l,y:c+(s>r?e:-e)};const f=(s-r)/(i-n),p=Math.sqrt(e*e/(1+f*f))*(i<n?-1:1),m=f*p;if(Math.abs(c-r-f*(l-n))<1e-10)return{x:l+p,y:c+m};const w=((l-n)*(i-n)+(c-r)*(s-r))/(u*u),y=n+w*(i-n),x=r+w*(s-r),C=this.getLineLength(l,c,y,x),S=Math.sqrt(e*e-C*C),_=Math.sqrt(S*S/(1+f*f))*(i<n?-1:1),E=f*_;return{x:y+_,y:x+E}}static getPointOnCubicBezier(e,n,r,i,s,l,c,u,f){function p(S){return S*S*S}function m(S){return 3*S*S*(1-S)}function w(S){return 3*S*(1-S)*(1-S)}function y(S){return(1-S)*(1-S)*(1-S)}const x=u*p(e)+l*m(e)+i*w(e)+n*y(e),C=f*p(e)+c*m(e)+s*w(e)+r*y(e);return{x,y:C}}static getPointOnQuadraticBezier(e,n,r,i,s,l,c){function u(y){return y*y}function f(y){return 2*y*(1-y)}function p(y){return(1-y)*(1-y)}const m=l*u(e)+i*f(e)+n*p(e),w=c*u(e)+s*f(e)+r*p(e);return{x:m,y:w}}static getPointOnEllipticalArc(e,n,r,i,s,l){const c=Math.cos(l),u=Math.sin(l),f={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(f.x*c-f.y*u),y:n+(f.x*u+f.y*c)}}static parsePathData(e){if(!e)return[];let n=e;const r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(var i=0;i<r.length;i++)n=n.replace(new RegExp(r[i],"g"),"|"+r[i]);const s=n.split("|"),l=[],c=[];let u=0,f=0;const p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let m;for(i=1;i<s.length;i++){let M=s[i],L=M.charAt(0);for(M=M.slice(1),c.length=0;m=p.exec(M);)c.push(m[0]);const A=[];for(let R=0,j=c.length;R<j;R++){if(c[R]==="00"){A.push(0,0);continue}const G=parseFloat(c[R]);isNaN(G)?A.push(0):A.push(G)}for(;A.length>0&&!isNaN(A[0]);){let R="",j=[];const G=u,U=f;var w,y,x,C,S,_,E,h,k,T;switch(L){case"l":u+=A.shift(),f+=A.shift(),R="L",j.push(u,f);break;case"L":u=A.shift(),f=A.shift(),j.push(u,f);break;case"m":var N=A.shift(),I=A.shift();if(u+=N,f+=I,R="M",l.length>2&&l[l.length-1].command==="z"){for(let O=l.length-2;O>=0;O--)if(l[O].command==="M"){u=l[O].points[0]+N,f=l[O].points[1]+I;break}}j.push(u,f),L="l";break;case"M":u=A.shift(),f=A.shift(),R="M",j.push(u,f),L="L";break;case"h":u+=A.shift(),R="L",j.push(u,f);break;case"H":u=A.shift(),R="L",j.push(u,f);break;case"v":f+=A.shift(),R="L",j.push(u,f);break;case"V":f=A.shift(),R="L",j.push(u,f);break;case"C":j.push(A.shift(),A.shift(),A.shift(),A.shift()),u=A.shift(),f=A.shift(),j.push(u,f);break;case"c":j.push(u+A.shift(),f+A.shift(),u+A.shift(),f+A.shift()),u+=A.shift(),f+=A.shift(),R="C",j.push(u,f);break;case"S":y=u,x=f,w=l[l.length-1],w.command==="C"&&(y=u+(u-w.points[2]),x=f+(f-w.points[3])),j.push(y,x,A.shift(),A.shift()),u=A.shift(),f=A.shift(),R="C",j.push(u,f);break;case"s":y=u,x=f,w=l[l.length-1],w.command==="C"&&(y=u+(u-w.points[2]),x=f+(f-w.points[3])),j.push(y,x,u+A.shift(),f+A.shift()),u+=A.shift(),f+=A.shift(),R="C",j.push(u,f);break;case"Q":j.push(A.shift(),A.shift()),u=A.shift(),f=A.shift(),j.push(u,f);break;case"q":j.push(u+A.shift(),f+A.shift()),u+=A.shift(),f+=A.shift(),R="Q",j.push(u,f);break;case"T":y=u,x=f,w=l[l.length-1],w.command==="Q"&&(y=u+(u-w.points[0]),x=f+(f-w.points[1])),u=A.shift(),f=A.shift(),R="Q",j.push(y,x,u,f);break;case"t":y=u,x=f,w=l[l.length-1],w.command==="Q"&&(y=u+(u-w.points[0]),x=f+(f-w.points[1])),u+=A.shift(),f+=A.shift(),R="Q",j.push(y,x,u,f);break;case"A":C=A.shift(),S=A.shift(),_=A.shift(),E=A.shift(),h=A.shift(),k=u,T=f,u=A.shift(),f=A.shift(),R="A",j=this.convertEndpointToCenterParameterization(k,T,u,f,E,h,C,S,_);break;case"a":C=A.shift(),S=A.shift(),_=A.shift(),E=A.shift(),h=A.shift(),k=u,T=f,u+=A.shift(),f+=A.shift(),R="A",j=this.convertEndpointToCenterParameterization(k,T,u,f,E,h,C,S,_);break}l.push({command:R||L,points:j,start:{x:G,y:U},pathLength:this.calcLength(G,U,R||L,j)})}(L==="z"||L==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(e,n,r,i){let s,l,c,u;const f=kt;switch(r){case"L":return f.getLineLength(e,n,i[0],i[1]);case"C":return(0,$s.getCubicArcLength)([e,i[0],i[2],i[4]],[n,i[1],i[3],i[5]],1);case"Q":return(0,$s.getQuadraticArcLength)([e,i[0],i[2]],[n,i[1],i[3]],1);case"A":s=0;var p=i[4],m=i[5],w=i[4]+m,y=Math.PI/180;if(Math.abs(p-w)<y&&(y=Math.abs(p-w)),l=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),m<0)for(u=p-y;u>w;u-=y)c=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),s+=f.getLineLength(l.x,l.y,c.x,c.y),l=c;else for(u=p+y;u<w;u+=y)c=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),s+=f.getLineLength(l.x,l.y,c.x,c.y),l=c;return c=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],w,0),s+=f.getLineLength(l.x,l.y,c.x,c.y),s}return 0}static convertEndpointToCenterParameterization(e,n,r,i,s,l,c,u,f){const p=f*(Math.PI/180),m=Math.cos(p)*(e-r)/2+Math.sin(p)*(n-i)/2,w=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(n-i)/2,y=m*m/(c*c)+w*w/(u*u);y>1&&(c*=Math.sqrt(y),u*=Math.sqrt(y));let x=Math.sqrt((c*c*(u*u)-c*c*(w*w)-u*u*(m*m))/(c*c*(w*w)+u*u*(m*m)));s===l&&(x*=-1),isNaN(x)&&(x=0);const C=x*c*w/u,S=x*-u*m/c,_=(e+r)/2+Math.cos(p)*C-Math.sin(p)*S,E=(n+i)/2+Math.sin(p)*C+Math.cos(p)*S,h=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},k=function(A,R){return(A[0]*R[0]+A[1]*R[1])/(h(A)*h(R))},T=function(A,R){return(A[0]*R[1]<A[1]*R[0]?-1:1)*Math.acos(k(A,R))},N=T([1,0],[(m-C)/c,(w-S)/u]),I=[(m-C)/c,(w-S)/u],M=[(-1*m-C)/c,(-1*w-S)/u];let L=T(I,M);return k(I,M)<=-1&&(L=Math.PI),k(I,M)>=1&&(L=0),l===0&&L>0&&(L=L-2*Math.PI),l===1&&L<0&&(L=L+2*Math.PI),[_,E,c,u,N,L,p,l]}}Oo.Path=kt;kt.prototype.className="Path";kt.prototype._attrsAffectingSize=["data"];(0,US._registerNode)(kt);zS.Factory.addGetterSetter(kt,"data");Object.defineProperty(od,"__esModule",{value:!0});od.Arrow=void 0;const ld=Re,GS=xl,X5=Ee,VS=Ae,m2=Oo;let ws=class extends GS.Line{_sceneFunc(e){super._sceneFunc(e);const n=Math.PI*2,r=this.points();let i=r;const s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());const l=this.pointerLength(),c=r.length;let u,f;if(s){const w=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[c-2],r[c-1]],y=m2.Path.calcLength(i[i.length-4],i[i.length-3],"C",w),x=m2.Path.getPointOnQuadraticBezier(Math.min(1,1-l/y),w[0],w[1],w[2],w[3],w[4],w[5]);u=r[c-2]-x.x,f=r[c-1]-x.y}else u=r[c-2]-r[c-4],f=r[c-1]-r[c-3];const p=(Math.atan2(f,u)+n)%n,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[c-2],r[c-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-l,m/2),e.lineTo(-l,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(u=(i[0]+i[2])/2-r[0],f=(i[1]+i[3])/2-r[1]):(u=r[2]-r[0],f=r[3]-r[1]),e.rotate((Math.atan2(-f,-u)+n)%n),e.moveTo(0,0),e.lineTo(-l,m/2),e.lineTo(-l,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x,y:e.y-n,width:e.width,height:e.height+n*2}}};od.Arrow=ws;ws.prototype.className="Arrow";(0,VS._registerNode)(ws);ld.Factory.addGetterSetter(ws,"pointerLength",10,(0,X5.getNumberValidator)());ld.Factory.addGetterSetter(ws,"pointerWidth",10,(0,X5.getNumberValidator)());ld.Factory.addGetterSetter(ws,"pointerAtBeginning",!1);ld.Factory.addGetterSetter(ws,"pointerAtEnding",!0);var ud={};Object.defineProperty(ud,"__esModule",{value:!0});ud.Circle=void 0;const WS=Re,$S=Et,HS=Ee,YS=Ae;let Do=class extends $S.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};ud.Circle=Do;Do.prototype._centroid=!0;Do.prototype.className="Circle";Do.prototype._attrsAffectingSize=["radius"];(0,YS._registerNode)(Do);WS.Factory.addGetterSetter(Do,"radius",0,(0,HS.getNumberValidator)());var cd={};Object.defineProperty(cd,"__esModule",{value:!0});cd.Ellipse=void 0;const wg=Re,XS=Et,K5=Ee,KS=Ae;class Bi extends XS.Shape{_sceneFunc(e){const n=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),n!==r&&e.scale(1,r/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}cd.Ellipse=Bi;Bi.prototype.className="Ellipse";Bi.prototype._centroid=!0;Bi.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,KS._registerNode)(Bi);wg.Factory.addComponentsGetterSetter(Bi,"radius",["x","y"]);wg.Factory.addGetterSetter(Bi,"radiusX",0,(0,K5.getNumberValidator)());wg.Factory.addGetterSetter(Bi,"radiusY",0,(0,K5.getNumberValidator)());var dd={};Object.defineProperty(dd,"__esModule",{value:!0});dd.Image=void 0;const Kh=dt,_s=Re,QS=Et,ZS=Ae,wl=Ee;class Yn extends QS.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",n=>{this._removeImageLoad(n.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),n=this.hasShadow();return e&&n?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let l;if(s){const c=this.attrs.cropWidth,u=this.attrs.cropHeight;c&&u?l=[s,this.cropX(),this.cropY(),c,u,0,0,n,r]:l=[s,0,0,n,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?Kh.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,l))}_hitFunc(e){const n=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?Kh.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n;return(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width}getHeight(){var e,n;return(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height}static fromURL(e,n,r=null){const i=Kh.Util.createImageElement();i.onload=function(){const s=new Yn({image:i});n(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}}dd.Image=Yn;Yn.prototype.className="Image";(0,ZS._registerNode)(Yn);_s.Factory.addGetterSetter(Yn,"cornerRadius",0,(0,wl.getNumberOrArrayOfNumbersValidator)(4));_s.Factory.addGetterSetter(Yn,"image");_s.Factory.addComponentsGetterSetter(Yn,"crop",["x","y","width","height"]);_s.Factory.addGetterSetter(Yn,"cropX",0,(0,wl.getNumberValidator)());_s.Factory.addGetterSetter(Yn,"cropY",0,(0,wl.getNumberValidator)());_s.Factory.addGetterSetter(Yn,"cropWidth",0,(0,wl.getNumberValidator)());_s.Factory.addGetterSetter(Yn,"cropHeight",0,(0,wl.getNumberValidator)());var Co={};Object.defineProperty(Co,"__esModule",{value:!0});Co.Tag=Co.Label=void 0;const fd=Re,qS=Et,JS=Fo,_g=Ee,Q5=Ae,Z5=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],ek="Change.konva",tk="none",up="up",cp="right",dp="down",fp="left",nk=Z5.length;class Sg extends JS.Group{constructor(e){super(e),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let n=this,r;const i=function(){n._sync()};for(r=0;r<nk;r++)e.on(Z5[r]+ek,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),n=this.getTag(),r,i,s,l,c,u,f;if(e&&n){switch(r=e.width(),i=e.height(),s=n.pointerDirection(),l=n.pointerWidth(),f=n.pointerHeight(),c=0,u=0,s){case up:c=r/2,u=-1*f;break;case cp:c=r+l,u=i/2;break;case dp:c=r/2,u=i+f;break;case fp:c=-1*l,u=i/2;break}n.setAttrs({x:-1*c,y:-1*u,width:r,height:i}),e.setAttrs({x:-1*c,y:-1*u})}}}Co.Label=Sg;Sg.prototype.className="Label";(0,Q5._registerNode)(Sg);class Ss extends qS.Shape{_sceneFunc(e){const n=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),l=this.pointerHeight(),c=this.cornerRadius();let u=0,f=0,p=0,m=0;typeof c=="number"?u=f=p=m=Math.min(c,n/2,r/2):(u=Math.min(c[0]||0,n/2,r/2),f=Math.min(c[1]||0,n/2,r/2),m=Math.min(c[2]||0,n/2,r/2),p=Math.min(c[3]||0,n/2,r/2)),e.beginPath(),e.moveTo(u,0),i===up&&(e.lineTo((n-s)/2,0),e.lineTo(n/2,-1*l),e.lineTo((n+s)/2,0)),e.lineTo(n-f,0),e.arc(n-f,f,f,Math.PI*3/2,0,!1),i===cp&&(e.lineTo(n,(r-l)/2),e.lineTo(n+s,r/2),e.lineTo(n,(r+l)/2)),e.lineTo(n,r-m),e.arc(n-m,r-m,m,0,Math.PI/2,!1),i===dp&&(e.lineTo((n+s)/2,r),e.lineTo(n/2,r+l),e.lineTo((n-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===fp&&(e.lineTo(0,(r+l)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-l)/2)),e.lineTo(0,u),e.arc(u,u,u,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,n=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),l=this.width(),c=this.height();return s===up?(n-=i,c+=i):s===dp?c+=i:s===fp?(e-=r*1.5,l+=r):s===cp&&(l+=r*1.5),{x:e,y:n,width:l,height:c}}}Co.Tag=Ss;Ss.prototype.className="Tag";(0,Q5._registerNode)(Ss);fd.Factory.addGetterSetter(Ss,"pointerDirection",tk);fd.Factory.addGetterSetter(Ss,"pointerWidth",0,(0,_g.getNumberValidator)());fd.Factory.addGetterSetter(Ss,"pointerHeight",0,(0,_g.getNumberValidator)());fd.Factory.addGetterSetter(Ss,"cornerRadius",0,(0,_g.getNumberOrArrayOfNumbersValidator)(4));var _l={};Object.defineProperty(_l,"__esModule",{value:!0});_l.Rect=void 0;const rk=Re,ik=Et,sk=Ae,ok=dt,ak=Ee;let hd=class extends ik.Shape{_sceneFunc(e){const n=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),n?ok.Util.drawRoundedRectPath(e,r,i,n):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};_l.Rect=hd;hd.prototype.className="Rect";(0,sk._registerNode)(hd);rk.Factory.addGetterSetter(hd,"cornerRadius",0,(0,ak.getNumberOrArrayOfNumbersValidator)(4));var pd={};Object.defineProperty(pd,"__esModule",{value:!0});pd.RegularPolygon=void 0;const q5=Re,lk=Et,J5=Ee,uk=Ae;class ks extends lk.Shape{_sceneFunc(e){const n=this._getPoints();e.beginPath(),e.moveTo(n[0].x,n[0].y);for(let r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,r=[];for(let i=0;i<e;i++)r.push({x:n*Math.sin(i*2*Math.PI/e),y:-1*n*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();let n=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(l=>{n=Math.min(n,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),s=Math.max(s,l.y)}),{x:n,y:i,width:r-n,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}pd.RegularPolygon=ks;ks.prototype.className="RegularPolygon";ks.prototype._centroid=!0;ks.prototype._attrsAffectingSize=["radius"];(0,uk._registerNode)(ks);q5.Factory.addGetterSetter(ks,"radius",0,(0,J5.getNumberValidator)());q5.Factory.addGetterSetter(ks,"sides",0,(0,J5.getNumberValidator)());var gd={};Object.defineProperty(gd,"__esModule",{value:!0});gd.Ring=void 0;const e4=Re,ck=Et,t4=Ee,dk=Ae,y2=Math.PI*2;class Cs extends ck.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,y2,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),y2,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}gd.Ring=Cs;Cs.prototype.className="Ring";Cs.prototype._centroid=!0;Cs.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,dk._registerNode)(Cs);e4.Factory.addGetterSetter(Cs,"innerRadius",0,(0,t4.getNumberValidator)());e4.Factory.addGetterSetter(Cs,"outerRadius",0,(0,t4.getNumberValidator)());var md={};Object.defineProperty(md,"__esModule",{value:!0});md.Sprite=void 0;const Ts=Re,fk=Et,hk=jo,n4=Ee,pk=Ae;class Mr extends fk.Shape{constructor(e){super(e),this._updated=!0,this.anim=new hk.Animation(()=>{const n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const n=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[n],l=this.frameOffsets(),c=s[i+0],u=s[i+1],f=s[i+2],p=s[i+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,f,p),e.closePath(),e.fillStrokeShape(this)),m)if(l){const w=l[n],y=r*2;e.drawImage(m,c,u,f,p,w[y+0],w[y+1],f,p)}else e.drawImage(m,c,u,f,p,0,0,f,p)}_hitFunc(e){const n=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[n],l=this.frameOffsets(),c=s[i+2],u=s[i+3];if(e.beginPath(),l){const f=l[n],p=r*2;e.rect(f[p+0],f[p+1],c,u)}else e.rect(0,0,c,u);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),n=this.animation(),r=this.animations(),i=r[n],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}md.Sprite=Mr;Mr.prototype.className="Sprite";(0,pk._registerNode)(Mr);Ts.Factory.addGetterSetter(Mr,"animation");Ts.Factory.addGetterSetter(Mr,"animations");Ts.Factory.addGetterSetter(Mr,"frameOffsets");Ts.Factory.addGetterSetter(Mr,"image");Ts.Factory.addGetterSetter(Mr,"frameIndex",0,(0,n4.getNumberValidator)());Ts.Factory.addGetterSetter(Mr,"frameRate",17,(0,n4.getNumberValidator)());Ts.Factory.backCompat(Mr,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var yd={};Object.defineProperty(yd,"__esModule",{value:!0});yd.Star=void 0;const kg=Re,gk=Et,Cg=Ee,mk=Ae;class Ui extends gk.Shape{_sceneFunc(e){const n=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(let s=1;s<i*2;s++){const l=s%2===0?r:n,c=l*Math.sin(s*Math.PI/i),u=-1*l*Math.cos(s*Math.PI/i);e.lineTo(c,u)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}yd.Star=Ui;Ui.prototype.className="Star";Ui.prototype._centroid=!0;Ui.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,mk._registerNode)(Ui);kg.Factory.addGetterSetter(Ui,"numPoints",5,(0,Cg.getNumberValidator)());kg.Factory.addGetterSetter(Ui,"innerRadius",0,(0,Cg.getNumberValidator)());kg.Factory.addGetterSetter(Ui,"outerRadius",0,(0,Cg.getNumberValidator)());var zo={};Object.defineProperty(zo,"__esModule",{value:!0});zo.Text=void 0;zo.stringToArray=ss;const hp=dt,en=Re,yk=Et,Qh=Ae,Gi=Ee,vk=Ae;function ss(t){return[...t].reduce((e,n,r,i)=>{if(/\p{Emoji}/u.test(n)){const s=i[r+1];s&&/\p{Emoji_Modifier}|\u200D/u.test(s)?(e.push(n+s),i[r+1]=""):e.push(n)}else/\p{Regional_Indicator}{2}/u.test(n+(i[r+1]||""))?e.push(n+i[r+1]):r>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(n)?e[e.length-1]+=n:n&&e.push(n);return e},[])}const Hs="auto",xk="center",r4="inherit",xa="justify",wk="Change.konva",_k="2d",v2="-",i4="left",Sk="text",kk="Text",Ck="top",Tk="bottom",x2="middle",s4="normal",Ek="px ",Fu=" ",bk="right",w2="rtl",Nk="word",Pk="char",_2="none",Zh="",o4=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Mk=o4.length;function Ak(t){return t.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!r&&(e=`"${e}"`),e}).join(", ")}let ju;function qh(){return ju||(ju=hp.Util.createCanvasElement().getContext(_k),ju)}function Ik(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Rk(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Lk(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let gt=class extends yk.Shape{constructor(e){super(Lk(e)),this._partialTextX=0,this._partialTextY=0;for(let n=0;n<Mk;n++)this.on(o4[n]+wk,this._setTextData);this._setTextData()}_sceneFunc(e){const n=this.textArr,r=n.length;if(!this.text())return;let i=this.padding(),s=this.fontSize(),l=this.lineHeight()*s,c=this.verticalAlign(),u=this.direction(),f=0,p=this.align(),m=this.getWidth(),w=this.letterSpacing(),y=this.fill(),x=this.textDecoration(),C=x.indexOf("underline")!==-1,S=x.indexOf("line-through")!==-1,_;u=u===r4?e.direction:u;let E=l/2,h=x2;if(Qh.Konva._fixTextRendering){const j=this.measureSize("M");h="alphabetic",E=(j.fontBoundingBoxAscent-j.fontBoundingBoxDescent)/2+l/2}var k=0,T=0;for(u===w2&&e.setAttr("direction",u),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",h),e.setAttr("textAlign",i4),c===x2?f=(this.getHeight()-r*l-i*2)/2:c===Tk&&(f=this.getHeight()-r*l-i*2),e.translate(i,f+i),_=0;_<r;_++){var k=0,T=0,N=n[_],I=N.text,M=N.width,L=N.lastInParagraph,A,R;if(e.save(),p===bk?k+=m-M-i*2:p===xk&&(k+=(m-M-i*2)/2),C){e.save(),e.beginPath();const U=Qh.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2),O=k,V=E+T+U;e.moveTo(O,V),A=I.split(" ").length-1,R=p===xa&&!L?m-i*2:M,e.lineTo(O+Math.round(R),V),e.lineWidth=s/15;const $=this._getLinearGradient();e.strokeStyle=$||y,e.stroke(),e.restore()}if(S){e.save(),e.beginPath();const U=Qh.Konva._fixTextRendering?-Math.round(s/4):0;e.moveTo(k,E+T+U),A=I.split(" ").length-1,R=p===xa&&!L?m-i*2:M,e.lineTo(k+Math.round(R),E+T+U),e.lineWidth=s/15;const O=this._getLinearGradient();e.strokeStyle=O||y,e.stroke(),e.restore()}if(u!==w2&&(w!==0||p===xa)){A=I.split(" ").length-1;const U=ss(I);for(let O=0;O<U.length;O++){const V=U[O];V===" "&&!L&&p===xa&&(k+=(m-i*2-M)/A),this._partialTextX=k,this._partialTextY=E+T,this._partialText=V,e.fillStrokeShape(this),k+=this.measureSize(V).width+w}}else w!==0&&e.setAttr("letterSpacing",`${w}px`),this._partialTextX=k,this._partialTextY=E+T,this._partialText=I,e.fillStrokeShape(this);e.restore(),r>1&&(E+=l)}}_hitFunc(e){const n=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}setText(e){const n=hp.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(Sk,n),this}getWidth(){return this.attrs.width===Hs||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Hs||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return hp.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n,r,i,s,l,c,u,f,p,m,w;let y=qh(),x=this.fontSize(),C;y.save(),y.font=this._getContextFont(),C=y.measureText(e),y.restore();const S=x/100;return{actualBoundingBoxAscent:(n=C.actualBoundingBoxAscent)!==null&&n!==void 0?n:71.58203125*S,actualBoundingBoxDescent:(r=C.actualBoundingBoxDescent)!==null&&r!==void 0?r:0,actualBoundingBoxLeft:(i=C.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*S,actualBoundingBoxRight:(s=C.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*S,alphabeticBaseline:(l=C.alphabeticBaseline)!==null&&l!==void 0?l:0,emHeightAscent:(c=C.emHeightAscent)!==null&&c!==void 0?c:100*S,emHeightDescent:(u=C.emHeightDescent)!==null&&u!==void 0?u:-20*S,fontBoundingBoxAscent:(f=C.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*S,fontBoundingBoxDescent:(p=C.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*S,hangingBaseline:(m=C.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*S,ideographicBaseline:(w=C.ideographicBaseline)!==null&&w!==void 0?w:-21*S,width:C.width,height:x}}_getContextFont(){return this.fontStyle()+Fu+this.fontVariant()+Fu+(this.fontSize()+Ek)+Ak(this.fontFamily())}_addTextLine(e){this.align()===xa&&(e=e.trim());const r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){const n=this.letterSpacing(),r=e.length;return qh().measureText(e).width+n*r}_setTextData(){let e=this.text().split(`
`),n=+this.fontSize(),r=0,i=this.lineHeight()*n,s=this.attrs.width,l=this.attrs.height,c=s!==Hs&&s!==void 0,u=l!==Hs&&l!==void 0,f=this.padding(),p=s-f*2,m=l-f*2,w=0,y=this.wrap(),x=y!==_2,C=y!==Pk&&x,S=this.ellipsis();this.textArr=[],qh().font=this._getContextFont();const _=S?this._getTextWidth(Zh):0;for(let E=0,h=e.length;E<h;++E){let k=e[E],T=this._getTextWidth(k);if(c&&T>p)for(;k.length>0;){let N=0,I=ss(k).length,M="",L=0;for(;N<I;){const A=N+I>>>1,R=ss(k),j=R.slice(0,A+1).join(""),G=this._getTextWidth(j);(S&&u&&w+i>m?G+_:G)<=p?(N=A+1,M=j,L=G):I=A}if(M){if(C){const j=ss(k),G=ss(M),U=j[G.length],O=U===Fu||U===v2;let V;if(O&&L<=p)V=G.length;else{const $=G.lastIndexOf(Fu),D=G.lastIndexOf(v2);V=Math.max($,D)+1}V>0&&(N=V,M=j.slice(0,N).join(""),L=this._getTextWidth(M))}if(M=M.trimRight(),this._addTextLine(M),r=Math.max(r,L),w+=i,this._shouldHandleEllipsis(w)){this._tryToAddEllipsisToLastLine();break}if(k=ss(k).slice(N).join("").trimLeft(),k.length>0&&(T=this._getTextWidth(k),T<=p)){this._addTextLine(k),w+=i,r=Math.max(r,T);break}}else break}else this._addTextLine(k),w+=i,r=Math.max(r,T),this._shouldHandleEllipsis(w)&&E<h-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&w+i>m)break}this.textHeight=n,this.textWidth=r}_shouldHandleEllipsis(e){const n=+this.fontSize(),r=this.lineHeight()*n,i=this.attrs.height,s=i!==Hs&&i!==void 0,l=this.padding(),c=i-l*2;return!(this.wrap()!==_2)||s&&e+r>c}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,n=e!==Hs&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),l=this.textArr[this.textArr.length-1];!l||!s||(n&&(this._getTextWidth(l.text+Zh)<i||(l.text=l.text.slice(0,l.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(l.text+Zh))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return e&&n?!0:super._useBufferCanvas()}};zo.Text=gt;gt.prototype._fillFunc=Ik;gt.prototype._strokeFunc=Rk;gt.prototype.className=kk;gt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,vk._registerNode)(gt);en.Factory.overWriteSetter(gt,"width",(0,Gi.getNumberOrAutoValidator)());en.Factory.overWriteSetter(gt,"height",(0,Gi.getNumberOrAutoValidator)());en.Factory.addGetterSetter(gt,"direction",r4);en.Factory.addGetterSetter(gt,"fontFamily","Arial");en.Factory.addGetterSetter(gt,"fontSize",12,(0,Gi.getNumberValidator)());en.Factory.addGetterSetter(gt,"fontStyle",s4);en.Factory.addGetterSetter(gt,"fontVariant",s4);en.Factory.addGetterSetter(gt,"padding",0,(0,Gi.getNumberValidator)());en.Factory.addGetterSetter(gt,"align",i4);en.Factory.addGetterSetter(gt,"verticalAlign",Ck);en.Factory.addGetterSetter(gt,"lineHeight",1,(0,Gi.getNumberValidator)());en.Factory.addGetterSetter(gt,"wrap",Nk);en.Factory.addGetterSetter(gt,"ellipsis",!1,(0,Gi.getBooleanValidator)());en.Factory.addGetterSetter(gt,"letterSpacing",0,(0,Gi.getNumberValidator)());en.Factory.addGetterSetter(gt,"text","",(0,Gi.getStringValidator)());en.Factory.addGetterSetter(gt,"textDecoration","");var vd={};Object.defineProperty(vd,"__esModule",{value:!0});vd.TextPath=void 0;const Jh=dt,hr=Re,Fk=Et,wa=Oo,e0=zo,a4=Ee,jk=Ae,Ok="",l4="normal";function u4(t){t.fillText(this.partialText,0,0)}function c4(t){t.strokeText(this.partialText,0,0)}class bt extends Fk.Shape{constructor(e){super(e),this.dummyCanvas=Jh.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return wa.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const n=this.pathLength;return e-1>n?null:wa.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=wa.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const n=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;n==="underline"&&e.beginPath();for(let l=0;l<s.length;l++){e.save();const c=s[l].p0;e.translate(c.x,c.y),e.rotate(s[l].rotation),this.partialText=s[l].text,e.fillStrokeShape(this),n==="underline"&&(l===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}n==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const n=this.glyphInfo;if(n.length>=1){const r=n[0].p0;e.moveTo(r.x,r.y)}for(let r=0;r<n.length;r++){const i=n[r].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Jh.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return e0.Text.prototype.setText.call(this,e)}_getContextFont(){return e0.Text.prototype._getContextFont.call(this)}_getTextSize(e){const r=this.dummyCanvas.getContext("2d");r.save(),r.font=this._getContextFont();const i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:n}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=n,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),l=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let c=0;i==="center"&&(c=Math.max(0,this.pathLength/2-l/2)),i==="right"&&(c=Math.max(0,this.pathLength-l));const u=(0,e0.stringToArray)(this.text());let f=c;for(let p=0;p<u.length;p++){const m=this._getPointAtLength(f);if(!m)return;let w=this._getTextSize(u[p]).width+r;if(u[p]===" "&&i==="justify"){const E=this.text().split(" ").length-1;w+=(this.pathLength-l)/E}const y=this._getPointAtLength(f+w);if(!y)return;const x=wa.Path.getLineLength(m.x,m.y,y.x,y.y);let C=0;if(s)try{C=s(u[p-1],u[p])*this.fontSize()}catch{C=0}m.x+=C,y.x+=C,this.textWidth+=C;const S=wa.Path.getPointOnLine(C+x/2,m.x,m.y,y.x,y.y),_=Math.atan2(y.y-m.y,y.x-m.x);this.glyphInfo.push({transposeX:S.x,transposeY:S.y,text:u[p],rotation:_,p0:m,p1:y}),f+=w}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(f){e.push(f.p0.x),e.push(f.p0.y),e.push(f.p1.x),e.push(f.p1.y)});let n=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,l,c;for(let f=0;f<e.length/2;f++)l=e[f*2],c=e[f*2+1],n=Math.min(n,l),r=Math.max(r,l),i=Math.min(i,c),s=Math.max(s,c);const u=this.fontSize();return{x:n-u/2,y:i-u/2,width:r-n+u,height:s-i+u}}destroy(){return Jh.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}vd.TextPath=bt;bt.prototype._fillFunc=u4;bt.prototype._strokeFunc=c4;bt.prototype._fillFuncHit=u4;bt.prototype._strokeFuncHit=c4;bt.prototype.className="TextPath";bt.prototype._attrsAffectingSize=["text","fontSize","data"];(0,jk._registerNode)(bt);hr.Factory.addGetterSetter(bt,"data");hr.Factory.addGetterSetter(bt,"fontFamily","Arial");hr.Factory.addGetterSetter(bt,"fontSize",12,(0,a4.getNumberValidator)());hr.Factory.addGetterSetter(bt,"fontStyle",l4);hr.Factory.addGetterSetter(bt,"align","left");hr.Factory.addGetterSetter(bt,"letterSpacing",0,(0,a4.getNumberValidator)());hr.Factory.addGetterSetter(bt,"textBaseline","middle");hr.Factory.addGetterSetter(bt,"fontVariant",l4);hr.Factory.addGetterSetter(bt,"text",Ok);hr.Factory.addGetterSetter(bt,"textDecoration","");hr.Factory.addGetterSetter(bt,"kerningFunc",void 0);var xd={};Object.defineProperty(xd,"__esModule",{value:!0});xd.Transformer=void 0;const $e=dt,Ge=Re,S2=st,Dk=Et,zk=_l,k2=Fo,rr=Ae,Vi=Ee,Bk=Ae,d4="tr-konva",Uk=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${d4}`).join(" "),C2="nodesRect",Gk=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],Vk={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Wk="ontouchstart"in rr.Konva._global;function $k(t,e,n){if(t==="rotater")return n;e+=$e.Util.degToRad(Vk[t]||0);const r=($e.Util.radToDeg(e)%360+360)%360;return $e.Util._inRange(r,315+22.5,360)||$e.Util._inRange(r,0,22.5)?"ns-resize":$e.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":$e.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":$e.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":$e.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":$e.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":$e.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":$e.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":($e.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}const Ac=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],T2=1e8;function Hk(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function f4(t,e,n){const r=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),i=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:r,y:i}}function Yk(t,e){const n=Hk(t);return f4(t,e,n)}function Xk(t,e,n){let r=e;for(let i=0;i<t.length;i++){const s=rr.Konva.getAngle(t[i]),l=Math.abs(s-e)%(Math.PI*2);Math.min(l,Math.PI*2-l)<n&&(r=s)}return r}let pp=0;class je extends k2.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Uk,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return $e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return d4+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const n=e.filter(i=>i.isAncestorOf(this)?($e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=n,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const l=i._attrsAffectingSize.map(c=>c+"Change."+this._getEventNamespace()).join(" ");i.on(l,s)}i.on(Gk.map(l=>l+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let n;e.on(`dragstart.${this._getEventNamespace()}`,r=>{n=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!n)return;const i=e.getAbsolutePosition(),s=i.x-n.x,l=i.y-n.y;this.nodes().forEach(c=>{if(c===e||c.isDragging())return;const u=c.getAbsolutePosition();c.setAbsolutePosition({x:u.x+s,y:u.y+l}),c.startDrag(r)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(C2),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(C2,this.__getNodeRect)}__getNodeShape(e,n=this.rotation(),r){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),l=e.getAbsolutePosition(r),c=i.x*s.x-e.offsetX()*s.x,u=i.y*s.y-e.offsetY()*s.y,f=(rr.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:l.x+c*Math.cos(f)+u*Math.sin(-f),y:l.y+u*Math.cos(f)+c*Math.sin(f),width:i.width*s.x,height:i.height*s.y,rotation:f};return f4(p,-rr.Konva.getAngle(n),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-T2,y:-T2,width:0,height:0,rotation:0};const n=[];this.nodes().map(f=>{const p=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),m=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],w=f.getAbsoluteTransform();m.forEach(function(y){const x=w.point(y);n.push(x)})});const r=new $e.Transform;r.rotate(-rr.Konva.getAngle(this.rotation()));let i=1/0,s=1/0,l=-1/0,c=-1/0;n.forEach(function(f){const p=r.point(f);i===void 0&&(i=l=p.x,s=c=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),l=Math.max(l,p.x),c=Math.max(c,p.y)}),r.invert();const u=r.point({x:i,y:s});return{x:u.x,y:u.y,width:l-i,height:c-s,rotation:rr.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Ac.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const n=new zk.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Wk?10:"auto"}),r=this;n.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),n.on("dragstart",i=>{n.stopDrag(),i.cancelBubble=!0}),n.on("dragend",i=>{i.cancelBubble=!0}),n.on("mouseenter",()=>{const i=rr.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),l=$k(e,i,s);n.getStage().content&&(n.getStage().content.style.cursor=l),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){const e=new Dk.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(n,r){const i=r.getParent(),s=i.padding();n.beginPath(),n.rect(-s,-s,r.width()+s*2,r.height()+s*2),n.moveTo(r.width()/2,-s),i.rotateEnabled()&&i.rotateLineVisible()&&n.lineTo(r.width()/2,-i.rotateAnchorOffset()*$e.Util._sign(r.height())-s),n.fillStrokeShape(r)},hitFunc:(n,r)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();n.beginPath(),n.rect(-i,-i,r.width()+i*2,r.height()+i*2),n.fillStrokeShape(r)}});this.add(e),this._proxyDrag(e),e.on("dragstart",n=>{n.cancelBubble=!0}),e.on("dragmove",n=>{n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const n=this._getNodeRect(),r=n.width,i=n.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const l=e.target.getAbsolutePosition(),c=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:c.x-l.x,y:c.y-l.y},pp++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(u=>{u._fire("transformstart",{evt:e.evt,target:u})})}_handleMouseMove(e){let n,r,i;const s=this.findOne("."+this._movingAnchorName),l=s.getStage();l.setPointersPositions(e);const c=l.getPointerPosition();let u={x:c.x-this._anchorDragOffset.x,y:c.y-this._anchorDragOffset.y};const f=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(f,u,e)),s.setAbsolutePosition(u);const p=s.getAbsolutePosition();if(f.x===p.x&&f.y===p.y)return;if(this._movingAnchorName==="rotater"){const T=this._getNodeRect();n=s.x()-T.width/2,r=-s.y()+T.height/2;let N=Math.atan2(-r,n)+Math.PI/2;T.height<0&&(N-=Math.PI);const M=rr.Konva.getAngle(this.rotation())+N,L=rr.Konva.getAngle(this.rotationSnapTolerance()),R=Xk(this.rotationSnaps(),M,L)-T.rotation,j=Yk(T,R);this._fitNodesInto(j,e);return}const m=this.shiftBehavior();let w;m==="inverted"?w=this.keepRatio()&&!e.shiftKey:m==="none"?w=this.keepRatio():w=this.keepRatio()||e.shiftKey;var _=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(w){var y=_?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(y.x-s.x(),2)+Math.pow(y.y-s.y(),2));var x=this.findOne(".top-left").x()>y.x?-1:1,C=this.findOne(".top-left").y()>y.y?-1:1;n=i*this.cos*x,r=i*this.sin*C,this.findOne(".top-left").x(y.x-n),this.findOne(".top-left").y(y.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(w){var y=_?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-y.x,2)+Math.pow(y.y-s.y(),2));var x=this.findOne(".top-right").x()<y.x?-1:1,C=this.findOne(".top-right").y()>y.y?-1:1;n=i*this.cos*x,r=i*this.sin*C,this.findOne(".top-right").x(y.x+n),this.findOne(".top-right").y(y.y-r)}var S=s.position();this.findOne(".top-left").y(S.y),this.findOne(".bottom-right").x(S.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(w){var y=_?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(y.x-s.x(),2)+Math.pow(s.y()-y.y,2));var x=y.x<s.x()?-1:1,C=s.y()<y.y?-1:1;n=i*this.cos*x,r=i*this.sin*C,s.x(y.x-n),s.y(y.y+r)}S=s.position(),this.findOne(".top-left").x(S.x),this.findOne(".bottom-right").y(S.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(w){var y=_?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-y.x,2)+Math.pow(s.y()-y.y,2));var x=this.findOne(".bottom-right").x()<y.x?-1:1,C=this.findOne(".bottom-right").y()<y.y?-1:1;n=i*this.cos*x,r=i*this.sin*C,this.findOne(".bottom-right").x(y.x+n),this.findOne(".bottom-right").y(y.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var _=this.centeredScaling()||e.altKey;if(_){const T=this.findOne(".top-left"),N=this.findOne(".bottom-right"),I=T.x(),M=T.y(),L=this.getWidth()-N.x(),A=this.getHeight()-N.y();N.move({x:-I,y:-M}),T.move({x:L,y:A})}const E=this.findOne(".top-left").getAbsolutePosition();n=E.x,r=E.y;const h=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),k=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:r,width:h,height:k,rotation:rr.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var n;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const r=this.getNode();pp--,this._fire("transformend",{evt:e,target:r}),(n=this.getLayer())===null||n===void 0||n.batchDraw(),r&&this._nodes.forEach(i=>{var s;i._fire("transformend",{evt:e,target:i}),(s=i.getLayer())===null||s===void 0||s.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,n){const r=this._getNodeRect(),i=1;if($e.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if($e.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const s=new $e.Transform;if(s.rotate(rr.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const w=s.point({x:-this.padding()*2,y:0});e.x+=w.x,e.y+=w.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=w.x,this._anchorDragOffset.y-=w.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const w=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=w.x,this._anchorDragOffset.y-=w.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const w=s.point({x:0,y:-this.padding()*2});e.x+=w.x,e.y+=w.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=w.x,this._anchorDragOffset.y-=w.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const w=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=w.x,this._anchorDragOffset.y-=w.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const w=this.boundBoxFunc()(r,e);w?e=w:$e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const l=1e7,c=new $e.Transform;c.translate(r.x,r.y),c.rotate(r.rotation),c.scale(r.width/l,r.height/l);const u=new $e.Transform,f=e.width/l,p=e.height/l;this.flipEnabled()===!1?(u.translate(e.x,e.y),u.rotate(e.rotation),u.translate(e.width<0?e.width:0,e.height<0?e.height:0),u.scale(Math.abs(f),Math.abs(p))):(u.translate(e.x,e.y),u.rotate(e.rotation),u.scale(f,p));const m=u.multiply(c.invert());this._nodes.forEach(w=>{var y;const x=w.getParent().getAbsoluteTransform(),C=w.getTransform().copy();C.translate(w.offsetX(),w.offsetY());const S=new $e.Transform;S.multiply(x.copy().invert()).multiply(m).multiply(x).multiply(C);const _=S.decompose();w.setAttrs(_),(y=w.getLayer())===null||y===void 0||y.batchDraw()}),this.rotation($e.Util._getRotation(e.rotation)),this._nodes.forEach(w=>{this._fire("transform",{evt:n,target:w}),w._fire("transform",{evt:n,target:w})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,n){this.findOne(e).setAttrs(n)}update(){var e;const n=this._getNodeRect();this.rotation($e.Util._getRotation(n.rotation));const r=n.width,i=n.height,s=this.enabledAnchors(),l=this.resizeEnabled(),c=this.padding(),u=this.anchorSize(),f=this.find("._anchor");f.forEach(m=>{m.setAttrs({width:u,height:u,offsetX:u/2,offsetY:u/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:u/2+c,offsetY:u/2+c,visible:l&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:u/2+c,visible:l&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:u/2-c,offsetY:u/2+c,visible:l&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:u/2+c,visible:l&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:u/2-c,visible:l&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:u/2+c,offsetY:u/2-c,visible:l&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:u/2-c,visible:l&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:u/2-c,offsetY:u/2-c,visible:l&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*$e.Util._sign(i)-c,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&f.forEach(m=>{p(m)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),k2.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return S2.Node.prototype.toObject.call(this)}clone(e){return S2.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}xd.Transformer=je;je.isTransforming=()=>pp>0;function Kk(t){return t instanceof Array||$e.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){Ac.indexOf(e)===-1&&$e.Util.warn("Unknown anchor name: "+e+". Available names are: "+Ac.join(", "))}),t||[]}je.prototype.className="Transformer";(0,Bk._registerNode)(je);Ge.Factory.addGetterSetter(je,"enabledAnchors",Ac,Kk);Ge.Factory.addGetterSetter(je,"flipEnabled",!0,(0,Vi.getBooleanValidator)());Ge.Factory.addGetterSetter(je,"resizeEnabled",!0);Ge.Factory.addGetterSetter(je,"anchorSize",10,(0,Vi.getNumberValidator)());Ge.Factory.addGetterSetter(je,"rotateEnabled",!0);Ge.Factory.addGetterSetter(je,"rotateLineVisible",!0);Ge.Factory.addGetterSetter(je,"rotationSnaps",[]);Ge.Factory.addGetterSetter(je,"rotateAnchorOffset",50,(0,Vi.getNumberValidator)());Ge.Factory.addGetterSetter(je,"rotateAnchorCursor","crosshair");Ge.Factory.addGetterSetter(je,"rotationSnapTolerance",5,(0,Vi.getNumberValidator)());Ge.Factory.addGetterSetter(je,"borderEnabled",!0);Ge.Factory.addGetterSetter(je,"anchorStroke","rgb(0, 161, 255)");Ge.Factory.addGetterSetter(je,"anchorStrokeWidth",1,(0,Vi.getNumberValidator)());Ge.Factory.addGetterSetter(je,"anchorFill","white");Ge.Factory.addGetterSetter(je,"anchorCornerRadius",0,(0,Vi.getNumberValidator)());Ge.Factory.addGetterSetter(je,"borderStroke","rgb(0, 161, 255)");Ge.Factory.addGetterSetter(je,"borderStrokeWidth",1,(0,Vi.getNumberValidator)());Ge.Factory.addGetterSetter(je,"borderDash");Ge.Factory.addGetterSetter(je,"keepRatio",!0);Ge.Factory.addGetterSetter(je,"shiftBehavior","default");Ge.Factory.addGetterSetter(je,"centeredScaling",!1);Ge.Factory.addGetterSetter(je,"ignoreStroke",!1);Ge.Factory.addGetterSetter(je,"padding",0,(0,Vi.getNumberValidator)());Ge.Factory.addGetterSetter(je,"nodes");Ge.Factory.addGetterSetter(je,"node");Ge.Factory.addGetterSetter(je,"boundBoxFunc");Ge.Factory.addGetterSetter(je,"anchorDragBoundFunc");Ge.Factory.addGetterSetter(je,"anchorStyleFunc");Ge.Factory.addGetterSetter(je,"shouldOverdrawWholeArea",!1);Ge.Factory.addGetterSetter(je,"useSingleNodeRotation",!0);Ge.Factory.backCompat(je,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var wd={};Object.defineProperty(wd,"__esModule",{value:!0});wd.Wedge=void 0;const _d=Re,Qk=Et,Zk=Ae,h4=Ee,qk=Ae;class ri extends Qk.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,Zk.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}wd.Wedge=ri;ri.prototype.className="Wedge";ri.prototype._centroid=!0;ri.prototype._attrsAffectingSize=["radius"];(0,qk._registerNode)(ri);_d.Factory.addGetterSetter(ri,"radius",0,(0,h4.getNumberValidator)());_d.Factory.addGetterSetter(ri,"angle",0,(0,h4.getNumberValidator)());_d.Factory.addGetterSetter(ri,"clockwise",!1);_d.Factory.backCompat(ri,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Sd={};Object.defineProperty(Sd,"__esModule",{value:!0});Sd.Blur=void 0;const E2=Re,Jk=st,eC=Ee;function b2(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const tC=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],nC=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function rC(t,e){const n=t.data,r=t.width,i=t.height;let s,l,c,u,f,p,m,w,y,x,C,S,_,E,h,k,T,N,I,M,L,A,R,j;const G=e+e+1,U=r-1,O=i-1,V=e+1,$=V*(V+1)/2,D=new b2,X=tC[e],H=nC[e];let re=null,K=D,ne=null,te=null;for(c=1;c<G;c++)K=K.next=new b2,c===V&&(re=K);for(K.next=D,m=p=0,l=0;l<i;l++){for(k=T=N=I=w=y=x=C=0,S=V*(M=n[p]),_=V*(L=n[p+1]),E=V*(A=n[p+2]),h=V*(R=n[p+3]),w+=$*M,y+=$*L,x+=$*A,C+=$*R,K=D,c=0;c<V;c++)K.r=M,K.g=L,K.b=A,K.a=R,K=K.next;for(c=1;c<V;c++)u=p+((U<c?U:c)<<2),w+=(K.r=M=n[u])*(j=V-c),y+=(K.g=L=n[u+1])*j,x+=(K.b=A=n[u+2])*j,C+=(K.a=R=n[u+3])*j,k+=M,T+=L,N+=A,I+=R,K=K.next;for(ne=D,te=re,s=0;s<r;s++)n[p+3]=R=C*X>>H,R!==0?(R=255/R,n[p]=(w*X>>H)*R,n[p+1]=(y*X>>H)*R,n[p+2]=(x*X>>H)*R):n[p]=n[p+1]=n[p+2]=0,w-=S,y-=_,x-=E,C-=h,S-=ne.r,_-=ne.g,E-=ne.b,h-=ne.a,u=m+((u=s+e+1)<U?u:U)<<2,k+=ne.r=n[u],T+=ne.g=n[u+1],N+=ne.b=n[u+2],I+=ne.a=n[u+3],w+=k,y+=T,x+=N,C+=I,ne=ne.next,S+=M=te.r,_+=L=te.g,E+=A=te.b,h+=R=te.a,k-=M,T-=L,N-=A,I-=R,te=te.next,p+=4;m+=r}for(s=0;s<r;s++){for(T=N=I=k=y=x=C=w=0,p=s<<2,S=V*(M=n[p]),_=V*(L=n[p+1]),E=V*(A=n[p+2]),h=V*(R=n[p+3]),w+=$*M,y+=$*L,x+=$*A,C+=$*R,K=D,c=0;c<V;c++)K.r=M,K.g=L,K.b=A,K.a=R,K=K.next;for(f=r,c=1;c<=e;c++)p=f+s<<2,w+=(K.r=M=n[p])*(j=V-c),y+=(K.g=L=n[p+1])*j,x+=(K.b=A=n[p+2])*j,C+=(K.a=R=n[p+3])*j,k+=M,T+=L,N+=A,I+=R,K=K.next,c<O&&(f+=r);for(p=s,ne=D,te=re,l=0;l<i;l++)u=p<<2,n[u+3]=R=C*X>>H,R>0?(R=255/R,n[u]=(w*X>>H)*R,n[u+1]=(y*X>>H)*R,n[u+2]=(x*X>>H)*R):n[u]=n[u+1]=n[u+2]=0,w-=S,y-=_,x-=E,C-=h,S-=ne.r,_-=ne.g,E-=ne.b,h-=ne.a,u=s+((u=l+V)<O?u:O)*r<<2,w+=k+=ne.r=n[u],y+=T+=ne.g=n[u+1],x+=N+=ne.b=n[u+2],C+=I+=ne.a=n[u+3],ne=ne.next,S+=M=te.r,_+=L=te.g,E+=A=te.b,h+=R=te.a,k-=M,T-=L,N-=A,I-=R,te=te.next,p+=r}}const iC=function(e){const n=Math.round(this.blurRadius());n>0&&rC(e,n)};Sd.Blur=iC;E2.Factory.addGetterSetter(Jk.Node,"blurRadius",0,(0,eC.getNumberValidator)(),E2.Factory.afterSetFilter);var kd={};Object.defineProperty(kd,"__esModule",{value:!0});kd.Brighten=void 0;const N2=Re,sC=st,oC=Ee,aC=function(t){const e=this.brightness()*255,n=t.data,r=n.length;for(let i=0;i<r;i+=4)n[i]+=e,n[i+1]+=e,n[i+2]+=e};kd.Brighten=aC;N2.Factory.addGetterSetter(sC.Node,"brightness",0,(0,oC.getNumberValidator)(),N2.Factory.afterSetFilter);var Cd={};Object.defineProperty(Cd,"__esModule",{value:!0});Cd.Contrast=void 0;const P2=Re,lC=st,uC=Ee,cC=function(t){const e=Math.pow((this.contrast()+100)/100,2),n=t.data,r=n.length;let i=150,s=150,l=150;for(let c=0;c<r;c+=4)i=n[c],s=n[c+1],l=n[c+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,l/=255,l-=.5,l*=e,l+=.5,l*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,l=l<0?0:l>255?255:l,n[c]=i,n[c+1]=s,n[c+2]=l};Cd.Contrast=cC;P2.Factory.addGetterSetter(lC.Node,"contrast",0,(0,uC.getNumberValidator)(),P2.Factory.afterSetFilter);var Td={};Object.defineProperty(Td,"__esModule",{value:!0});Td.Emboss=void 0;const Li=Re,Ed=st,dC=dt,p4=Ee,fC=function(t){const e=this.embossStrength()*10,n=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=t.data,l=t.width,c=t.height,u=l*4;let f=0,p=0,m=c;switch(r){case"top-left":f=-1,p=-1;break;case"top":f=-1,p=0;break;case"top-right":f=-1,p=1;break;case"right":f=0,p=1;break;case"bottom-right":f=1,p=1;break;case"bottom":f=1,p=0;break;case"bottom-left":f=1,p=-1;break;case"left":f=0,p=-1;break;default:dC.Util.error("Unknown emboss direction: "+r)}do{const w=(m-1)*u;let y=f;m+y<1&&(y=0),m+y>c&&(y=0);const x=(m-1+y)*l*4;let C=l;do{const S=w+(C-1)*4;let _=p;C+_<1&&(_=0),C+_>l&&(_=0);const E=x+(C-1+_)*4,h=s[S]-s[E],k=s[S+1]-s[E+1],T=s[S+2]-s[E+2];let N=h;const I=N>0?N:-N,M=k>0?k:-k,L=T>0?T:-T;if(M>I&&(N=k),L>I&&(N=T),N*=e,i){const A=s[S]+N,R=s[S+1]+N,j=s[S+2]+N;s[S]=A>255?255:A<0?0:A,s[S+1]=R>255?255:R<0?0:R,s[S+2]=j>255?255:j<0?0:j}else{let A=n-N;A<0?A=0:A>255&&(A=255),s[S]=s[S+1]=s[S+2]=A}}while(--C)}while(--m)};Td.Emboss=fC;Li.Factory.addGetterSetter(Ed.Node,"embossStrength",.5,(0,p4.getNumberValidator)(),Li.Factory.afterSetFilter);Li.Factory.addGetterSetter(Ed.Node,"embossWhiteLevel",.5,(0,p4.getNumberValidator)(),Li.Factory.afterSetFilter);Li.Factory.addGetterSetter(Ed.Node,"embossDirection","top-left",void 0,Li.Factory.afterSetFilter);Li.Factory.addGetterSetter(Ed.Node,"embossBlend",!1,void 0,Li.Factory.afterSetFilter);var bd={};Object.defineProperty(bd,"__esModule",{value:!0});bd.Enhance=void 0;const M2=Re,hC=st,pC=Ee;function t0(t,e,n,r,i){const s=n-e,l=i-r;if(s===0)return r+l/2;if(l===0)return r;let c=(t-e)/s;return c=l*c+r,c}const gC=function(t){const e=t.data,n=e.length;let r=e[0],i=r,s,l=e[1],c=l,u,f=e[2],p=f,m;const w=this.enhance();if(w===0)return;for(let N=0;N<n;N+=4)s=e[N+0],s<r?r=s:s>i&&(i=s),u=e[N+1],u<l?l=u:u>c&&(c=u),m=e[N+2],m<f?f=m:m>p&&(p=m);i===r&&(i=255,r=0),c===l&&(c=255,l=0),p===f&&(p=255,f=0);let y,x,C,S,_,E,h,k,T;w>0?(x=i+w*(255-i),C=r-w*(r-0),_=c+w*(255-c),E=l-w*(l-0),k=p+w*(255-p),T=f-w*(f-0)):(y=(i+r)*.5,x=i+w*(i-y),C=r+w*(r-y),S=(c+l)*.5,_=c+w*(c-S),E=l+w*(l-S),h=(p+f)*.5,k=p+w*(p-h),T=f+w*(f-h));for(let N=0;N<n;N+=4)e[N+0]=t0(e[N+0],r,i,C,x),e[N+1]=t0(e[N+1],l,c,E,_),e[N+2]=t0(e[N+2],f,p,T,k)};bd.Enhance=gC;M2.Factory.addGetterSetter(hC.Node,"enhance",0,(0,pC.getNumberValidator)(),M2.Factory.afterSetFilter);var Nd={};Object.defineProperty(Nd,"__esModule",{value:!0});Nd.Grayscale=void 0;const mC=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=.34*e[r]+.5*e[r+1]+.16*e[r+2];e[r]=i,e[r+1]=i,e[r+2]=i}};Nd.Grayscale=mC;var Pd={};Object.defineProperty(Pd,"__esModule",{value:!0});Pd.HSL=void 0;const To=Re,Tg=st,Eg=Ee;To.Factory.addGetterSetter(Tg.Node,"hue",0,(0,Eg.getNumberValidator)(),To.Factory.afterSetFilter);To.Factory.addGetterSetter(Tg.Node,"saturation",0,(0,Eg.getNumberValidator)(),To.Factory.afterSetFilter);To.Factory.addGetterSetter(Tg.Node,"luminance",0,(0,Eg.getNumberValidator)(),To.Factory.afterSetFilter);const yC=function(t){const e=t.data,n=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,l=this.luminance()*127,c=r*i*Math.cos(s*Math.PI/180),u=r*i*Math.sin(s*Math.PI/180),f=.299*r+.701*c+.167*u,p=.587*r-.587*c+.33*u,m=.114*r-.114*c-.497*u,w=.299*r-.299*c-.328*u,y=.587*r+.413*c+.035*u,x=.114*r-.114*c+.293*u,C=.299*r-.3*c+1.25*u,S=.587*r-.586*c-1.05*u,_=.114*r+.886*c-.2*u;let E,h,k,T;for(let N=0;N<n;N+=4)E=e[N+0],h=e[N+1],k=e[N+2],T=e[N+3],e[N+0]=f*E+p*h+m*k+l,e[N+1]=w*E+y*h+x*k+l,e[N+2]=C*E+S*h+_*k+l,e[N+3]=T};Pd.HSL=yC;var Md={};Object.defineProperty(Md,"__esModule",{value:!0});Md.HSV=void 0;const Eo=Re,bg=st,Ng=Ee,vC=function(t){const e=t.data,n=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,l=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),u=.299*r+.701*l+.167*c,f=.587*r-.587*l+.33*c,p=.114*r-.114*l-.497*c,m=.299*r-.299*l-.328*c,w=.587*r+.413*l+.035*c,y=.114*r-.114*l+.293*c,x=.299*r-.3*l+1.25*c,C=.587*r-.586*l-1.05*c,S=.114*r+.886*l-.2*c;let _,E,h,k;for(let T=0;T<n;T+=4)_=e[T+0],E=e[T+1],h=e[T+2],k=e[T+3],e[T+0]=u*_+f*E+p*h,e[T+1]=m*_+w*E+y*h,e[T+2]=x*_+C*E+S*h,e[T+3]=k};Md.HSV=vC;Eo.Factory.addGetterSetter(bg.Node,"hue",0,(0,Ng.getNumberValidator)(),Eo.Factory.afterSetFilter);Eo.Factory.addGetterSetter(bg.Node,"saturation",0,(0,Ng.getNumberValidator)(),Eo.Factory.afterSetFilter);Eo.Factory.addGetterSetter(bg.Node,"value",0,(0,Ng.getNumberValidator)(),Eo.Factory.afterSetFilter);var Ad={};Object.defineProperty(Ad,"__esModule",{value:!0});Ad.Invert=void 0;const xC=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};Ad.Invert=xC;var Id={};Object.defineProperty(Id,"__esModule",{value:!0});Id.Kaleidoscope=void 0;const Ic=Re,g4=st,A2=dt,m4=Ee,wC=function(t,e,n){const r=t.data,i=e.data,s=t.width,l=t.height,c=n.polarCenterX||s/2,u=n.polarCenterY||l/2;let f=Math.sqrt(c*c+u*u),p=s-c,m=l-u;const w=Math.sqrt(p*p+m*m);f=w>f?w:f;const y=l,x=s,C=360/x*Math.PI/180;for(let S=0;S<x;S+=1){const _=Math.sin(S*C),E=Math.cos(S*C);for(let h=0;h<y;h+=1){p=Math.floor(c+f*h/y*E),m=Math.floor(u+f*h/y*_);let k=(m*s+p)*4;const T=r[k+0],N=r[k+1],I=r[k+2],M=r[k+3];k=(S+h*s)*4,i[k+0]=T,i[k+1]=N,i[k+2]=I,i[k+3]=M}}},_C=function(t,e,n){const r=t.data,i=e.data,s=t.width,l=t.height,c=n.polarCenterX||s/2,u=n.polarCenterY||l/2;let f=Math.sqrt(c*c+u*u),p=s-c,m=l-u;const w=Math.sqrt(p*p+m*m);f=w>f?w:f;const y=l,x=s,C=n.polarRotation||0;let S,_;for(p=0;p<s;p+=1)for(m=0;m<l;m+=1){const E=p-c,h=m-u,k=Math.sqrt(E*E+h*h)*y/f;let T=(Math.atan2(h,E)*180/Math.PI+360+C)%360;T=T*x/360,S=Math.floor(T),_=Math.floor(k);let N=(_*s+S)*4;const I=r[N+0],M=r[N+1],L=r[N+2],A=r[N+3];N=(m*s+p)*4,i[N+0]=I,i[N+1]=M,i[N+2]=L,i[N+3]=A}},SC=function(t){const e=t.width,n=t.height;let r,i,s,l,c,u,f,p,m,w,y=Math.round(this.kaleidoscopePower());const x=Math.round(this.kaleidoscopeAngle()),C=Math.floor(e*(x%360)/360);if(y<1)return;const S=A2.Util.createCanvasElement();S.width=e,S.height=n;const _=S.getContext("2d").getImageData(0,0,e,n);A2.Util.releaseCanvas(S),wC(t,_,{polarCenterX:e/2,polarCenterY:n/2});let E=e/Math.pow(2,y);for(;E<=8;)E=E*2,y-=1;E=Math.ceil(E);let h=E,k=0,T=h,N=1;for(C+E>e&&(k=h,T=0,N=-1),i=0;i<n;i+=1)for(r=k;r!==T;r+=N)s=Math.round(r+C)%e,m=(e*i+s)*4,c=_.data[m+0],u=_.data[m+1],f=_.data[m+2],p=_.data[m+3],w=(e*i+r)*4,_.data[w+0]=c,_.data[w+1]=u,_.data[w+2]=f,_.data[w+3]=p;for(i=0;i<n;i+=1)for(h=Math.floor(E),l=0;l<y;l+=1){for(r=0;r<h+1;r+=1)m=(e*i+r)*4,c=_.data[m+0],u=_.data[m+1],f=_.data[m+2],p=_.data[m+3],w=(e*i+h*2-r-1)*4,_.data[w+0]=c,_.data[w+1]=u,_.data[w+2]=f,_.data[w+3]=p;h*=2}_C(_,t,{polarRotation:0})};Id.Kaleidoscope=SC;Ic.Factory.addGetterSetter(g4.Node,"kaleidoscopePower",2,(0,m4.getNumberValidator)(),Ic.Factory.afterSetFilter);Ic.Factory.addGetterSetter(g4.Node,"kaleidoscopeAngle",0,(0,m4.getNumberValidator)(),Ic.Factory.afterSetFilter);var Rd={};Object.defineProperty(Rd,"__esModule",{value:!0});Rd.Mask=void 0;const I2=Re,kC=st,CC=Ee;function Ou(t,e,n){let r=(n*t.width+e)*4;const i=[];return i.push(t.data[r++],t.data[r++],t.data[r++],t.data[r++]),i}function _a(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function TC(t){const e=[0,0,0];for(let n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function EC(t,e){const n=Ou(t,0,0),r=Ou(t,t.width-1,0),i=Ou(t,0,t.height-1),s=Ou(t,t.width-1,t.height-1),l=e||10;if(_a(n,r)<l&&_a(r,s)<l&&_a(s,i)<l&&_a(i,n)<l){const c=TC([r,n,s,i]),u=[];for(let f=0;f<t.width*t.height;f++){const p=_a(c,[t.data[f*4],t.data[f*4+1],t.data[f*4+2]]);u[f]=p<l?0:255}return u}}function bC(t,e){for(let n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function NC(t,e,n){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let c=0;c<n;c++)for(let u=0;u<e;u++){const f=c*e+u;let p=0;for(let m=0;m<i;m++)for(let w=0;w<i;w++){const y=c+m-s,x=u+w-s;if(y>=0&&y<n&&x>=0&&x<e){const C=y*e+x,S=r[m*i+w];p+=t[C]*S}}l[f]=p===255*8?255:0}return l}function PC(t,e,n){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let c=0;c<n;c++)for(let u=0;u<e;u++){const f=c*e+u;let p=0;for(let m=0;m<i;m++)for(let w=0;w<i;w++){const y=c+m-s,x=u+w-s;if(y>=0&&y<n&&x>=0&&x<e){const C=y*e+x,S=r[m*i+w];p+=t[C]*S}}l[f]=p>=255*4?255:0}return l}function MC(t,e,n){const r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),l=[];for(let c=0;c<n;c++)for(let u=0;u<e;u++){const f=c*e+u;let p=0;for(let m=0;m<i;m++)for(let w=0;w<i;w++){const y=c+m-s,x=u+w-s;if(y>=0&&y<n&&x>=0&&x<e){const C=y*e+x,S=r[m*i+w];p+=t[C]*S}}l[f]=p}return l}const AC=function(t){const e=this.threshold();let n=EC(t,e);return n&&(n=NC(n,t.width,t.height),n=PC(n,t.width,t.height),n=MC(n,t.width,t.height),bC(t,n)),t};Rd.Mask=AC;I2.Factory.addGetterSetter(kC.Node,"threshold",0,(0,CC.getNumberValidator)(),I2.Factory.afterSetFilter);var Ld={};Object.defineProperty(Ld,"__esModule",{value:!0});Ld.Noise=void 0;const R2=Re,IC=st,RC=Ee,LC=function(t){const e=this.noise()*255,n=t.data,r=n.length,i=e/2;for(let s=0;s<r;s+=4)n[s+0]+=i-2*i*Math.random(),n[s+1]+=i-2*i*Math.random(),n[s+2]+=i-2*i*Math.random()};Ld.Noise=LC;R2.Factory.addGetterSetter(IC.Node,"noise",.2,(0,RC.getNumberValidator)(),R2.Factory.afterSetFilter);var Fd={};Object.defineProperty(Fd,"__esModule",{value:!0});Fd.Pixelate=void 0;const L2=Re,FC=dt,jC=st,OC=Ee,DC=function(t){let e=Math.ceil(this.pixelSize()),n=t.width,r=t.height,i,s,l,c,u,f,p,m=Math.ceil(n/e),w=Math.ceil(r/e),y,x,C,S,_,E,h,k=t.data;if(e<=0){FC.Util.error("pixelSize value can not be <= 0");return}for(_=0;_<m;_+=1)for(E=0;E<w;E+=1){for(c=0,u=0,f=0,p=0,y=_*e,x=y+e,C=E*e,S=C+e,h=0,i=y;i<x;i+=1)if(!(i>=n))for(s=C;s<S;s+=1)s>=r||(l=(n*s+i)*4,c+=k[l+0],u+=k[l+1],f+=k[l+2],p+=k[l+3],h+=1);for(c=c/h,u=u/h,f=f/h,p=p/h,i=y;i<x;i+=1)if(!(i>=n))for(s=C;s<S;s+=1)s>=r||(l=(n*s+i)*4,k[l+0]=c,k[l+1]=u,k[l+2]=f,k[l+3]=p)}};Fd.Pixelate=DC;L2.Factory.addGetterSetter(jC.Node,"pixelSize",8,(0,OC.getNumberValidator)(),L2.Factory.afterSetFilter);var jd={};Object.defineProperty(jd,"__esModule",{value:!0});jd.Posterize=void 0;const F2=Re,zC=st,BC=Ee,UC=function(t){const e=Math.round(this.levels()*254)+1,n=t.data,r=n.length,i=255/e;for(let s=0;s<r;s+=1)n[s]=Math.floor(n[s]/i)*i};jd.Posterize=UC;F2.Factory.addGetterSetter(zC.Node,"levels",.5,(0,BC.getNumberValidator)(),F2.Factory.afterSetFilter);var Od={};Object.defineProperty(Od,"__esModule",{value:!0});Od.RGB=void 0;const Rc=Re,Pg=st,GC=Ee,VC=function(t){const e=t.data,n=e.length,r=this.red(),i=this.green(),s=this.blue();for(let l=0;l<n;l+=4){const c=(.34*e[l]+.5*e[l+1]+.16*e[l+2])/255;e[l]=c*r,e[l+1]=c*i,e[l+2]=c*s,e[l+3]=e[l+3]}};Od.RGB=VC;Rc.Factory.addGetterSetter(Pg.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Rc.Factory.addGetterSetter(Pg.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Rc.Factory.addGetterSetter(Pg.Node,"blue",0,GC.RGBComponent,Rc.Factory.afterSetFilter);var Dd={};Object.defineProperty(Dd,"__esModule",{value:!0});Dd.RGBA=void 0;const ol=Re,zd=st,WC=Ee,$C=function(t){const e=t.data,n=e.length,r=this.red(),i=this.green(),s=this.blue(),l=this.alpha();for(let c=0;c<n;c+=4){const u=1-l;e[c]=r*l+e[c]*u,e[c+1]=i*l+e[c+1]*u,e[c+2]=s*l+e[c+2]*u}};Dd.RGBA=$C;ol.Factory.addGetterSetter(zd.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});ol.Factory.addGetterSetter(zd.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});ol.Factory.addGetterSetter(zd.Node,"blue",0,WC.RGBComponent,ol.Factory.afterSetFilter);ol.Factory.addGetterSetter(zd.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var Bd={};Object.defineProperty(Bd,"__esModule",{value:!0});Bd.Sepia=void 0;const HC=function(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=e[r+0],s=e[r+1],l=e[r+2];e[r+0]=Math.min(255,i*.393+s*.769+l*.189),e[r+1]=Math.min(255,i*.349+s*.686+l*.168),e[r+2]=Math.min(255,i*.272+s*.534+l*.131)}};Bd.Sepia=HC;var Ud={};Object.defineProperty(Ud,"__esModule",{value:!0});Ud.Solarize=void 0;const YC=function(t){const e=t.data,n=t.width,r=t.height,i=n*4;let s=r;do{const l=(s-1)*i;let c=n;do{const u=l+(c-1)*4;let f=e[u],p=e[u+1],m=e[u+2];f>127&&(f=255-f),p>127&&(p=255-p),m>127&&(m=255-m),e[u]=f,e[u+1]=p,e[u+2]=m}while(--c)}while(--s)};Ud.Solarize=YC;var Gd={};Object.defineProperty(Gd,"__esModule",{value:!0});Gd.Threshold=void 0;const j2=Re,XC=st,KC=Ee,QC=function(t){const e=this.threshold()*255,n=t.data,r=n.length;for(let i=0;i<r;i+=1)n[i]=n[i]<e?0:255};Gd.Threshold=QC;j2.Factory.addGetterSetter(XC.Node,"threshold",.5,(0,KC.getNumberValidator)(),j2.Factory.afterSetFilter);Object.defineProperty(qc,"__esModule",{value:!0});qc.Konva=void 0;const O2=Pc,ZC=rd,qC=od,JC=ud,eT=cd,tT=dd,D2=Co,nT=xl,rT=Oo,iT=_l,sT=pd,oT=gd,aT=md,lT=yd,uT=zo,cT=vd,dT=xd,fT=wd,hT=Sd,pT=kd,gT=Cd,mT=Td,yT=bd,vT=Nd,xT=Pd,wT=Md,_T=Ad,ST=Id,kT=Rd,CT=Ld,TT=Fd,ET=jd,bT=Od,NT=Dd,PT=Bd,MT=Ud,AT=Gd;qc.Konva=O2.Konva.Util._assign(O2.Konva,{Arc:ZC.Arc,Arrow:qC.Arrow,Circle:JC.Circle,Ellipse:eT.Ellipse,Image:tT.Image,Label:D2.Label,Tag:D2.Tag,Line:nT.Line,Path:rT.Path,Rect:iT.Rect,RegularPolygon:sT.RegularPolygon,Ring:oT.Ring,Sprite:aT.Sprite,Star:lT.Star,Text:uT.Text,TextPath:cT.TextPath,Transformer:dT.Transformer,Wedge:fT.Wedge,Filters:{Blur:hT.Blur,Brighten:pT.Brighten,Contrast:gT.Contrast,Emboss:mT.Emboss,Enhance:yT.Enhance,Grayscale:vT.Grayscale,HSL:xT.HSL,HSV:wT.HSV,Invert:_T.Invert,Kaleidoscope:ST.Kaleidoscope,Mask:kT.Mask,Noise:CT.Noise,Pixelate:TT.Pixelate,Posterize:ET.Posterize,RGB:bT.RGB,RGBA:NT.RGBA,Sepia:PT.Sepia,Solarize:MT.Solarize,Threshold:AT.Threshold}});var IT=O5.exports;Object.defineProperty(IT,"__esModule",{value:!0});const RT=qc;O5.exports=RT.Konva;var gp={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var n=Pc;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return n.Konva}});const r=Pc;t.exports=r.Konva})(gp,gp.exports);var LT=gp.exports;const al=ul(LT);var y4={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FT=function(e){var n={},r=z,i=ba,s=Object.assign;function l(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,d=1;d<arguments.length;d++)a+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),f=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),x=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),k=Symbol.for("react.offscreen"),T=Symbol.iterator;function N(o){return o===null||typeof o!="object"?null:(o=T&&o[T]||o["@@iterator"],typeof o=="function"?o:null)}function I(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case p:return"Fragment";case f:return"Portal";case w:return"Profiler";case m:return"StrictMode";case S:return"Suspense";case _:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case x:return(o.displayName||"Context")+".Consumer";case y:return(o._context.displayName||"Context")+".Provider";case C:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case E:return a=o.displayName||null,a!==null?a:I(o.type)||"Memo";case h:a=o._payload,o=o._init;try{return I(o(a))}catch{}}return null}function M(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(a);case 8:return a===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function L(o){var a=o,d=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,a.flags&4098&&(d=a.return),o=a.return;while(o)}return a.tag===3?d:null}function A(o){if(L(o)!==o)throw Error(l(188))}function R(o){var a=o.alternate;if(!a){if(a=L(o),a===null)throw Error(l(188));return a!==o?null:o}for(var d=o,g=a;;){var v=d.return;if(v===null)break;var b=v.alternate;if(b===null){if(g=v.return,g!==null){d=g;continue}break}if(v.child===b.child){for(b=v.child;b;){if(b===d)return A(v),o;if(b===g)return A(v),a;b=b.sibling}throw Error(l(188))}if(d.return!==g.return)d=v,g=b;else{for(var F=!1,W=v.child;W;){if(W===d){F=!0,d=v,g=b;break}if(W===g){F=!0,g=v,d=b;break}W=W.sibling}if(!F){for(W=b.child;W;){if(W===d){F=!0,d=b,g=v;break}if(W===g){F=!0,g=b,d=v;break}W=W.sibling}if(!F)throw Error(l(189))}}if(d.alternate!==g)throw Error(l(190))}if(d.tag!==3)throw Error(l(188));return d.stateNode.current===d?o:a}function j(o){return o=R(o),o!==null?G(o):null}function G(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=G(o);if(a!==null)return a;o=o.sibling}return null}function U(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){if(o.tag!==4){var a=U(o);if(a!==null)return a}o=o.sibling}return null}var O=Array.isArray,V=e.getPublicInstance,$=e.getRootHostContext,D=e.getChildHostContext,X=e.prepareForCommit,H=e.resetAfterCommit,re=e.createInstance,K=e.appendInitialChild,ne=e.finalizeInitialChildren,te=e.prepareUpdate,he=e.shouldSetTextContent,de=e.createTextInstance,B=e.scheduleTimeout,Q=e.cancelTimeout,J=e.noTimeout,ie=e.isPrimaryRenderer,ce=e.supportsMutation,_e=e.supportsPersistence,Se=e.supportsHydration,Oe=e.getInstanceFromNode,Ce=e.preparePortalMount,Qe=e.getCurrentEventPriority,Ve=e.detachDeletedInstance,tt=e.supportsMicrotasks,ln=e.scheduleMicrotask,Gt=e.supportsTestSelectors,Vt=e.findFiberRoot,Xn=e.getBoundingRect,Kn=e.getTextContent,Lt=e.isHiddenSubtree,Ar=e.matchAccessibilityRole,Ir=e.setFocusIfFocusable,le=e.setupIntersectionObserver,ue=e.appendChild,fe=e.appendChildToContainer,oe=e.commitTextUpdate,xe=e.commitMount,ke=e.commitUpdate,ft=e.insertBefore,bs=e.insertInContainerBefore,Ns=e.removeChild,Sl=e.removeChildFromContainer,$i=e.resetTextContent,Fg=e.hideInstance,Bo=e.hideTextInstance,$d=e.unhideInstance,Hd=e.unhideTextInstance,M4=e.clearContainer,A4=e.cloneInstance,jg=e.createContainerChildSet,Og=e.appendChildToContainerChildSet,I4=e.finalizeContainerChildren,Yd=e.replaceContainerChildren,Dg=e.cloneHiddenInstance,zg=e.cloneHiddenTextInstance,R4=e.canHydrateInstance,L4=e.canHydrateTextInstance,F4=e.canHydrateSuspenseInstance,Bg=e.isSuspenseInstancePending,Xd=e.isSuspenseInstanceFallback,j4=e.getSuspenseInstanceFallbackErrorDetails,O4=e.registerSuspenseInstanceRetry,kl=e.getNextHydratableSibling,D4=e.getFirstHydratableChild,z4=e.getFirstHydratableChildWithinContainer,B4=e.getFirstHydratableChildWithinSuspenseInstance,U4=e.hydrateInstance,G4=e.hydrateTextInstance,V4=e.hydrateSuspenseInstance,W4=e.getNextHydratableInstanceAfterSuspenseInstance,$4=e.commitHydratedContainer,H4=e.commitHydratedSuspenseInstance,Y4=e.clearSuspenseBoundary,X4=e.clearSuspenseBoundaryFromContainer,K4=e.shouldDeleteUnhydratedTailInstances,Q4=e.didNotMatchHydratedContainerTextInstance,Z4=e.didNotMatchHydratedTextInstance,Kd;function Uo(o){if(Kd===void 0)try{throw Error()}catch(d){var a=d.stack.trim().match(/\n( *(at )?)/);Kd=a&&a[1]||""}return`
`+Kd+o}var Qd=!1;function Zd(o,a){if(!o||Qd)return"";Qd=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ae){var g=ae}Reflect.construct(o,[],a)}else{try{a.call()}catch(ae){g=ae}o.call(a.prototype)}else{try{throw Error()}catch(ae){g=ae}o()}}catch(ae){if(ae&&g&&typeof ae.stack=="string"){for(var v=ae.stack.split(`
`),b=g.stack.split(`
`),F=v.length-1,W=b.length-1;1<=F&&0<=W&&v[F]!==b[W];)W--;for(;1<=F&&0<=W;F--,W--)if(v[F]!==b[W]){if(F!==1||W!==1)do if(F--,W--,0>W||v[F]!==b[W]){var q=`
`+v[F].replace(" at new "," at ");return o.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",o.displayName)),q}while(1<=F&&0<=W);break}}}finally{Qd=!1,Error.prepareStackTrace=d}return(o=o?o.displayName||o.name:"")?Uo(o):""}var q4=Object.prototype.hasOwnProperty,qd=[],Ps=-1;function ii(o){return{current:o}}function Ze(o){0>Ps||(o.current=qd[Ps],qd[Ps]=null,Ps--)}function Xe(o,a){Ps++,qd[Ps]=o.current,o.current=a}var si={},Wt=ii(si),un=ii(!1),Hi=si;function Ms(o,a){var d=o.type.contextTypes;if(!d)return si;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===a)return g.__reactInternalMemoizedMaskedChildContext;var v={},b;for(b in d)v[b]=a[b];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=v),v}function cn(o){return o=o.childContextTypes,o!=null}function Cl(){Ze(un),Ze(Wt)}function Ug(o,a,d){if(Wt.current!==si)throw Error(l(168));Xe(Wt,a),Xe(un,d)}function Gg(o,a,d){var g=o.stateNode;if(a=a.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var v in g)if(!(v in a))throw Error(l(108,M(o)||"Unknown",v));return s({},d,g)}function Tl(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||si,Hi=Wt.current,Xe(Wt,o),Xe(un,un.current),!0}function Vg(o,a,d){var g=o.stateNode;if(!g)throw Error(l(169));d?(o=Gg(o,a,Hi),g.__reactInternalMemoizedMergedChildContext=o,Ze(un),Ze(Wt),Xe(Wt,o)):Ze(un),Xe(un,d)}var Qn=Math.clz32?Math.clz32:t6,J4=Math.log,e6=Math.LN2;function t6(o){return o>>>=0,o===0?32:31-(J4(o)/e6|0)|0}var El=64,bl=4194304;function Go(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Nl(o,a){var d=o.pendingLanes;if(d===0)return 0;var g=0,v=o.suspendedLanes,b=o.pingedLanes,F=d&268435455;if(F!==0){var W=F&~v;W!==0?g=Go(W):(b&=F,b!==0&&(g=Go(b)))}else F=d&~v,F!==0?g=Go(F):b!==0&&(g=Go(b));if(g===0)return 0;if(a!==0&&a!==g&&!(a&v)&&(v=g&-g,b=a&-a,v>=b||v===16&&(b&4194240)!==0))return a;if(g&4&&(g|=d&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=g;0<a;)d=31-Qn(a),v=1<<d,g|=o[d],a&=~v;return g}function n6(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function r6(o,a){for(var d=o.suspendedLanes,g=o.pingedLanes,v=o.expirationTimes,b=o.pendingLanes;0<b;){var F=31-Qn(b),W=1<<F,q=v[F];q===-1?(!(W&d)||W&g)&&(v[F]=n6(W,a)):q<=a&&(o.expiredLanes|=W),b&=~W}}function Jd(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Wg(){var o=El;return El<<=1,!(El&4194240)&&(El=64),o}function ef(o){for(var a=[],d=0;31>d;d++)a.push(o);return a}function Vo(o,a,d){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-Qn(a),o[a]=d}function i6(o,a){var d=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<d;){var v=31-Qn(d),b=1<<v;a[v]=0,g[v]=-1,o[v]=-1,d&=~b}}function tf(o,a){var d=o.entangledLanes|=a;for(o=o.entanglements;d;){var g=31-Qn(d),v=1<<g;v&a|o[g]&a&&(o[g]|=a),d&=~v}}var ze=0;function $g(o){return o&=-o,1<o?4<o?o&268435455?16:536870912:4:1}var nf=i.unstable_scheduleCallback,Hg=i.unstable_cancelCallback,s6=i.unstable_shouldYield,o6=i.unstable_requestPaint,Nt=i.unstable_now,rf=i.unstable_ImmediatePriority,a6=i.unstable_UserBlockingPriority,sf=i.unstable_NormalPriority,l6=i.unstable_IdlePriority,Pl=null,pr=null;function u6(o){if(pr&&typeof pr.onCommitFiberRoot=="function")try{pr.onCommitFiberRoot(Pl,o,void 0,(o.current.flags&128)===128)}catch{}}function c6(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var Zn=typeof Object.is=="function"?Object.is:c6,Rr=null,Ml=!1,of=!1;function Yg(o){Rr===null?Rr=[o]:Rr.push(o)}function d6(o){Ml=!0,Yg(o)}function gr(){if(!of&&Rr!==null){of=!0;var o=0,a=ze;try{var d=Rr;for(ze=1;o<d.length;o++){var g=d[o];do g=g(!0);while(g!==null)}Rr=null,Ml=!1}catch(v){throw Rr!==null&&(Rr=Rr.slice(o+1)),nf(rf,gr),v}finally{ze=a,of=!1}}return null}var As=[],Is=0,Al=null,Il=0,Mn=[],An=0,Yi=null,Lr=1,Fr="";function Xi(o,a){As[Is++]=Il,As[Is++]=Al,Al=o,Il=a}function Xg(o,a,d){Mn[An++]=Lr,Mn[An++]=Fr,Mn[An++]=Yi,Yi=o;var g=Lr;o=Fr;var v=32-Qn(g)-1;g&=~(1<<v),d+=1;var b=32-Qn(a)+v;if(30<b){var F=v-v%5;b=(g&(1<<F)-1).toString(32),g>>=F,v-=F,Lr=1<<32-Qn(a)+v|d<<v|g,Fr=b+o}else Lr=1<<b|d<<v|g,Fr=o}function af(o){o.return!==null&&(Xi(o,1),Xg(o,1,0))}function lf(o){for(;o===Al;)Al=As[--Is],As[Is]=null,Il=As[--Is],As[Is]=null;for(;o===Yi;)Yi=Mn[--An],Mn[An]=null,Fr=Mn[--An],Mn[An]=null,Lr=Mn[--An],Mn[An]=null}var Sn=null,In=null,nt=!1,Wo=!1,qn=null;function Kg(o,a){var d=On(5,null,null,0);d.elementType="DELETED",d.stateNode=a,d.return=o,a=o.deletions,a===null?(o.deletions=[d],o.flags|=16):a.push(d)}function Qg(o,a){switch(o.tag){case 5:return a=R4(a,o.type,o.pendingProps),a!==null?(o.stateNode=a,Sn=o,In=D4(a),!0):!1;case 6:return a=L4(a,o.pendingProps),a!==null?(o.stateNode=a,Sn=o,In=null,!0):!1;case 13:if(a=F4(a),a!==null){var d=Yi!==null?{id:Lr,overflow:Fr}:null;return o.memoizedState={dehydrated:a,treeContext:d,retryLane:1073741824},d=On(18,null,null,0),d.stateNode=a,d.return=o,o.child=d,Sn=o,In=null,!0}return!1;default:return!1}}function uf(o){return(o.mode&1)!==0&&(o.flags&128)===0}function cf(o){if(nt){var a=In;if(a){var d=a;if(!Qg(o,a)){if(uf(o))throw Error(l(418));a=kl(d);var g=Sn;a&&Qg(o,a)?Kg(g,d):(o.flags=o.flags&-4097|2,nt=!1,Sn=o)}}else{if(uf(o))throw Error(l(418));o.flags=o.flags&-4097|2,nt=!1,Sn=o}}}function Zg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Sn=o}function Rl(o){if(!Se||o!==Sn)return!1;if(!nt)return Zg(o),nt=!0,!1;if(o.tag!==3&&(o.tag!==5||K4(o.type)&&!he(o.type,o.memoizedProps))){var a=In;if(a){if(uf(o))throw qg(),Error(l(418));for(;a;)Kg(o,a),a=kl(a)}}if(Zg(o),o.tag===13){if(!Se)throw Error(l(316));if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(l(317));In=W4(o)}else In=Sn?kl(o.stateNode):null;return!0}function qg(){for(var o=In;o;)o=kl(o)}function Rs(){Se&&(In=Sn=null,Wo=nt=!1)}function df(o){qn===null?qn=[o]:qn.push(o)}var f6=c.ReactCurrentBatchConfig;function Ll(o,a){if(Zn(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var d=Object.keys(o),g=Object.keys(a);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var v=d[g];if(!q4.call(a,v)||!Zn(o[v],a[v]))return!1}return!0}function h6(o){switch(o.tag){case 5:return Uo(o.type);case 16:return Uo("Lazy");case 13:return Uo("Suspense");case 19:return Uo("SuspenseList");case 0:case 2:case 15:return o=Zd(o.type,!1),o;case 11:return o=Zd(o.type.render,!1),o;case 1:return o=Zd(o.type,!0),o;default:return""}}function $o(o,a,d){if(o=d.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(l(309));var g=d.stateNode}if(!g)throw Error(l(147,o));var v=g,b=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===b?a.ref:(a=function(F){var W=v.refs;F===null?delete W[b]:W[b]=F},a._stringRef=b,a)}if(typeof o!="string")throw Error(l(284));if(!d._owner)throw Error(l(290,o))}return o}function Fl(o,a){throw o=Object.prototype.toString.call(a),Error(l(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function Jg(o){var a=o._init;return a(o._payload)}function e1(o){function a(Z,Y){if(o){var ee=Z.deletions;ee===null?(Z.deletions=[Y],Z.flags|=16):ee.push(Y)}}function d(Z,Y){if(!o)return null;for(;Y!==null;)a(Z,Y),Y=Y.sibling;return null}function g(Z,Y){for(Z=new Map;Y!==null;)Y.key!==null?Z.set(Y.key,Y):Z.set(Y.index,Y),Y=Y.sibling;return Z}function v(Z,Y){return Z=fi(Z,Y),Z.index=0,Z.sibling=null,Z}function b(Z,Y,ee){return Z.index=ee,o?(ee=Z.alternate,ee!==null?(ee=ee.index,ee<Y?(Z.flags|=2,Y):ee):(Z.flags|=2,Y)):(Z.flags|=1048576,Y)}function F(Z){return o&&Z.alternate===null&&(Z.flags|=2),Z}function W(Z,Y,ee,ge){return Y===null||Y.tag!==6?(Y=oh(ee,Z.mode,ge),Y.return=Z,Y):(Y=v(Y,ee),Y.return=Z,Y)}function q(Z,Y,ee,ge){var Te=ee.type;return Te===p?we(Z,Y,ee.props.children,ge,ee.key):Y!==null&&(Y.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===h&&Jg(Te)===Y.type)?(ge=v(Y,ee.props),ge.ref=$o(Z,Y,ee),ge.return=Z,ge):(ge=fu(ee.type,ee.key,ee.props,null,Z.mode,ge),ge.ref=$o(Z,Y,ee),ge.return=Z,ge)}function ae(Z,Y,ee,ge){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==ee.containerInfo||Y.stateNode.implementation!==ee.implementation?(Y=ah(ee,Z.mode,ge),Y.return=Z,Y):(Y=v(Y,ee.children||[]),Y.return=Z,Y)}function we(Z,Y,ee,ge,Te){return Y===null||Y.tag!==7?(Y=ts(ee,Z.mode,ge,Te),Y.return=Z,Y):(Y=v(Y,ee),Y.return=Z,Y)}function Ne(Z,Y,ee){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=oh(""+Y,Z.mode,ee),Y.return=Z,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case u:return ee=fu(Y.type,Y.key,Y.props,null,Z.mode,ee),ee.ref=$o(Z,null,Y),ee.return=Z,ee;case f:return Y=ah(Y,Z.mode,ee),Y.return=Z,Y;case h:var ge=Y._init;return Ne(Z,ge(Y._payload),ee)}if(O(Y)||N(Y))return Y=ts(Y,Z.mode,ee,null),Y.return=Z,Y;Fl(Z,Y)}return null}function pe(Z,Y,ee,ge){var Te=Y!==null?Y.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number")return Te!==null?null:W(Z,Y,""+ee,ge);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case u:return ee.key===Te?q(Z,Y,ee,ge):null;case f:return ee.key===Te?ae(Z,Y,ee,ge):null;case h:return Te=ee._init,pe(Z,Y,Te(ee._payload),ge)}if(O(ee)||N(ee))return Te!==null?null:we(Z,Y,ee,ge,null);Fl(Z,ee)}return null}function qe(Z,Y,ee,ge,Te){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return Z=Z.get(ee)||null,W(Y,Z,""+ge,Te);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case u:return Z=Z.get(ge.key===null?ee:ge.key)||null,q(Y,Z,ge,Te);case f:return Z=Z.get(ge.key===null?ee:ge.key)||null,ae(Y,Z,ge,Te);case h:var Me=ge._init;return qe(Z,Y,ee,Me(ge._payload),Te)}if(O(ge)||N(ge))return Z=Z.get(ee)||null,we(Y,Z,ge,Te,null);Fl(Y,ge)}return null}function He(Z,Y,ee,ge){for(var Te=null,Me=null,Pe=Y,Be=Y=0,At=null;Pe!==null&&Be<ee.length;Be++){Pe.index>Be?(At=Pe,Pe=null):At=Pe.sibling;var Ue=pe(Z,Pe,ee[Be],ge);if(Ue===null){Pe===null&&(Pe=At);break}o&&Pe&&Ue.alternate===null&&a(Z,Pe),Y=b(Ue,Y,Be),Me===null?Te=Ue:Me.sibling=Ue,Me=Ue,Pe=At}if(Be===ee.length)return d(Z,Pe),nt&&Xi(Z,Be),Te;if(Pe===null){for(;Be<ee.length;Be++)Pe=Ne(Z,ee[Be],ge),Pe!==null&&(Y=b(Pe,Y,Be),Me===null?Te=Pe:Me.sibling=Pe,Me=Pe);return nt&&Xi(Z,Be),Te}for(Pe=g(Z,Pe);Be<ee.length;Be++)At=qe(Pe,Z,Be,ee[Be],ge),At!==null&&(o&&At.alternate!==null&&Pe.delete(At.key===null?Be:At.key),Y=b(At,Y,Be),Me===null?Te=At:Me.sibling=At,Me=At);return o&&Pe.forEach(function(hi){return a(Z,hi)}),nt&&Xi(Z,Be),Te}function pn(Z,Y,ee,ge){var Te=N(ee);if(typeof Te!="function")throw Error(l(150));if(ee=Te.call(ee),ee==null)throw Error(l(151));for(var Me=Te=null,Pe=Y,Be=Y=0,At=null,Ue=ee.next();Pe!==null&&!Ue.done;Be++,Ue=ee.next()){Pe.index>Be?(At=Pe,Pe=null):At=Pe.sibling;var hi=pe(Z,Pe,Ue.value,ge);if(hi===null){Pe===null&&(Pe=At);break}o&&Pe&&hi.alternate===null&&a(Z,Pe),Y=b(hi,Y,Be),Me===null?Te=hi:Me.sibling=hi,Me=hi,Pe=At}if(Ue.done)return d(Z,Pe),nt&&Xi(Z,Be),Te;if(Pe===null){for(;!Ue.done;Be++,Ue=ee.next())Ue=Ne(Z,Ue.value,ge),Ue!==null&&(Y=b(Ue,Y,Be),Me===null?Te=Ue:Me.sibling=Ue,Me=Ue);return nt&&Xi(Z,Be),Te}for(Pe=g(Z,Pe);!Ue.done;Be++,Ue=ee.next())Ue=qe(Pe,Z,Be,Ue.value,ge),Ue!==null&&(o&&Ue.alternate!==null&&Pe.delete(Ue.key===null?Be:Ue.key),Y=b(Ue,Y,Be),Me===null?Te=Ue:Me.sibling=Ue,Me=Ue);return o&&Pe.forEach(function(V6){return a(Z,V6)}),nt&&Xi(Z,Be),Te}function zr(Z,Y,ee,ge){if(typeof ee=="object"&&ee!==null&&ee.type===p&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case u:e:{for(var Te=ee.key,Me=Y;Me!==null;){if(Me.key===Te){if(Te=ee.type,Te===p){if(Me.tag===7){d(Z,Me.sibling),Y=v(Me,ee.props.children),Y.return=Z,Z=Y;break e}}else if(Me.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===h&&Jg(Te)===Me.type){d(Z,Me.sibling),Y=v(Me,ee.props),Y.ref=$o(Z,Me,ee),Y.return=Z,Z=Y;break e}d(Z,Me);break}else a(Z,Me);Me=Me.sibling}ee.type===p?(Y=ts(ee.props.children,Z.mode,ge,ee.key),Y.return=Z,Z=Y):(ge=fu(ee.type,ee.key,ee.props,null,Z.mode,ge),ge.ref=$o(Z,Y,ee),ge.return=Z,Z=ge)}return F(Z);case f:e:{for(Me=ee.key;Y!==null;){if(Y.key===Me)if(Y.tag===4&&Y.stateNode.containerInfo===ee.containerInfo&&Y.stateNode.implementation===ee.implementation){d(Z,Y.sibling),Y=v(Y,ee.children||[]),Y.return=Z,Z=Y;break e}else{d(Z,Y);break}else a(Z,Y);Y=Y.sibling}Y=ah(ee,Z.mode,ge),Y.return=Z,Z=Y}return F(Z);case h:return Me=ee._init,zr(Z,Y,Me(ee._payload),ge)}if(O(ee))return He(Z,Y,ee,ge);if(N(ee))return pn(Z,Y,ee,ge);Fl(Z,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"?(ee=""+ee,Y!==null&&Y.tag===6?(d(Z,Y.sibling),Y=v(Y,ee),Y.return=Z,Z=Y):(d(Z,Y),Y=oh(ee,Z.mode,ge),Y.return=Z,Z=Y),F(Z)):d(Z,Y)}return zr}var Ls=e1(!0),t1=e1(!1),jl=ii(null),Ol=null,Fs=null,ff=null;function hf(){ff=Fs=Ol=null}function n1(o,a,d){ie?(Xe(jl,a._currentValue),a._currentValue=d):(Xe(jl,a._currentValue2),a._currentValue2=d)}function pf(o){var a=jl.current;Ze(jl),ie?o._currentValue=a:o._currentValue2=a}function gf(o,a,d){for(;o!==null;){var g=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),o===d)break;o=o.return}}function js(o,a){Ol=o,ff=Fs=null,o=o.dependencies,o!==null&&o.firstContext!==null&&(o.lanes&a&&(dn=!0),o.firstContext=null)}function Rn(o){var a=ie?o._currentValue:o._currentValue2;if(ff!==o)if(o={context:o,memoizedValue:a,next:null},Fs===null){if(Ol===null)throw Error(l(308));Fs=o,Ol.dependencies={lanes:0,firstContext:o}}else Fs=Fs.next=o;return a}var Ki=null;function mf(o){Ki===null?Ki=[o]:Ki.push(o)}function r1(o,a,d,g){var v=a.interleaved;return v===null?(d.next=d,mf(a)):(d.next=v.next,v.next=d),a.interleaved=d,mr(o,g)}function mr(o,a){o.lanes|=a;var d=o.alternate;for(d!==null&&(d.lanes|=a),d=o,o=o.return;o!==null;)o.childLanes|=a,d=o.alternate,d!==null&&(d.childLanes|=a),d=o,o=o.return;return d.tag===3?d.stateNode:null}var oi=!1;function yf(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function i1(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function jr(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function ai(o,a,d){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,Ie&2){var v=g.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),g.pending=a,mr(o,d)}return v=g.interleaved,v===null?(a.next=a,mf(g)):(a.next=v.next,v.next=a),g.interleaved=a,mr(o,d)}function Dl(o,a,d){if(a=a.updateQueue,a!==null&&(a=a.shared,(d&4194240)!==0)){var g=a.lanes;g&=o.pendingLanes,d|=g,a.lanes=d,tf(o,d)}}function s1(o,a){var d=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var v=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var F={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};b===null?v=b=F:b=b.next=F,d=d.next}while(d!==null);b===null?v=b=a:b=b.next=a}else v=b=a;d={baseState:g.baseState,firstBaseUpdate:v,lastBaseUpdate:b,shared:g.shared,effects:g.effects},o.updateQueue=d;return}o=d.lastBaseUpdate,o===null?d.firstBaseUpdate=a:o.next=a,d.lastBaseUpdate=a}function zl(o,a,d,g){var v=o.updateQueue;oi=!1;var b=v.firstBaseUpdate,F=v.lastBaseUpdate,W=v.shared.pending;if(W!==null){v.shared.pending=null;var q=W,ae=q.next;q.next=null,F===null?b=ae:F.next=ae,F=q;var we=o.alternate;we!==null&&(we=we.updateQueue,W=we.lastBaseUpdate,W!==F&&(W===null?we.firstBaseUpdate=ae:W.next=ae,we.lastBaseUpdate=q))}if(b!==null){var Ne=v.baseState;F=0,we=ae=q=null,W=b;do{var pe=W.lane,qe=W.eventTime;if((g&pe)===pe){we!==null&&(we=we.next={eventTime:qe,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var He=o,pn=W;switch(pe=a,qe=d,pn.tag){case 1:if(He=pn.payload,typeof He=="function"){Ne=He.call(qe,Ne,pe);break e}Ne=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=pn.payload,pe=typeof He=="function"?He.call(qe,Ne,pe):He,pe==null)break e;Ne=s({},Ne,pe);break e;case 2:oi=!0}}W.callback!==null&&W.lane!==0&&(o.flags|=64,pe=v.effects,pe===null?v.effects=[W]:pe.push(W))}else qe={eventTime:qe,lane:pe,tag:W.tag,payload:W.payload,callback:W.callback,next:null},we===null?(ae=we=qe,q=Ne):we=we.next=qe,F|=pe;if(W=W.next,W===null){if(W=v.shared.pending,W===null)break;pe=W,W=pe.next,pe.next=null,v.lastBaseUpdate=pe,v.shared.pending=null}}while(1);if(we===null&&(q=Ne),v.baseState=q,v.firstBaseUpdate=ae,v.lastBaseUpdate=we,a=v.shared.interleaved,a!==null){v=a;do F|=v.lane,v=v.next;while(v!==a)}else b===null&&(v.shared.lanes=0);Zi|=F,o.lanes=F,o.memoizedState=Ne}}function o1(o,a,d){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var g=o[a],v=g.callback;if(v!==null){if(g.callback=null,g=d,typeof v!="function")throw Error(l(191,v));v.call(g)}}}var Ho={},Ln=ii(Ho),Yo=ii(Ho),Os=ii(Ho);function yr(o){if(o===Ho)throw Error(l(174));return o}function vf(o,a){Xe(Os,a),Xe(Yo,o),Xe(Ln,Ho),o=$(a),Ze(Ln),Xe(Ln,o)}function Ds(){Ze(Ln),Ze(Yo),Ze(Os)}function a1(o){var a=yr(Os.current),d=yr(Ln.current);a=D(d,o.type,a),d!==a&&(Xe(Yo,o),Xe(Ln,a))}function xf(o){Yo.current===o&&(Ze(Ln),Ze(Yo))}var ot=ii(0);function Bl(o){for(var a=o;a!==null;){if(a.tag===13){var d=a.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||Bg(d)||Xd(d)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var wf=[];function _f(){for(var o=0;o<wf.length;o++){var a=wf[o];ie?a._workInProgressVersionPrimary=null:a._workInProgressVersionSecondary=null}wf.length=0}var Ul=c.ReactCurrentDispatcher,Sf=c.ReactCurrentBatchConfig,Qi=0,at=null,_t=null,Pt=null,Gl=!1,Xo=!1,Ko=0,p6=0;function $t(){throw Error(l(321))}function kf(o,a){if(a===null)return!1;for(var d=0;d<a.length&&d<o.length;d++)if(!Zn(o[d],a[d]))return!1;return!0}function Cf(o,a,d,g,v,b){if(Qi=b,at=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Ul.current=o===null||o.memoizedState===null?v6:x6,o=d(g,v),Xo){b=0;do{if(Xo=!1,Ko=0,25<=b)throw Error(l(301));b+=1,Pt=_t=null,a.updateQueue=null,Ul.current=w6,o=d(g,v)}while(Xo)}if(Ul.current=$l,a=_t!==null&&_t.next!==null,Qi=0,Pt=_t=at=null,Gl=!1,a)throw Error(l(300));return o}function Tf(){var o=Ko!==0;return Ko=0,o}function vr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pt===null?at.memoizedState=Pt=o:Pt=Pt.next=o,Pt}function Fn(){if(_t===null){var o=at.alternate;o=o!==null?o.memoizedState:null}else o=_t.next;var a=Pt===null?at.memoizedState:Pt.next;if(a!==null)Pt=a,_t=o;else{if(o===null)throw Error(l(310));_t=o,o={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},Pt===null?at.memoizedState=Pt=o:Pt=Pt.next=o}return Pt}function Qo(o,a){return typeof a=="function"?a(o):a}function Ef(o){var a=Fn(),d=a.queue;if(d===null)throw Error(l(311));d.lastRenderedReducer=o;var g=_t,v=g.baseQueue,b=d.pending;if(b!==null){if(v!==null){var F=v.next;v.next=b.next,b.next=F}g.baseQueue=v=b,d.pending=null}if(v!==null){b=v.next,g=g.baseState;var W=F=null,q=null,ae=b;do{var we=ae.lane;if((Qi&we)===we)q!==null&&(q=q.next={lane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),g=ae.hasEagerState?ae.eagerState:o(g,ae.action);else{var Ne={lane:we,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null};q===null?(W=q=Ne,F=g):q=q.next=Ne,at.lanes|=we,Zi|=we}ae=ae.next}while(ae!==null&&ae!==b);q===null?F=g:q.next=W,Zn(g,a.memoizedState)||(dn=!0),a.memoizedState=g,a.baseState=F,a.baseQueue=q,d.lastRenderedState=g}if(o=d.interleaved,o!==null){v=o;do b=v.lane,at.lanes|=b,Zi|=b,v=v.next;while(v!==o)}else v===null&&(d.lanes=0);return[a.memoizedState,d.dispatch]}function bf(o){var a=Fn(),d=a.queue;if(d===null)throw Error(l(311));d.lastRenderedReducer=o;var g=d.dispatch,v=d.pending,b=a.memoizedState;if(v!==null){d.pending=null;var F=v=v.next;do b=o(b,F.action),F=F.next;while(F!==v);Zn(b,a.memoizedState)||(dn=!0),a.memoizedState=b,a.baseQueue===null&&(a.baseState=b),d.lastRenderedState=b}return[b,g]}function l1(){}function u1(o,a){var d=at,g=Fn(),v=a(),b=!Zn(g.memoizedState,v);if(b&&(g.memoizedState=v,dn=!0),g=g.queue,Nf(f1.bind(null,d,g,o),[o]),g.getSnapshot!==a||b||Pt!==null&&Pt.memoizedState.tag&1){if(d.flags|=2048,Zo(9,d1.bind(null,d,g,v,a),void 0,null),Mt===null)throw Error(l(349));Qi&30||c1(d,a,v)}return v}function c1(o,a,d){o.flags|=16384,o={getSnapshot:a,value:d},a=at.updateQueue,a===null?(a={lastEffect:null,stores:null},at.updateQueue=a,a.stores=[o]):(d=a.stores,d===null?a.stores=[o]:d.push(o))}function d1(o,a,d,g){a.value=d,a.getSnapshot=g,h1(a)&&p1(o)}function f1(o,a,d){return d(function(){h1(a)&&p1(o)})}function h1(o){var a=o.getSnapshot;o=o.value;try{var d=a();return!Zn(o,d)}catch{return!0}}function p1(o){var a=mr(o,1);a!==null&&jn(a,o,1,-1)}function g1(o){var a=vr();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:o},a.queue=o,o=o.dispatch=y6.bind(null,at,o),[a.memoizedState,o]}function Zo(o,a,d,g){return o={tag:o,create:a,destroy:d,deps:g,next:null},a=at.updateQueue,a===null?(a={lastEffect:null,stores:null},at.updateQueue=a,a.lastEffect=o.next=o):(d=a.lastEffect,d===null?a.lastEffect=o.next=o:(g=d.next,d.next=o,o.next=g,a.lastEffect=o)),o}function m1(){return Fn().memoizedState}function Vl(o,a,d,g){var v=vr();at.flags|=o,v.memoizedState=Zo(1|a,d,void 0,g===void 0?null:g)}function Wl(o,a,d,g){var v=Fn();g=g===void 0?null:g;var b=void 0;if(_t!==null){var F=_t.memoizedState;if(b=F.destroy,g!==null&&kf(g,F.deps)){v.memoizedState=Zo(a,d,b,g);return}}at.flags|=o,v.memoizedState=Zo(1|a,d,b,g)}function y1(o,a){return Vl(8390656,8,o,a)}function Nf(o,a){return Wl(2048,8,o,a)}function v1(o,a){return Wl(4,2,o,a)}function x1(o,a){return Wl(4,4,o,a)}function w1(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function _1(o,a,d){return d=d!=null?d.concat([o]):null,Wl(4,4,w1.bind(null,a,o),d)}function Pf(){}function S1(o,a){var d=Fn();a=a===void 0?null:a;var g=d.memoizedState;return g!==null&&a!==null&&kf(a,g[1])?g[0]:(d.memoizedState=[o,a],o)}function k1(o,a){var d=Fn();a=a===void 0?null:a;var g=d.memoizedState;return g!==null&&a!==null&&kf(a,g[1])?g[0]:(o=o(),d.memoizedState=[o,a],o)}function C1(o,a,d){return Qi&21?(Zn(d,a)||(d=Wg(),at.lanes|=d,Zi|=d,o.baseState=!0),a):(o.baseState&&(o.baseState=!1,dn=!0),o.memoizedState=d)}function g6(o,a){var d=ze;ze=d!==0&&4>d?d:4,o(!0);var g=Sf.transition;Sf.transition={};try{o(!1),a()}finally{ze=d,Sf.transition=g}}function T1(){return Fn().memoizedState}function m6(o,a,d){var g=ci(o);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},E1(o))b1(a,d);else if(d=r1(o,a,d,g),d!==null){var v=Xt();jn(d,o,g,v),N1(d,a,g)}}function y6(o,a,d){var g=ci(o),v={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(E1(o))b1(a,v);else{var b=o.alternate;if(o.lanes===0&&(b===null||b.lanes===0)&&(b=a.lastRenderedReducer,b!==null))try{var F=a.lastRenderedState,W=b(F,d);if(v.hasEagerState=!0,v.eagerState=W,Zn(W,F)){var q=a.interleaved;q===null?(v.next=v,mf(a)):(v.next=q.next,q.next=v),a.interleaved=v;return}}catch{}finally{}d=r1(o,a,v,g),d!==null&&(v=Xt(),jn(d,o,g,v),N1(d,a,g))}}function E1(o){var a=o.alternate;return o===at||a!==null&&a===at}function b1(o,a){Xo=Gl=!0;var d=o.pending;d===null?a.next=a:(a.next=d.next,d.next=a),o.pending=a}function N1(o,a,d){if(d&4194240){var g=a.lanes;g&=o.pendingLanes,d|=g,a.lanes=d,tf(o,d)}}var $l={readContext:Rn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},v6={readContext:Rn,useCallback:function(o,a){return vr().memoizedState=[o,a===void 0?null:a],o},useContext:Rn,useEffect:y1,useImperativeHandle:function(o,a,d){return d=d!=null?d.concat([o]):null,Vl(4194308,4,w1.bind(null,a,o),d)},useLayoutEffect:function(o,a){return Vl(4194308,4,o,a)},useInsertionEffect:function(o,a){return Vl(4,2,o,a)},useMemo:function(o,a){var d=vr();return a=a===void 0?null:a,o=o(),d.memoizedState=[o,a],o},useReducer:function(o,a,d){var g=vr();return a=d!==void 0?d(a):a,g.memoizedState=g.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},g.queue=o,o=o.dispatch=m6.bind(null,at,o),[g.memoizedState,o]},useRef:function(o){var a=vr();return o={current:o},a.memoizedState=o},useState:g1,useDebugValue:Pf,useDeferredValue:function(o){return vr().memoizedState=o},useTransition:function(){var o=g1(!1),a=o[0];return o=g6.bind(null,o[1]),vr().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,d){var g=at,v=vr();if(nt){if(d===void 0)throw Error(l(407));d=d()}else{if(d=a(),Mt===null)throw Error(l(349));Qi&30||c1(g,a,d)}v.memoizedState=d;var b={value:d,getSnapshot:a};return v.queue=b,y1(f1.bind(null,g,b,o),[o]),g.flags|=2048,Zo(9,d1.bind(null,g,b,d,a),void 0,null),d},useId:function(){var o=vr(),a=Mt.identifierPrefix;if(nt){var d=Fr,g=Lr;d=(g&~(1<<32-Qn(g)-1)).toString(32)+d,a=":"+a+"R"+d,d=Ko++,0<d&&(a+="H"+d.toString(32)),a+=":"}else d=p6++,a=":"+a+"r"+d.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},x6={readContext:Rn,useCallback:S1,useContext:Rn,useEffect:Nf,useImperativeHandle:_1,useInsertionEffect:v1,useLayoutEffect:x1,useMemo:k1,useReducer:Ef,useRef:m1,useState:function(){return Ef(Qo)},useDebugValue:Pf,useDeferredValue:function(o){var a=Fn();return C1(a,_t.memoizedState,o)},useTransition:function(){var o=Ef(Qo)[0],a=Fn().memoizedState;return[o,a]},useMutableSource:l1,useSyncExternalStore:u1,useId:T1,unstable_isNewReconciler:!1},w6={readContext:Rn,useCallback:S1,useContext:Rn,useEffect:Nf,useImperativeHandle:_1,useInsertionEffect:v1,useLayoutEffect:x1,useMemo:k1,useReducer:bf,useRef:m1,useState:function(){return bf(Qo)},useDebugValue:Pf,useDeferredValue:function(o){var a=Fn();return _t===null?a.memoizedState=o:C1(a,_t.memoizedState,o)},useTransition:function(){var o=bf(Qo)[0],a=Fn().memoizedState;return[o,a]},useMutableSource:l1,useSyncExternalStore:u1,useId:T1,unstable_isNewReconciler:!1};function Jn(o,a){if(o&&o.defaultProps){a=s({},a),o=o.defaultProps;for(var d in o)a[d]===void 0&&(a[d]=o[d]);return a}return a}function Mf(o,a,d,g){a=o.memoizedState,d=d(g,a),d=d==null?a:s({},a,d),o.memoizedState=d,o.lanes===0&&(o.updateQueue.baseState=d)}var Hl={isMounted:function(o){return(o=o._reactInternals)?L(o)===o:!1},enqueueSetState:function(o,a,d){o=o._reactInternals;var g=Xt(),v=ci(o),b=jr(g,v);b.payload=a,d!=null&&(b.callback=d),a=ai(o,b,v),a!==null&&(jn(a,o,v,g),Dl(a,o,v))},enqueueReplaceState:function(o,a,d){o=o._reactInternals;var g=Xt(),v=ci(o),b=jr(g,v);b.tag=1,b.payload=a,d!=null&&(b.callback=d),a=ai(o,b,v),a!==null&&(jn(a,o,v,g),Dl(a,o,v))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var d=Xt(),g=ci(o),v=jr(d,g);v.tag=2,a!=null&&(v.callback=a),a=ai(o,v,g),a!==null&&(jn(a,o,g,d),Dl(a,o,g))}};function P1(o,a,d,g,v,b,F){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,b,F):a.prototype&&a.prototype.isPureReactComponent?!Ll(d,g)||!Ll(v,b):!0}function M1(o,a,d){var g=!1,v=si,b=a.contextType;return typeof b=="object"&&b!==null?b=Rn(b):(v=cn(a)?Hi:Wt.current,g=a.contextTypes,b=(g=g!=null)?Ms(o,v):si),a=new a(d,b),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Hl,o.stateNode=a,a._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=v,o.__reactInternalMemoizedMaskedChildContext=b),a}function A1(o,a,d,g){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(d,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(d,g),a.state!==o&&Hl.enqueueReplaceState(a,a.state,null)}function Af(o,a,d,g){var v=o.stateNode;v.props=d,v.state=o.memoizedState,v.refs={},yf(o);var b=a.contextType;typeof b=="object"&&b!==null?v.context=Rn(b):(b=cn(a)?Hi:Wt.current,v.context=Ms(o,b)),v.state=o.memoizedState,b=a.getDerivedStateFromProps,typeof b=="function"&&(Mf(o,a,b,d),v.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(a=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),a!==v.state&&Hl.enqueueReplaceState(v,v.state,null),zl(o,d,v,g),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308)}function zs(o,a){try{var d="",g=a;do d+=h6(g),g=g.return;while(g);var v=d}catch(b){v=`
Error generating stack: `+b.message+`
`+b.stack}return{value:o,source:a,stack:v,digest:null}}function If(o,a,d){return{value:o,source:null,stack:d??null,digest:a??null}}function Rf(o,a){try{console.error(a.value)}catch(d){setTimeout(function(){throw d})}}var _6=typeof WeakMap=="function"?WeakMap:Map;function I1(o,a,d){d=jr(-1,d),d.tag=3,d.payload={element:null};var g=a.value;return d.callback=function(){ou||(ou=!0,Jf=g),Rf(o,a)},d}function R1(o,a,d){d=jr(-1,d),d.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var v=a.value;d.payload=function(){return g(v)},d.callback=function(){Rf(o,a)}}var b=o.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(d.callback=function(){Rf(o,a),typeof g!="function"&&(li===null?li=new Set([this]):li.add(this));var F=a.stack;this.componentDidCatch(a.value,{componentStack:F!==null?F:""})}),d}function L1(o,a,d){var g=o.pingCache;if(g===null){g=o.pingCache=new _6;var v=new Set;g.set(a,v)}else v=g.get(a),v===void 0&&(v=new Set,g.set(a,v));v.has(d)||(v.add(d),o=F6.bind(null,o,a,d),a.then(o,o))}function F1(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function j1(o,a,d,g,v){return o.mode&1?(o.flags|=65536,o.lanes=v,o):(o===a?o.flags|=65536:(o.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(a=jr(-1,1),a.tag=2,ai(d,a,1))),d.lanes|=1),o)}var S6=c.ReactCurrentOwner,dn=!1;function tn(o,a,d,g){a.child=o===null?t1(a,null,d,g):Ls(a,o.child,d,g)}function O1(o,a,d,g,v){d=d.render;var b=a.ref;return js(a,v),g=Cf(o,a,d,g,b,v),d=Tf(),o!==null&&!dn?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~v,Or(o,a,v)):(nt&&d&&af(a),a.flags|=1,tn(o,a,g,v),a.child)}function D1(o,a,d,g,v){if(o===null){var b=d.type;return typeof b=="function"&&!sh(b)&&b.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(a.tag=15,a.type=b,z1(o,a,b,g,v)):(o=fu(d.type,null,g,a,a.mode,v),o.ref=a.ref,o.return=a,a.child=o)}if(b=o.child,!(o.lanes&v)){var F=b.memoizedProps;if(d=d.compare,d=d!==null?d:Ll,d(F,g)&&o.ref===a.ref)return Or(o,a,v)}return a.flags|=1,o=fi(b,g),o.ref=a.ref,o.return=a,a.child=o}function z1(o,a,d,g,v){if(o!==null){var b=o.memoizedProps;if(Ll(b,g)&&o.ref===a.ref)if(dn=!1,a.pendingProps=g=b,(o.lanes&v)!==0)o.flags&131072&&(dn=!0);else return a.lanes=o.lanes,Or(o,a,v)}return Lf(o,a,d,g,v)}function B1(o,a,d){var g=a.pendingProps,v=g.children,b=o!==null?o.memoizedState:null;if(g.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(Us,kn),kn|=d;else{if(!(d&1073741824))return o=b!==null?b.baseLanes|d:d,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,Xe(Us,kn),kn|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=b!==null?b.baseLanes:d,Xe(Us,kn),kn|=g}else b!==null?(g=b.baseLanes|d,a.memoizedState=null):g=d,Xe(Us,kn),kn|=g;return tn(o,a,v,d),a.child}function U1(o,a){var d=a.ref;(o===null&&d!==null||o!==null&&o.ref!==d)&&(a.flags|=512,a.flags|=2097152)}function Lf(o,a,d,g,v){var b=cn(d)?Hi:Wt.current;return b=Ms(a,b),js(a,v),d=Cf(o,a,d,g,b,v),g=Tf(),o!==null&&!dn?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~v,Or(o,a,v)):(nt&&g&&af(a),a.flags|=1,tn(o,a,d,v),a.child)}function G1(o,a,d,g,v){if(cn(d)){var b=!0;Tl(a)}else b=!1;if(js(a,v),a.stateNode===null)Xl(o,a),M1(a,d,g),Af(a,d,g,v),g=!0;else if(o===null){var F=a.stateNode,W=a.memoizedProps;F.props=W;var q=F.context,ae=d.contextType;typeof ae=="object"&&ae!==null?ae=Rn(ae):(ae=cn(d)?Hi:Wt.current,ae=Ms(a,ae));var we=d.getDerivedStateFromProps,Ne=typeof we=="function"||typeof F.getSnapshotBeforeUpdate=="function";Ne||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(W!==g||q!==ae)&&A1(a,F,g,ae),oi=!1;var pe=a.memoizedState;F.state=pe,zl(a,g,F,v),q=a.memoizedState,W!==g||pe!==q||un.current||oi?(typeof we=="function"&&(Mf(a,d,we,g),q=a.memoizedState),(W=oi||P1(a,d,W,g,pe,q,ae))?(Ne||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(a.flags|=4194308)):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=q),F.props=g,F.state=q,F.context=ae,g=W):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{F=a.stateNode,i1(o,a),W=a.memoizedProps,ae=a.type===a.elementType?W:Jn(a.type,W),F.props=ae,Ne=a.pendingProps,pe=F.context,q=d.contextType,typeof q=="object"&&q!==null?q=Rn(q):(q=cn(d)?Hi:Wt.current,q=Ms(a,q));var qe=d.getDerivedStateFromProps;(we=typeof qe=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(W!==Ne||pe!==q)&&A1(a,F,g,q),oi=!1,pe=a.memoizedState,F.state=pe,zl(a,g,F,v);var He=a.memoizedState;W!==Ne||pe!==He||un.current||oi?(typeof qe=="function"&&(Mf(a,d,qe,g),He=a.memoizedState),(ae=oi||P1(a,d,ae,g,pe,He,q)||!1)?(we||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(g,He,q),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(g,He,q)),typeof F.componentDidUpdate=="function"&&(a.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof F.componentDidUpdate!="function"||W===o.memoizedProps&&pe===o.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&pe===o.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=He),F.props=g,F.state=He,F.context=q,g=ae):(typeof F.componentDidUpdate!="function"||W===o.memoizedProps&&pe===o.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&pe===o.memoizedState||(a.flags|=1024),g=!1)}return Ff(o,a,d,g,b,v)}function Ff(o,a,d,g,v,b){U1(o,a);var F=(a.flags&128)!==0;if(!g&&!F)return v&&Vg(a,d,!1),Or(o,a,b);g=a.stateNode,S6.current=a;var W=F&&typeof d.getDerivedStateFromError!="function"?null:g.render();return a.flags|=1,o!==null&&F?(a.child=Ls(a,o.child,null,b),a.child=Ls(a,null,W,b)):tn(o,a,W,b),a.memoizedState=g.state,v&&Vg(a,d,!0),a.child}function V1(o){var a=o.stateNode;a.pendingContext?Ug(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Ug(o,a.context,!1),vf(o,a.containerInfo)}function W1(o,a,d,g,v){return Rs(),df(v),a.flags|=256,tn(o,a,d,g),a.child}var jf={dehydrated:null,treeContext:null,retryLane:0};function Of(o){return{baseLanes:o,cachePool:null,transitions:null}}function $1(o,a,d){var g=a.pendingProps,v=ot.current,b=!1,F=(a.flags&128)!==0,W;if((W=F)||(W=o!==null&&o.memoizedState===null?!1:(v&2)!==0),W?(b=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(v|=1),Xe(ot,v&1),o===null)return cf(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?(a.mode&1?Xd(o)?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(F=g.children,o=g.fallback,b?(g=a.mode,b=a.child,F={mode:"hidden",children:F},!(g&1)&&b!==null?(b.childLanes=0,b.pendingProps=F):b=hu(F,g,0,null),o=ts(o,g,d,null),b.return=a,o.return=a,b.sibling=o,a.child=b,a.child.memoizedState=Of(d),a.memoizedState=jf,o):Df(a,F));if(v=o.memoizedState,v!==null&&(W=v.dehydrated,W!==null))return k6(o,a,F,g,W,v,d);if(b){b=g.fallback,F=a.mode,v=o.child,W=v.sibling;var q={mode:"hidden",children:g.children};return!(F&1)&&a.child!==v?(g=a.child,g.childLanes=0,g.pendingProps=q,a.deletions=null):(g=fi(v,q),g.subtreeFlags=v.subtreeFlags&14680064),W!==null?b=fi(W,b):(b=ts(b,F,d,null),b.flags|=2),b.return=a,g.return=a,g.sibling=b,a.child=g,g=b,b=a.child,F=o.child.memoizedState,F=F===null?Of(d):{baseLanes:F.baseLanes|d,cachePool:null,transitions:F.transitions},b.memoizedState=F,b.childLanes=o.childLanes&~d,a.memoizedState=jf,g}return b=o.child,o=b.sibling,g=fi(b,{mode:"visible",children:g.children}),!(a.mode&1)&&(g.lanes=d),g.return=a,g.sibling=null,o!==null&&(d=a.deletions,d===null?(a.deletions=[o],a.flags|=16):d.push(o)),a.child=g,a.memoizedState=null,g}function Df(o,a){return a=hu({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function Yl(o,a,d,g){return g!==null&&df(g),Ls(a,o.child,null,d),o=Df(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function k6(o,a,d,g,v,b,F){if(d)return a.flags&256?(a.flags&=-257,g=If(Error(l(422))),Yl(o,a,F,g)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(b=g.fallback,v=a.mode,g=hu({mode:"visible",children:g.children},v,0,null),b=ts(b,v,F,null),b.flags|=2,g.return=a,b.return=a,g.sibling=b,a.child=g,a.mode&1&&Ls(a,o.child,null,F),a.child.memoizedState=Of(F),a.memoizedState=jf,b);if(!(a.mode&1))return Yl(o,a,F,null);if(Xd(v))return g=j4(v).digest,b=Error(l(419)),g=If(b,g,void 0),Yl(o,a,F,g);if(d=(F&o.childLanes)!==0,dn||d){if(g=Mt,g!==null){switch(F&-F){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=v&(g.suspendedLanes|F)?0:v,v!==0&&v!==b.retryLane&&(b.retryLane=v,mr(o,v),jn(g,o,v,-1))}return ih(),g=If(Error(l(421))),Yl(o,a,F,g)}return Bg(v)?(a.flags|=128,a.child=o.child,a=j6.bind(null,o),O4(v,a),null):(o=b.treeContext,Se&&(In=B4(v),Sn=a,nt=!0,qn=null,Wo=!1,o!==null&&(Mn[An++]=Lr,Mn[An++]=Fr,Mn[An++]=Yi,Lr=o.id,Fr=o.overflow,Yi=a)),a=Df(a,g.children),a.flags|=4096,a)}function H1(o,a,d){o.lanes|=a;var g=o.alternate;g!==null&&(g.lanes|=a),gf(o.return,a,d)}function zf(o,a,d,g,v){var b=o.memoizedState;b===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:v}:(b.isBackwards=a,b.rendering=null,b.renderingStartTime=0,b.last=g,b.tail=d,b.tailMode=v)}function Y1(o,a,d){var g=a.pendingProps,v=g.revealOrder,b=g.tail;if(tn(o,a,g.children,d),g=ot.current,g&2)g=g&1|2,a.flags|=128;else{if(o!==null&&o.flags&128)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&H1(o,d,a);else if(o.tag===19)H1(o,d,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(Xe(ot,g),!(a.mode&1))a.memoizedState=null;else switch(v){case"forwards":for(d=a.child,v=null;d!==null;)o=d.alternate,o!==null&&Bl(o)===null&&(v=d),d=d.sibling;d=v,d===null?(v=a.child,a.child=null):(v=d.sibling,d.sibling=null),zf(a,!1,v,d,b);break;case"backwards":for(d=null,v=a.child,a.child=null;v!==null;){if(o=v.alternate,o!==null&&Bl(o)===null){a.child=v;break}o=v.sibling,v.sibling=d,d=v,v=o}zf(a,!0,d,null,b);break;case"together":zf(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Xl(o,a){!(a.mode&1)&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Or(o,a,d){if(o!==null&&(a.dependencies=o.dependencies),Zi|=a.lanes,!(d&a.childLanes))return null;if(o!==null&&a.child!==o.child)throw Error(l(153));if(a.child!==null){for(o=a.child,d=fi(o,o.pendingProps),a.child=d,d.return=a;o.sibling!==null;)o=o.sibling,d=d.sibling=fi(o,o.pendingProps),d.return=a;d.sibling=null}return a.child}function C6(o,a,d){switch(a.tag){case 3:V1(a),Rs();break;case 5:a1(a);break;case 1:cn(a.type)&&Tl(a);break;case 4:vf(a,a.stateNode.containerInfo);break;case 10:n1(a,a.type._context,a.memoizedProps.value);break;case 13:var g=a.memoizedState;if(g!==null)return g.dehydrated!==null?(Xe(ot,ot.current&1),a.flags|=128,null):d&a.child.childLanes?$1(o,a,d):(Xe(ot,ot.current&1),o=Or(o,a,d),o!==null?o.sibling:null);Xe(ot,ot.current&1);break;case 19:if(g=(d&a.childLanes)!==0,o.flags&128){if(g)return Y1(o,a,d);a.flags|=128}var v=a.memoizedState;if(v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Xe(ot,ot.current),g)break;return null;case 22:case 23:return a.lanes=0,B1(o,a,d)}return Or(o,a,d)}function xr(o){o.flags|=4}function X1(o,a){if(o!==null&&o.child===a.child)return!0;if(a.flags&16)return!1;for(o=a.child;o!==null;){if(o.flags&12854||o.subtreeFlags&12854)return!1;o=o.sibling}return!0}var qo,Jo,Kl,Ql;if(ce)qo=function(o,a){for(var d=a.child;d!==null;){if(d.tag===5||d.tag===6)K(o,d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===a)break;for(;d.sibling===null;){if(d.return===null||d.return===a)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Jo=function(){},Kl=function(o,a,d,g,v){if(o=o.memoizedProps,o!==g){var b=a.stateNode,F=yr(Ln.current);d=te(b,d,o,g,v,F),(a.updateQueue=d)&&xr(a)}},Ql=function(o,a,d,g){d!==g&&xr(a)};else if(_e){qo=function(o,a,d,g){for(var v=a.child;v!==null;){if(v.tag===5){var b=v.stateNode;d&&g&&(b=Dg(b,v.type,v.memoizedProps,v)),K(o,b)}else if(v.tag===6)b=v.stateNode,d&&g&&(b=zg(b,v.memoizedProps,v)),K(o,b);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)b=v.child,b!==null&&(b.return=v),qo(o,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===a)break;for(;v.sibling===null;){if(v.return===null||v.return===a)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};var K1=function(o,a,d,g){for(var v=a.child;v!==null;){if(v.tag===5){var b=v.stateNode;d&&g&&(b=Dg(b,v.type,v.memoizedProps,v)),Og(o,b)}else if(v.tag===6)b=v.stateNode,d&&g&&(b=zg(b,v.memoizedProps,v)),Og(o,b);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)b=v.child,b!==null&&(b.return=v),K1(o,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===a)break;for(;v.sibling===null;){if(v.return===null||v.return===a)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};Jo=function(o,a){var d=a.stateNode;if(!X1(o,a)){o=d.containerInfo;var g=jg(o);K1(g,a,!1,!1),d.pendingChildren=g,xr(a),I4(o,g)}},Kl=function(o,a,d,g,v){var b=o.stateNode,F=o.memoizedProps;if((o=X1(o,a))&&F===g)a.stateNode=b;else{var W=a.stateNode,q=yr(Ln.current),ae=null;F!==g&&(ae=te(W,d,F,g,v,q)),o&&ae===null?a.stateNode=b:(b=A4(b,ae,d,F,g,a,o,W),ne(b,d,g,v,q)&&xr(a),a.stateNode=b,o?xr(a):qo(b,a,!1,!1))}},Ql=function(o,a,d,g){d!==g?(o=yr(Os.current),d=yr(Ln.current),a.stateNode=de(g,o,d,a),xr(a)):a.stateNode=o.stateNode}}else Jo=function(){},Kl=function(){},Ql=function(){};function ea(o,a){if(!nt)switch(o.tailMode){case"hidden":a=o.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?o.tail=null:d.sibling=null;break;case"collapsed":d=o.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Ht(o){var a=o.alternate!==null&&o.alternate.child===o.child,d=0,g=0;if(a)for(var v=o.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags&14680064,g|=v.flags&14680064,v.return=o,v=v.sibling;else for(v=o.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags,g|=v.flags,v.return=o,v=v.sibling;return o.subtreeFlags|=g,o.childLanes=d,a}function T6(o,a,d){var g=a.pendingProps;switch(lf(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(a),null;case 1:return cn(a.type)&&Cl(),Ht(a),null;case 3:return d=a.stateNode,Ds(),Ze(un),Ze(Wt),_f(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(o===null||o.child===null)&&(Rl(a)?xr(a):o===null||o.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,qn!==null&&(nh(qn),qn=null))),Jo(o,a),Ht(a),null;case 5:xf(a),d=yr(Os.current);var v=a.type;if(o!==null&&a.stateNode!=null)Kl(o,a,v,g,d),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!g){if(a.stateNode===null)throw Error(l(166));return Ht(a),null}if(o=yr(Ln.current),Rl(a)){if(!Se)throw Error(l(175));o=U4(a.stateNode,a.type,a.memoizedProps,d,o,a,!Wo),a.updateQueue=o,o!==null&&xr(a)}else{var b=re(v,g,d,o,a);qo(b,a,!1,!1),a.stateNode=b,ne(b,v,g,d,o)&&xr(a)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Ht(a),null;case 6:if(o&&a.stateNode!=null)Ql(o,a,o.memoizedProps,g);else{if(typeof g!="string"&&a.stateNode===null)throw Error(l(166));if(o=yr(Os.current),d=yr(Ln.current),Rl(a)){if(!Se)throw Error(l(176));if(o=a.stateNode,d=a.memoizedProps,(g=G4(o,d,a,!Wo))&&(v=Sn,v!==null))switch(v.tag){case 3:Q4(v.stateNode.containerInfo,o,d,(v.mode&1)!==0);break;case 5:Z4(v.type,v.memoizedProps,v.stateNode,o,d,(v.mode&1)!==0)}g&&xr(a)}else a.stateNode=de(g,o,d,a)}return Ht(a),null;case 13:if(Ze(ot),g=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(nt&&In!==null&&a.mode&1&&!(a.flags&128))qg(),Rs(),a.flags|=98560,v=!1;else if(v=Rl(a),g!==null&&g.dehydrated!==null){if(o===null){if(!v)throw Error(l(318));if(!Se)throw Error(l(344));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(l(317));V4(v,a)}else Rs(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Ht(a),v=!1}else qn!==null&&(nh(qn),qn=null),v=!0;if(!v)return a.flags&65536?a:null}return a.flags&128?(a.lanes=d,a):(d=g!==null,d!==(o!==null&&o.memoizedState!==null)&&d&&(a.child.flags|=8192,a.mode&1&&(o===null||ot.current&1?St===0&&(St=3):ih())),a.updateQueue!==null&&(a.flags|=4),Ht(a),null);case 4:return Ds(),Jo(o,a),o===null&&Ce(a.stateNode.containerInfo),Ht(a),null;case 10:return pf(a.type._context),Ht(a),null;case 17:return cn(a.type)&&Cl(),Ht(a),null;case 19:if(Ze(ot),v=a.memoizedState,v===null)return Ht(a),null;if(g=(a.flags&128)!==0,b=v.rendering,b===null)if(g)ea(v,!1);else{if(St!==0||o!==null&&o.flags&128)for(o=a.child;o!==null;){if(b=Bl(o),b!==null){for(a.flags|=128,ea(v,!1),o=b.updateQueue,o!==null&&(a.updateQueue=o,a.flags|=4),a.subtreeFlags=0,o=d,d=a.child;d!==null;)g=d,v=o,g.flags&=14680066,b=g.alternate,b===null?(g.childLanes=0,g.lanes=v,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=b.childLanes,g.lanes=b.lanes,g.child=b.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=b.memoizedProps,g.memoizedState=b.memoizedState,g.updateQueue=b.updateQueue,g.type=b.type,v=b.dependencies,g.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext}),d=d.sibling;return Xe(ot,ot.current&1|2),a.child}o=o.sibling}v.tail!==null&&Nt()>qf&&(a.flags|=128,g=!0,ea(v,!1),a.lanes=4194304)}else{if(!g)if(o=Bl(b),o!==null){if(a.flags|=128,g=!0,o=o.updateQueue,o!==null&&(a.updateQueue=o,a.flags|=4),ea(v,!0),v.tail===null&&v.tailMode==="hidden"&&!b.alternate&&!nt)return Ht(a),null}else 2*Nt()-v.renderingStartTime>qf&&d!==1073741824&&(a.flags|=128,g=!0,ea(v,!1),a.lanes=4194304);v.isBackwards?(b.sibling=a.child,a.child=b):(o=v.last,o!==null?o.sibling=b:a.child=b,v.last=b)}return v.tail!==null?(a=v.tail,v.rendering=a,v.tail=a.sibling,v.renderingStartTime=Nt(),a.sibling=null,o=ot.current,Xe(ot,g?o&1|2:o&1),a):(Ht(a),null);case 22:case 23:return rh(),d=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==d&&(a.flags|=8192),d&&a.mode&1?kn&1073741824&&(Ht(a),ce&&a.subtreeFlags&6&&(a.flags|=8192)):Ht(a),null;case 24:return null;case 25:return null}throw Error(l(156,a.tag))}function E6(o,a){switch(lf(a),a.tag){case 1:return cn(a.type)&&Cl(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return Ds(),Ze(un),Ze(Wt),_f(),o=a.flags,o&65536&&!(o&128)?(a.flags=o&-65537|128,a):null;case 5:return xf(a),null;case 13:if(Ze(ot),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(l(340));Rs()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return Ze(ot),null;case 4:return Ds(),null;case 10:return pf(a.type._context),null;case 22:case 23:return rh(),null;case 24:return null;default:return null}}var Zl=!1,Yt=!1,b6=typeof WeakSet=="function"?WeakSet:Set,me=null;function Bs(o,a){var d=o.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){rt(o,a,g)}else d.current=null}function Bf(o,a,d){try{d()}catch(g){rt(o,a,g)}}var Q1=!1;function N6(o,a){for(X(o.containerInfo),me=a;me!==null;)if(o=me,a=o.child,(o.subtreeFlags&1028)!==0&&a!==null)a.return=o,me=a;else for(;me!==null;){o=me;try{var d=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(d!==null){var g=d.memoizedProps,v=d.memoizedState,b=o.stateNode,F=b.getSnapshotBeforeUpdate(o.elementType===o.type?g:Jn(o.type,g),v);b.__reactInternalSnapshotBeforeUpdate=F}break;case 3:ce&&M4(o.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch(W){rt(o,o.return,W)}if(a=o.sibling,a!==null){a.return=o.return,me=a;break}me=o.return}return d=Q1,Q1=!1,d}function ta(o,a,d){var g=a.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&o)===o){var b=v.destroy;v.destroy=void 0,b!==void 0&&Bf(a,d,b)}v=v.next}while(v!==g)}}function ql(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var d=a=a.next;do{if((d.tag&o)===o){var g=d.create;d.destroy=g()}d=d.next}while(d!==a)}}function Uf(o){var a=o.ref;if(a!==null){var d=o.stateNode;switch(o.tag){case 5:o=V(d);break;default:o=d}typeof a=="function"?a(o):a.current=o}}function Z1(o){var a=o.alternate;a!==null&&(o.alternate=null,Z1(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&Ve(a)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function q1(o){return o.tag===5||o.tag===3||o.tag===4}function J1(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||q1(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Gf(o,a,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?bs(d,o,a):fe(d,o);else if(g!==4&&(o=o.child,o!==null))for(Gf(o,a,d),o=o.sibling;o!==null;)Gf(o,a,d),o=o.sibling}function Vf(o,a,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?ft(d,o,a):ue(d,o);else if(g!==4&&(o=o.child,o!==null))for(Vf(o,a,d),o=o.sibling;o!==null;)Vf(o,a,d),o=o.sibling}var Ft=null,er=!1;function wr(o,a,d){for(d=d.child;d!==null;)Wf(o,a,d),d=d.sibling}function Wf(o,a,d){if(pr&&typeof pr.onCommitFiberUnmount=="function")try{pr.onCommitFiberUnmount(Pl,d)}catch{}switch(d.tag){case 5:Yt||Bs(d,a);case 6:if(ce){var g=Ft,v=er;Ft=null,wr(o,a,d),Ft=g,er=v,Ft!==null&&(er?Sl(Ft,d.stateNode):Ns(Ft,d.stateNode))}else wr(o,a,d);break;case 18:ce&&Ft!==null&&(er?X4(Ft,d.stateNode):Y4(Ft,d.stateNode));break;case 4:ce?(g=Ft,v=er,Ft=d.stateNode.containerInfo,er=!0,wr(o,a,d),Ft=g,er=v):(_e&&(g=d.stateNode.containerInfo,v=jg(g),Yd(g,v)),wr(o,a,d));break;case 0:case 11:case 14:case 15:if(!Yt&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){v=g=g.next;do{var b=v,F=b.destroy;b=b.tag,F!==void 0&&(b&2||b&4)&&Bf(d,a,F),v=v.next}while(v!==g)}wr(o,a,d);break;case 1:if(!Yt&&(Bs(d,a),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(W){rt(d,a,W)}wr(o,a,d);break;case 21:wr(o,a,d);break;case 22:d.mode&1?(Yt=(g=Yt)||d.memoizedState!==null,wr(o,a,d),Yt=g):wr(o,a,d);break;default:wr(o,a,d)}}function em(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var d=o.stateNode;d===null&&(d=o.stateNode=new b6),a.forEach(function(g){var v=O6.bind(null,o,g);d.has(g)||(d.add(g),g.then(v,v))})}}function tr(o,a){var d=a.deletions;if(d!==null)for(var g=0;g<d.length;g++){var v=d[g];try{var b=o,F=a;if(ce){var W=F;e:for(;W!==null;){switch(W.tag){case 5:Ft=W.stateNode,er=!1;break e;case 3:Ft=W.stateNode.containerInfo,er=!0;break e;case 4:Ft=W.stateNode.containerInfo,er=!0;break e}W=W.return}if(Ft===null)throw Error(l(160));Wf(b,F,v),Ft=null,er=!1}else Wf(b,F,v);var q=v.alternate;q!==null&&(q.return=null),v.return=null}catch(ae){rt(v,a,ae)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)tm(a,o),a=a.sibling}function tm(o,a){var d=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(tr(a,o),_r(o),g&4){try{ta(3,o,o.return),ql(3,o)}catch(pe){rt(o,o.return,pe)}try{ta(5,o,o.return)}catch(pe){rt(o,o.return,pe)}}break;case 1:tr(a,o),_r(o),g&512&&d!==null&&Bs(d,d.return);break;case 5:if(tr(a,o),_r(o),g&512&&d!==null&&Bs(d,d.return),ce){if(o.flags&32){var v=o.stateNode;try{$i(v)}catch(pe){rt(o,o.return,pe)}}if(g&4&&(v=o.stateNode,v!=null)){var b=o.memoizedProps;if(d=d!==null?d.memoizedProps:b,g=o.type,a=o.updateQueue,o.updateQueue=null,a!==null)try{ke(v,a,g,d,b,o)}catch(pe){rt(o,o.return,pe)}}}break;case 6:if(tr(a,o),_r(o),g&4&&ce){if(o.stateNode===null)throw Error(l(162));v=o.stateNode,b=o.memoizedProps,d=d!==null?d.memoizedProps:b;try{oe(v,d,b)}catch(pe){rt(o,o.return,pe)}}break;case 3:if(tr(a,o),_r(o),g&4){if(ce&&Se&&d!==null&&d.memoizedState.isDehydrated)try{$4(a.containerInfo)}catch(pe){rt(o,o.return,pe)}if(_e){v=a.containerInfo,b=a.pendingChildren;try{Yd(v,b)}catch(pe){rt(o,o.return,pe)}}}break;case 4:if(tr(a,o),_r(o),g&4&&_e){b=o.stateNode,v=b.containerInfo,b=b.pendingChildren;try{Yd(v,b)}catch(pe){rt(o,o.return,pe)}}break;case 13:tr(a,o),_r(o),v=o.child,v.flags&8192&&(b=v.memoizedState!==null,v.stateNode.isHidden=b,!b||v.alternate!==null&&v.alternate.memoizedState!==null||(Zf=Nt())),g&4&&em(o);break;case 22:var F=d!==null&&d.memoizedState!==null;if(o.mode&1?(Yt=(d=Yt)||F,tr(a,o),Yt=d):tr(a,o),_r(o),g&8192){if(d=o.memoizedState!==null,(o.stateNode.isHidden=d)&&!F&&o.mode&1)for(me=o,g=o.child;g!==null;){for(a=me=g;me!==null;){F=me;var W=F.child;switch(F.tag){case 0:case 11:case 14:case 15:ta(4,F,F.return);break;case 1:Bs(F,F.return);var q=F.stateNode;if(typeof q.componentWillUnmount=="function"){var ae=F,we=F.return;try{var Ne=ae;q.props=Ne.memoizedProps,q.state=Ne.memoizedState,q.componentWillUnmount()}catch(pe){rt(ae,we,pe)}}break;case 5:Bs(F,F.return);break;case 22:if(F.memoizedState!==null){im(a);continue}}W!==null?(W.return=F,me=W):im(a)}g=g.sibling}if(ce){e:if(g=null,ce)for(a=o;;){if(a.tag===5){if(g===null){g=a;try{v=a.stateNode,d?Fg(v):$d(a.stateNode,a.memoizedProps)}catch(pe){rt(o,o.return,pe)}}}else if(a.tag===6){if(g===null)try{b=a.stateNode,d?Bo(b):Hd(b,a.memoizedProps)}catch(pe){rt(o,o.return,pe)}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===o)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;g===a&&(g=null),a=a.return}g===a&&(g=null),a.sibling.return=a.return,a=a.sibling}}}break;case 19:tr(a,o),_r(o),g&4&&em(o);break;case 21:break;default:tr(a,o),_r(o)}}function _r(o){var a=o.flags;if(a&2){try{if(ce){e:{for(var d=o.return;d!==null;){if(q1(d)){var g=d;break e}d=d.return}throw Error(l(160))}switch(g.tag){case 5:var v=g.stateNode;g.flags&32&&($i(v),g.flags&=-33);var b=J1(o);Vf(o,b,v);break;case 3:case 4:var F=g.stateNode.containerInfo,W=J1(o);Gf(o,W,F);break;default:throw Error(l(161))}}}catch(q){rt(o,o.return,q)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function P6(o,a,d){me=o,nm(o)}function nm(o,a,d){for(var g=(o.mode&1)!==0;me!==null;){var v=me,b=v.child;if(v.tag===22&&g){var F=v.memoizedState!==null||Zl;if(!F){var W=v.alternate,q=W!==null&&W.memoizedState!==null||Yt;W=Zl;var ae=Yt;if(Zl=F,(Yt=q)&&!ae)for(me=v;me!==null;)F=me,q=F.child,F.tag===22&&F.memoizedState!==null?sm(v):q!==null?(q.return=F,me=q):sm(v);for(;b!==null;)me=b,nm(b),b=b.sibling;me=v,Zl=W,Yt=ae}rm(o)}else v.subtreeFlags&8772&&b!==null?(b.return=v,me=b):rm(o)}}function rm(o){for(;me!==null;){var a=me;if(a.flags&8772){var d=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:Yt||ql(5,a);break;case 1:var g=a.stateNode;if(a.flags&4&&!Yt)if(d===null)g.componentDidMount();else{var v=a.elementType===a.type?d.memoizedProps:Jn(a.type,d.memoizedProps);g.componentDidUpdate(v,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var b=a.updateQueue;b!==null&&o1(a,b,g);break;case 3:var F=a.updateQueue;if(F!==null){if(d=null,a.child!==null)switch(a.child.tag){case 5:d=V(a.child.stateNode);break;case 1:d=a.child.stateNode}o1(a,F,d)}break;case 5:var W=a.stateNode;d===null&&a.flags&4&&xe(W,a.type,a.memoizedProps,a);break;case 6:break;case 4:break;case 12:break;case 13:if(Se&&a.memoizedState===null){var q=a.alternate;if(q!==null){var ae=q.memoizedState;if(ae!==null){var we=ae.dehydrated;we!==null&&H4(we)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(l(163))}Yt||a.flags&512&&Uf(a)}catch(Ne){rt(a,a.return,Ne)}}if(a===o){me=null;break}if(d=a.sibling,d!==null){d.return=a.return,me=d;break}me=a.return}}function im(o){for(;me!==null;){var a=me;if(a===o){me=null;break}var d=a.sibling;if(d!==null){d.return=a.return,me=d;break}me=a.return}}function sm(o){for(;me!==null;){var a=me;try{switch(a.tag){case 0:case 11:case 15:var d=a.return;try{ql(4,a)}catch(q){rt(a,d,q)}break;case 1:var g=a.stateNode;if(typeof g.componentDidMount=="function"){var v=a.return;try{g.componentDidMount()}catch(q){rt(a,v,q)}}var b=a.return;try{Uf(a)}catch(q){rt(a,b,q)}break;case 5:var F=a.return;try{Uf(a)}catch(q){rt(a,F,q)}}}catch(q){rt(a,a.return,q)}if(a===o){me=null;break}var W=a.sibling;if(W!==null){W.return=a.return,me=W;break}me=a.return}}var Jl=0,eu=1,tu=2,nu=3,ru=4;if(typeof Symbol=="function"&&Symbol.for){var na=Symbol.for;Jl=na("selector.component"),eu=na("selector.has_pseudo_class"),tu=na("selector.role"),nu=na("selector.test_id"),ru=na("selector.text")}function $f(o){var a=Oe(o);if(a!=null){if(typeof a.memoizedProps["data-testname"]!="string")throw Error(l(364));return a}if(o=Vt(o),o===null)throw Error(l(362));return o.stateNode.current}function Hf(o,a){switch(a.$$typeof){case Jl:if(o.type===a.value)return!0;break;case eu:e:{a=a.value,o=[o,0];for(var d=0;d<o.length;){var g=o[d++],v=o[d++],b=a[v];if(g.tag!==5||!Lt(g)){for(;b!=null&&Hf(g,b);)v++,b=a[v];if(v===a.length){a=!0;break e}else for(g=g.child;g!==null;)o.push(g,v),g=g.sibling}}a=!1}return a;case tu:if(o.tag===5&&Ar(o.stateNode,a.value))return!0;break;case ru:if((o.tag===5||o.tag===6)&&(o=Kn(o),o!==null&&0<=o.indexOf(a.value)))return!0;break;case nu:if(o.tag===5&&(o=o.memoizedProps["data-testname"],typeof o=="string"&&o.toLowerCase()===a.value.toLowerCase()))return!0;break;default:throw Error(l(365))}return!1}function Yf(o){switch(o.$$typeof){case Jl:return"<"+(I(o.value)||"Unknown")+">";case eu:return":has("+(Yf(o)||"")+")";case tu:return'[role="'+o.value+'"]';case ru:return'"'+o.value+'"';case nu:return'[data-testname="'+o.value+'"]';default:throw Error(l(365))}}function om(o,a){var d=[];o=[o,0];for(var g=0;g<o.length;){var v=o[g++],b=o[g++],F=a[b];if(v.tag!==5||!Lt(v)){for(;F!=null&&Hf(v,F);)b++,F=a[b];if(b===a.length)d.push(v);else for(v=v.child;v!==null;)o.push(v,b),v=v.sibling}}return d}function Xf(o,a){if(!Gt)throw Error(l(363));o=$f(o),o=om(o,a),a=[],o=Array.from(o);for(var d=0;d<o.length;){var g=o[d++];if(g.tag===5)Lt(g)||a.push(g.stateNode);else for(g=g.child;g!==null;)o.push(g),g=g.sibling}return a}var M6=Math.ceil,iu=c.ReactCurrentDispatcher,Kf=c.ReactCurrentOwner,mt=c.ReactCurrentBatchConfig,Ie=0,Mt=null,xt=null,jt=0,kn=0,Us=ii(0),St=0,ra=null,Zi=0,su=0,Qf=0,ia=null,fn=null,Zf=0,qf=1/0,Dr=null;function Gs(){qf=Nt()+500}var ou=!1,Jf=null,li=null,au=!1,ui=null,lu=0,sa=0,eh=null,uu=-1,cu=0;function Xt(){return Ie&6?Nt():uu!==-1?uu:uu=Nt()}function ci(o){return o.mode&1?Ie&2&&jt!==0?jt&-jt:f6.transition!==null?(cu===0&&(cu=Wg()),cu):(o=ze,o!==0?o:Qe()):1}function jn(o,a,d,g){if(50<sa)throw sa=0,eh=null,Error(l(185));Vo(o,d,g),(!(Ie&2)||o!==Mt)&&(o===Mt&&(!(Ie&2)&&(su|=d),St===4&&di(o,jt)),hn(o,g),d===1&&Ie===0&&!(a.mode&1)&&(Gs(),Ml&&gr()))}function hn(o,a){var d=o.callbackNode;r6(o,a);var g=Nl(o,o===Mt?jt:0);if(g===0)d!==null&&Hg(d),o.callbackNode=null,o.callbackPriority=0;else if(a=g&-g,o.callbackPriority!==a){if(d!=null&&Hg(d),a===1)o.tag===0?d6(lm.bind(null,o)):Yg(lm.bind(null,o)),tt?ln(function(){!(Ie&6)&&gr()}):nf(rf,gr),d=null;else{switch($g(g)){case 1:d=rf;break;case 4:d=a6;break;case 16:d=sf;break;case 536870912:d=l6;break;default:d=sf}d=ym(d,am.bind(null,o))}o.callbackPriority=a,o.callbackNode=d}}function am(o,a){if(uu=-1,cu=0,Ie&6)throw Error(l(327));var d=o.callbackNode;if(es()&&o.callbackNode!==d)return null;var g=Nl(o,o===Mt?jt:0);if(g===0)return null;if(g&30||g&o.expiredLanes||a)a=du(o,g);else{a=g;var v=Ie;Ie|=2;var b=dm();(Mt!==o||jt!==a)&&(Dr=null,Gs(),qi(o,a));do try{R6();break}catch(W){cm(o,W)}while(1);hf(),iu.current=b,Ie=v,xt!==null?a=0:(Mt=null,jt=0,a=St)}if(a!==0){if(a===2&&(v=Jd(o),v!==0&&(g=v,a=th(o,v))),a===1)throw d=ra,qi(o,0),di(o,g),hn(o,Nt()),d;if(a===6)di(o,g);else{if(v=o.current.alternate,!(g&30)&&!A6(v)&&(a=du(o,g),a===2&&(b=Jd(o),b!==0&&(g=b,a=th(o,b))),a===1))throw d=ra,qi(o,0),di(o,g),hn(o,Nt()),d;switch(o.finishedWork=v,o.finishedLanes=g,a){case 0:case 1:throw Error(l(345));case 2:Ji(o,fn,Dr);break;case 3:if(di(o,g),(g&130023424)===g&&(a=Zf+500-Nt(),10<a)){if(Nl(o,0)!==0)break;if(v=o.suspendedLanes,(v&g)!==g){Xt(),o.pingedLanes|=o.suspendedLanes&v;break}o.timeoutHandle=B(Ji.bind(null,o,fn,Dr),a);break}Ji(o,fn,Dr);break;case 4:if(di(o,g),(g&4194240)===g)break;for(a=o.eventTimes,v=-1;0<g;){var F=31-Qn(g);b=1<<F,F=a[F],F>v&&(v=F),g&=~b}if(g=v,g=Nt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*M6(g/1960))-g,10<g){o.timeoutHandle=B(Ji.bind(null,o,fn,Dr),g);break}Ji(o,fn,Dr);break;case 5:Ji(o,fn,Dr);break;default:throw Error(l(329))}}}return hn(o,Nt()),o.callbackNode===d?am.bind(null,o):null}function th(o,a){var d=ia;return o.current.memoizedState.isDehydrated&&(qi(o,a).flags|=256),o=du(o,a),o!==2&&(a=fn,fn=d,a!==null&&nh(a)),o}function nh(o){fn===null?fn=o:fn.push.apply(fn,o)}function A6(o){for(var a=o;;){if(a.flags&16384){var d=a.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var v=d[g],b=v.getSnapshot;v=v.value;try{if(!Zn(b(),v))return!1}catch{return!1}}}if(d=a.child,a.subtreeFlags&16384&&d!==null)d.return=a,a=d;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function di(o,a){for(a&=~Qf,a&=~su,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var d=31-Qn(a),g=1<<d;o[d]=-1,a&=~g}}function lm(o){if(Ie&6)throw Error(l(327));es();var a=Nl(o,0);if(!(a&1))return hn(o,Nt()),null;var d=du(o,a);if(o.tag!==0&&d===2){var g=Jd(o);g!==0&&(a=g,d=th(o,g))}if(d===1)throw d=ra,qi(o,0),di(o,a),hn(o,Nt()),d;if(d===6)throw Error(l(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,Ji(o,fn,Dr),hn(o,Nt()),null}function um(o){ui!==null&&ui.tag===0&&!(Ie&6)&&es();var a=Ie;Ie|=1;var d=mt.transition,g=ze;try{if(mt.transition=null,ze=1,o)return o()}finally{ze=g,mt.transition=d,Ie=a,!(Ie&6)&&gr()}}function rh(){kn=Us.current,Ze(Us)}function qi(o,a){o.finishedWork=null,o.finishedLanes=0;var d=o.timeoutHandle;if(d!==J&&(o.timeoutHandle=J,Q(d)),xt!==null)for(d=xt.return;d!==null;){var g=d;switch(lf(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Cl();break;case 3:Ds(),Ze(un),Ze(Wt),_f();break;case 5:xf(g);break;case 4:Ds();break;case 13:Ze(ot);break;case 19:Ze(ot);break;case 10:pf(g.type._context);break;case 22:case 23:rh()}d=d.return}if(Mt=o,xt=o=fi(o.current,null),jt=kn=a,St=0,ra=null,Qf=su=Zi=0,fn=ia=null,Ki!==null){for(a=0;a<Ki.length;a++)if(d=Ki[a],g=d.interleaved,g!==null){d.interleaved=null;var v=g.next,b=d.pending;if(b!==null){var F=b.next;b.next=v,g.next=F}d.pending=g}Ki=null}return o}function cm(o,a){do{var d=xt;try{if(hf(),Ul.current=$l,Gl){for(var g=at.memoizedState;g!==null;){var v=g.queue;v!==null&&(v.pending=null),g=g.next}Gl=!1}if(Qi=0,Pt=_t=at=null,Xo=!1,Ko=0,Kf.current=null,d===null||d.return===null){St=1,ra=a,xt=null;break}e:{var b=o,F=d.return,W=d,q=a;if(a=jt,W.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var ae=q,we=W,Ne=we.tag;if(!(we.mode&1)&&(Ne===0||Ne===11||Ne===15)){var pe=we.alternate;pe?(we.updateQueue=pe.updateQueue,we.memoizedState=pe.memoizedState,we.lanes=pe.lanes):(we.updateQueue=null,we.memoizedState=null)}var qe=F1(F);if(qe!==null){qe.flags&=-257,j1(qe,F,W,b,a),qe.mode&1&&L1(b,ae,a),a=qe,q=ae;var He=a.updateQueue;if(He===null){var pn=new Set;pn.add(q),a.updateQueue=pn}else He.add(q);break e}else{if(!(a&1)){L1(b,ae,a),ih();break e}q=Error(l(426))}}else if(nt&&W.mode&1){var zr=F1(F);if(zr!==null){!(zr.flags&65536)&&(zr.flags|=256),j1(zr,F,W,b,a),df(zs(q,W));break e}}b=q=zs(q,W),St!==4&&(St=2),ia===null?ia=[b]:ia.push(b),b=F;do{switch(b.tag){case 3:b.flags|=65536,a&=-a,b.lanes|=a;var Z=I1(b,q,a);s1(b,Z);break e;case 1:W=q;var Y=b.type,ee=b.stateNode;if(!(b.flags&128)&&(typeof Y.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(li===null||!li.has(ee)))){b.flags|=65536,a&=-a,b.lanes|=a;var ge=R1(b,W,a);s1(b,ge);break e}}b=b.return}while(b!==null)}hm(d)}catch(Te){a=Te,xt===d&&d!==null&&(xt=d=d.return);continue}break}while(1)}function dm(){var o=iu.current;return iu.current=$l,o===null?$l:o}function ih(){(St===0||St===3||St===2)&&(St=4),Mt===null||!(Zi&268435455)&&!(su&268435455)||di(Mt,jt)}function du(o,a){var d=Ie;Ie|=2;var g=dm();(Mt!==o||jt!==a)&&(Dr=null,qi(o,a));do try{I6();break}catch(v){cm(o,v)}while(1);if(hf(),Ie=d,iu.current=g,xt!==null)throw Error(l(261));return Mt=null,jt=0,St}function I6(){for(;xt!==null;)fm(xt)}function R6(){for(;xt!==null&&!s6();)fm(xt)}function fm(o){var a=mm(o.alternate,o,kn);o.memoizedProps=o.pendingProps,a===null?hm(o):xt=a,Kf.current=null}function hm(o){var a=o;do{var d=a.alternate;if(o=a.return,a.flags&32768){if(d=E6(d,a),d!==null){d.flags&=32767,xt=d;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{St=6,xt=null;return}}else if(d=T6(d,a,kn),d!==null){xt=d;return}if(a=a.sibling,a!==null){xt=a;return}xt=a=o}while(a!==null);St===0&&(St=5)}function Ji(o,a,d){var g=ze,v=mt.transition;try{mt.transition=null,ze=1,L6(o,a,d,g)}finally{mt.transition=v,ze=g}return null}function L6(o,a,d,g){do es();while(ui!==null);if(Ie&6)throw Error(l(327));d=o.finishedWork;var v=o.finishedLanes;if(d===null)return null;if(o.finishedWork=null,o.finishedLanes=0,d===o.current)throw Error(l(177));o.callbackNode=null,o.callbackPriority=0;var b=d.lanes|d.childLanes;if(i6(o,b),o===Mt&&(xt=Mt=null,jt=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||au||(au=!0,ym(sf,function(){return es(),null})),b=(d.flags&15990)!==0,d.subtreeFlags&15990||b){b=mt.transition,mt.transition=null;var F=ze;ze=1;var W=Ie;Ie|=4,Kf.current=null,N6(o,d),tm(d,o),H(o.containerInfo),o.current=d,P6(d),o6(),Ie=W,ze=F,mt.transition=b}else o.current=d;if(au&&(au=!1,ui=o,lu=v),b=o.pendingLanes,b===0&&(li=null),u6(d.stateNode),hn(o,Nt()),a!==null)for(g=o.onRecoverableError,d=0;d<a.length;d++)v=a[d],g(v.value,{componentStack:v.stack,digest:v.digest});if(ou)throw ou=!1,o=Jf,Jf=null,o;return lu&1&&o.tag!==0&&es(),b=o.pendingLanes,b&1?o===eh?sa++:(sa=0,eh=o):sa=0,gr(),null}function es(){if(ui!==null){var o=$g(lu),a=mt.transition,d=ze;try{if(mt.transition=null,ze=16>o?16:o,ui===null)var g=!1;else{if(o=ui,ui=null,lu=0,Ie&6)throw Error(l(331));var v=Ie;for(Ie|=4,me=o.current;me!==null;){var b=me,F=b.child;if(me.flags&16){var W=b.deletions;if(W!==null){for(var q=0;q<W.length;q++){var ae=W[q];for(me=ae;me!==null;){var we=me;switch(we.tag){case 0:case 11:case 15:ta(8,we,b)}var Ne=we.child;if(Ne!==null)Ne.return=we,me=Ne;else for(;me!==null;){we=me;var pe=we.sibling,qe=we.return;if(Z1(we),we===ae){me=null;break}if(pe!==null){pe.return=qe,me=pe;break}me=qe}}}var He=b.alternate;if(He!==null){var pn=He.child;if(pn!==null){He.child=null;do{var zr=pn.sibling;pn.sibling=null,pn=zr}while(pn!==null)}}me=b}}if(b.subtreeFlags&2064&&F!==null)F.return=b,me=F;else e:for(;me!==null;){if(b=me,b.flags&2048)switch(b.tag){case 0:case 11:case 15:ta(9,b,b.return)}var Z=b.sibling;if(Z!==null){Z.return=b.return,me=Z;break e}me=b.return}}var Y=o.current;for(me=Y;me!==null;){F=me;var ee=F.child;if(F.subtreeFlags&2064&&ee!==null)ee.return=F,me=ee;else e:for(F=Y;me!==null;){if(W=me,W.flags&2048)try{switch(W.tag){case 0:case 11:case 15:ql(9,W)}}catch(Te){rt(W,W.return,Te)}if(W===F){me=null;break e}var ge=W.sibling;if(ge!==null){ge.return=W.return,me=ge;break e}me=W.return}}if(Ie=v,gr(),pr&&typeof pr.onPostCommitFiberRoot=="function")try{pr.onPostCommitFiberRoot(Pl,o)}catch{}g=!0}return g}finally{ze=d,mt.transition=a}}return!1}function pm(o,a,d){a=zs(d,a),a=I1(o,a,1),o=ai(o,a,1),a=Xt(),o!==null&&(Vo(o,1,a),hn(o,a))}function rt(o,a,d){if(o.tag===3)pm(o,o,d);else for(;a!==null;){if(a.tag===3){pm(a,o,d);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(li===null||!li.has(g))){o=zs(d,o),o=R1(a,o,1),a=ai(a,o,1),o=Xt(),a!==null&&(Vo(a,1,o),hn(a,o));break}}a=a.return}}function F6(o,a,d){var g=o.pingCache;g!==null&&g.delete(a),a=Xt(),o.pingedLanes|=o.suspendedLanes&d,Mt===o&&(jt&d)===d&&(St===4||St===3&&(jt&130023424)===jt&&500>Nt()-Zf?qi(o,0):Qf|=d),hn(o,a)}function gm(o,a){a===0&&(o.mode&1?(a=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):a=1);var d=Xt();o=mr(o,a),o!==null&&(Vo(o,a,d),hn(o,d))}function j6(o){var a=o.memoizedState,d=0;a!==null&&(d=a.retryLane),gm(o,d)}function O6(o,a){var d=0;switch(o.tag){case 13:var g=o.stateNode,v=o.memoizedState;v!==null&&(d=v.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(l(314))}g!==null&&g.delete(a),gm(o,d)}var mm;mm=function(o,a,d){if(o!==null)if(o.memoizedProps!==a.pendingProps||un.current)dn=!0;else{if(!(o.lanes&d)&&!(a.flags&128))return dn=!1,C6(o,a,d);dn=!!(o.flags&131072)}else dn=!1,nt&&a.flags&1048576&&Xg(a,Il,a.index);switch(a.lanes=0,a.tag){case 2:var g=a.type;Xl(o,a),o=a.pendingProps;var v=Ms(a,Wt.current);js(a,d),v=Cf(null,a,g,o,v,d);var b=Tf();return a.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,cn(g)?(b=!0,Tl(a)):b=!1,a.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,yf(a),v.updater=Hl,a.stateNode=v,v._reactInternals=a,Af(a,g,o,d),a=Ff(null,a,g,!0,b,d)):(a.tag=0,nt&&b&&af(a),tn(null,a,v,d),a=a.child),a;case 16:g=a.elementType;e:{switch(Xl(o,a),o=a.pendingProps,v=g._init,g=v(g._payload),a.type=g,v=a.tag=z6(g),o=Jn(g,o),v){case 0:a=Lf(null,a,g,o,d);break e;case 1:a=G1(null,a,g,o,d);break e;case 11:a=O1(null,a,g,o,d);break e;case 14:a=D1(null,a,g,Jn(g.type,o),d);break e}throw Error(l(306,g,""))}return a;case 0:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:Jn(g,v),Lf(o,a,g,v,d);case 1:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:Jn(g,v),G1(o,a,g,v,d);case 3:e:{if(V1(a),o===null)throw Error(l(387));g=a.pendingProps,b=a.memoizedState,v=b.element,i1(o,a),zl(a,g,null,d);var F=a.memoizedState;if(g=F.element,Se&&b.isDehydrated)if(b={element:g,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},a.updateQueue.baseState=b,a.memoizedState=b,a.flags&256){v=zs(Error(l(423)),a),a=W1(o,a,g,d,v);break e}else if(g!==v){v=zs(Error(l(424)),a),a=W1(o,a,g,d,v);break e}else for(Se&&(In=z4(a.stateNode.containerInfo),Sn=a,nt=!0,qn=null,Wo=!1),d=t1(a,null,g,d),a.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Rs(),g===v){a=Or(o,a,d);break e}tn(o,a,g,d)}a=a.child}return a;case 5:return a1(a),o===null&&cf(a),g=a.type,v=a.pendingProps,b=o!==null?o.memoizedProps:null,F=v.children,he(g,v)?F=null:b!==null&&he(g,b)&&(a.flags|=32),U1(o,a),tn(o,a,F,d),a.child;case 6:return o===null&&cf(a),null;case 13:return $1(o,a,d);case 4:return vf(a,a.stateNode.containerInfo),g=a.pendingProps,o===null?a.child=Ls(a,null,g,d):tn(o,a,g,d),a.child;case 11:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:Jn(g,v),O1(o,a,g,v,d);case 7:return tn(o,a,a.pendingProps,d),a.child;case 8:return tn(o,a,a.pendingProps.children,d),a.child;case 12:return tn(o,a,a.pendingProps.children,d),a.child;case 10:e:{if(g=a.type._context,v=a.pendingProps,b=a.memoizedProps,F=v.value,n1(a,g,F),b!==null)if(Zn(b.value,F)){if(b.children===v.children&&!un.current){a=Or(o,a,d);break e}}else for(b=a.child,b!==null&&(b.return=a);b!==null;){var W=b.dependencies;if(W!==null){F=b.child;for(var q=W.firstContext;q!==null;){if(q.context===g){if(b.tag===1){q=jr(-1,d&-d),q.tag=2;var ae=b.updateQueue;if(ae!==null){ae=ae.shared;var we=ae.pending;we===null?q.next=q:(q.next=we.next,we.next=q),ae.pending=q}}b.lanes|=d,q=b.alternate,q!==null&&(q.lanes|=d),gf(b.return,d,a),W.lanes|=d;break}q=q.next}}else if(b.tag===10)F=b.type===a.type?null:b.child;else if(b.tag===18){if(F=b.return,F===null)throw Error(l(341));F.lanes|=d,W=F.alternate,W!==null&&(W.lanes|=d),gf(F,d,a),F=b.sibling}else F=b.child;if(F!==null)F.return=b;else for(F=b;F!==null;){if(F===a){F=null;break}if(b=F.sibling,b!==null){b.return=F.return,F=b;break}F=F.return}b=F}tn(o,a,v.children,d),a=a.child}return a;case 9:return v=a.type,g=a.pendingProps.children,js(a,d),v=Rn(v),g=g(v),a.flags|=1,tn(o,a,g,d),a.child;case 14:return g=a.type,v=Jn(g,a.pendingProps),v=Jn(g.type,v),D1(o,a,g,v,d);case 15:return z1(o,a,a.type,a.pendingProps,d);case 17:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:Jn(g,v),Xl(o,a),a.tag=1,cn(g)?(o=!0,Tl(a)):o=!1,js(a,d),M1(a,g,v),Af(a,g,v,d),Ff(null,a,g,!0,o,d);case 19:return Y1(o,a,d);case 22:return B1(o,a,d)}throw Error(l(156,a.tag))};function ym(o,a){return nf(o,a)}function D6(o,a,d,g){this.tag=o,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(o,a,d,g){return new D6(o,a,d,g)}function sh(o){return o=o.prototype,!(!o||!o.isReactComponent)}function z6(o){if(typeof o=="function")return sh(o)?1:0;if(o!=null){if(o=o.$$typeof,o===C)return 11;if(o===E)return 14}return 2}function fi(o,a){var d=o.alternate;return d===null?(d=On(o.tag,a,o.key,o.mode),d.elementType=o.elementType,d.type=o.type,d.stateNode=o.stateNode,d.alternate=o,o.alternate=d):(d.pendingProps=a,d.type=o.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=o.flags&14680064,d.childLanes=o.childLanes,d.lanes=o.lanes,d.child=o.child,d.memoizedProps=o.memoizedProps,d.memoizedState=o.memoizedState,d.updateQueue=o.updateQueue,a=o.dependencies,d.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},d.sibling=o.sibling,d.index=o.index,d.ref=o.ref,d}function fu(o,a,d,g,v,b){var F=2;if(g=o,typeof o=="function")sh(o)&&(F=1);else if(typeof o=="string")F=5;else e:switch(o){case p:return ts(d.children,v,b,a);case m:F=8,v|=8;break;case w:return o=On(12,d,a,v|2),o.elementType=w,o.lanes=b,o;case S:return o=On(13,d,a,v),o.elementType=S,o.lanes=b,o;case _:return o=On(19,d,a,v),o.elementType=_,o.lanes=b,o;case k:return hu(d,v,b,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case y:F=10;break e;case x:F=9;break e;case C:F=11;break e;case E:F=14;break e;case h:F=16,g=null;break e}throw Error(l(130,o==null?o:typeof o,""))}return a=On(F,d,a,v),a.elementType=o,a.type=g,a.lanes=b,a}function ts(o,a,d,g){return o=On(7,o,g,a),o.lanes=d,o}function hu(o,a,d,g){return o=On(22,o,g,a),o.elementType=k,o.lanes=d,o.stateNode={isHidden:!1},o}function oh(o,a,d){return o=On(6,o,null,a),o.lanes=d,o}function ah(o,a,d){return a=On(4,o.children!==null?o.children:[],o.key,a),a.lanes=d,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function B6(o,a,d,g,v){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=J,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ef(0),this.expirationTimes=ef(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ef(0),this.identifierPrefix=g,this.onRecoverableError=v,Se&&(this.mutableSourceEagerHydrationData=null)}function vm(o,a,d,g,v,b,F,W,q){return o=new B6(o,a,d,W,q),a===1?(a=1,b===!0&&(a|=8)):a=0,b=On(3,null,null,a),o.current=b,b.stateNode=o,b.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},yf(b),o}function xm(o){if(!o)return si;o=o._reactInternals;e:{if(L(o)!==o||o.tag!==1)throw Error(l(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(cn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(l(171))}if(o.tag===1){var d=o.type;if(cn(d))return Gg(o,d,a)}return a}function wm(o){var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(l(188)):(o=Object.keys(o).join(","),Error(l(268,o)));return o=j(a),o===null?null:o.stateNode}function _m(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var d=o.retryLane;o.retryLane=d!==0&&d<a?d:a}}function pu(o,a){_m(o,a),(o=o.alternate)&&_m(o,a)}function U6(o){return o=j(o),o===null?null:o.stateNode}function G6(){return null}return n.attemptContinuousHydration=function(o){if(o.tag===13){var a=mr(o,134217728);if(a!==null){var d=Xt();jn(a,o,134217728,d)}pu(o,134217728)}},n.attemptDiscreteHydration=function(o){if(o.tag===13){var a=mr(o,1);if(a!==null){var d=Xt();jn(a,o,1,d)}pu(o,1)}},n.attemptHydrationAtCurrentPriority=function(o){if(o.tag===13){var a=ci(o),d=mr(o,a);if(d!==null){var g=Xt();jn(d,o,a,g)}pu(o,a)}},n.attemptSynchronousHydration=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var d=Go(a.pendingLanes);d!==0&&(tf(a,d|1),hn(a,Nt()),!(Ie&6)&&(Gs(),gr()))}break;case 13:um(function(){var g=mr(o,1);if(g!==null){var v=Xt();jn(g,o,1,v)}}),pu(o,1)}},n.batchedUpdates=function(o,a){var d=Ie;Ie|=1;try{return o(a)}finally{Ie=d,Ie===0&&(Gs(),Ml&&gr())}},n.createComponentSelector=function(o){return{$$typeof:Jl,value:o}},n.createContainer=function(o,a,d,g,v,b,F){return vm(o,a,!1,null,d,g,v,b,F)},n.createHasPseudoClassSelector=function(o){return{$$typeof:eu,value:o}},n.createHydrationContainer=function(o,a,d,g,v,b,F,W,q){return o=vm(d,g,!0,o,v,b,F,W,q),o.context=xm(null),d=o.current,g=Xt(),v=ci(d),b=jr(g,v),b.callback=a??null,ai(d,b,v),o.current.lanes=v,Vo(o,v,g),hn(o,g),o},n.createPortal=function(o,a,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:g==null?null:""+g,children:o,containerInfo:a,implementation:d}},n.createRoleSelector=function(o){return{$$typeof:tu,value:o}},n.createTestNameSelector=function(o){return{$$typeof:nu,value:o}},n.createTextSelector=function(o){return{$$typeof:ru,value:o}},n.deferredUpdates=function(o){var a=ze,d=mt.transition;try{return mt.transition=null,ze=16,o()}finally{ze=a,mt.transition=d}},n.discreteUpdates=function(o,a,d,g,v){var b=ze,F=mt.transition;try{return mt.transition=null,ze=1,o(a,d,g,v)}finally{ze=b,mt.transition=F,Ie===0&&Gs()}},n.findAllNodes=Xf,n.findBoundingRects=function(o,a){if(!Gt)throw Error(l(363));a=Xf(o,a),o=[];for(var d=0;d<a.length;d++)o.push(Xn(a[d]));for(a=o.length-1;0<a;a--){d=o[a];for(var g=d.x,v=g+d.width,b=d.y,F=b+d.height,W=a-1;0<=W;W--)if(a!==W){var q=o[W],ae=q.x,we=ae+q.width,Ne=q.y,pe=Ne+q.height;if(g>=ae&&b>=Ne&&v<=we&&F<=pe){o.splice(a,1);break}else if(g!==ae||d.width!==q.width||pe<b||Ne>F){if(!(b!==Ne||d.height!==q.height||we<g||ae>v)){ae>g&&(q.width+=ae-g,q.x=g),we<v&&(q.width=v-ae),o.splice(a,1);break}}else{Ne>b&&(q.height+=Ne-b,q.y=b),pe<F&&(q.height=F-Ne),o.splice(a,1);break}}}return o},n.findHostInstance=wm,n.findHostInstanceWithNoPortals=function(o){return o=R(o),o=o!==null?U(o):null,o===null?null:o.stateNode},n.findHostInstanceWithWarning=function(o){return wm(o)},n.flushControlled=function(o){var a=Ie;Ie|=1;var d=mt.transition,g=ze;try{mt.transition=null,ze=1,o()}finally{ze=g,mt.transition=d,Ie=a,Ie===0&&(Gs(),gr())}},n.flushPassiveEffects=es,n.flushSync=um,n.focusWithin=function(o,a){if(!Gt)throw Error(l(363));for(o=$f(o),a=om(o,a),a=Array.from(a),o=0;o<a.length;){var d=a[o++];if(!Lt(d)){if(d.tag===5&&Ir(d.stateNode))return!0;for(d=d.child;d!==null;)a.push(d),d=d.sibling}}return!1},n.getCurrentUpdatePriority=function(){return ze},n.getFindAllNodesFailureDescription=function(o,a){if(!Gt)throw Error(l(363));var d=0,g=[];o=[$f(o),0];for(var v=0;v<o.length;){var b=o[v++],F=o[v++],W=a[F];if((b.tag!==5||!Lt(b))&&(Hf(b,W)&&(g.push(Yf(W)),F++,F>d&&(d=F)),F<a.length))for(b=b.child;b!==null;)o.push(b,F),b=b.sibling}if(d<a.length){for(o=[];d<a.length;d++)o.push(Yf(a[d]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+o.join(" > ")}return null},n.getPublicRootInstance=function(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return V(o.child.stateNode);default:return o.child.stateNode}},n.injectIntoDevTools=function(o){if(o={bundleType:o.bundleType,version:o.version,rendererPackageName:o.rendererPackageName,rendererConfig:o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:U6,findFiberByHostInstance:o.findFiberByHostInstance||G6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")o=!1;else{var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled||!a.supportsFiber)o=!0;else{try{Pl=a.inject(o),pr=a}catch{}o=!!a.checkDCE}}return o},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(o,a,d,g){if(!Gt)throw Error(l(363));o=Xf(o,a);var v=le(o,d,g).disconnect;return{disconnect:function(){v()}}},n.registerMutableSourceForHydration=function(o,a){var d=a._getVersion;d=d(a._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[a,d]:o.mutableSourceEagerHydrationData.push(a,d)},n.runWithPriority=function(o,a){var d=ze;try{return ze=o,a()}finally{ze=d}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(o,a,d,g){var v=a.current,b=Xt(),F=ci(v);return d=xm(d),a.context===null?a.context=d:a.pendingContext=d,a=jr(b,F),a.payload={element:o},g=g===void 0?null:g,g!==null&&(a.callback=g),o=ai(v,a,F),o!==null&&(jn(o,v,F,b),Dl(o,v,F)),F},n};y4.exports=FT;var jT=y4.exports;const OT=ul(jT);var v4={exports:{}},Es={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Es.ConcurrentRoot=1;Es.ContinuousEventPriority=4;Es.DefaultEventPriority=16;Es.DiscreteEventPriority=1;Es.IdleEventPriority=536870912;Es.LegacyRoot=0;v4.exports=Es;var x4=v4.exports;const z2={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let B2=!1,U2=!1;const Mg=".react-konva-event",DT=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,zT=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,BT={};function Vd(t,e,n=BT){if(!B2&&"zIndex"in e&&(console.warn(zT),B2=!0),!U2&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(DT),U2=!0)}for(var s in n)if(!z2[s]){var l=s.slice(0,2)==="on",c=n[s]!==e[s];if(l&&c){var u=s.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),t.off(u,n[s])}var f=!e.hasOwnProperty(s);f&&t.setAttr(s,void 0)}var p=e._useStrictMode,m={},w=!1;const y={};for(var s in e)if(!z2[s]){var l=s.slice(0,2)==="on",x=n[s]!==e[s];if(l&&x){var u=s.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e[s]&&(y[u]=e[s])}!l&&(e[s]!==n[s]||p&&e[s]!==t.getAttr(s))&&(w=!0,m[s]=e[s])}w&&(t.setAttrs(m),Wi(t));for(var u in y)t.on(u+Mg,y[u])}function Wi(t){if(!Ae.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const w4={},UT={};al.Node.prototype._applyProps=Vd;function GT(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),Wi(t)}function VT(t,e,n){let r=al[t];r||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=al.Group);const i={},s={};for(var l in e){var c=l.slice(0,2)==="on";c?s[l]=e[l]:i[l]=e[l]}const u=new r(i);return Vd(u,s),u}function WT(t,e,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function $T(t,e,n){return!1}function HT(t){return t}function YT(){return null}function XT(){return null}function KT(t,e,n,r){return UT}function QT(){}function ZT(t){}function qT(t,e){return!1}function JT(){return w4}function eE(){return w4}const tE=setTimeout,nE=clearTimeout,rE=-1;function iE(t,e){return!1}const sE=!1,oE=!0,aE=!0;function lE(t,e){e.parent===t?e.moveToTop():t.add(e),Wi(t)}function uE(t,e){e.parent===t?e.moveToTop():t.add(e),Wi(t)}function _4(t,e,n){e._remove(),t.add(e),e.setZIndex(n.getZIndex()),Wi(t)}function cE(t,e,n){_4(t,e,n)}function dE(t,e){e.destroy(),e.off(Mg),Wi(t)}function fE(t,e){e.destroy(),e.off(Mg),Wi(t)}function hE(t,e,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function pE(t,e,n){}function gE(t,e,n,r,i){Vd(t,i,r)}function mE(t){t.hide(),Wi(t)}function yE(t){}function vE(t,e){(e.visible==null||e.visible)&&t.show()}function xE(t,e){}function wE(t){}function _E(){}const SE=()=>x4.DefaultEventPriority,kE=Object.freeze(Object.defineProperty({__proto__:null,appendChild:lE,appendChildToContainer:uE,appendInitialChild:GT,cancelTimeout:nE,clearContainer:wE,commitMount:pE,commitTextUpdate:hE,commitUpdate:gE,createInstance:VT,createTextInstance:WT,detachDeletedInstance:_E,finalizeInitialChildren:$T,getChildHostContext:eE,getCurrentEventPriority:SE,getPublicInstance:HT,getRootHostContext:JT,hideInstance:mE,hideTextInstance:yE,idlePriority:ba.unstable_IdlePriority,insertBefore:_4,insertInContainerBefore:cE,isPrimaryRenderer:sE,noTimeout:rE,now:ba.unstable_now,prepareForCommit:YT,preparePortalMount:XT,prepareUpdate:KT,removeChild:dE,removeChildFromContainer:fE,resetAfterCommit:QT,resetTextContent:ZT,run:ba.unstable_runWithPriority,scheduleTimeout:tE,shouldDeprioritizeSubtree:qT,shouldSetTextContent:iE,supportsMutation:aE,unhideInstance:vE,unhideTextInstance:xE,warnsIfNotActing:oE},Symbol.toStringTag,{value:"Module"}));var CE=Object.defineProperty,TE=Object.defineProperties,EE=Object.getOwnPropertyDescriptors,G2=Object.getOwnPropertySymbols,bE=Object.prototype.hasOwnProperty,NE=Object.prototype.propertyIsEnumerable,V2=(t,e,n)=>e in t?CE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,W2=(t,e)=>{for(var n in e||(e={}))bE.call(e,n)&&V2(t,n,e[n]);if(G2)for(var n of G2(e))NE.call(e,n)&&V2(t,n,e[n]);return t},PE=(t,e)=>TE(t,EE(e)),$2,H2;typeof window<"u"&&(($2=window.document)!=null&&$2.createElement||((H2=window.navigator)==null?void 0:H2.product)==="ReactNative")?z.useLayoutEffect:z.useEffect;function S4(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=e?t.return:t.child;for(;r;){const i=S4(r,e,n);if(i)return i;r=e?null:r.sibling}}function k4(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const Y2=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=Y2;return}return Y2.apply(this,arguments)};const Ag=k4(z.createContext(null));class C4 extends z.Component{render(){return z.createElement(Ag.Provider,{value:this._reactInternals},this.props.children)}}function ME(){const t=z.useContext(Ag);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=z.useId();return z.useMemo(()=>{for(const r of[t,t==null?void 0:t.alternate]){if(!r)continue;const i=S4(r,!1,s=>{let l=s.memoizedState;for(;l;){if(l.memoizedState===e)return!0;l=l.next}});if(i)return i}},[t,e])}function AE(){const t=ME(),[e]=z.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){const i=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;i&&i!==Ag&&!e.has(i)&&e.set(i,z.useContext(k4(i)))}n=n.return}return e}function IE(){const t=AE();return z.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>z.createElement(e,null,z.createElement(n.Provider,PE(W2({},r),{value:t.get(n)}))),e=>z.createElement(C4,W2({},e))),[t])}function RE(t){const e=Zt.useRef({});return Zt.useLayoutEffect(()=>{e.current=t}),Zt.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const LE=t=>{const e=Zt.useRef(),n=Zt.useRef(),r=Zt.useRef(),i=RE(t),s=IE(),l=c=>{const{forwardedRef:u}=t;u&&(typeof u=="function"?u(c):u.current=c)};return Zt.useLayoutEffect(()=>(n.current=new al.Stage({width:t.width,height:t.height,container:e.current}),l(n.current),r.current=Ea.createContainer(n.current,x4.LegacyRoot,!1,null),Ea.updateContainer(Zt.createElement(s,{},t.children),r.current),()=>{al.isBrowser&&(l(null),Ea.updateContainer(null,r.current,null),n.current.destroy())}),[]),Zt.useLayoutEffect(()=>{l(n.current),Vd(n.current,t,i),Ea.updateContainer(Zt.createElement(s,{},t.children),r.current,null)}),Zt.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},Lc="Layer",Wd="Group",Fc="Rect",ll="Circle",mp="Line",Gn="Text",FE="Arrow",Ea=OT(kE);Ea.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Zt.version,rendererPackageName:"react-konva"});const jE=Zt.forwardRef((t,e)=>Zt.createElement(C4,{},Zt.createElement(LE,{...t,forwardedRef:e}))),T4=()=>{const{elements:t,setElements:e,arcStart:n,setArcStart:r,setTempArcEnd:i,setSelectedElement:s,snapToGrid:l,gridSnappingEnabled:c}=sn(),u=z.useCallback((w,y)=>{if(w.id===y.id)return;if(w.type===y.type){console.warn("Invalid arc: Cannot connect elements of the same type."),r(null),i(null),s(null);return}const x={id:go(),source:w.id,target:y.id,weight:1,anglePoints:[],sourceType:w.type,targetType:y.type};e(C=>({...C,arcs:[...C.arcs,x]})),r(null),i(null),s(null)},[e,r,i,s]),f=z.useCallback((w,y)=>{e(x=>{const C=x.arcs.map(S=>{if(S.id===w){const _=c?l(y.x,y.y):y,E=S.anglePoints?[...S.anglePoints]:[];return E.push(_),{...S,anglePoints:E}}return S});return{...x,arcs:C}})},[e,c,l]),p=z.useCallback((w,y,x)=>{e(C=>{const S=C.arcs.map(_=>{if(_.id===w&&_.anglePoints&&_.anglePoints[y]){const E=c?l(x.x,x.y):x,h=[..._.anglePoints];return h[y]=E,{..._,anglePoints:h}}return _});return{...C,arcs:S}})},[e,c,l]),m=z.useCallback((w,y)=>{e(x=>{const C=x.arcs.map(S=>{if(S.id===w&&S.anglePoints&&S.anglePoints[y]){const _=[...S.anglePoints];return _.splice(y,1),{...S,anglePoints:_}}return S});return{...x,arcs:C}})},[e]);return{handleCompleteArc:u,handleAddAnglePoint:f,handleDragAnglePoint:p,handleDeleteAnglePoint:m}};function X2(t,e){if(!t||!e)return!1;const n=Math.min(e.x,e.x+e.w),r=Math.min(e.y,e.y+e.h),i=Math.max(e.x,e.x+e.w),s=Math.max(e.y,e.y+e.h);return t.x>=n&&t.x<=i&&t.y>=r&&t.y<=s}function K2(t,e){if(!t||!e)return[];const n=[];return(t.places||[]).forEach(r=>{X2({x:r.x,y:r.y},e)&&n.push({id:r.id,type:"place"})}),(t.transitions||[]).forEach(r=>{X2({x:r.x,y:r.y},e)&&n.push({id:r.id,type:"transition"})}),n}function OE(t,e){return t.some(r=>r.id===e.id&&r.type===e.type)?t.filter(r=>!(r.id===e.id&&r.type===e.type)):[...t,e]}function E4(t,e,n,r={}){if(!e||!e.startPositions)return t;const{dx:i,dy:s}=n||{dx:0,dy:0},{gridSnappingEnabled:l=!1,snapToGrid:c=(x,C)=>({x,y:C})}=r,u=e.startPositions;if(u.size===0)return t;const f=new Map((t.places||[]).map(x=>[x.id,x])),p=new Map((t.transitions||[]).map(x=>[x.id,x])),m=new Map,w=new Map;for(const[x,C]of u){const S=l?c(C.x+i,C.y+s):{x:C.x+i,y:C.y+s};if(C.type==="place"){const _=f.get(x);_&&m.set(x,{..._,x:S.x,y:S.y})}else if(C.type==="transition"){const _=p.get(x);_&&w.set(x,{..._,x:S.x,y:S.y})}}const y={...t};return m.size>0&&(y.places=(t.places||[]).map(x=>m.get(x.id)||x)),w.size>0&&(y.transitions=(t.transitions||[]).map(x=>w.get(x.id)||x)),e.startArcPoints&&e.startArcPoints.size>0&&(y.arcs=(t.arcs||[]).map(x=>{const C=e.startArcPoints.get(x.id);if(!C)return x;const S=C.map(_=>({x:_.x+i,y:_.y+s}));return{...x,anglePoints:S}})),y}const Ig=()=>{var M,L;const{gridSnappingEnabled:t}=Io(),{elements:e,setElements:n,selectedElement:r,setSelectedElement:i,selectedElements:s,setSelectedElements:l,isIdSelected:c,setSelection:u,mode:f,arcStart:p,setArcStart:m,tempArcEnd:w,setTempArcEnd:y,snapToGrid:x,isShiftPressedRef:C}=sn(),{handleCompleteArc:S}=T4(),_=z.useCallback(()=>{if(!r)return;const{type:A,id:R}=r;let j=JSON.parse(JSON.stringify(e));A==="place"?(j.places=j.places.filter(G=>G.id!==R),j.arcs=j.arcs.filter(G=>G.source!==R&&G.target!==R)):A==="transition"?(j.transitions=j.transitions.filter(G=>G.id!==R),j.arcs=j.arcs.filter(G=>G.source!==R&&G.target!==R)):A==="arc"&&(j.arcs=j.arcs.filter(G=>G.id!==R)),n(j),i(null)},[r,e,n,i]),E=z.useCallback(()=>{n({places:[],transitions:[],arcs:[]}),i(null),m(null),y(null)},[n,i,m,y]),h=z.useCallback(A=>{var j,G;if(!A)return;let R=t?x(A.x,A.y):A;if(f==="place"){const U=((j=e==null?void 0:e.places)==null?void 0:j.length)||0,O={id:go(),x:R.x,y:R.y,label:`P${U+1}`,tokens:0};n(V=>({...V,places:[...(V==null?void 0:V.places)||[],O]}))}else if(f==="transition"){const U=((G=e==null?void 0:e.transitions)==null?void 0:G.length)||0,O={id:go(),x:R.x,y:R.y,label:`T${U+1}`};n(V=>({...V,transitions:[...(V==null?void 0:V.transitions)||[],O]}))}},[f,(M=e==null?void 0:e.places)==null?void 0:M.length,(L=e==null?void 0:e.transitions)==null?void 0:L.length,n,x,t]),k=z.useCallback((A,R,j)=>{var V,$;let G=null,U=null,O=null;typeof j<"u"?(G=A,U=R,O=j):(U=A,O=R),f==="select"||f==="arc_angle"?(!!(G&&((V=G.evt)!=null&&V.shiftKey||($=G.evt)!=null&&$.getModifierState&&G.evt.getModifierState("Shift")))||!!(C&&C.current)?(l(X=>OE(X,{id:U.id,type:O})),i({...U,type:O})):u([{id:U.id,type:O}]),m(null),y(null)):f==="arc"&&(p?S(p.element,{...U,type:O}):(i({...U,type:O}),m({element:{id:U.id,type:O},point:{x:U.x,y:U.y}}),y({sourcePoint:{x:U.x,y:U.y},x:U.x,y:U.y,potentialTarget:null})))},[f,p,i,l,c,u,m,y,S]),T=z.useCallback((A,R,j)=>{const G=t?x(j.x,j.y):j;n(U=>{const O={...U};return R==="place"?O.places=U.places.map(V=>V.id===A.id?{...V,x:G.x,y:G.y}:V):R==="transition"&&(O.transitions=U.transitions.map(V=>V.id===A.id?{...V,x:G.x,y:G.y}:V)),O})},[n,t,x]),N=z.useCallback(A=>b5(e,A),[e]),I=z.useCallback((A,R={x:40,y:40})=>{if(!A)return null;const{newPlaces:j,newTransitions:G,newArcs:U,newSelection:O}=N5(A,go,R);return n(V=>({...V,places:[...V.places,...j],transitions:[...V.transitions,...G],arcs:[...V.arcs,...U]})),O},[n]);return{handleDeleteElement:_,clearAllElements:E,handleCreateElement:h,handleElementClick:k,handleElementDragEnd:T,collectClipboard:N,pasteClipboard:I}},DE=30,zE=4,BE=4,Rg=4,ar=2,UE=12,yp=10,GE=10,Lg=.48,n0=.25,VE={},b4=new WeakMap;function Du(t,e,n){return b4.set(t,{baseRadius:e,visuals:n}),n}function WE(t,e,n=2){const r=t.x+t.width,i=t.y+t.height,s=e.x+e.width,l=e.y+e.height;return!(r+n<=e.x||s+n<=t.x||i+n<=e.y||l+n<=t.y)}function $E(t){if(t<=0)return[];const e=[[t]];if(t>=4){const n=Math.min(6,t-1);for(let r=n;r>=Math.ceil(t/2);r-=1){const i=t-r;i>=1&&e.push([r,i])}}if(t>=7){const n=Math.min(6,t-3),r=Math.max(2,Math.ceil((t-n)/2)),i=t-n-r;i>0&&e.push([n,r,i])}return e}function HE(t,e,n){const r=[...e].sort((l,c)=>n[c].width-n[l].width),i=[];let s=0;for(let l=0;l<t.length;l+=1){const c=t[l],u=r.slice(s,s+c);if(u.length<c)return null;i.push(u),s+=c}return i}function YE(t,e,n,r,i){const s=t.length;if(s===0)return[];const l=new Array(s),c=t[0],u=Math.max(...c.map(S=>e[S].diagonal),r);let f=n-u-ar;if(f<=0)return null;const p=i?i+r+ar:r+ar;if(s===1)return l[0]=Math.max(f,p),l;const m=t[s-1],w=Math.max(...m.map(S=>e[S].diagonal),r),y=Math.max(p,w+ar),x=f-y,C=Math.max(r+ar,x/s);l[0]=f;for(let S=1;S<s;S+=1){const E=l[S-1]-C,h=t[S],k=Math.max(...h.map(N=>e[N].diagonal),r),T=Math.max(k+ar,p);if(l[S]=Math.max(E,T),l[S]<=0)return null}return l[s-1]<y&&(l[s-1]=y),l}function tc(t,e,n){if(!t||t.length===0)return e;let r=0;t.forEach(s=>{const l=s.x+s.width/2,c=s.y+s.height/2,u=Math.hypot(s.width/2,s.height/2),f=Math.hypot(l,c)+u+Rg;f>r&&(r=f)});const i=Math.ceil(r);return i>n&&n>=e?n:Math.max(e,i)}function nc(t){return typeof t=="boolean"?t?"T":"F":typeof t=="string"?`'${t}'`:Array.isArray(t)?`[${t.map(nc).join(", ")}]`:t&&typeof t=="object"&&t.__pair__?`(${nc(t.fst)}, ${nc(t.snd)})`:String(t)}function N4(t,e){return t.length?Math.max(e,t.length*e*Lg):e}function XE(t,e,n){const r=t.length;if(r===0)return null;const i=e-Rg;if(i<=0)return null;const s=i*2,l=[];for(let u=1;u<=r;u+=1){const f=Math.ceil(r/u);u===1&&r>4||f===1&&r>4||l.push({cols:u,rows:f})}l.sort((u,f)=>{const p=Math.abs(u.cols-u.rows)-Math.abs(f.cols-f.rows);return p!==0?p:u.cols-f.cols});const c=Math.max(...t.map(u=>u.length||1),1);for(const u of l){const f=u.cols,p=u.rows,m=s-ar*(f-1),w=s-ar*(p-1);if(m<=0||w<=0)continue;const y=m/f,x=w/p,C=x*.8,S=y/(c*Lg||1),_=Math.min(UE,C,S);if(_<yp)continue;const E=[];let h=!0;const k=y+ar,T=x+ar,N=k*(f-1),I=T*(p-1),M=-N/2,L=-I/2;if(t.forEach((A,R)=>{if(!h)return;const j=Math.floor(R/f),G=R%f,U=r-j*f,O=j===p-1?Math.min(U,f):f,$=M+(f-O)*k/2+G*k,D=L+j*T,H=N4(A,_)/2,re=_/2,K=Math.hypot(H,re);if(Math.hypot($,D)+K>i){h=!1;return}E.push({key:`token-${R}`,text:A,fontSize:_,x:$-y/2,y:D-_/2,width:y,height:_})}),h)return{radius:tc(E,n,e),layout:E}}return null}function KE(t,e,n){const r=t.length;if(r===0)return{layout:[],radius:n};const i=e-Rg;if(i<=0)return null;const s=Math.max(...t.map(f=>f.length||1),1),l=Math.max(yp,Math.min(12,i*2/(s*Lg))),c=t.map((f,p)=>p),u=f=>{const p=c.map(_=>{const E=N4(t[_],f);return{width:E,halfWidth:E/2,halfHeight:f/2,diagonal:Math.hypot(E/2,f/2)}});if(r===1){const _=p[0];if(_.diagonal>i)return null;const E=_.width*(1+n0),h=[{key:"token-0",text:t[0],fontSize:f,x:-E/2,y:-_.halfHeight,width:E,height:f}];return{layout:h,radius:tc(h,n,e)}}let m=null,w=0;if(r%2===1&&r>1){const E=[...c].sort((M,L)=>p[L].width-p[M].width)[0],h=p[E].diagonal,k=c.filter(M=>M!==E),T=k.length?Math.max(...k.map(M=>p[M].diagonal)):0,N=h+f*.5;i-T-2>=N&&(m=E,w=h)}const y=new Array(r);if(m!==null){const _=p[m];if(_.diagonal>i)return null;const E=_.width*(1+n0);y[m]={key:`token-${m}`,text:t[m],fontSize:f,x:-E/2,y:-_.halfHeight,width:E,height:f}}const x=c.filter(_=>_!==m);if(x.length===0){const _=y.filter(Boolean);return{layout:_,radius:tc(_,n,e)}}const C=y.slice(),S=$E(x.length);for(const _ of S){const E=HE(_,x,p);if(!E)continue;const h=YE(E,p,i,f,w);if(!h)continue;const k=C.slice();let T=!0;if(E.forEach((M,L)=>{const A=h[L],R=M.length;if(!R)return;const j=L%2===1?Math.PI/R:0;M.forEach((G,U)=>{if(!T)return;const O=p[G],V=O.width*(1+n0),$=V/2,D=-Math.PI/2+2*Math.PI*U/R+j,X=Math.cos(D)*A,H=Math.sin(D)*A;if(Math.hypot(X,H)+O.diagonal>i+ar){T=!1;return}k[G]={key:`token-${G}`,text:t[G],fontSize:f,x:X-$,y:H-O.halfHeight,width:V,height:f}})}),!T)continue;const N=k.filter(Boolean);if(N.length!==r)continue;let I=!1;for(let M=0;M<N.length;M+=1){for(let L=M+1;L<N.length;L+=1)if(WE(N[M],N[L])){I=!0;break}if(I)break}if(!I){const M=tc(N,n,e);return{layout:N,radius:M}}}return null};for(let f=l;f>=yp;f-=.5){const p=u(f);if(p&&p.layout&&p.layout.length===r)return p}return null}function P4(t,e=DE){var c;const n=Array.isArray(t)?t:VE,r=b4.get(n);if(r&&r.baseRadius===e)return r.visuals;const i=Array.isArray(t)?t:[];if(i.length===0)return Du(n,e,{radius:e,tokens:[],indicator:null});const s=i.map(nc),l=e*zE;for(let u=e;u<=l;u+=BE){if(s.length<=GE){const p=KE(s,u,e);if(p&&((c=p.layout)==null?void 0:c.length)===s.length){const m=Math.max(e,Math.min(p.radius,u));return Du(n,e,{radius:m,tokens:p.layout,indicator:null})}}const f=XE(s,u,e);if(f){const p=Math.max(e,Math.min(f.radius,u));return Du(n,e,{radius:p,tokens:f.layout,indicator:null})}}return Du(n,e,{radius:e,tokens:[],indicator:s.length})}const QE=typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0),ZE=t=>QE?t>500?200:t>100?150:100:t>500?100:50,qE=({id:t,x:e,y:n,label:r,tokens:i,valueTokens:s,isSelected:l,onSelect:c,onChange:u})=>{const{setIsDragging:f,snapToGrid:p,netMode:m,elements:w,selectedElements:y,setElements:x,multiDragRef:C,isIdSelected:S,mode:_,arcStart:E}=sn(),{gridSnappingEnabled:h,setSnapIndicator:k}=Io(),T=30,N=z.useRef(0),I=m==="algebraic-int"||Array.isArray(s),M=z.useMemo(()=>I?P4(s||[],T):{radius:T,tokens:[],indicator:null},[I,s]),L=I?M.radius:T,A=z.useCallback(O=>{const V=new Map;w.places.forEach(D=>{O.has(D.id)&&V.set(D.id,{type:"place",x:D.x,y:D.y})}),w.transitions.forEach(D=>{O.has(D.id)&&V.set(D.id,{type:"transition",x:D.x,y:D.y})});const $=new Map;return w.arcs.forEach(D=>{if(O.has(D.source)&&O.has(D.target)){const X=Array.isArray(D.anglePoints)?D.anglePoints.map(H=>({x:H.x,y:H.y})):[];$.set(D.id,X)}}),{startPositions:V,startArcPoints:$}},[w]),R=()=>{C.current!==null&&(C.current=null),f(!0);const O=S(t,"place");let V;O?V=new Set(y.filter(D=>D.type==="place"||D.type==="transition").map(D=>D.id)):(V=new Set([t]),typeof c=="function"&&c(t));const $=A(V);C.current={baseId:t,lastDelta:{dx:0,dy:0},...$}},j=O=>{var de,B;let V={x:O.target.x(),y:O.target.y()};if(h){const Q=p(V.x,V.y);k({visible:!0,position:Q,elementType:"place"}),O.target.position({x:Q.x,y:Q.y}),V=Q}const $=C.current;if(!$||!$.startPositions||$.baseId!==t)return;const D=$.startPositions.get(t);if(!D)return;const X=V.x-D.x,H=V.y-D.y,re=$.lastDelta||{dx:0,dy:0};if(re.dx===X&&re.dy===H)return;const K=(((de=w.places)==null?void 0:de.length)||0)+(((B=w.transitions)==null?void 0:B.length)||0),ne=ZE(K),te=performance.now();if(te-N.current<ne)return;N.current=te,$.lastDelta={dx:X,dy:H};const he={dx:X,dy:H};x(Q=>!$||!$.startPositions?Q:E4(Q,$,he,{gridSnappingEnabled:h,snapToGrid:p}))},G=O=>{const V={x:O.target.x(),y:O.target.y()};C.current=null,f(!1),k({visible:!1,position:null,elementType:null}),u(V)},U=()=>I?M.tokens.length>0?P.jsx(P.Fragment,{children:M.tokens.map(O=>P.jsx(Gn,{text:O.text,fontSize:O.fontSize,fill:"black",x:O.x,y:O.y,width:O.width,align:"center",wrap:"none",listening:!1},O.key))}):M.indicator?P.jsx(Gn,{text:`(${M.indicator})`,fontSize:12,fill:"black",x:-L,y:-7,width:L*2,align:"center",wrap:"none",listening:!1}):null:i===0?m==="algebraic-int"||Array.isArray(s)?null:P.jsx(Gn,{text:"0",fontSize:14,fill:"black",x:-L,y:-7,width:L*2,align:"center",listening:!1}):i<=5?P.jsxs(P.Fragment,{children:[Array.from({length:i}).map((O,V)=>{const $=2*Math.PI*V/i,D=4,X=L/2,H=Math.cos($)*X,re=Math.sin($)*X;return P.jsx(ll,{x:H,y:re,radius:D,fill:"black",listening:!1},V)}),P.jsx(Gn,{text:i.toString(),fontSize:14,fill:"black",x:-L,y:-7,width:L*2,align:"center",listening:!1})]}):P.jsx(Gn,{text:i.toString(),fontSize:16,fill:"black",x:-L,y:-8,width:L*2,align:"center",listening:!1});return P.jsxs(Wd,{x:e,y:n,draggable:_!=="arc"||!E,onDragStart:R,onDragMove:j,onDragEnd:G,onClick:()=>c(t),onTap:O=>{O.evt&&O.evt._handledByTouchEnd||c(t)},onTouchEnd:O=>{_==="arc"&&E&&E.element.id!==t&&(c(t),O.evt&&(O.evt._handledByTouchEnd=!0))},id:t,name:"element",elementType:"place",children:[P.jsx(ll,{radius:L,fill:"white",stroke:l?"blue":"black",strokeWidth:2}),P.jsx(Gn,{text:r,fontSize:12,fill:"black",x:-L,y:L+5,width:L*2,align:"center",listening:!1}),U()]})},JE=typeof window<"u"&&("ontouchstart"in window||navigator.maxTouchPoints>0),eb=t=>JE?t>500?200:t>100?150:100:t>500?100:50,r0=11,tb=.48,Q2=160,nb=6,rb=({id:t,x:e,y:n,label:r,guard:i,isSelected:s,isEnabled:l,onSelect:c,onChange:u})=>{const{gridSnappingEnabled:m,setSnapIndicator:w}=Io(),{setIsDragging:y,snapToGrid:x,simulationSettings:C,netMode:S,elements:_,selectedElements:E,setElements:h,multiDragRef:k,isIdSelected:T,setSelection:N,mode:I,arcStart:M}=sn(),L=z.useRef(0),A=z.useCallback($=>{const D=new Map;_.places.forEach(H=>{$.has(H.id)&&D.set(H.id,{type:"place",x:H.x,y:H.y})}),_.transitions.forEach(H=>{$.has(H.id)&&D.set(H.id,{type:"transition",x:H.x,y:H.y})});const X=new Map;return _.arcs.forEach(H=>{if($.has(H.source)&&$.has(H.target)){const re=Array.isArray(H.anglePoints)?H.anglePoints.map(K=>({x:K.x,y:K.y})):[];X.set(H.id,re)}}),{startPositions:D,startArcPoints:X}},[_]),R=()=>{k.current!==null&&(k.current=null),y(!0);const $=T(t,"transition");let D;$?D=new Set(E.filter(H=>H.type==="place"||H.type==="transition").map(H=>H.id)):(D=new Set([t]),typeof c=="function"&&c(t));const X=A(D);k.current={baseId:t,lastDelta:{dx:0,dy:0},...X}},j=$=>{var Q,J;let D={x:$.target.x(),y:$.target.y()};if(m){const ie=x(D.x,D.y);w({visible:!0,position:ie,elementType:"transition"}),$.target.position({x:ie.x,y:ie.y}),D=ie}const X=k.current;if(!X||!X.startPositions||X.baseId!==t)return;const H=X.startPositions.get(t);if(!H)return;const re=D.x-H.x,K=D.y-H.y,ne=X.lastDelta||{dx:0,dy:0};if(ne.dx===re&&ne.dy===K)return;const te=(((Q=_.places)==null?void 0:Q.length)||0)+(((J=_.transitions)==null?void 0:J.length)||0),he=eb(te),de=performance.now();if(de-L.current<he)return;L.current=de,X.lastDelta={dx:re,dy:K};const B={dx:re,dy:K};h(ie=>!X||!X.startPositions?ie:E4(ie,X,B,{gridSnappingEnabled:m,snapToGrid:x}))},G=$=>{const D={x:$.target.x(),y:$.target.y()};k.current=null,y(!1),w({visible:!1,position:null,elementType:null}),u(D)},U=S==="algebraic-int"?String(i||""):"";let O=40,V="none";if(U){const $=U.length*r0*tb+nb*2;$<=Q2?O=Math.max(40,$):(O=Q2,V="char")}return P.jsxs(Wd,{x:e,y:n,onClick:$=>c(t,$),onTap:$=>{$.evt&&$.evt._handledByTouchEnd||c(t,$)},onTouchEnd:$=>{I==="arc"&&M&&M.element.id!==t&&(c(t,$),$.evt&&($.evt._handledByTouchEnd=!0))},draggable:I!=="arc"||!M,onDragStart:R,onDragMove:j,onDragEnd:G,id:t,name:"element",elementType:"transition",children:[P.jsx(Fc,{x:-40/2,y:-50/2,width:40,height:50,fill:l?"rgba(255, 255, 0, 0.8)":"gray",stroke:s?"blue":l?"rgba(255, 180, 0, 1)":"black",strokeWidth:s||l?3:2}),P.jsx(Gn,{text:r,fontSize:14,fill:"black",x:-40/2,y:50/2+5,width:40,align:"center",listening:!1}),S==="algebraic-int"&&U&&P.jsx(Gn,{text:U,fontSize:r0,fill:"#333",x:-O/2,y:-50/2-14,width:O,align:"center",wrap:V,listening:!1,ellipsis:V!=="none"}),S==="algebraic-int"&&!U&&P.jsx(Gn,{text:"",fontSize:r0,fill:"gray",x:-40/2,y:-50/2-14,width:40,align:"center",listening:!1})]})},ib=({elements:t,selectedElement:e,handleElementClick:n,handleElementDragEnd:r,enabledTransitionIds:i})=>{var l,c;const{isIdSelected:s}=sn();return P.jsxs(Lc,{children:[(l=t==null?void 0:t.places)==null?void 0:l.map(u=>P.jsx(qE,{...u,isSelected:s(u.id,"place"),onSelect:f=>n(u,"place"),onChange:f=>r(u,"place",f)},u.id)),(c=t==null?void 0:t.transitions)==null?void 0:c.map(u=>P.jsx(rb,{...u,isSelected:s(u.id,"transition"),onSelect:f=>n(u,"transition"),onChange:f=>r(u,"transition",f),isEnabled:Array.isArray(i)?i.includes(u.id):!1},u.id))]})};function sb(t){return t!=null&&t.sourceType?t.sourceType:(t==null?void 0:t.type)==="place-to-transition"?"place":(t==null?void 0:t.type)==="transition-to-place"?"transition":"place"}function ob(t){return t!=null&&t.targetType?t.targetType:(t==null?void 0:t.type)==="place-to-transition"?"transition":(t==null?void 0:t.type)==="transition-to-place"?"place":"transition"}const ab=.52,i0=(t="",e=12,{padding:n=4,maxWidth:r=1/0}={})=>{if(!t.length)return{width:0,wrap:"none"};const i=t.length*e*ab+n*2;return i<=r?{width:i,wrap:"none"}:{width:r,wrap:"char"}},s0=(t,e)=>t.width||e*2,Ys=t=>Number.isFinite(t),lb=()=>{var E;const{elements:t,selectedElement:e,selectedElements:n,mode:r,tempArcEnd:i,getVirtualPointerPosition:s,gridSnappingEnabled:l,snapToGrid:c,simulationSettings:u}=sn(),f=(u==null?void 0:u.netMode)||"pt",{handleElementClick:p}=Ig(),{handleAddAnglePoint:m,handleDragAnglePoint:w,handleDeleteAnglePoint:y}=T4(),x=z.useMemo(()=>{const h=new Map;return(t.places||[]).forEach(k=>h.set(k.id,k)),(t.transitions||[]).forEach(k=>h.set(k.id,k)),h},[t.places,t.transitions]),C=h=>!h||typeof h!="string"?null:x.get(h)||null,S=h=>{if(!h)return 30;if(f==="algebraic-int"||Array.isArray(h.valueTokens)){const k=P4(h.valueTokens,30);if(k&&typeof k.radius=="number"&&Number.isFinite(k.radius))return k.radius}return 30},_=(h,k,T=[])=>{if(!h||!k||typeof h.x!="number"||typeof h.y!="number"||typeof k.x!="number"||typeof k.y!="number")return[0,0,100,100];const N={x:h.x,y:h.y},I={x:k.x,y:k.y},M=[{...h},...T,{...k}],L=40,A=50,R={...M[0]},j={...M[M.length-1]},G=M[1]||j,U=M[M.length-2]||R;let O=G.x-R.x,V=G.y-R.y,$=Math.atan2(V,O);if(h.type==="place"){const te=S(h);R.x+=te*Math.cos($),R.y+=te*Math.sin($)}else{const te=L/2,he=A/2,de=Math.abs(Math.cos($)),B=Math.abs(Math.sin($)),Q=Math.tan($);if(te*B<=he*de)R.x+=Math.sign(O)*te,R.y+=Math.sign(O)*te*Q;else{const J=Math.abs(Q)<1e-6?1e-6*Math.sign(Q||1):Q;R.x+=Math.sign(V)*he/J,R.y+=Math.sign(V)*he}}let D=j.x-U.x,X=j.y-U.y,H=Math.atan2(X,D);if(k.type==="place"){const te=S(k);j.x-=te*Math.cos(H),j.y-=te*Math.sin(H)}else{const te=L/2,he=A/2,de=Math.abs(Math.cos(H)),B=Math.abs(Math.sin(H)),Q=Math.tan(H);if(te*B<=he*de)j.x-=Math.sign(D)*te,j.y-=Math.sign(D)*te*Q;else{const J=Math.abs(Q)<1e-6?1e-6*Math.sign(Q||1):Q;j.x-=Math.sign(X)*he/J,j.y-=Math.sign(X)*he}}const re=[R.x,R.y];if(T.forEach(te=>re.push(te.x,te.y)),re.push(j.x,j.y),re.every(te=>Number.isFinite(te)))return re;const ne=[N.x,N.y];return T.forEach(te=>ne.push(te.x,te.y)),ne.push(I.x,I.y),ne};return[P.jsxs(Lc,{children:[(E=t==null?void 0:t.arcs)==null?void 0:E.map(h=>{try{if(!h||!h.source||!h.target)return null;const k=C(h.source),T=C(h.target);if(!k||!T)return null;const N=_({...k,type:sb(h)},{...T,type:ob(h)},Array.isArray(h.anglePoints)?h.anglePoints:[]);if(!N||N.length<4||!N.every(fe=>Number.isFinite(fe)))return null;const I=(N[0]+N[N.length-2])/2,M=(N[1]+N[N.length-1])/2;if(!Number.isFinite(I)||!Number.isFinite(M))return null;const L=8,A=14,R=(n==null?void 0:n.some(fe=>fe.id===h.id&&fe.type==="arc"))||(n==null?void 0:n.some(fe=>fe.id===k.id))&&(n==null?void 0:n.some(fe=>fe.id===T.id)),j=12,G=12,U=12,O=h.label?`${h.label}`:"",V=h.weight>1?`${h.weight}`:"",$=f==="algebraic-int"&&Array.isArray(h.bindings)&&h.bindings.length>0?h.bindings.map(f5).join(", "):"",D=i0(O,j,{padding:6,maxWidth:220}),X=i0(V,G,{padding:4,maxWidth:80}),H=i0($,U,{padding:6,maxWidth:240}),re=N[0],K=N[1],ne=N[N.length-2],te=N[N.length-1],he=ne-re,de=te-K,B=Math.hypot(he,de);let Q=0,J=-1;B>.001&&(Q=-de/B,J=he/B);const ie=6,ce=9,_e=8,Se=.66,Oe=Math.abs(Q),Ce=Math.abs(J),Qe=(fe,oe,xe=4)=>fe/2*Oe+oe/2*Ce+xe,Ve=s0(X,G),tt=s0(D,j),ln=s0(H,U),Gt=Math.max(ie,Qe(Ve,G)),Vt=Math.max(ce,Qe(tt,j)),Xn=Math.max(Vt+_e,Qe(ln,U,6)*Se),Kn=I-Q*Gt,Lt=M-J*Gt,Ar=I+Q*Vt,Ir=M+J*Vt,le=I+Q*Xn,ue=M+J*Xn;return!Ys(Kn)||!Ys(Lt)||!Ys(Ar)||!Ys(Ir)||!Ys(le)||!Ys(ue)?null:P.jsxs(Wd,{children:[P.jsx(FE,{points:N,stroke:(e==null?void 0:e.id)===h.id||R?"blue":"black",strokeWidth:2,fill:"black",pointerLength:10,pointerWidth:10,hitStrokeWidth:12,onClick:fe=>p(fe,h,"arc"),onTap:fe=>p(fe,h,"arc"),onDblClick:fe=>{if(r==="arc_angle"){const oe=s();oe&&m(h.id,oe)}}}),h.weight>1&&P.jsx(Gn,{x:Kn,y:Lt,text:V,fontSize:G,width:Ve,offsetX:Ve/2,offsetY:G/2,align:"center",listening:!1}),h.label&&P.jsx(Gn,{x:Ar,y:Ir,text:O,fontSize:j,fill:"gray",width:tt,offsetX:tt/2,offsetY:j/2,align:"center",wrap:D.wrap,ellipsis:D.wrap!=="none",listening:!1}),$&&P.jsx(Gn,{x:le,y:ue,text:$,fontSize:U,fill:"#333",width:ln,offsetX:ln/2,offsetY:U/2,align:"center",wrap:H.wrap,ellipsis:H.wrap!=="none",listening:!1})]},h.id)}catch(k){return console.warn("[ArcManager] Error rendering arc:",h==null?void 0:h.id,k),null}}),i&&i.sourcePoint&&P.jsx(mp,{points:[i.sourcePoint.x,i.sourcePoint.y,i.x,i.y],stroke:"grey",strokeWidth:2,dash:[5,5],listening:!1})]},"arcs-layer"),P.jsx(Lc,{children:(e==null?void 0:e.type)==="arc"&&r==="arc_angle"&&e.anglePoints.map((h,k)=>P.jsx(ll,{x:h.x,y:h.y,radius:6,fill:"red",stroke:"black",strokeWidth:1,draggable:!0,onDragEnd:T=>{const N={x:T.target.x(),y:T.target.y()},I=l?c(N.x,N.y):N;w(e.id,k,I)},onClick:T=>{T.evt.button===2&&(T.evt.preventDefault(),y(e.id,k))},onContextMenu:T=>{T.evt.preventDefault(),y(e.id,k)}},`angle-${e.id}-${k}`))},"handles-layer")]},ub=({width:t,height:e,gridSize:n})=>{const r=[],i=[],s=Math.ceil(e/n),l=Math.ceil(t/n);for(let c=0;c<=s;c++){const u=c*n;r.push(P.jsx(mp,{points:[0,u,t,u],stroke:"#ddd",strokeWidth:c%5===0?.5:.2,perfectDrawEnabled:!1,listening:!1},`h-${c}`))}for(let c=0;c<=l;c++){const u=c*n;i.push(P.jsx(mp,{points:[u,0,u,e],stroke:"#ddd",strokeWidth:c%5===0?.5:.2,perfectDrawEnabled:!1,listening:!1},`v-${c}`))}return P.jsxs(Wd,{listening:!1,perfectDrawEnabled:!1,children:[r,i]})},Z2=({orientation:t,contentSize:e,viewportSize:n,scrollPosition:r,onScroll:i})=>{const s=z.useRef(null),l=z.useRef(null),[c,u]=z.useState(!1),f=z.useRef(0),p=z.useRef(0),m=t==="horizontal",w=z.useCallback(M=>{M.preventDefault(),M.stopPropagation(),u(!0),f.current=r,p.current=m?M.clientX:M.clientY},[m,r]),y=z.useCallback(M=>{if(s.current&&l.current&&!l.current.contains(M.target)){const{left:L,top:A,width:R,height:j}=s.current.getBoundingClientRect(),G=m?R:j,U=Math.max(20,G*(n/e)),O=Math.max(0,e-n),V=Math.max(0,G-U);let D=((m?M.clientX-L:M.clientY-A)-U/2)/V*O;D=Math.max(0,Math.min(D,O)),i(D)}},[e,n,m,i]);if(z.useEffect(()=>{const M=A=>{if(!c||!s.current)return;const j=(m?A.clientX:A.clientY)-p.current,G=m?s.current.clientWidth:s.current.clientHeight,U=Math.max(20,G*(n/e)),O=Math.max(0,e-n),V=Math.max(0,G-U);if(V<=0)return;const $=O/V,D=f.current+j*$;i(Math.max(0,Math.min(D,O)))},L=()=>{c&&u(!1)};return c&&(document.addEventListener("mousemove",M),document.addEventListener("mouseup",L),document.body.style.cursor=m?"ew-resize":"ns-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",L),document.body.style.cursor="default",document.body.style.userSelect="auto"}},[c,m,i,e,n]),e<=n)return null;const x=s.current?m?s.current.clientWidth:s.current.clientHeight:0,C=x>0?x*(n/e):0,S=Math.max(20,Math.min(C,x)),_=Math.max(0,e-n),E=Math.max(0,x-S),h=Math.max(0,Math.min(r,_)),k=_>0?Math.min(h/_*E,E):0,T={position:"absolute",zIndex:50,padding:0,margin:0,...m?{left:"0px",right:"0px",bottom:"0px",height:"10px"}:{top:"0px",bottom:"0px",right:"0px",width:"10px"}},N={position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.1)",borderRadius:"6px",overflow:"hidden"},I={position:"absolute",backgroundColor:"rgba(0,0,0,0.45)",borderRadius:"6px",cursor:"pointer",willChange:"transform",...m?{left:`${Math.round(k)}px`,top:"0px",width:`${Math.round(S)}px`,height:"100%"}:{top:`${Math.round(k)}px`,left:"0px",height:`${Math.round(S)}px`,width:"100%"}};return P.jsx("div",{style:T,children:P.jsx("div",{ref:s,style:N,onMouseDown:y,children:P.jsx("div",{ref:l,style:I,onMouseDown:w})})})},cb=({position:t,visible:e,elementType:n})=>!e||!t?null:n==="place"?P.jsx(ll,{x:t.x,y:t.y,radius:5,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}):n==="transition"?P.jsx(Fc,{x:t.x-5,y:t.y-5,width:10,height:10,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}):P.jsx(ll,{x:t.x,y:t.y,radius:5,fill:"rgba(0, 120, 255, 0.5)",stroke:"rgba(0, 120, 255, 0.8)",strokeWidth:1,perfectDrawEnabled:!1,listening:!1}),db=({handleZoom:t,ZOOM_STEP:e,isSingleFingerPanningActive:n,isSelectionActiveRef:r,activateSingleFingerPan:i})=>{const{stageDimensions:s,setStageDimensions:l,virtualCanvasDimensions:c,canvasScroll:u,setCanvasScroll:f,zoomLevel:p,setContainerRef:m,stageRef:w,gridSize:y,gridSnappingEnabled:x,snapIndicator:C,setSnapIndicator:S}=Io(),{mode:_,setMode:E,arcStart:h,setArcStart:k,tempArcEnd:T,setTempArcEnd:N,selectedElement:I,setSelectedElement:M,elements:L,enabledTransitionIds:A,snapToGrid:R,selectedElements:j,setSelection:G,isDragging:U}=sn(),{handleCreateElement:O,handleElementClick:V,handleElementDragEnd:$}=Ig(),D=z.useRef(null),X=z.useRef({isSelecting:!1,start:null}),[H,re]=z.useState(null),[K,ne]=z.useState(!1),te=z.useRef(!1),he=z.useRef([]),de=z.useRef(null),B=z.useRef(null),Q=3,J=z.useRef({active:!1,touchId:null,startX:0,startY:0,startVirtualX:0,startVirtualY:0,maxMovement:0,startTime:0,selectionTimerId:null,gestureStartTimerId:null,gestureDecided:!1,gestureType:null,isQuickTap:!1}),ie=500,ce=25,_e=20,Se=10,Oe=50,Ce=z.useCallback(()=>{const le=J.current;le.selectionTimerId&&clearTimeout(le.selectionTimerId),le.gestureStartTimerId&&clearTimeout(le.gestureStartTimerId),J.current={active:!1,touchId:null,startX:0,startY:0,startVirtualX:0,startVirtualY:0,maxMovement:0,startTime:0,selectionTimerId:null,gestureStartTimerId:null,gestureDecided:!1,gestureType:null,isQuickTap:!1},r&&(r.current=!1)},[r]),Qe=z.useCallback((le,ue,fe)=>{Ce();const oe=J.current;oe.active=!0,oe.touchId=le.identifier,oe.startX=le.clientX,oe.startY=le.clientY,oe.startVirtualX=ue.x,oe.startVirtualY=ue.y,oe.maxMovement=0,oe.startTime=Date.now(),oe.gestureDecided=!1,oe.gestureType=null,oe.isQuickTap=!0,console.log("[TouchGesture] Started:",{touchId:le.identifier,startX:le.clientX,startY:le.clientY,isSelectMode:fe}),oe.gestureStartTimerId=setTimeout(()=>{const xe=J.current;if(!(!xe.active||xe.gestureDecided)){if(xe.maxMovement>Se){xe.isQuickTap=!1;return}fe&&(xe.isQuickTap=!1,xe.selectionTimerId=setTimeout(()=>{const ke=J.current;if(console.log("[TouchGesture] Timer fired:",{active:ke.active,gestureDecided:ke.gestureDecided,maxMovement:ke.maxMovement}),ke.gestureDecided||!ke.active){console.log("[TouchGesture] Selection cancelled - gesture already decided or inactive");return}if(ke.maxMovement>_e){console.log("[TouchGesture] Selection cancelled - moved too much:",ke.maxMovement);return}if(console.log("[TouchGesture] Selection ACTIVATED!"),ke.gestureDecided=!0,ke.gestureType="selection",ke.selectionTimerId=null,r&&(r.current=!0),X.current={isSelecting:!0,start:{x:ke.startVirtualX,y:ke.startVirtualY}},re({x:ke.startVirtualX,y:ke.startVirtualY,w:0,h:0}),navigator.vibrate)try{navigator.vibrate([10,50,10])}catch{}},ie-Oe))}},Oe)},[Ce,r,re]),Ve=z.useCallback(le=>{const ue=J.current;if(!ue.active||ue.gestureDecided||ue.isQuickTap&&ue.maxMovement<=Se)return;ue.maxMovement>Se&&(ue.isQuickTap=!1),Date.now()-ue.startTime>=ce&&ue.maxMovement>_e&&(ue.gestureDecided=!0,ue.gestureType="pan",ue.selectionTimerId&&(clearTimeout(ue.selectionTimerId),ue.selectionTimerId=null),ue.gestureStartTimerId&&(clearTimeout(ue.gestureStartTimerId),ue.gestureStartTimerId=null),i&&i())},[i]);z.useEffect(()=>{if(typeof window>"u")return;const le=window.matchMedia("(pointer: coarse)"),ue=fe=>ne(fe.matches);return ue(le),le.addEventListener?le.addEventListener("change",ue):le.addListener(ue),()=>{le.removeEventListener?le.removeEventListener("change",ue):le.removeListener(ue)}},[]),z.useEffect(()=>()=>{Ce()},[Ce]),z.useEffect(()=>{U||Ce()},[U,Ce]),z.useEffect(()=>{const le=D.current;if(!le)return;m(le);const ue=new ResizeObserver(fe=>{for(let oe of fe){const{width:xe,height:ke}=oe.contentRect;xe>0&&ke>0&&l({width:xe,height:ke})}});return ue.observe(le),()=>{ue.disconnect()}},[l,m]);const tt=()=>{const le=w.current;if(!le)return null;const ue=le.getPointerPosition();if(!ue)return null;const fe=le.getAbsoluteTransform().copy();fe.invert();const{x:oe,y:xe}=fe.point(ue);return{x:oe,y:xe}},ln=le=>{if(le.target.name()!=="background"||te.current)return;if(_==="select"){G([]),M(null);return}const ue=tt();ue&&O(ue)},Gt=le=>{if(le.target.name()!=="background"||te.current)return;if(_==="select"){G([]),M(null);return}const ue=tt();ue&&O(ue)},Vt=le=>{const ue=tt();if(ue){if(_==="arc"&&h){let fe=null;const oe=w.current;if(oe){const xe=oe.getPointerPosition(),ke=oe.getIntersection(xe);ke&&(ke.attrs.elementType==="place"||ke.attrs.elementType==="transition")&&ke.attrs.id!==h.element.id&&(fe={id:ke.attrs.id,type:ke.attrs.elementType})}N({sourcePoint:h.point,x:ue.x,y:ue.y,potentialTarget:fe})}if(r!=null&&r.current,_==="select"&&X.current.isSelecting&&X.current.start){const fe=X.current.start;re({x:fe.x,y:fe.y,w:ue.x-fe.x,h:ue.y-fe.y})}if(x&&(_==="place"||_==="transition")){const fe=R(ue.x,ue.y);S({visible:!0,position:fe,elementType:_})}else C.visible&&S({visible:!1,position:null,elementType:null})}},Xn=z.useCallback(()=>{const le=he.current;if(le.length<2)return{vx:0,vy:0};const[ue,fe]=le.slice(-2),oe=fe.time-ue.time;if(oe<=0)return{vx:0,vy:0};const xe=(fe.deltaX-ue.deltaX)/oe,ke=(fe.deltaY-ue.deltaY)/oe;return{vx:xe,vy:ke}},[]),Kn=z.useCallback((le,ue)=>{de.current&&cancelAnimationFrame(de.current),B.current&&clearTimeout(B.current);const fe=.95,oe=.01,xe=16;let ke=le/p,ft=ue/p,bs=performance.now();const Ns=Sl=>{const $i=Sl-bs;if(bs=Sl,ke*=Math.pow(fe,$i/xe),ft*=Math.pow(fe,$i/xe),Math.hypot(ke,ft)<oe){de.current=null;return}f(Bo=>{if(!c||!s)return Bo;const $d=Math.max(0,c.width-s.width/p),Hd=Math.max(0,c.height-s.height/p);return{x:Math.max(0,Math.min($d,Bo.x+ke*$i)),y:Math.max(0,Math.min(Hd,Bo.y+ft*$i))}}),de.current=requestAnimationFrame(Ns)};de.current=requestAnimationFrame(Ns)},[p,f,c,s]),Lt=z.useCallback(()=>{de.current&&(cancelAnimationFrame(de.current),de.current=null),B.current&&(clearTimeout(B.current),B.current=null),he.current=[]},[]),Ar=z.useCallback(le=>{if(le.preventDefault(),le.stopPropagation(),le.ctrlKey||le.metaKey){Lt();const ue=le.deltaY>0?-e:e;t(ue,{clientX:le.clientX,clientY:le.clientY})}else{const ue=le.deltaX/p,fe=le.deltaY/p,oe=performance.now();he.current.push({deltaX:le.deltaX,deltaY:le.deltaY,time:oe}),he.current.length>Q&&he.current.shift(),B.current&&clearTimeout(B.current),de.current&&(cancelAnimationFrame(de.current),de.current=null),f(xe=>{if(!c||!s)return xe;const ke=Math.max(0,c.width-s.width/p),ft=Math.max(0,c.height-s.height/p);return{x:Math.max(0,Math.min(ke,xe.x+ue)),y:Math.max(0,Math.min(ft,xe.y+fe))}}),B.current=setTimeout(()=>{const xe=Xn();Math.hypot(xe.vx,xe.vy)>.1&&Kn(xe.vx,xe.vy),B.current=null},150)}},[e,t,f,p,c,s,Xn,Kn,Lt]);z.useEffect(()=>{const le=D.current;if(!le)return;const ue=fe=>{le.contains(fe.target)&&Ar(fe)};return document.addEventListener("wheel",ue,{passive:!1}),()=>{document.removeEventListener("wheel",ue),Lt()}},[Ar,Lt]);const Ir=z.useCallback((le,ue)=>{f(fe=>{const oe=Math.max(0,c.width-s.width/p),xe=Math.max(0,c.height-s.height/p),ke=(bs,Ns)=>Math.max(0,Math.min(bs,Ns)),ft={...fe};return le==="x"&&(ft.x=ke(ue,oe)),le==="y"&&(ft.y=ke(ue,xe)),ft})},[f,c,s,p]);return P.jsxs("div",{ref:D,className:"canvas-container",style:{width:"100%",height:"100%",position:"relative",backgroundColor:"#f0f0f0",overflow:"hidden",touchAction:K?"none":"auto"},children:[P.jsxs(jE,{ref:w,width:s.width,height:s.height,listening:!0,onClick:ln,onTap:Gt,onMouseMove:Vt,onTouchMove:le=>{const ue=le.evt&&le.evt.touches||le.touches;if(K){const fe=J.current;if(fe.active&&!fe.gestureDecided&&ue&&ue.length===1){const oe=ue[0],xe=oe.clientX-fe.startX,ke=oe.clientY-fe.startY,ft=Math.hypot(xe,ke);fe.maxMovement=Math.max(fe.maxMovement,ft),fe.maxMovement>Se&&(fe.isQuickTap=!1),console.log("[TouchGesture] Move:",{distance:ft,maxMovement:fe.maxMovement,gestureDecided:fe.gestureDecided,isQuickTap:fe.isQuickTap}),Ve()}}Vt()},onMouseDown:le=>{if(_!=="select"||le.target&&le.target.name&&le.target.name()!=="background")return;const ue=tt();ue&&(X.current={isSelecting:!0,start:ue},re({x:ue.x,y:ue.y,w:0,h:0}))},onTouchStart:le=>{const ue=le.target&&le.target.name&&le.target.name()==="background",fe=le.evt&&le.evt.touches||le.touches;if(fe&&fe.length===1){const oe=fe[0],xe=tt();if(!xe)return;ue?Qe(oe,xe,_==="select"):Ce()}else Ce()},onMouseUp:()=>{if(_!=="select"||!X.current.isSelecting||!H)return;const le=K2(L,H);G(le),X.current={isSelecting:!1,start:null},re(null),te.current=!0,setTimeout(()=>{te.current=!1},100)},onTouchEnd:le=>{console.log("[TouchGesture] TouchEnd");const ue=J.current,fe=ue.isQuickTap&&ue.maxMovement<=Se;if(fe&&Ce(),_==="select"&&!fe&&X.current.isSelecting&&H){const oe=K2(L,H);G(oe),X.current={isSelecting:!1,start:null},re(null),te.current=!0,setTimeout(()=>{te.current=!1},100)}fe||Ce(),_==="arc"&&h&&setTimeout(()=>{if(_==="arc"&&h){const oe=w.current;if(oe){const xe=oe.getPointerPosition();if(xe){const ke=oe.getIntersection(xe);(!ke||ke.attrs.elementType!=="place"&&ke.attrs.elementType!=="transition")&&(k(null),N(null))}else k(null),N(null)}else k(null),N(null)}},20)},scaleX:p,scaleY:p,x:-u.x*p,y:-u.y*p,children:[P.jsxs(Lc,{children:[P.jsx(Fc,{x:0,y:0,width:c.width,height:c.height,fill:"#FFFFFF",name:"background",onClick:()=>{_==="arc"&&h&&(k(null),N(null)),M(null)},onTap:()=>{_==="arc"&&h&&(k(null),N(null)),M(null)},onTouchEnd:()=>{_==="arc"&&h&&(k(null),N(null)),M(null)}}),H&&P.jsx(Fc,{x:Math.min(H.x,H.x+H.w),y:Math.min(H.y,H.y+H.h),width:Math.abs(H.w),height:Math.abs(H.h),stroke:"#3399FF",strokeWidth:1,dash:[4,4],fill:"rgba(51,153,255,0.15)",listening:!1}),P.jsx(ub,{width:c.width,height:c.height,gridSize:y}),P.jsx(cb,{position:C.position,visible:C.visible,elementType:C.elementType})]}),P.jsx(ib,{elements:L,selectedElement:I,handleElementClick:V,handleElementDragEnd:$,enabledTransitionIds:A}),P.jsx(lb,{})]}),!K&&s.width>0&&c.width>s.width/p&&P.jsx(Z2,{orientation:"horizontal",contentSize:c.width,viewportSize:s.width/p,scrollPosition:u.x,onScroll:le=>Ir("x",le)}),!K&&s.height>0&&c.height>s.height/p&&P.jsx(Z2,{orientation:"vertical",contentSize:c.height,viewportSize:s.height/p,scrollPosition:u.y,onScroll:le=>{ve.debug("Vertical scroll callback:",{newScroll:le,currentScroll:u.y,maxScroll:Math.max(0,c.height-s.height/p)}),Ir("y",le)}})]})},fb=()=>{const{mode:t,setMode:e}=sn(),[n,r]=z.useState(!1);if(z.useEffect(()=>{if(typeof window>"u")return;const s=window.matchMedia("(pointer: coarse)"),l=c=>r(c.matches);return l(s),s.addEventListener?s.addEventListener("change",l):s.addListener(l),()=>{s.removeEventListener?s.removeEventListener("change",l):s.removeListener(l)}},[]),!n)return null;const i=s=>({width:"44px",height:"44px",borderRadius:"50%",backgroundColor:s?"#4338ca":"white",color:s?"white":"#374151",border:s?"2px solid #312e81":"1px solid #d1d5db",boxShadow:"0 2px 4px -1px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.06)",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",marginBottom:"8px",cursor:"pointer",position:"relative"});return P.jsxs("div",{className:"fixed bottom-32 left-6 z-50 flex flex-col items-center",children:[P.jsx("button",{style:i(t==="arc"),onClick:()=>e("arc"),title:"Arc Tool","data-testid":"toolbar-arc",className:"active:scale-95",children:P.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:P.jsx("path",{d:"M3 21l18-18M3 21l7-1M3 21l1-7"})})}),P.jsx("button",{style:i(t==="transition"),onClick:()=>e("transition"),title:"Transition Tool","data-testid":"toolbar-transition",className:"active:scale-95",children:P.jsx("div",{style:{width:"11px",height:"26px",backgroundColor:"currentColor"}})}),P.jsx("button",{style:i(t==="place"),onClick:()=>e("place"),title:"Place Tool","data-testid":"toolbar-place",className:"active:scale-95",children:P.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",border:"2px solid currentColor",backgroundColor:"transparent"}})}),P.jsx("button",{style:i(t==="select"),onClick:()=>e("select"),title:"Select Tool","data-testid":"toolbar-select",className:"active:scale-95",children:P.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:P.jsx("path",{d:"M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"})})})]})},o0=()=>({active:!1,touchId:null,startX:0,startY:0,lastX:0,lastY:0});function hb({MIN_ZOOM:t,MAX_ZOOM:e,zoomLevel:n,setZoomLevel:r,virtualCanvasDimensions:i,canvasScroll:s,setCanvasScroll:l,setContainerRef:c,isDragging:u=!1,isSelectionActiveRef:f=null}){const[p,m]=z.useState(null),w=z.useRef(null),y=z.useCallback(K=>{w.current=K,m(K),c&&c(K)},[c]),x=z.useRef(!1),C=z.useRef({active:!1}),S=z.useRef({active:!1,startX:0,startY:0,lastX:0,lastY:0}),[_,E]=z.useState(!1),h=z.useRef(o0()),k=z.useRef(n),T=z.useRef(!1),N=z.useRef(0),I=100,M=z.useRef(null),L=z.useRef([]),A=5;z.useEffect(()=>{k.current=n},[n]),z.useEffect(()=>{T.current=u,u||(N.current=performance.now())},[u]);const R=z.useCallback(K=>Math.max(t,Math.min(e,K)),[t,e]),j=z.useCallback((K,ne,te)=>{if(!w.current||!i)return;const he=w.current,de=he.clientWidth||1,B=he.clientHeight||1,Q=he.getBoundingClientRect(),J=te?Math.min(Math.max(te.clientX-Q.left,0),de):de/2,ie=te?Math.min(Math.max(te.clientY-Q.top,0),B):B/2,ce=(s.x+J)/K,_e=(s.y+ie)/K,Se=Math.max(0,i.width-de/ne),Oe=Math.max(0,i.height-B/ne),Ce=Math.max(0,Math.min(Se,ce*ne-J)),Qe=Math.max(0,Math.min(Oe,_e*ne-ie));l({x:Ce,y:Qe})},[s,l,i]),G=z.useCallback((K,ne,te)=>{if(!w.current||!i||!Number.isFinite(te)||te<=0)return;const he=w.current,de=he.clientWidth||1,B=he.clientHeight||1,Q=Math.max(0,i.width-de/te),J=Math.max(0,i.height-B/te);l(ie=>{const ce=Math.max(0,Math.min(Q,ie.x-K/te)),_e=Math.max(0,Math.min(J,ie.y-ne/te));return ce===ie.x&&_e===ie.y?ie:{x:ce,y:_e}})},[l,i]),U=z.useCallback(()=>{const K=L.current;if(K.length<2)return{vx:0,vy:0};const ne=K.slice(-Math.min(K.length,3)),[te,...he]=ne,de=ne[ne.length-1],B=de.time-te.time;if(B<=0||B>500)return{vx:0,vy:0};const Q=(de.x-te.x)/B,J=(de.y-te.y)/B;return{vx:Q,vy:J}},[]),O=z.useCallback((K,ne)=>{M.current&&cancelAnimationFrame(M.current);const te=.95,he=.01,de=16;let B=K,Q=ne,J=performance.now();const ie=ce=>{const _e=ce-J;if(J=ce,B*=Math.pow(te,_e/de),Q*=Math.pow(te,_e/de),Math.hypot(B,Q)<he){M.current=null;return}const Oe=B*_e,Ce=Q*_e;G(-Oe,-Ce,k.current),M.current=requestAnimationFrame(ie)};M.current=requestAnimationFrame(ie)},[G]),V=z.useCallback(()=>{M.current&&(cancelAnimationFrame(M.current),M.current=null),L.current=[]},[]),$=z.useCallback((K,ne)=>{r(te=>{const he=R(K(te));return he!==te&&j(te,he,ne),he})},[j,R,r]),D=z.useCallback((K,ne)=>{typeof K!="number"||Number.isNaN(K)||K===0||$(te=>te+K,ne)},[$]),X=z.useCallback((K,ne)=>{typeof K!="number"||Number.isNaN(K)||$(()=>K,ne)},[$]),H=z.useCallback(K=>{if(x.current){x.current=!1;return}l&&l({x:K.target.scrollLeft,y:K.target.scrollTop})},[l]);z.useEffect(()=>{w.current&&(x.current=!0,w.current.scrollLeft!==s.x&&(w.current.scrollLeft=s.x),w.current.scrollTop!==s.y&&(w.current.scrollTop=s.y))},[s,w]),z.useEffect(()=>{const K=p;if(!K)return;const ne=J=>{const[ie,ce]=J;return Math.hypot(ie.clientX-ce.clientX,ie.clientY-ce.clientY)},te=J=>{const[ie,ce]=J;return{clientX:(ie.clientX+ce.clientX)/2,clientY:(ie.clientY+ce.clientY)/2}},he=()=>{h.current=o0(),E(!1)},de=J=>{if(V(),J.touches.length===2){he();const ie=te(J.touches),ce=ne(J.touches);C.current={active:!1,startDistance:ce,startZoom:k.current,lastCenter:ie},S.current={active:!1,startX:ie.clientX,startY:ie.clientY,lastX:ie.clientX,lastY:ie.clientY},L.current=[];return}if(J.touches.length===1){S.current={active:!1,startX:0,startY:0,lastX:0,lastY:0},C.current={active:!1};const ce=performance.now()-N.current<I;if(T.current||ce){he(),L.current=[];return}const _e=J.touches[0];h.current={active:!1,touchId:_e.identifier,startX:_e.clientX,startY:_e.clientY,lastX:_e.clientX,lastY:_e.clientY},L.current=[];return}he(),C.current={active:!1},S.current={active:!1,startX:0,startY:0,lastX:0,lastY:0},L.current=[]},B=J=>{if(J.touches.length===2){he();const ie=te(J.touches),ce=ne(J.touches),_e=C.current,Se=_e.startDistance>0?ce/_e.startDistance:1;if(Math.abs(Se-1)>.05){_e.active||(C.current={..._e,active:!0}),J.preventDefault(),J.stopPropagation();const Qe=R(_e.startZoom*Se);X(Qe,ie),C.current={..._e,active:!0,startDistance:_e.startDistance,startZoom:_e.startZoom,lastCenter:ie}}else{const Ve={...S.current},tt=ie.clientX-Ve.lastX,ln=ie.clientY-Ve.lastY,Gt=ie.clientX-Ve.startX,Vt=ie.clientY-Ve.startY,Xn=Math.hypot(Gt,Vt),Kn=5;if(!Ve.active&&Xn>Kn&&(Ve.active=!0),Ve.active){J.preventDefault(),J.stopPropagation(),G(-tt,-ln,k.current);const Lt=performance.now();L.current.push({x:ie.clientX,y:ie.clientY,time:Lt}),L.current.length>A&&L.current.shift()}S.current={...Ve,lastX:ie.clientX,lastY:ie.clientY}}return}if(J.touches.length===1){const ie=(f==null?void 0:f.current)||!1,_e=performance.now()-N.current<I;if(T.current||_e||ie){he(),L.current=[];return}const Se=J.touches[0],Oe=h.current;if(Se.identifier!==Oe.touchId)return;if(Oe.active){const Ce=Se.clientX-Oe.lastX,Qe=Se.clientY-Oe.lastY;J.preventDefault(),J.stopPropagation(),G(-Ce,-Qe,k.current)}if(Oe.touchId!==null&&(Oe.lastX!==0||Oe.lastY!==0)){const Ce=performance.now();L.current.push({x:Se.clientX,y:Se.clientY,time:Ce}),L.current.length>A&&L.current.shift()}Oe.lastX=Se.clientX,Oe.lastY=Se.clientY;return}he(),C.current={active:!1},S.current={active:!1,startX:0,startY:0,lastX:0,lastY:0}},Q=J=>{const ie=S.current.active||h.current.active;let ce={vx:0,vy:0};if(L.current.length>=2){ce=U();const Se=Math.hypot(ce.vx,ce.vy);console.log("[Inertia] Touch end:",{panWasActive:ie,historyLength:L.current.length,velocity:{vx:ce.vx,vy:ce.vy},speed:Se,panStateActive:S.current.active,singlePanActive:h.current.active}),Se>.05&&(ie||Se>.2)?(console.log("[Inertia] Starting animation with velocity:",{vx:ce.vx,vy:ce.vy,speed:Se}),O(ce.vx,ce.vy)):console.log("[Inertia] Speed too low, not starting:",Se)}else console.log("[Inertia] Not starting:",{panWasActive:ie,historyLength:L.current.length});he(),C.current={active:!1},S.current={active:!1,startX:0,startY:0,lastX:0,lastY:0},setTimeout(()=>{M.current||(L.current=[])},100)};return K.addEventListener("touchstart",de,{passive:!1}),K.addEventListener("touchmove",B,{passive:!1}),K.addEventListener("touchend",Q,{passive:!1}),K.addEventListener("touchcancel",Q,{passive:!1}),()=>{K.removeEventListener("touchstart",de),K.removeEventListener("touchmove",B),K.removeEventListener("touchend",Q),K.removeEventListener("touchcancel",Q),V()}},[G,R,X,u,f,p,U,O,V]),z.useEffect(()=>{V(),L.current=[],h.current=o0(),E(!1),C.current={active:!1},S.current={active:!1,startX:0,startY:0,lastX:0,lastY:0},T.current=u,u||(N.current=performance.now())},[u,V]);const re=z.useCallback(()=>{const K=h.current;if(K.touchId!==null&&!K.active&&(K.active=!0,E(!0),navigator.vibrate))try{navigator.vibrate(10)}catch{}},[]);return{localCanvasContainerDivRef:y,handleZoom:D,handleNativeCanvasScroll:H,isSingleFingerPanningActive:_,activateSingleFingerPan:re}}function pb({elements:t,selectedElements:e,mode:n,clipboardRef:r,simulationSettings:i,simulatorCore:s}){try{if(t&&(window.__PETRI_NET_STATE__={places:t.places,transitions:t.transitions,arcs:t.arcs,selectedElements:e||[]}),typeof n<"u"&&(window.__PETRI_NET_MODE__=n),r&&(window.__PETRI_NET_CLIPBOARD__=r),i){const c=!!(i!=null&&i.batchMode),u=!!(i!=null&&i.limitIterations),f=Number(i==null?void 0:i.maxIterations),p=Number.isFinite(f)&&f>0?Math.floor(f):2e5,m=!!(i!=null&&i.useNonVisualRun||c);window.__PETRI_NET_NON_VISUAL_RUN__=m,window.__PETRI_NET_SETTINGS__={...window.__PETRI_NET_SETTINGS__||{},batchMode:c,limitIterations:u,maxIterations:p}}s&&!window.__PETRI_NET_SIM_CORE__&&(window.__PETRI_NET_SIM_CORE__=s)}catch{}}const gb=()=>{const{stageDimensions:e,virtualCanvasDimensions:n,canvasScroll:r,setCanvasScroll:i,zoomLevel:s,setZoomLevel:l,gridSnappingEnabled:c,toggleGridSnapping:u,MIN_ZOOM:f,MAX_ZOOM:p,appRef:m,containerRef:w,setContainerRef:y,stageRef:x}=Io(),{elements:C,setElements:S,selectedElement:_,setSelectedElement:E,selectedElements:h,mode:k,setMode:T,arcStart:N,setArcStart:I,tempArcEnd:M,setTempArcEnd:L,clearSelection:A,setSelection:R,isSettingsDialogOpen:j,setIsSettingsDialogOpen:G,simulationSettings:U,setSimulationSettings:O,historyManagerRef:V,canUndo:$,canRedo:D,handleUndo:X,handleRedo:H,updateHistory:re,snapToGrid:K,resetEditor:ne,simulatorCore:te,enabledTransitionIds:he,clipboardRef:de,setClipboard:B,getClipboard:Q,isShiftPressedRef:J}=sn(),[ie,ce]=z.useState(!1);z.useEffect(()=>{typeof SharedArrayBuffer>"u"?console.warn(" SharedArrayBuffer is not available. This is required for Z3 workers in batch mode. The COOP/COEP service worker should enable this. If this warning persists, the service worker may not be active. Try refreshing the page or checking browser console for service worker errors."):console.log(" SharedArrayBuffer is available - Z3 workers should work correctly")},[]);const{isDragging:_e}=sn(),Se=z.useRef(!1),{localCanvasContainerDivRef:Oe,handleZoom:Ce,handleNativeCanvasScroll:Qe,isSingleFingerPanningActive:Ve,activateSingleFingerPan:tt}=hb({MIN_ZOOM:f,MAX_ZOOM:p,zoomLevel:s,setZoomLevel:l,virtualCanvasDimensions:n,canvasScroll:r,setCanvasScroll:i,setContainerRef:y,isDragging:_e,isSelectionActiveRef:Se}),{handleDeleteElement:ln,clearAllElements:Gt}=Ig();return z.useEffect(()=>{pb({elements:C,selectedElements:h,mode:k,clipboardRef:de,simulationSettings:U,simulatorCore:te})},[C.places,C.transitions,C.arcs,h,k,U==null?void 0:U.useNonVisualRun,U==null?void 0:U.batchMode,U==null?void 0:U.limitIterations,U==null?void 0:U.maxIterations,de,te]),P5({elements:C,setElements:S,selectedElement:_,selectedElements:h,clearSelection:A,setSelection:R,clipboardRef:de,netMode:(U==null?void 0:U.netMode)||"pt",setClipboard:B,getClipboard:Q,onClipboardMismatch:void 0,handleUndo:X,handleRedo:H,setMode:T,arcStart:N,setArcStart:I,setTempArcEnd:L,setSelectedElement:E,isShiftPressedRef:J}),P.jsxs("div",{ref:m,className:"app-container h-screen max-h-screen overflow-hidden",tabIndex:-1,children:[P.jsx("button",{className:"fixed top-2.5 right-2 z-50 p-2 bg-white rounded-md shadow-md lg:hidden",onClick:()=>ce(!ie),children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),P.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 bg-white",onWheel:Vt=>Vt.stopPropagation(),children:P.jsx(S7,{mode:k,setMode:T,onNew:Gt,onUndo:X,canUndo:$,onRedo:H,canRedo:D,gridSnappingEnabled:c,onToggleGridSnapping:u,onOpenSettings:()=>G(!0),elements:C,setElements:S,updateHistory:re,simulationSettings:U,setSimulationSettings:O,resetEditor:ne})}),P.jsxs("div",{className:`fixed w-80 right-0 top-16 bottom-0 z-30 bg-gray-100/90 backdrop-blur-sm shadow-lg pt-4 flex flex-col overflow-hidden transform transition-transform duration-300 ease-in-out ${ie?"translate-x-0":"translate-x-full"} lg:translate-x-0`,onWheel:Vt=>Vt.stopPropagation(),children:[P.jsx("div",{className:"overflow-y-auto pr-2",children:P.jsx(L7,{selectedElement:_,elements:C,setElements:S,updateHistory:re,simulationSettings:U})}),P.jsx("div",{className:"flex-1 overflow-y-auto pr-2 border-t-2 border-gray-200",children:P.jsx(j7,{elements:C,enabledTransitionIds:he})}),P.jsx("div",{className:"hidden lg:block border-t-2 border-gray-200 mt-auto sticky bottom-0 bg-gray-100",children:P.jsx(r2,{})})]}),P.jsxs("div",{className:"fixed top-20 left-0 bottom-0 right-0 lg:right-80 transition-all duration-300",children:[P.jsx("div",{className:"absolute inset-0 overflow-hidden stage-container bg-gray-200 dark:bg-gray-700","data-testid":"canvas-container",ref:Oe,onScroll:Qe,children:P.jsx(db,{handleZoom:Ce,ZOOM_STEP:.1,isSingleFingerPanningActive:Ve,isSelectionActiveRef:Se,activateSingleFingerPan:tt})}),P.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-40",children:P.jsx(r2,{isMobile:!0})}),P.jsxs("div",{className:"hidden lg:flex fixed top-24 right-[336px] z-10 flex-col space-y-2 pointer-events-auto",children:[P.jsx("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none",onClick:()=>Ce(.1),title:"Zoom In",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),P.jsx("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none",onClick:()=>Ce(-.1),title:"Zoom Out",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 12H6"})})}),P.jsxs("button",{className:"bg-white p-2 rounded-full shadow-md hover:bg-gray-100 focus:outline-none text-xs font-mono",onClick:()=>{l(1),i({x:0,y:0})},title:"Reset Zoom",children:[Math.round(s*100),"%"]})]}),P.jsx(fb,{})]}),P.jsx(D7,{isOpen:j,onClose:()=>G(!1)})]})},mb=()=>P.jsx(xw,{children:P.jsx(w7,{children:P.jsx(_7,{children:P.jsx(gb,{})})})});a0.createRoot(document.getElementById("root")).render(P.jsx(Zt.StrictMode,{children:P.jsx(mb,{})}));export{ko as a,zn as b,pa as c,po as d,lr as e,Nw as f,Ew as g,vb as h,yb as i,ul as j,bw as p};
//# sourceMappingURL=index-b78a7e46.js.map
